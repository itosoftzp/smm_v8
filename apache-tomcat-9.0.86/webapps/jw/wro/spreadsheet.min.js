
(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==='object'&&typeof module==='object')
module.exports=factory();else if(typeof define==='function'&&define.amd)
define("Handsontable",[],factory);else if(typeof exports==='object')
exports["Handsontable"]=factory();else
root["Handsontable"]=factory();})(typeof self!=='undefined'?self:this,function(){return(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports;}
var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports;}
__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter});}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default'];}:function getModuleExports(){return module;};__webpack_require__.d(getter,'a',getter);return getter;};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property);};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=437);})
([(function(module,exports,__webpack_require__){var global=__webpack_require__(6);var core=__webpack_require__(21);var hide=__webpack_require__(28);var redefine=__webpack_require__(23);var ctx=__webpack_require__(37);var PROTOTYPE='prototype';var $export=function(type,name,source){var IS_FORCED=type&$export.F;var IS_GLOBAL=type&$export.G;var IS_STATIC=type&$export.S;var IS_PROTO=type&$export.P;var IS_BIND=type&$export.B;var target=IS_GLOBAL?global:IS_STATIC?global[name]||(global[name]={}):(global[name]||{})[PROTOTYPE];var exports=IS_GLOBAL?core:core[name]||(core[name]={});var expProto=exports[PROTOTYPE]||(exports[PROTOTYPE]={});var key,own,out,exp;if(IS_GLOBAL)source=name;for(key in source){own=!IS_FORCED&&target&&target[key]!==undefined;out=(own?target:source)[key];exp=IS_BIND&&own?ctx(out,global):IS_PROTO&&typeof out=='function'?ctx(Function.call,out):out;if(target)redefine(target,key,out,type&$export.U);if(exports[key]!=out)hide(exports,key,exp);if(IS_PROTO&&expProto[key]!=out)expProto[key]=out;}};global.core=core;$export.F=1;$export.G=2;$export.S=4;$export.P=8;$export.B=16;$export.W=32;$export.U=64;$export.R=128;module.exports=$export;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.getParent=getParent;exports.closest=closest;exports.closestDown=closestDown;exports.isChildOf=isChildOf;exports.isChildOfWebComponentTable=isChildOfWebComponentTable;exports.polymerWrap=polymerWrap;exports.polymerUnwrap=polymerUnwrap;exports.index=index;exports.overlayContainsElement=overlayContainsElement;exports.hasClass=hasClass;exports.addClass=addClass;exports.removeClass=removeClass;exports.removeTextNodes=removeTextNodes;exports.empty=empty;exports.fastInnerHTML=fastInnerHTML;exports.fastInnerText=fastInnerText;exports.isVisible=isVisible;exports.offset=offset;exports.getWindowScrollTop=getWindowScrollTop;exports.getWindowScrollLeft=getWindowScrollLeft;exports.getScrollTop=getScrollTop;exports.getScrollLeft=getScrollLeft;exports.getScrollableElement=getScrollableElement;exports.getTrimmingContainer=getTrimmingContainer;exports.getStyle=getStyle;exports.getComputedStyle=getComputedStyle;exports.outerWidth=outerWidth;exports.outerHeight=outerHeight;exports.innerHeight=innerHeight;exports.innerWidth=innerWidth;exports.addEvent=addEvent;exports.removeEvent=removeEvent;exports.getCaretPosition=getCaretPosition;exports.getSelectionEndPosition=getSelectionEndPosition;exports.getSelectionText=getSelectionText;exports.setCaretPosition=setCaretPosition;exports.getScrollbarWidth=getScrollbarWidth;exports.hasVerticalScrollbar=hasVerticalScrollbar;exports.hasHorizontalScrollbar=hasHorizontalScrollbar;exports.setOverlayPosition=setOverlayPosition;exports.getCssTransform=getCssTransform;exports.resetCssTransform=resetCssTransform;exports.isInput=isInput;exports.isOutsideInput=isOutsideInput;exports.HTML_CHARACTERS=void 0;var _browser=__webpack_require__(42);var _feature=__webpack_require__(47);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
function getParent(element){var level=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var iteration=-1;var parent=null;var elementToCheck=element;while(elementToCheck!==null){if(iteration===level){parent=elementToCheck;break;}
if(elementToCheck.host&&elementToCheck.nodeType===Node.DOCUMENT_FRAGMENT_NODE){elementToCheck=elementToCheck.host;}else{iteration+=1;elementToCheck=elementToCheck.parentNode;}}
return parent;}
function closest(element,nodes,until){var elementToCheck=element;while(elementToCheck!==null&&elementToCheck!==until){if(elementToCheck.nodeType===Node.ELEMENT_NODE&&(nodes.indexOf(elementToCheck.nodeName)>-1||nodes.indexOf(elementToCheck)>-1)){return elementToCheck;}
if(elementToCheck.host&&elementToCheck.nodeType===Node.DOCUMENT_FRAGMENT_NODE){elementToCheck=elementToCheck.host;}else{elementToCheck=elementToCheck.parentNode;}}
return null;}
function closestDown(element,nodes,until){var matched=[];var elementToCheck=element;while(elementToCheck){elementToCheck=closest(elementToCheck,nodes,until);if(!elementToCheck||until&&!until.contains(elementToCheck)){break;}
matched.push(elementToCheck);if(elementToCheck.host&&elementToCheck.nodeType===Node.DOCUMENT_FRAGMENT_NODE){elementToCheck=elementToCheck.host;}else{elementToCheck=elementToCheck.parentNode;}}
var length=matched.length;return length?matched[length-1]:null;}
function isChildOf(child,parent){var node=child.parentNode;var queriedParents=[];if(typeof parent==='string'){queriedParents=Array.prototype.slice.call(document.querySelectorAll(parent),0);}else{queriedParents.push(parent);}
while(node!==null){if(queriedParents.indexOf(node)>-1){return true;}
node=node.parentNode;}
return false;}
function isChildOfWebComponentTable(element){var hotTableName='hot-table';var result=false;var parentNode=polymerWrap(element);function isHotTable(testElement){return testElement.nodeType===Node.ELEMENT_NODE&&testElement.nodeName===hotTableName.toUpperCase();}
while(parentNode!==null){if(isHotTable(parentNode)){result=true;break;}else if(parentNode.host&&parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){result=isHotTable(parentNode.host);if(result){break;}
parentNode=parentNode.host;}
parentNode=parentNode.parentNode;}
return result;}
function polymerWrap(element){return typeof Polymer!=='undefined'&&typeof wrap==='function'?wrap(element):element;}
function polymerUnwrap(element){return typeof Polymer!=='undefined'&&typeof unwrap==='function'?unwrap(element):element;}
function index(element){var i=0;var elementToCheck=element;if(elementToCheck.previousSibling){while(elementToCheck=elementToCheck.previousSibling){i+=1;}}
return i;}
function overlayContainsElement(overlayType,element){var overlayElement=document.querySelector(".ht_clone_".concat(overlayType));return overlayElement?overlayElement.contains(element):null;}
var classListSupport=!!document.documentElement.classList;var _hasClass;var _addClass;var _removeClass;function filterEmptyClassNames(classNames){var result=[];if(!classNames||!classNames.length){return result;}
var len=0;while(classNames[len]){result.push(classNames[len]);len+=1;}
return result;}
if(classListSupport){var isSupportMultipleClassesArg=function(){var element=document.createElement('div');element.classList.add('test','test2');return element.classList.contains('test2');}();_hasClass=function _hasClass(element,className){if(element.classList===void 0||typeof className!=='string'||className===''){return false;}
return element.classList.contains(className);};_addClass=function _addClass(element,classes){var className=classes;if(typeof className==='string'){className=className.split(' ');}
className=filterEmptyClassNames(className);if(className.length>0){if(isSupportMultipleClassesArg){var _element$classList;(_element$classList=element.classList).add.apply(_element$classList,_toConsumableArray(className));}else{var len=0;while(className&&className[len]){element.classList.add(className[len]);len+=1;}}}};_removeClass=function _removeClass(element,classes){var className=classes;if(typeof className==='string'){className=className.split(' ');}
className=filterEmptyClassNames(className);if(className.length>0){if(isSupportMultipleClassesArg){var _element$classList2;(_element$classList2=element.classList).remove.apply(_element$classList2,_toConsumableArray(className));}else{var len=0;while(className&&className[len]){element.classList.remove(className[len]);len+=1;}}}};}else{var createClassNameRegExp=function createClassNameRegExp(className){return new RegExp("(\\s|^)".concat(className,"(\\s|$)"));};_hasClass=function _hasClass(element,className){return element.className!==void 0&&createClassNameRegExp(className).test(element.className);};_addClass=function _addClass(element,classes){var len=0;var _className=element.className;var className=classes;if(typeof className==='string'){className=className.split(' ');}
if(_className===''){_className=className.join(' ');}else{while(className&&className[len]){if(!createClassNameRegExp(className[len]).test(_className)){_className+=" ".concat(className[len]);}
len+=1;}}
element.className=_className;};_removeClass=function _removeClass(element,classes){var len=0;var _className=element.className;var className=classes;if(typeof className==='string'){className=className.split(' ');}
while(className&&className[len]){_className=_className.replace(createClassNameRegExp(className[len]),' ').trim();len+=1;}
if(element.className!==_className){element.className=_className;}};}
function hasClass(element,className){return _hasClass(element,className);}
function addClass(element,className){return _addClass(element,className);}
function removeClass(element,className){return _removeClass(element,className);}
function removeTextNodes(element,parent){if(element.nodeType===3){parent.removeChild(element);}else if(['TABLE','THEAD','TBODY','TFOOT','TR'].indexOf(element.nodeName)>-1){var childs=element.childNodes;for(var i=childs.length-1;i>=0;i--){removeTextNodes(childs[i],element);}}}
function empty(element){var child;while(child=element.lastChild){element.removeChild(child);}}
var HTML_CHARACTERS=/(<(.*)>|&(.*);)/;exports.HTML_CHARACTERS=HTML_CHARACTERS;function fastInnerHTML(element,content){if(HTML_CHARACTERS.test(content)){element.innerHTML=content;}else{fastInnerText(element,content);}}
var textContextSupport=!!document.createTextNode('test').textContent;function fastInnerText(element,content){var child=element.firstChild;if(child&&child.nodeType===3&&child.nextSibling===null){if(textContextSupport){child.textContent=content;}else{child.data=content;}}else{empty(element);element.appendChild(document.createTextNode(content));}}
function isVisible(elem){var next=elem;while(polymerUnwrap(next)!==document.documentElement){if(next===null){return false;}else if(next.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(next.host){if(next.host.impl){return isVisible(next.host.impl);}else if(next.host){return isVisible(next.host);}
throw new Error('Lost in Web Components world');}else{return false;}}else if(next.style.display==='none'){return false;}
next=next.parentNode;}
return true;}
function offset(elem){var docElem=document.documentElement;var elementToCheck=elem;var offsetLeft;var offsetTop;var lastElem;var box;if((0,_feature.hasCaptionProblem)()&&elementToCheck.firstChild&&elementToCheck.firstChild.nodeName==='CAPTION'){box=elementToCheck.getBoundingClientRect();return{top:box.top+(window.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(window.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)};}
offsetLeft=elementToCheck.offsetLeft;offsetTop=elementToCheck.offsetTop;lastElem=elementToCheck;while(elementToCheck=elementToCheck.offsetParent){if(elementToCheck===document.body){break;}
offsetLeft+=elementToCheck.offsetLeft;offsetTop+=elementToCheck.offsetTop;lastElem=elementToCheck;}
if(lastElem&&lastElem.style.position==='fixed'){offsetLeft+=window.pageXOffset||docElem.scrollLeft;offsetTop+=window.pageYOffset||docElem.scrollTop;}
return{left:offsetLeft,top:offsetTop};}
function getWindowScrollTop(){var res=window.scrollY;if(res===void 0){res=document.documentElement.scrollTop;}
return res;}
function getWindowScrollLeft(){var res=window.scrollX;if(res===void 0){res=document.documentElement.scrollLeft;}
return res;}
function getScrollTop(element){if(element===window){return getWindowScrollTop();}
return element.scrollTop;}
function getScrollLeft(element){if(element===window){return getWindowScrollLeft();}
return element.scrollLeft;}
function getScrollableElement(element){var props=['auto','scroll'];var el=element.parentNode;var overflow;var overflowX;var overflowY;var computedStyle='';var computedOverflow='';var computedOverflowY='';var computedOverflowX='';while(el&&el.style&&document.body!==el){overflow=el.style.overflow;overflowX=el.style.overflowX;overflowY=el.style.overflowY;if(overflow==='scroll'||overflowX==='scroll'||overflowY==='scroll'){return el;}else if(window.getComputedStyle){computedStyle=window.getComputedStyle(el);computedOverflow=computedStyle.getPropertyValue('overflow');computedOverflowY=computedStyle.getPropertyValue('overflow-y');computedOverflowX=computedStyle.getPropertyValue('overflow-x');if(computedOverflow==='scroll'||computedOverflowX==='scroll'||computedOverflowY==='scroll'){return el;}}
if(el.clientHeight<=el.scrollHeight+1&&(props.indexOf(overflowY)!==-1||props.indexOf(overflow)!==-1||props.indexOf(computedOverflow)!==-1||props.indexOf(computedOverflowY)!==-1)){return el;}
if(el.clientWidth<=el.scrollWidth+1&&(props.indexOf(overflowX)!==-1||props.indexOf(overflow)!==-1||props.indexOf(computedOverflow)!==-1||props.indexOf(computedOverflowX)!==-1)){return el;}
el=el.parentNode;}
return window;}
function getTrimmingContainer(base){var el=base.parentNode;while(el&&el.style&&document.body!==el){if(el.style.overflow!=='visible'&&el.style.overflow!==''){return el;}
var computedStyle=getComputedStyle(el);var allowedProperties=['scroll','hidden','auto'];var property=computedStyle.getPropertyValue('overflow');var propertyY=computedStyle.getPropertyValue('overflow-y');var propertyX=computedStyle.getPropertyValue('overflow-x');if(allowedProperties.includes(property)||allowedProperties.includes(propertyY)||allowedProperties.includes(propertyX)){return el;}
el=el.parentNode;}
return window;}
function getStyle(element,prop){if(!element){return;}else if(element===window){if(prop==='width'){return window.innerWidth+'px';}else if(prop==='height'){return window.innerHeight+'px';}
return;}
var styleProp=element.style[prop],computedStyle;if(styleProp!==''&&styleProp!==void 0){return styleProp;}else{computedStyle=getComputedStyle(element);if(computedStyle[prop]!==''&&computedStyle[prop]!==void 0){return computedStyle[prop];}}}
function getComputedStyle(element){return element.currentStyle||document.defaultView.getComputedStyle(element);}
function outerWidth(element){return element.offsetWidth;}
function outerHeight(elem){if((0,_feature.hasCaptionProblem)()&&elem.firstChild&&elem.firstChild.nodeName==='CAPTION'){return elem.offsetHeight+elem.firstChild.offsetHeight;}
return elem.offsetHeight;}
function innerHeight(element){return element.clientHeight||element.innerHeight;}
function innerWidth(element){return element.clientWidth||element.innerWidth;}
function addEvent(element,event,callback){if(window.addEventListener){element.addEventListener(event,callback,false);}else{element.attachEvent('on'+event,callback);}}
function removeEvent(element,event,callback){if(window.removeEventListener){element.removeEventListener(event,callback,false);}else{element.detachEvent('on'+event,callback);}}
function getCaretPosition(el){if(el.selectionStart){return el.selectionStart;}else if(document.selection){el.focus();var r=document.selection.createRange();if(r==null){return 0;}
var re=el.createTextRange();var rc=re.duplicate();re.moveToBookmark(r.getBookmark());rc.setEndPoint('EndToStart',re);return rc.text.length;}
return 0;}
function getSelectionEndPosition(el){if(el.selectionEnd){return el.selectionEnd;}else if(document.selection){var r=document.selection.createRange();if(r==null){return 0;}
var re=el.createTextRange();return re.text.indexOf(r.text)+r.text.length;}
return 0;}
function getSelectionText(){var text='';if(window.getSelection){text=window.getSelection().toString();}else if(document.selection&&document.selection.type!=='Control'){text=document.selection.createRange().text;}
return text;}
function setCaretPosition(element,pos,endPos){if(endPos===void 0){endPos=pos;}
if(element.setSelectionRange){element.focus();try{element.setSelectionRange(pos,endPos);}catch(err){var elementParent=element.parentNode;var parentDisplayValue=elementParent.style.display;elementParent.style.display='block';element.setSelectionRange(pos,endPos);elementParent.style.display=parentDisplayValue;}}else if(element.createTextRange){var range=element.createTextRange();range.collapse(true);range.moveEnd('character',endPos);range.moveStart('character',pos);range.select();}}
var cachedScrollbarWidth;function walkontableCalculateScrollbarWidth(){var inner=document.createElement('div');inner.style.height='200px';inner.style.width='100%';var outer=document.createElement('div');outer.style.boxSizing='content-box';outer.style.height='150px';outer.style.left='0px';outer.style.overflow='hidden';outer.style.position='absolute';outer.style.top='0px';outer.style.width='200px';outer.style.visibility='hidden';outer.appendChild(inner);(document.body||document.documentElement).appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow='scroll';var w2=inner.offsetWidth;if(w1==w2){w2=outer.clientWidth;}
(document.body||document.documentElement).removeChild(outer);return w1-w2;}
function getScrollbarWidth(){if(cachedScrollbarWidth===void 0){cachedScrollbarWidth=walkontableCalculateScrollbarWidth();}
return cachedScrollbarWidth;}
function hasVerticalScrollbar(element){return element.offsetWidth!==element.clientWidth;}
function hasHorizontalScrollbar(element){return element.offsetHeight!==element.clientHeight;}
function setOverlayPosition(overlayElem,left,top){if((0,_browser.isIE8)()||(0,_browser.isIE9)()){overlayElem.style.top=top;overlayElem.style.left=left;}else if((0,_browser.isSafari)()){overlayElem.style['-webkit-transform']='translate3d('+left+','+top+',0)';}else{overlayElem.style.transform='translate3d('+left+','+top+',0)';}}
function getCssTransform(element){var transform;if(element.style.transform&&(transform=element.style.transform)!==''){return['transform',transform];}else if(element.style['-webkit-transform']&&(transform=element.style['-webkit-transform'])!==''){return['-webkit-transform',transform];}
return-1;}
function resetCssTransform(element){if(element.style.transform&&element.style.transform!==''){element.style.transform='';}else if(element.style['-webkit-transform']&&element.style['-webkit-transform']!==''){element.style['-webkit-transform']='';}}
function isInput(element){var inputs=['INPUT','SELECT','TEXTAREA'];return element&&(inputs.indexOf(element.nodeName)>-1||element.contentEditable==='true');}
function isOutsideInput(element){return isInput(element)&&element.className.indexOf('handsontableInput')==-1&&element.className.indexOf('copyPaste')==-1;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.duckSchema=duckSchema;exports.inherit=inherit;exports.extend=extend;exports.deepExtend=deepExtend;exports.deepClone=deepClone;exports.clone=clone;exports.mixin=mixin;exports.isObjectEqual=isObjectEqual;exports.isObject=isObject;exports.defineGetter=defineGetter;exports.objectEach=objectEach;exports.getProperty=getProperty;exports.deepObjectSize=deepObjectSize;exports.createObjectPropListener=createObjectPropListener;exports.hasOwnProperty=hasOwnProperty;var _array=__webpack_require__(3);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function duckSchema(object){var schema;if(Array.isArray(object)){schema=[];}else{schema={};objectEach(object,function(value,key){if(key==='__children'){return;}
if(value&&_typeof(value)==='object'&&!Array.isArray(value)){schema[key]=duckSchema(value);}else if(Array.isArray(value)){if(value.length&&_typeof(value[0])==='object'&&!Array.isArray(value[0])){schema[key]=[duckSchema(value[0])];}else{schema[key]=[];}}else{schema[key]=null;}});}
return schema;}
function inherit(Child,Parent){Parent.prototype.constructor=Parent;Child.prototype=new Parent();Child.prototype.constructor=Child;return Child;}
function extend(target,extension){objectEach(extension,function(value,key){target[key]=value;});return target;}
function deepExtend(target,extension){objectEach(extension,function(value,key){if(extension[key]&&_typeof(extension[key])==='object'){if(!target[key]){if(Array.isArray(extension[key])){target[key]=[];}else if(Object.prototype.toString.call(extension[key])==='[object Date]'){target[key]=extension[key];}else{target[key]={};}}
deepExtend(target[key],extension[key]);}else{target[key]=extension[key];}});}
function deepClone(obj){if(_typeof(obj)==='object'){return JSON.parse(JSON.stringify(obj));}
return obj;}
function clone(object){var result={};objectEach(object,function(value,key){result[key]=value;});return result;}
function mixin(Base){if(!Base.MIXINS){Base.MIXINS=[];}
for(var _len=arguments.length,mixins=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){mixins[_key-1]=arguments[_key];}
(0,_array.arrayEach)(mixins,function(mixinItem){Base.MIXINS.push(mixinItem.MIXIN_NAME);objectEach(mixinItem,function(value,key){if(Base.prototype[key]!==void 0){throw new Error("Mixin conflict. Property '".concat(key,"' already exist and cannot be overwritten."));}
if(typeof value==='function'){Base.prototype[key]=value;}else{var getter=function _getter(property,initialValue){var propertyName="_".concat(property);var initValue=function initValue(newValue){var result=newValue;if(Array.isArray(result)||isObject(result)){result=deepClone(result);}
return result;};return function(){if(this[propertyName]===void 0){this[propertyName]=initValue(initialValue);}
return this[propertyName];};};var setter=function _setter(property){var propertyName="_".concat(property);return function(newValue){this[propertyName]=newValue;};};Object.defineProperty(Base.prototype,key,{get:getter(key,value),set:setter(key),configurable:true});}});});return Base;}
function isObjectEqual(object1,object2){return JSON.stringify(object1)===JSON.stringify(object2);}
function isObject(obj){return Object.prototype.toString.call(obj)==='[object Object]';}
function defineGetter(object,property,value,options){options.value=value;options.writable=options.writable!==false;options.enumerable=options.enumerable!==false;options.configurable=options.configurable!==false;Object.defineProperty(object,property,options);}
function objectEach(object,iteratee){for(var key in object){if(!object.hasOwnProperty||object.hasOwnProperty&&Object.prototype.hasOwnProperty.call(object,key)){if(iteratee(object[key],key,object)===false){break;}}}
return object;}
function getProperty(object,name){var names=name.split('.');var result=object;objectEach(names,function(nameItem){result=result[nameItem];if(result===void 0){result=void 0;return false;}});return result;}
function deepObjectSize(object){if(!isObject(object)){return 0;}
var recursObjLen=function recursObjLen(obj){var result=0;if(isObject(obj)){objectEach(obj,function(key){result+=recursObjLen(key);});}else{result+=1;}
return result;};return recursObjLen(object);}
function createObjectPropListener(defaultValue){var _holder;var propertyToListen=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'value';var privateProperty="_".concat(propertyToListen);var holder=(_holder={_touched:false},_defineProperty(_holder,privateProperty,defaultValue),_defineProperty(_holder,"isTouched",function isTouched(){return this._touched;}),_holder);Object.defineProperty(holder,propertyToListen,{get:function get(){return this[privateProperty];},set:function set(value){this._touched=true;this[privateProperty]=value;},enumerable:true,configurable:true});return holder;}
function hasOwnProperty(object,key){return Object.prototype.hasOwnProperty.call(object,key);}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.to2dArray=to2dArray;exports.extendArray=extendArray;exports.pivot=pivot;exports.arrayReduce=arrayReduce;exports.arrayFilter=arrayFilter;exports.arrayMap=arrayMap;exports.arrayEach=arrayEach;exports.arraySum=arraySum;exports.arrayMax=arrayMax;exports.arrayMin=arrayMin;exports.arrayAvg=arrayAvg;exports.arrayFlatten=arrayFlatten;exports.arrayUnique=arrayUnique;function to2dArray(arr){var ilen=arr.length;var i=0;while(i<ilen){arr[i]=[arr[i]];i+=1;}}
function extendArray(arr,extension){var ilen=extension.length;var i=0;while(i<ilen){arr.push(extension[i]);i+=1;}}
function pivot(arr){var pivotedArr=[];if(!arr||arr.length===0||!arr[0]||arr[0].length===0){return pivotedArr;}
var rowCount=arr.length;var colCount=arr[0].length;for(var i=0;i<rowCount;i++){for(var j=0;j<colCount;j++){if(!pivotedArr[j]){pivotedArr[j]=[];}
pivotedArr[j][i]=arr[i][j];}}
return pivotedArr;}
function arrayReduce(array,iteratee,accumulator,initFromArray){var index=-1;var iterable=array;var result=accumulator;if(!Array.isArray(array)){iterable=Array.from(array);}
var length=iterable.length;if(initFromArray&&length){index+=1;result=iterable[index];}
index+=1;while(index<length){result=iteratee(result,iterable[index],index,iterable);index+=1;}
return result;}
function arrayFilter(array,predicate){var index=0;var iterable=array;if(!Array.isArray(array)){iterable=Array.from(array);}
var length=iterable.length;var result=[];var resIndex=-1;while(index<length){var value=iterable[index];if(predicate(value,index,iterable)){resIndex+=1;result[resIndex]=value;}
index+=1;}
return result;}
function arrayMap(array,iteratee){var index=0;var iterable=array;if(!Array.isArray(array)){iterable=Array.from(array);}
var length=iterable.length;var result=[];var resIndex=-1;while(index<length){var value=iterable[index];resIndex+=1;result[resIndex]=iteratee(value,index,iterable);index+=1;}
return result;}
function arrayEach(array,iteratee){var index=0;var iterable=array;if(!Array.isArray(array)){iterable=Array.from(array);}
var length=iterable.length;while(index<length){if(iteratee(iterable[index],index,iterable)===false){break;}
index+=1;}
return array;}
function arraySum(array){return arrayReduce(array,function(a,b){return a+b;},0);}
function arrayMax(array){return arrayReduce(array,function(a,b){return a>b?a:b;},Array.isArray(array)?array[0]:void 0);}
function arrayMin(array){return arrayReduce(array,function(a,b){return a<b?a:b;},Array.isArray(array)?array[0]:void 0);}
function arrayAvg(array){if(!array.length){return 0;}
return arraySum(array)/array.length;}
function arrayFlatten(array){return arrayReduce(array,function(initial,value){return initial.concat(Array.isArray(value)?arrayFlatten(value):value);},[]);}
function arrayUnique(array){var unique=[];arrayEach(array,function(value){if(unique.indexOf(value)===-1){unique.push(value);}});return unique;}}),(function(module,exports){module.exports=function(exec){try{return!!exec();}catch(e){return true;}};}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);module.exports=function(it){if(!isObject(it))throw TypeError(it+' is not an object!');return it;};}),(function(module,exports){var global=module.exports=typeof window!='undefined'&&window.Math==Math?window:typeof self!='undefined'&&self.Math==Math?self:Function('return this')();if(typeof __g=='number')__g=global;}),(function(module,exports){module.exports=function(it){return typeof it==='object'?it!==null:typeof it==='function';};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;__webpack_require__(129);var _viewportColumns=_interopRequireDefault(__webpack_require__(160));exports.ViewportColumnsCalculator=_viewportColumns.default;var _viewportRows=_interopRequireDefault(__webpack_require__(161));exports.ViewportRowsCalculator=_viewportRows.default;var _coords=_interopRequireDefault(__webpack_require__(75));exports.CellCoords=_coords.default;var _range=_interopRequireDefault(__webpack_require__(162));exports.CellRange=_range.default;var _column=_interopRequireDefault(__webpack_require__(163));exports.ColumnFilter=_column.default;var _row=_interopRequireDefault(__webpack_require__(164));exports.RowFilter=_row.default;var _debug=_interopRequireDefault(__webpack_require__(605));exports.DebugOverlay=_debug.default;var _left=_interopRequireDefault(__webpack_require__(607));exports.LeftOverlay=_left.default;var _top=_interopRequireDefault(__webpack_require__(608));exports.TopOverlay=_top.default;var _topLeftCorner=_interopRequireDefault(__webpack_require__(609));exports.TopLeftCornerOverlay=_topLeftCorner.default;var _bottom=_interopRequireDefault(__webpack_require__(610));exports.BottomOverlay=_bottom.default;var _bottomLeftCorner=_interopRequireDefault(__webpack_require__(611));exports.BottomLeftCornerOverlay=_bottomLeftCorner.default;var _border=_interopRequireDefault(__webpack_require__(293));exports.Border=_border.default;var _core=_interopRequireDefault(__webpack_require__(165));exports.default=_core.default;exports.Core=_core.default;var _event=_interopRequireDefault(__webpack_require__(286));exports.Event=_event.default;var _overlays=_interopRequireDefault(__webpack_require__(287));exports.Overlays=_overlays.default;var _scroll=_interopRequireDefault(__webpack_require__(288));exports.Scroll=_scroll.default;var _selection=_interopRequireDefault(__webpack_require__(612));exports.Selection=_selection.default;var _settings=_interopRequireDefault(__webpack_require__(289));exports.Settings=_settings.default;var _table=_interopRequireDefault(__webpack_require__(290));exports.Table=_table.default;var _tableRenderer=_interopRequireDefault(__webpack_require__(291));exports.TableRenderer=_tableRenderer.default;var _viewport=_interopRequireDefault(__webpack_require__(292));exports.Viewport=_viewport.default;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.isNumeric=isNumeric;exports.rangeEach=rangeEach;exports.rangeEachReverse=rangeEachReverse;exports.valueAccordingPercent=valueAccordingPercent;function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function isNumeric(n){var t=_typeof(n);return t=='number'?!isNaN(n)&&isFinite(n):t=='string'?!n.length?false:n.length==1?/\d/.test(n):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(n):t=='object'?!!n&&typeof n.valueOf()=='number'&&!(n instanceof Date):false;}
function rangeEach(rangeFrom,rangeTo,iteratee){var index=-1;if(typeof rangeTo==='function'){iteratee=rangeTo;rangeTo=rangeFrom;}else{index=rangeFrom-1;}
while(++index<=rangeTo){if(iteratee(index)===false){break;}}}
function rangeEachReverse(rangeFrom,rangeTo,iteratee){var index=rangeFrom+1;if(typeof rangeTo==='function'){iteratee=rangeTo;rangeTo=0;}
while(--index>=rangeTo){if(iteratee(index)===false){break;}}}
function valueAccordingPercent(value,percent){percent=parseInt(percent.toString().replace('%',''),10);percent=parseInt(value*percent/100,10);return percent;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.getListenersCounter=getListenersCounter;exports.default=void 0;var _element=__webpack_require__(1);var _object=__webpack_require__(2);var _feature=__webpack_require__(47);var _event=__webpack_require__(18);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var listenersCounter=0;var EventManager=function(){function EventManager(){var context=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;_classCallCheck(this,EventManager);this.context=context||this;if(!this.context.eventListeners){this.context.eventListeners=[];}}
_createClass(EventManager,[{key:"addEventListener",value:function addEventListener(element,eventName,callback){var _this=this;var context=this.context;function callbackProxy(event){callback.call(this,extendEvent(context,event));}
this.context.eventListeners.push({element:element,event:eventName,callback:callback,callbackProxy:callbackProxy});element.addEventListener(eventName,callbackProxy,false);listenersCounter+=1;return function(){_this.removeEventListener(element,eventName,callback);};}},{key:"removeEventListener",value:function removeEventListener(element,eventName,callback){var len=this.context.eventListeners.length;var tmpEvent;while(len){len-=1;tmpEvent=this.context.eventListeners[len];if(tmpEvent.event===eventName&&tmpEvent.element===element){if(callback&&callback!==tmpEvent.callback){continue;}
this.context.eventListeners.splice(len,1);tmpEvent.element.removeEventListener(tmpEvent.event,tmpEvent.callbackProxy,false);listenersCounter-=1;}}}},{key:"clearEvents",value:function clearEvents(){if(!this.context){return;}
var len=this.context.eventListeners.length;while(len){len-=1;var event=this.context.eventListeners[len];if(event){this.removeEventListener(event.element,event.event,event.callback);}}}},{key:"clear",value:function clear(){this.clearEvents();}},{key:"destroy",value:function destroy(){this.clearEvents();this.context=null;}},{key:"fireEvent",value:function fireEvent(element,eventName){var options={bubbles:true,cancelable:eventName!=='mousemove',view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,relatedTarget:undefined};var event;if(document.createEvent){event=document.createEvent('MouseEvents');event.initMouseEvent(eventName,options.bubbles,options.cancelable,options.view,options.detail,options.screenX,options.screenY,options.clientX,options.clientY,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.button,options.relatedTarget||document.body.parentNode);}else{event=document.createEventObject();}
if(element.dispatchEvent){element.dispatchEvent(event);}else{element.fireEvent("on".concat(eventName),event);}}}]);return EventManager;}();function extendEvent(context,event){var componentName='HOT-TABLE';var isHotTableSpotted;var fromElement;var realTarget;var target;var len;event.isTargetWebComponent=false;event.realTarget=event.target;var nativeStopImmediatePropagation=event.stopImmediatePropagation;event.stopImmediatePropagation=function(){nativeStopImmediatePropagation.apply(this);(0,_event.stopImmediatePropagation)(this);};if(!EventManager.isHotTableEnv){return event;}
event=(0,_element.polymerWrap)(event);len=event.path?event.path.length:0;while(len){len-=1;if(event.path[len].nodeName===componentName){isHotTableSpotted=true;}else if(isHotTableSpotted&&event.path[len].shadowRoot){target=event.path[len];break;}
if(len===0&&!target){target=event.path[len];}}
if(!target){target=event.target;}
event.isTargetWebComponent=true;if((0,_feature.isWebComponentSupportedNatively)()){event.realTarget=event.srcElement||event.toElement;}else if((0,_object.hasOwnProperty)(context,'hot')||context.isHotTableEnv||context.wtTable){if((0,_object.hasOwnProperty)(context,'hot')){fromElement=context.hot?context.hot.view.wt.wtTable.TABLE:null;}else if(context.isHotTableEnv){fromElement=context.view.activeWt.wtTable.TABLE.parentNode.parentNode;}else if(context.wtTable){fromElement=context.wtTable.TABLE.parentNode.parentNode;}
realTarget=(0,_element.closest)(event.target,[componentName],fromElement);if(realTarget){event.realTarget=fromElement.querySelector(componentName)||event.target;}else{event.realTarget=event.target;}}
Object.defineProperty(event,'target',{get:function get(){return(0,_element.polymerWrap)(target);},enumerable:true,configurable:true});return event;}
var _default=EventManager;exports.default=_default;function getListenersCounter(){return listenersCounter;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=exports.FILTERS_BUTTONS_PLACEHOLDER_VALUE=exports.FILTERS_BUTTONS_PLACEHOLDER_SEARCH=exports.FILTERS_BUTTONS_CANCEL=exports.FILTERS_BUTTONS_OK=exports.FILTERS_BUTTONS_CLEAR=exports.FILTERS_BUTTONS_SELECT_ALL=exports.FILTERS_VALUES_BLANK_CELLS=exports.FILTERS_LABELS_DISJUNCTION=exports.FILTERS_LABELS_CONJUNCTION=exports.FILTERS_DIVS_FILTER_BY_VALUE=exports.FILTERS_DIVS_FILTER_BY_CONDITION=exports.FILTERS_CONDITIONS_YESTERDAY=exports.FILTERS_CONDITIONS_TOMORROW=exports.FILTERS_CONDITIONS_TODAY=exports.FILTERS_CONDITIONS_BEFORE=exports.FILTERS_CONDITIONS_AFTER=exports.FILTERS_CONDITIONS_NOT_BETWEEN=exports.FILTERS_CONDITIONS_BETWEEN=exports.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=exports.FILTERS_CONDITIONS_LESS_THAN=exports.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=exports.FILTERS_CONDITIONS_GREATER_THAN=exports.FILTERS_CONDITIONS_BY_VALUE=exports.FILTERS_CONDITIONS_NOT_CONTAIN=exports.FILTERS_CONDITIONS_CONTAINS=exports.FILTERS_CONDITIONS_ENDS_WITH=exports.FILTERS_CONDITIONS_BEGINS_WITH=exports.FILTERS_CONDITIONS_NOT_EQUAL=exports.FILTERS_CONDITIONS_EQUAL=exports.FILTERS_CONDITIONS_NOT_EMPTY=exports.FILTERS_CONDITIONS_EMPTY=exports.FILTERS_CONDITIONS_NONE=exports.FILTERS_CONDITIONS_NAMESPACE=exports.FILTERS_NAMESPACE=exports.CONTEXTMENU_ITEMS_SHOW_ROW=exports.CONTEXTMENU_ITEMS_HIDE_ROW=exports.CONTEXTMENU_ITEMS_SHOW_COLUMN=exports.CONTEXTMENU_ITEMS_HIDE_COLUMN=exports.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=exports.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=exports.CONTEXTMENU_ITEMS_REMOVE_BORDERS=exports.CONTEXTMENU_ITEMS_BORDERS_LEFT=exports.CONTEXTMENU_ITEMS_BORDERS_BOTTOM=exports.CONTEXTMENU_ITEMS_BORDERS_RIGHT=exports.CONTEXTMENU_ITEMS_BORDERS_TOP=exports.CONTEXTMENU_ITEMS_BORDERS=exports.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=exports.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=exports.CONTEXTMENU_ITEMS_ALIGNMENT_TOP=exports.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=exports.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=exports.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=exports.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=exports.CONTEXTMENU_ITEMS_ALIGNMENT=exports.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=exports.CONTEXTMENU_ITEMS_REMOVE_COMMENT=exports.CONTEXTMENU_ITEMS_EDIT_COMMENT=exports.CONTEXTMENU_ITEMS_ADD_COMMENT=exports.CONTEXTMENU_ITEMS_UNMERGE_CELLS=exports.CONTEXTMENU_ITEMS_MERGE_CELLS=exports.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=exports.CONTEXTMENU_ITEMS_FREEZE_COLUMN=exports.CONTEXTMENU_ITEMS_CUT=exports.CONTEXTMENU_ITEMS_COPY=exports.CONTEXTMENU_ITEMS_CLEAR_COLUMN=exports.CONTEXTMENU_ITEMS_READ_ONLY=exports.CONTEXTMENU_ITEMS_REDO=exports.CONTEXTMENU_ITEMS_UNDO=exports.CONTEXTMENU_ITEMS_REMOVE_COLUMN=exports.CONTEXTMENU_ITEMS_REMOVE_ROW=exports.CONTEXTMENU_ITEMS_INSERT_RIGHT=exports.CONTEXTMENU_ITEMS_INSERT_LEFT=exports.CONTEXTMENU_ITEMS_ROW_BELOW=exports.CONTEXTMENU_ITEMS_ROW_ABOVE=exports.CONTEXT_MENU_ITEMS_NAMESPACE=void 0;var CONTEXT_MENU_ITEMS_NAMESPACE='ContextMenu:items';exports.CONTEXT_MENU_ITEMS_NAMESPACE=CONTEXT_MENU_ITEMS_NAMESPACE;var CONTEXTMENU_ITEMS_ROW_ABOVE="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".insertRowAbove");exports.CONTEXTMENU_ITEMS_ROW_ABOVE=CONTEXTMENU_ITEMS_ROW_ABOVE;var CONTEXTMENU_ITEMS_ROW_BELOW="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".insertRowBelow");exports.CONTEXTMENU_ITEMS_ROW_BELOW=CONTEXTMENU_ITEMS_ROW_BELOW;var CONTEXTMENU_ITEMS_INSERT_LEFT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".insertColumnOnTheLeft");exports.CONTEXTMENU_ITEMS_INSERT_LEFT=CONTEXTMENU_ITEMS_INSERT_LEFT;var CONTEXTMENU_ITEMS_INSERT_RIGHT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".insertColumnOnTheRight");exports.CONTEXTMENU_ITEMS_INSERT_RIGHT=CONTEXTMENU_ITEMS_INSERT_RIGHT;var CONTEXTMENU_ITEMS_REMOVE_ROW="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".removeRow");exports.CONTEXTMENU_ITEMS_REMOVE_ROW=CONTEXTMENU_ITEMS_REMOVE_ROW;var CONTEXTMENU_ITEMS_REMOVE_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".removeColumn");exports.CONTEXTMENU_ITEMS_REMOVE_COLUMN=CONTEXTMENU_ITEMS_REMOVE_COLUMN;var CONTEXTMENU_ITEMS_UNDO="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".undo");exports.CONTEXTMENU_ITEMS_UNDO=CONTEXTMENU_ITEMS_UNDO;var CONTEXTMENU_ITEMS_REDO="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".redo");exports.CONTEXTMENU_ITEMS_REDO=CONTEXTMENU_ITEMS_REDO;var CONTEXTMENU_ITEMS_READ_ONLY="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".readOnly");exports.CONTEXTMENU_ITEMS_READ_ONLY=CONTEXTMENU_ITEMS_READ_ONLY;var CONTEXTMENU_ITEMS_CLEAR_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".clearColumn");exports.CONTEXTMENU_ITEMS_CLEAR_COLUMN=CONTEXTMENU_ITEMS_CLEAR_COLUMN;var CONTEXTMENU_ITEMS_COPY="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".copy");exports.CONTEXTMENU_ITEMS_COPY=CONTEXTMENU_ITEMS_COPY;var CONTEXTMENU_ITEMS_CUT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".cut");exports.CONTEXTMENU_ITEMS_CUT=CONTEXTMENU_ITEMS_CUT;var CONTEXTMENU_ITEMS_FREEZE_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".freezeColumn");exports.CONTEXTMENU_ITEMS_FREEZE_COLUMN=CONTEXTMENU_ITEMS_FREEZE_COLUMN;var CONTEXTMENU_ITEMS_UNFREEZE_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".unfreezeColumn");exports.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=CONTEXTMENU_ITEMS_UNFREEZE_COLUMN;var CONTEXTMENU_ITEMS_MERGE_CELLS="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".mergeCells");exports.CONTEXTMENU_ITEMS_MERGE_CELLS=CONTEXTMENU_ITEMS_MERGE_CELLS;var CONTEXTMENU_ITEMS_UNMERGE_CELLS="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".unmergeCells");exports.CONTEXTMENU_ITEMS_UNMERGE_CELLS=CONTEXTMENU_ITEMS_UNMERGE_CELLS;var CONTEXTMENU_ITEMS_ADD_COMMENT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".addComment");exports.CONTEXTMENU_ITEMS_ADD_COMMENT=CONTEXTMENU_ITEMS_ADD_COMMENT;var CONTEXTMENU_ITEMS_EDIT_COMMENT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".editComment");exports.CONTEXTMENU_ITEMS_EDIT_COMMENT=CONTEXTMENU_ITEMS_EDIT_COMMENT;var CONTEXTMENU_ITEMS_REMOVE_COMMENT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".removeComment");exports.CONTEXTMENU_ITEMS_REMOVE_COMMENT=CONTEXTMENU_ITEMS_REMOVE_COMMENT;var CONTEXTMENU_ITEMS_READ_ONLY_COMMENT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".readOnlyComment");exports.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=CONTEXTMENU_ITEMS_READ_ONLY_COMMENT;var CONTEXTMENU_ITEMS_ALIGNMENT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align");exports.CONTEXTMENU_ITEMS_ALIGNMENT=CONTEXTMENU_ITEMS_ALIGNMENT;var CONTEXTMENU_ITEMS_ALIGNMENT_LEFT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.left");exports.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=CONTEXTMENU_ITEMS_ALIGNMENT_LEFT;var CONTEXTMENU_ITEMS_ALIGNMENT_CENTER="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.center");exports.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=CONTEXTMENU_ITEMS_ALIGNMENT_CENTER;var CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.right");exports.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT;var CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.justify");exports.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY;var CONTEXTMENU_ITEMS_ALIGNMENT_TOP="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.top");exports.CONTEXTMENU_ITEMS_ALIGNMENT_TOP=CONTEXTMENU_ITEMS_ALIGNMENT_TOP;var CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.middle");exports.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE;var CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".align.bottom");exports.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM;var CONTEXTMENU_ITEMS_BORDERS="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders");exports.CONTEXTMENU_ITEMS_BORDERS=CONTEXTMENU_ITEMS_BORDERS;var CONTEXTMENU_ITEMS_BORDERS_TOP="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders.top");exports.CONTEXTMENU_ITEMS_BORDERS_TOP=CONTEXTMENU_ITEMS_BORDERS_TOP;var CONTEXTMENU_ITEMS_BORDERS_RIGHT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders.right");exports.CONTEXTMENU_ITEMS_BORDERS_RIGHT=CONTEXTMENU_ITEMS_BORDERS_RIGHT;var CONTEXTMENU_ITEMS_BORDERS_BOTTOM="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders.bottom");exports.CONTEXTMENU_ITEMS_BORDERS_BOTTOM=CONTEXTMENU_ITEMS_BORDERS_BOTTOM;var CONTEXTMENU_ITEMS_BORDERS_LEFT="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders.left");exports.CONTEXTMENU_ITEMS_BORDERS_LEFT=CONTEXTMENU_ITEMS_BORDERS_LEFT;var CONTEXTMENU_ITEMS_REMOVE_BORDERS="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".borders.remove");exports.CONTEXTMENU_ITEMS_REMOVE_BORDERS=CONTEXTMENU_ITEMS_REMOVE_BORDERS;var CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".nestedHeaders.insertChildRow");exports.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD;var CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".nestedHeaders.detachFromParent");exports.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD;var CONTEXTMENU_ITEMS_HIDE_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".hideColumn");exports.CONTEXTMENU_ITEMS_HIDE_COLUMN=CONTEXTMENU_ITEMS_HIDE_COLUMN;var CONTEXTMENU_ITEMS_SHOW_COLUMN="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".showColumn");exports.CONTEXTMENU_ITEMS_SHOW_COLUMN=CONTEXTMENU_ITEMS_SHOW_COLUMN;var CONTEXTMENU_ITEMS_HIDE_ROW="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".hideRow");exports.CONTEXTMENU_ITEMS_HIDE_ROW=CONTEXTMENU_ITEMS_HIDE_ROW;var CONTEXTMENU_ITEMS_SHOW_ROW="".concat(CONTEXT_MENU_ITEMS_NAMESPACE,".showRow");exports.CONTEXTMENU_ITEMS_SHOW_ROW=CONTEXTMENU_ITEMS_SHOW_ROW;var FILTERS_NAMESPACE='Filters:';exports.FILTERS_NAMESPACE=FILTERS_NAMESPACE;var FILTERS_CONDITIONS_NAMESPACE="".concat(FILTERS_NAMESPACE,"conditions");exports.FILTERS_CONDITIONS_NAMESPACE=FILTERS_CONDITIONS_NAMESPACE;var FILTERS_CONDITIONS_NONE="".concat(FILTERS_CONDITIONS_NAMESPACE,".none");exports.FILTERS_CONDITIONS_NONE=FILTERS_CONDITIONS_NONE;var FILTERS_CONDITIONS_EMPTY="".concat(FILTERS_CONDITIONS_NAMESPACE,".isEmpty");exports.FILTERS_CONDITIONS_EMPTY=FILTERS_CONDITIONS_EMPTY;var FILTERS_CONDITIONS_NOT_EMPTY="".concat(FILTERS_CONDITIONS_NAMESPACE,".isNotEmpty");exports.FILTERS_CONDITIONS_NOT_EMPTY=FILTERS_CONDITIONS_NOT_EMPTY;var FILTERS_CONDITIONS_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".isEqualTo");exports.FILTERS_CONDITIONS_EQUAL=FILTERS_CONDITIONS_EQUAL;var FILTERS_CONDITIONS_NOT_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".isNotEqualTo");exports.FILTERS_CONDITIONS_NOT_EQUAL=FILTERS_CONDITIONS_NOT_EQUAL;var FILTERS_CONDITIONS_BEGINS_WITH="".concat(FILTERS_CONDITIONS_NAMESPACE,".beginsWith");exports.FILTERS_CONDITIONS_BEGINS_WITH=FILTERS_CONDITIONS_BEGINS_WITH;var FILTERS_CONDITIONS_ENDS_WITH="".concat(FILTERS_CONDITIONS_NAMESPACE,".endsWith");exports.FILTERS_CONDITIONS_ENDS_WITH=FILTERS_CONDITIONS_ENDS_WITH;var FILTERS_CONDITIONS_CONTAINS="".concat(FILTERS_CONDITIONS_NAMESPACE,".contains");exports.FILTERS_CONDITIONS_CONTAINS=FILTERS_CONDITIONS_CONTAINS;var FILTERS_CONDITIONS_NOT_CONTAIN="".concat(FILTERS_CONDITIONS_NAMESPACE,".doesNotContain");exports.FILTERS_CONDITIONS_NOT_CONTAIN=FILTERS_CONDITIONS_NOT_CONTAIN;var FILTERS_CONDITIONS_BY_VALUE="".concat(FILTERS_CONDITIONS_NAMESPACE,".byValue");exports.FILTERS_CONDITIONS_BY_VALUE=FILTERS_CONDITIONS_BY_VALUE;var FILTERS_CONDITIONS_GREATER_THAN="".concat(FILTERS_CONDITIONS_NAMESPACE,".greaterThan");exports.FILTERS_CONDITIONS_GREATER_THAN=FILTERS_CONDITIONS_GREATER_THAN;var FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".greaterThanOrEqualTo");exports.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL;var FILTERS_CONDITIONS_LESS_THAN="".concat(FILTERS_CONDITIONS_NAMESPACE,".lessThan");exports.FILTERS_CONDITIONS_LESS_THAN=FILTERS_CONDITIONS_LESS_THAN;var FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL="".concat(FILTERS_CONDITIONS_NAMESPACE,".lessThanOrEqualTo");exports.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL;var FILTERS_CONDITIONS_BETWEEN="".concat(FILTERS_CONDITIONS_NAMESPACE,".isBetween");exports.FILTERS_CONDITIONS_BETWEEN=FILTERS_CONDITIONS_BETWEEN;var FILTERS_CONDITIONS_NOT_BETWEEN="".concat(FILTERS_CONDITIONS_NAMESPACE,".isNotBetween");exports.FILTERS_CONDITIONS_NOT_BETWEEN=FILTERS_CONDITIONS_NOT_BETWEEN;var FILTERS_CONDITIONS_AFTER="".concat(FILTERS_CONDITIONS_NAMESPACE,".after");exports.FILTERS_CONDITIONS_AFTER=FILTERS_CONDITIONS_AFTER;var FILTERS_CONDITIONS_BEFORE="".concat(FILTERS_CONDITIONS_NAMESPACE,".before");exports.FILTERS_CONDITIONS_BEFORE=FILTERS_CONDITIONS_BEFORE;var FILTERS_CONDITIONS_TODAY="".concat(FILTERS_CONDITIONS_NAMESPACE,".today");exports.FILTERS_CONDITIONS_TODAY=FILTERS_CONDITIONS_TODAY;var FILTERS_CONDITIONS_TOMORROW="".concat(FILTERS_CONDITIONS_NAMESPACE,".tomorrow");exports.FILTERS_CONDITIONS_TOMORROW=FILTERS_CONDITIONS_TOMORROW;var FILTERS_CONDITIONS_YESTERDAY="".concat(FILTERS_CONDITIONS_NAMESPACE,".yesterday");exports.FILTERS_CONDITIONS_YESTERDAY=FILTERS_CONDITIONS_YESTERDAY;var FILTERS_DIVS_FILTER_BY_CONDITION="".concat(FILTERS_NAMESPACE,"labels.filterByCondition");exports.FILTERS_DIVS_FILTER_BY_CONDITION=FILTERS_DIVS_FILTER_BY_CONDITION;var FILTERS_DIVS_FILTER_BY_VALUE="".concat(FILTERS_NAMESPACE,"labels.filterByValue");exports.FILTERS_DIVS_FILTER_BY_VALUE=FILTERS_DIVS_FILTER_BY_VALUE;var FILTERS_LABELS_CONJUNCTION="".concat(FILTERS_NAMESPACE,"labels.conjunction");exports.FILTERS_LABELS_CONJUNCTION=FILTERS_LABELS_CONJUNCTION;var FILTERS_LABELS_DISJUNCTION="".concat(FILTERS_NAMESPACE,"labels.disjunction");exports.FILTERS_LABELS_DISJUNCTION=FILTERS_LABELS_DISJUNCTION;var FILTERS_VALUES_BLANK_CELLS="".concat(FILTERS_NAMESPACE,"values.blankCells");exports.FILTERS_VALUES_BLANK_CELLS=FILTERS_VALUES_BLANK_CELLS;var FILTERS_BUTTONS_SELECT_ALL="".concat(FILTERS_NAMESPACE,"buttons.selectAll");exports.FILTERS_BUTTONS_SELECT_ALL=FILTERS_BUTTONS_SELECT_ALL;var FILTERS_BUTTONS_CLEAR="".concat(FILTERS_NAMESPACE,"buttons.clear");exports.FILTERS_BUTTONS_CLEAR=FILTERS_BUTTONS_CLEAR;var FILTERS_BUTTONS_OK="".concat(FILTERS_NAMESPACE,"buttons.ok");exports.FILTERS_BUTTONS_OK=FILTERS_BUTTONS_OK;var FILTERS_BUTTONS_CANCEL="".concat(FILTERS_NAMESPACE,"buttons.cancel");exports.FILTERS_BUTTONS_CANCEL=FILTERS_BUTTONS_CANCEL;var FILTERS_BUTTONS_PLACEHOLDER_SEARCH="".concat(FILTERS_NAMESPACE,"buttons.placeholder.search");exports.FILTERS_BUTTONS_PLACEHOLDER_SEARCH=FILTERS_BUTTONS_PLACEHOLDER_SEARCH;var FILTERS_BUTTONS_PLACEHOLDER_VALUE="".concat(FILTERS_NAMESPACE,"buttons.placeholder.value");exports.FILTERS_BUTTONS_PLACEHOLDER_VALUE=FILTERS_BUTTONS_PLACEHOLDER_VALUE;var FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE="".concat(FILTERS_NAMESPACE,"buttons.placeholder.secondValue");exports.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE;}),(function(module,exports,__webpack_require__){var store=__webpack_require__(93)('wks');var uid=__webpack_require__(51);var Symbol=__webpack_require__(6).Symbol;var USE_SYMBOL=typeof Symbol=='function';var $exports=module.exports=function(name){return store[name]||(store[name]=USE_SYMBOL&&Symbol[name]||(USE_SYMBOL?Symbol:uid)('Symbol.'+name));};$exports.store=store;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.registerPlugin=registerPlugin;exports.getPlugin=getPlugin;exports.getRegistredPluginNames=getRegistredPluginNames;exports.getPluginName=getPluginName;var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _object=__webpack_require__(2);var _string=__webpack_require__(48);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var registeredPlugins=new WeakMap();function registerPlugin(pluginName,PluginClass){var correctedPluginName=(0,_string.toUpperCaseFirst)(pluginName);_pluginHooks.default.getSingleton().add('construct',function(){if(!registeredPlugins.has(this)){registeredPlugins.set(this,{});}
var holder=registeredPlugins.get(this);if(!holder[correctedPluginName]){holder[correctedPluginName]=new PluginClass(this);}});_pluginHooks.default.getSingleton().add('afterDestroy',function(){if(registeredPlugins.has(this)){var pluginsHolder=registeredPlugins.get(this);(0,_object.objectEach)(pluginsHolder,function(plugin){return plugin.destroy();});registeredPlugins.delete(this);}});}
function getPlugin(instance,pluginName){if(typeof pluginName!=='string'){throw Error('Only strings can be passed as "plugin" parameter');}
var _pluginName=(0,_string.toUpperCaseFirst)(pluginName);if(!registeredPlugins.has(instance)||!registeredPlugins.get(instance)[_pluginName]){return void 0;}
return registeredPlugins.get(instance)[_pluginName];}
function getRegistredPluginNames(hotInstance){return registeredPlugins.has(hotInstance)?Object.keys(registeredPlugins.get(hotInstance)):[];}
function getPluginName(hotInstance,plugin){var pluginName=null;if(registeredPlugins.has(hotInstance)){(0,_object.objectEach)(registeredPlugins.get(hotInstance),function(pluginInstance,name){if(pluginInstance===plugin){pluginName=name;}});}
return pluginName;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.stringify=stringify;exports.isDefined=isDefined;exports.isUndefined=isUndefined;exports.isEmpty=isEmpty;exports.isRegExp=isRegExp;exports._injectProductInfo=_injectProductInfo;var _moment=_interopRequireDefault(__webpack_require__(67));var _templateLiteralTag=__webpack_require__(58);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _templateObject(){var data=_taggedTemplateLiteral(["\n          Your license key of Handsontable Pro has expired.\u200C\u200C\u200C\u200C \n          Renew your maintenance plan at https://handsontable.com or downgrade to the previous version of the software.\n          "]);_templateObject=function _templateObject(){return data;};return data;}
function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0);}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function stringify(value){var result;switch(_typeof(value)){case'string':case'number':result="".concat(value);break;case'object':result=value===null?'':value.toString();break;case'undefined':result='';break;default:result=value.toString();break;}
return result;}
function isDefined(variable){return typeof variable!=='undefined';}
function isUndefined(variable){return typeof variable==='undefined';}
function isEmpty(variable){return variable===null||variable===''||isUndefined(variable);}
function isRegExp(variable){return Object.prototype.toString.call(variable)==='[object RegExp]';}
var _m='\x6C\x65\x6E\x67\x74\x68';var _hd=function _hd(v){return parseInt(v,16);};var _pi=function _pi(v){return parseInt(v,10);};var _ss=function _ss(v,s,l){return v['\x73\x75\x62\x73\x74\x72'](s,l);};var _cp=function _cp(v){return v['\x63\x6F\x64\x65\x50\x6F\x69\x6E\x74\x41\x74'](0)-65;};var _norm=function _norm(v){return"".concat(v).replace(/\-/g,'');};var _extractTime=function _extractTime(v){return _hd(_ss(_norm(v),_hd('12'),_cp('\x46')))/(_hd(_ss(_norm(v),_cp('\x42'),~~![][_m]))||9);};var _ignored=function _ignored(){return typeof location!=='undefined'&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);};var _notified=false;function _injectProductInfo(key,element){key=_norm(key||'');var warningMessage='';var showDomMessage=true;var schemaValidity=_checkKeySchema(key);var ignored=_ignored();var trial=isEmpty(key)||key==='trial';if(trial||schemaValidity){if(schemaValidity){var releaseTime=Math.floor((0,_moment.default)("19/12/2018",'DD/MM/YYYY').toDate().getTime()/8.64e7);var keyGenTime=_extractTime(key);if(keyGenTime>45000||keyGenTime!==parseInt(keyGenTime,10)){warningMessage='The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly.';}
if(!warningMessage){if(releaseTime>keyGenTime+1){warningMessage=(0,_templateLiteralTag.toSingleLine)(_templateObject());}
showDomMessage=releaseTime>keyGenTime+15;}}else{warningMessage='Evaluation version of Handsontable Pro. Not licensed for use in a production environment.';}}else{warningMessage='The license key provided to Handsontable Pro is invalid. Make sure you pass it correctly.';}
if(ignored){warningMessage=false;showDomMessage=false;}
if(warningMessage&&!_notified){console[trial?'info':'warn'](warningMessage);_notified=true;}
if(showDomMessage&&element.parentNode){var message=document.createElement('div');message.id='hot-display-license-info';message.appendChild(document.createTextNode('Evaluation version of Handsontable Pro.'));message.appendChild(document.createElement('br'));message.appendChild(document.createTextNode('Not licensed for production use.'));element.parentNode.insertBefore(message,element.nextSibling);}}
function _checkKeySchema(v){var z=[][_m];var p=z;if(v[_m]!==_cp('\x5A')){return false;}
for(var c='',i='\x42\x3C\x48\x34\x50\x2B'.split(''),j=_cp(i.shift());j;j=_cp(i.shift()||'A')){--j<''[_m]?p=p|(_pi("".concat(_pi(_hd(c)+(_hd(_ss(v,Math.abs(j),2))+[]).padStart(2,'0'))))%97||2)>>1:c=_ss(v,j,!j?6:i[_m]===1?9:8);}
return p===z;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _object=__webpack_require__(2);var _array=__webpack_require__(3);var _recordTranslator=__webpack_require__(424);var _plugins=__webpack_require__(13);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var privatePool=new WeakMap();var initializedPlugins=null;var BasePlugin=function(){function BasePlugin(hotInstance){var _this=this;_classCallCheck(this,BasePlugin);(0,_object.defineGetter)(this,'hot',hotInstance,{writable:false});(0,_object.defineGetter)(this,'t',(0,_recordTranslator.getTranslator)(hotInstance),{writable:false});privatePool.set(this,{hooks:{}});initializedPlugins=null;this.pluginName=null;this.pluginsInitializedCallbacks=[];this.isPluginsReady=false;this.enabled=false;this.initialized=false;this.hot.addHook('afterPluginsInitialized',function(){return _this.onAfterPluginsInitialized();});this.hot.addHook('afterUpdateSettings',function(newSettings){return _this.onUpdateSettings(newSettings);});this.hot.addHook('beforeInit',function(){return _this.init();});}
_createClass(BasePlugin,[{key:"init",value:function init(){this.pluginName=(0,_plugins.getPluginName)(this.hot,this);if(this.isEnabled&&this.isEnabled()){this.enablePlugin();}
if(!initializedPlugins){initializedPlugins=(0,_plugins.getRegistredPluginNames)(this.hot);}
if(initializedPlugins.indexOf(this.pluginName)>=0){initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName),1);}
if(!initializedPlugins.length){this.hot.runHooks('afterPluginsInitialized');}
this.initialized=true;}},{key:"enablePlugin",value:function enablePlugin(){this.enabled=true;}},{key:"disablePlugin",value:function disablePlugin(){if(this.eventManager){this.eventManager.clear();}
this.clearHooks();this.enabled=false;}},{key:"addHook",value:function addHook(name,callback){privatePool.get(this).hooks[name]=privatePool.get(this).hooks[name]||[];var hooks=privatePool.get(this).hooks[name];this.hot.addHook(name,callback);hooks.push(callback);privatePool.get(this).hooks[name]=hooks;}},{key:"removeHooks",value:function removeHooks(name){var _this2=this;(0,_array.arrayEach)(privatePool.get(this).hooks[name]||[],function(callback){_this2.hot.removeHook(name,callback);});}},{key:"clearHooks",value:function clearHooks(){var _this3=this;var hooks=privatePool.get(this).hooks;(0,_object.objectEach)(hooks,function(callbacks,name){return _this3.removeHooks(name);});hooks.length=0;}},{key:"callOnPluginsReady",value:function callOnPluginsReady(callback){if(this.isPluginsReady){callback();}else{this.pluginsInitializedCallbacks.push(callback);}}},{key:"onAfterPluginsInitialized",value:function onAfterPluginsInitialized(){(0,_array.arrayEach)(this.pluginsInitializedCallbacks,function(callback){return callback();});this.pluginsInitializedCallbacks.length=0;this.isPluginsReady=true;}},{key:"onUpdateSettings",value:function onUpdateSettings(){if(this.isEnabled){if(this.enabled&&!this.isEnabled()){this.disablePlugin();}
if(!this.enabled&&this.isEnabled()){this.enablePlugin();}
if(this.enabled&&this.isEnabled()){this.updatePlugin();}}}},{key:"updatePlugin",value:function updatePlugin(){}},{key:"destroy",value:function destroy(){var _this4=this;if(this.eventManager){this.eventManager.destroy();}
this.clearHooks();(0,_object.objectEach)(this,function(value,property){if(property!=='hot'&&property!=='t'){_this4[property]=null;}});delete this.t;delete this.hot;}}]);return BasePlugin;}();var _default=BasePlugin;exports.default=_default;}),(function(module,exports,__webpack_require__){var toInteger=__webpack_require__(33);var min=Math.min;module.exports=function(it){return it>0?min(toInteger(it),0x1fffffffffffff):0;};}),(function(module,exports,__webpack_require__){var anObject=__webpack_require__(5);var IE8_DOM_DEFINE=__webpack_require__(130);var toPrimitive=__webpack_require__(44);var dP=Object.defineProperty;exports.f=__webpack_require__(20)?Object.defineProperty:function defineProperty(O,P,Attributes){anObject(O);P=toPrimitive(P,true);anObject(Attributes);if(IE8_DOM_DEFINE)try{return dP(O,P,Attributes);}catch(e){}
if('get'in Attributes||'set'in Attributes)throw TypeError('Accessors not supported!');if('value'in Attributes)O[P]=Attributes.value;return O;};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.stopImmediatePropagation=stopImmediatePropagation;exports.isImmediatePropagationStopped=isImmediatePropagationStopped;exports.stopPropagation=stopPropagation;exports.pageX=pageX;exports.pageY=pageY;exports.isRightClick=isRightClick;exports.isLeftClick=isLeftClick;var _element=__webpack_require__(1);function stopImmediatePropagation(event){event.isImmediatePropagationEnabled=false;event.cancelBubble=true;}
function isImmediatePropagationStopped(event){return event.isImmediatePropagationEnabled===false;}
function stopPropagation(event){if(typeof event.stopPropagation==='function'){event.stopPropagation();}else{event.cancelBubble=true;}}
function pageX(event){if(event.pageX){return event.pageX;}
return event.clientX+(0,_element.getWindowScrollLeft)();}
function pageY(event){if(event.pageY){return event.pageY;}
return event.clientY+(0,_element.getWindowScrollTop)();}
function isRightClick(event){return event.button===2;}
function isLeftClick(event){return event.button===0;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.getRenderer=_getItem;exports.getRegisteredRenderers=exports.getRegisteredRendererNames=exports.hasRenderer=exports.registerRenderer=void 0;var _staticRegister2=_interopRequireDefault(__webpack_require__(46));var _cellDecorator=_interopRequireDefault(__webpack_require__(624));var _autocompleteRenderer=_interopRequireDefault(__webpack_require__(625));var _checkboxRenderer=_interopRequireDefault(__webpack_require__(626));var _htmlRenderer=_interopRequireDefault(__webpack_require__(627));var _numericRenderer=_interopRequireDefault(__webpack_require__(628));var _passwordRenderer=_interopRequireDefault(__webpack_require__(629));var _textRenderer=_interopRequireDefault(__webpack_require__(630));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var _staticRegister=(0,_staticRegister2.default)('renderers'),register=_staticRegister.register,getItem=_staticRegister.getItem,hasItem=_staticRegister.hasItem,getNames=_staticRegister.getNames,getValues=_staticRegister.getValues;exports.getRegisteredRenderers=getValues;exports.getRegisteredRendererNames=getNames;exports.hasRenderer=hasItem;exports.registerRenderer=register;register('base',_cellDecorator.default);register('autocomplete',_autocompleteRenderer.default);register('checkbox',_checkboxRenderer.default);register('html',_htmlRenderer.default);register('numeric',_numericRenderer.default);register('password',_passwordRenderer.default);register('text',_textRenderer.default);function _getItem(name){if(typeof name==='function'){return name;}
if(!hasItem(name)){throw Error("No registered renderer found under \"".concat(name,"\" name"));}
return getItem(name);}}),(function(module,exports,__webpack_require__){module.exports=!__webpack_require__(4)(function(){return Object.defineProperty({},'a',{get:function(){return 7;}}).a!=7;});}),(function(module,exports){var core=module.exports={version:'2.6.1'};if(typeof __e=='number')__e=core;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _array=__webpack_require__(3);var _object=__webpack_require__(2);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var REGISTERED_HOOKS=['afterCellMetaReset','afterChange','afterChangesObserved','afterContextMenuDefaultOptions','beforeContextMenuSetItems','afterDropdownMenuDefaultOptions','beforeDropdownMenuSetItems','afterContextMenuHide','beforeContextMenuShow','afterContextMenuShow','afterCopyLimit','beforeCreateCol','afterCreateCol','beforeCreateRow','afterCreateRow','afterDeselect','afterDestroy','afterDocumentKeyDown','afterDrawSelection','beforeRemoveCellClassNames','afterGetCellMeta','afterGetColHeader','afterGetRowHeader','afterInit','afterLoadData','afterMomentumScroll','afterOnCellCornerMouseDown','afterOnCellCornerDblClick','afterOnCellMouseDown','afterOnCellMouseUp','afterOnCellContextMenu','afterOnCellMouseOver','afterOnCellMouseOut','afterRemoveCol','afterRemoveRow','afterRender','beforeRenderer','afterRenderer','afterScrollHorizontally','afterScrollVertically','afterSelection','afterSelectionByProp','afterSelectionEnd','afterSelectionEndByProp','afterSetCellMeta','afterRemoveCellMeta','afterSetDataAtCell','afterSetDataAtRowProp','afterUpdateSettings','afterValidate','beforeLanguageChange','afterLanguageChange','beforeAutofill','beforeCellAlignment','beforeChange','beforeChangeRender','beforeDrawBorders','beforeGetCellMeta','beforeRemoveCellMeta','beforeInit','beforeInitWalkontable','beforeKeyDown','beforeOnCellMouseDown','beforeOnCellMouseUp','beforeOnCellContextMenu','beforeOnCellMouseOver','beforeOnCellMouseOut','beforeRemoveCol','beforeRemoveRow','beforeRender','beforeSetRangeStartOnly','beforeSetRangeStart','beforeSetRangeEnd','beforeTouchScroll','beforeValidate','beforeValueRender','construct','init','modifyCol','unmodifyCol','unmodifyRow','modifyColHeader','modifyColWidth','modifyRow','modifyRowHeader','modifyRowHeight','modifyData','modifyRowData','modifyGetCellCoords','persistentStateLoad','persistentStateReset','persistentStateSave','beforeColumnSort','afterColumnSort','modifyAutofillRange','modifyCopyableRange','beforeCut','afterCut','beforeCopy','afterCopy','beforePaste','afterPaste','beforeColumnMove','afterColumnMove','beforeRowMove','afterRowMove','beforeColumnResize','afterColumnResize','beforeRowResize','afterRowResize','afterGetColumnHeaderRenderers','afterGetRowHeaderRenderers','beforeStretchingColumnWidth','beforeFilter','afterFilter','modifyColumnHeaderHeight','beforeUndo','afterUndo','beforeRedo','afterRedo','modifyRowHeaderWidth','beforeAutofillInsidePopulate','modifyTransformStart','modifyTransformEnd','afterModifyTransformStart','afterModifyTransformEnd','afterViewportRowCalculatorOverride','afterViewportColumnCalculatorOverride','afterPluginsInitialized','skipLengthCache','afterTrimRow','afterUntrimRow','beforeDropdownMenuShow','afterDropdownMenuShow','afterDropdownMenuHide','hiddenRow','hiddenColumn','beforeAddChild','afterAddChild','beforeDetachChild','afterDetachChild','afterBeginEditing','beforeMergeCells','afterMergeCells','beforeUnmergeCells','afterUnmergeCells','afterListen','afterUnlisten'];var Hooks=function(){_createClass(Hooks,null,[{key:"getSingleton",value:function getSingleton(){return getGlobalSingleton();}}]);function Hooks(){_classCallCheck(this,Hooks);this.globalBucket=this.createEmptyBucket();}
_createClass(Hooks,[{key:"createEmptyBucket",value:function createEmptyBucket(){var bucket=Object.create(null);(0,_array.arrayEach)(REGISTERED_HOOKS,function(hook){return bucket[hook]=[];});return bucket;}},{key:"getBucket",value:function getBucket(){var context=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(context){if(!context.pluginHookBucket){context.pluginHookBucket=this.createEmptyBucket();}
return context.pluginHookBucket;}
return this.globalBucket;}},{key:"add",value:function add(key,callback){var _this=this;var context=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(Array.isArray(callback)){(0,_array.arrayEach)(callback,function(c){return _this.add(key,c,context);});}else{var bucket=this.getBucket(context);if(typeof bucket[key]==='undefined'){this.register(key);bucket[key]=[];}
callback.skip=false;if(bucket[key].indexOf(callback)===-1){var foundInitialHook=false;if(callback.initialHook){(0,_array.arrayEach)(bucket[key],function(cb,i){if(cb.initialHook){bucket[key][i]=callback;foundInitialHook=true;return false;}});}
if(!foundInitialHook){bucket[key].push(callback);}}}
return this;}},{key:"once",value:function once(key,callback){var _this2=this;var context=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(Array.isArray(callback)){(0,_array.arrayEach)(callback,function(c){return _this2.once(key,c,context);});}else{callback.runOnce=true;this.add(key,callback,context);}}},{key:"remove",value:function remove(key,callback){var context=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var bucket=this.getBucket(context);if(typeof bucket[key]!=='undefined'){if(bucket[key].indexOf(callback)>=0){callback.skip=true;return true;}}
return false;}},{key:"has",value:function has(key){var context=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var bucket=this.getBucket(context);return!!(bucket[key]!==void 0&&bucket[key].length);}},{key:"run",value:function run(context,key,p1,p2,p3,p4,p5,p6){{var globalHandlers=this.globalBucket[key];var length=globalHandlers?globalHandlers.length:0;var index=0;if(length){while(index<length){if(!globalHandlers[index]||globalHandlers[index].skip){index+=1;continue;}
var res=globalHandlers[index].call(context,p1,p2,p3,p4,p5,p6);if(res!==void 0){p1=res;}
if(globalHandlers[index]&&globalHandlers[index].runOnce){this.remove(key,globalHandlers[index]);}
index+=1;}}}
{var localHandlers=this.getBucket(context)[key];var _length=localHandlers?localHandlers.length:0;var _index=0;if(_length){while(_index<_length){if(!localHandlers[_index]||localHandlers[_index].skip){_index+=1;continue;}
var _res=localHandlers[_index].call(context,p1,p2,p3,p4,p5,p6);if(_res!==void 0){p1=_res;}
if(localHandlers[_index]&&localHandlers[_index].runOnce){this.remove(key,localHandlers[_index],context);}
_index+=1;}}}
return p1;}},{key:"destroy",value:function destroy(){var context=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;(0,_object.objectEach)(this.getBucket(context),function(value,key,bucket){return bucket[key].length=0;});}},{key:"register",value:function register(key){if(!this.isRegistered(key)){REGISTERED_HOOKS.push(key);}}},{key:"deregister",value:function deregister(key){if(this.isRegistered(key)){REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(key),1);}}},{key:"isRegistered",value:function isRegistered(key){return REGISTERED_HOOKS.indexOf(key)>=0;}},{key:"getRegistered",value:function getRegistered(){return REGISTERED_HOOKS;}}]);return Hooks;}();var globalSingleton=new Hooks();function getGlobalSingleton(){return globalSingleton;}
var _default=Hooks;exports.default=_default;}),(function(module,exports,__webpack_require__){var global=__webpack_require__(6);var hide=__webpack_require__(28);var has=__webpack_require__(27);var SRC=__webpack_require__(51)('src');var TO_STRING='toString';var $toString=Function[TO_STRING];var TPL=(''+$toString).split(TO_STRING);__webpack_require__(21).inspectSource=function(it){return $toString.call(it);};(module.exports=function(O,key,val,safe){var isFunction=typeof val=='function';if(isFunction)has(val,'name')||hide(val,'name',key);if(O[key]===val)return;if(isFunction)has(val,SRC)||hide(val,SRC,O[key]?''+O[key]:TPL.join(String(key)));if(O===global){O[key]=val;}else if(!safe){delete O[key];hide(O,key,val);}else if(O[key]){O[key]=val;}else{hide(O,key,val);}})(Function.prototype,TO_STRING,function toString(){return typeof this=='function'&&this[SRC]||$toString.call(this);});}),(function(module,exports,__webpack_require__){var defined=__webpack_require__(40);module.exports=function(it){return Object(defined(it));};}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var fails=__webpack_require__(4);var defined=__webpack_require__(40);var quot=/"/g;var createHTML=function(string,tag,attribute,value){var S=String(defined(string));var p1='<'+tag;if(attribute!=='')p1+=' '+attribute+'="'+String(value).replace(quot,'&quot;')+'"';return p1+'>'+S+'</'+tag+'>';};module.exports=function(NAME,exec){var O={};O[NAME]=exec(createHTML);$export($export.P+$export.F*fails(function(){var test=''[NAME]('"');return test!==test.toLowerCase()||test.split('"').length>3;}),'String',O);};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.RegisteredEditor=RegisteredEditor;exports.getEditorInstance=exports._getEditorInstance=_getEditorInstance;exports.registerEditor=_register;exports.getEditor=_getItem;exports.getRegisteredEditors=exports.getRegisteredEditorNames=exports.hasEditor=void 0;var _staticRegister2=_interopRequireDefault(__webpack_require__(46));var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _baseEditor=_interopRequireDefault(__webpack_require__(74));var _autocompleteEditor=_interopRequireDefault(__webpack_require__(294));var _checkboxEditor=_interopRequireDefault(__webpack_require__(614));var _dateEditor=_interopRequireDefault(__webpack_require__(615));var _dropdownEditor=_interopRequireDefault(__webpack_require__(620));var _handsontableEditor=_interopRequireDefault(__webpack_require__(295));var _numericEditor=_interopRequireDefault(__webpack_require__(621));var _passwordEditor=_interopRequireDefault(__webpack_require__(622));var _selectEditor=_interopRequireDefault(__webpack_require__(623));var _textEditor=_interopRequireDefault(__webpack_require__(77));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var registeredEditorClasses=new WeakMap();var _staticRegister=(0,_staticRegister2.default)('editors'),register=_staticRegister.register,getItem=_staticRegister.getItem,hasItem=_staticRegister.hasItem,getNames=_staticRegister.getNames,getValues=_staticRegister.getValues;exports.getRegisteredEditors=getValues;exports.getRegisteredEditorNames=getNames;exports.hasEditor=hasItem;_register('base',_baseEditor.default);_register('autocomplete',_autocompleteEditor.default);_register('checkbox',_checkboxEditor.default);_register('date',_dateEditor.default);_register('dropdown',_dropdownEditor.default);_register('handsontable',_handsontableEditor.default);_register('numeric',_numericEditor.default);_register('password',_passwordEditor.default);_register('select',_selectEditor.default);_register('text',_textEditor.default);function RegisteredEditor(editorClass){var instances={};var Clazz=editorClass;this.getConstructor=function(){return editorClass;};this.getInstance=function(hotInstance){if(!(hotInstance.guid in instances)){instances[hotInstance.guid]=new Clazz(hotInstance);}
return instances[hotInstance.guid];};_pluginHooks.default.getSingleton().add('afterDestroy',function(){instances[this.guid]=null;});}
function _getEditorInstance(name,hotInstance){var editor;if(typeof name==='function'){if(!registeredEditorClasses.get(name)){_register(null,name);}
editor=registeredEditorClasses.get(name);}else if(typeof name==='string'){editor=getItem(name);}else{throw Error('Only strings and functions can be passed as "editor" parameter');}
if(!editor){throw Error("No editor registered under name \"".concat(name,"\""));}
return editor.getInstance(hotInstance);}
function _getItem(name){if(!hasItem(name)){throw Error("No registered editor found under \"".concat(name,"\" name"));}
return getItem(name).getConstructor();}
function _register(name,editorClass){var editorWrapper=new RegisteredEditor(editorClass);if(typeof name==='string'){register(name,editorWrapper);}
registeredEditorClasses.set(editorClass,editorWrapper);}}),(function(module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key);};}),(function(module,exports,__webpack_require__){var dP=__webpack_require__(17);var createDesc=__webpack_require__(50);module.exports=__webpack_require__(20)?function(object,key,value){return dP.f(object,key,createDesc(1,value));}:function(object,key,value){object[key]=value;return object;};}),(function(module,exports,__webpack_require__){var IObject=__webpack_require__(70);var defined=__webpack_require__(40);module.exports=function(it){return IObject(defined(it));};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.normalizeSelection=normalizeSelection;exports.isSeparator=isSeparator;exports.hasSubMenu=hasSubMenu;exports.isDisabled=isDisabled;exports.isSelectionDisabled=isSelectionDisabled;exports.getValidSelection=getValidSelection;exports.prepareVerticalAlignClass=prepareVerticalAlignClass;exports.prepareHorizontalAlignClass=prepareHorizontalAlignClass;exports.getAlignmentClasses=getAlignmentClasses;exports.align=align;exports.checkSelectionConsistency=checkSelectionConsistency;exports.markLabelAsSelected=markLabelAsSelected;exports.isItemHidden=isItemHidden;exports.filterSeparators=filterSeparators;var _array=__webpack_require__(3);var _element=__webpack_require__(1);var _separator=__webpack_require__(126);function normalizeSelection(selRanges){return(0,_array.arrayMap)(selRanges,function(range){return{start:range.getTopLeftCorner(),end:range.getBottomRightCorner()};});}
function isSeparator(cell){return(0,_element.hasClass)(cell,'htSeparator');}
function hasSubMenu(cell){return(0,_element.hasClass)(cell,'htSubmenu');}
function isDisabled(cell){return(0,_element.hasClass)(cell,'htDisabled');}
function isSelectionDisabled(cell){return(0,_element.hasClass)(cell,'htSelectionDisabled');}
function getValidSelection(hot){var selected=hot.getSelected();if(!selected){return null;}
if(selected[0]<0){return null;}
return selected;}
function prepareVerticalAlignClass(className,alignment){if(className.indexOf(alignment)!==-1){return className;}
var replacedClassName=className.replace('htTop','').replace('htMiddle','').replace('htBottom','').replace('  ','');return"".concat(replacedClassName," ").concat(alignment);}
function prepareHorizontalAlignClass(className,alignment){if(className.indexOf(alignment)!==-1){return className;}
var replacedClassName=className.replace('htLeft','').replace('htCenter','').replace('htRight','').replace('htJustify','').replace('  ','');return"".concat(replacedClassName," ").concat(alignment);}
function getAlignmentClasses(ranges,callback){var classes={};(0,_array.arrayEach)(ranges,function(_ref){var from=_ref.from,to=_ref.to;for(var row=from.row;row<=to.row;row++){for(var col=from.col;col<=to.col;col++){if(!classes[row]){classes[row]=[];}
classes[row][col]=callback(row,col);}}});return classes;}
function align(ranges,type,alignment,cellDescriptor,propertySetter){(0,_array.arrayEach)(ranges,function(_ref2){var from=_ref2.from,to=_ref2.to;if(from.row===to.row&&from.col===to.col){applyAlignClassName(from.row,from.col,type,alignment,cellDescriptor,propertySetter);}else{for(var row=from.row;row<=to.row;row++){for(var col=from.col;col<=to.col;col++){applyAlignClassName(row,col,type,alignment,cellDescriptor,propertySetter);}}}});}
function applyAlignClassName(row,col,type,alignment,cellDescriptor,propertySetter){var cellMeta=cellDescriptor(row,col);var className=alignment;if(cellMeta.className){if(type==='vertical'){className=prepareVerticalAlignClass(cellMeta.className,alignment);}else{className=prepareHorizontalAlignClass(cellMeta.className,alignment);}}
propertySetter(row,col,'className',className);}
function checkSelectionConsistency(ranges,comparator){var result=false;if(Array.isArray(ranges)){(0,_array.arrayEach)(ranges,function(range){range.forAll(function(row,col){if(comparator(row,col)){result=true;return false;}});return result;});}
return result;}
function markLabelAsSelected(label){return"<span class=\"selected\">".concat(String.fromCharCode(10003),"</span>").concat(label);}
function isItemHidden(item,instance){return!item.hidden||!(typeof item.hidden==='function'&&item.hidden.call(instance));}
function shiftSeparators(items,separator){var result=items.slice(0);for(var i=0;i<result.length;){if(result[i].name===separator){result.shift();}else{break;}}
return result;}
function popSeparators(items,separator){var result=items.slice(0);result.reverse();result=shiftSeparators(result,separator);result.reverse();return result;}
function removeDuplicatedSeparators(items){var result=[];(0,_array.arrayEach)(items,function(value,index){if(index>0){if(result[result.length-1].name!==value.name){result.push(value);}}else{result.push(value);}});return result;}
function filterSeparators(items){var separator=arguments.length>1&&arguments[1]!==undefined?arguments[1]:_separator.KEY;var result=items.slice(0);result=shiftSeparators(result,separator);result=popSeparators(result,separator);result=removeDuplicatedSeparators(result);return result;}}),(function(module,exports,__webpack_require__){"use strict";var fails=__webpack_require__(4);module.exports=function(method,arg){return!!method&&fails(function(){arg?method.call(null,function(){},1):method.call(null);});};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.isPrintableChar=isPrintableChar;exports.isMetaKey=isMetaKey;exports.isCtrlKey=isCtrlKey;exports.isCtrlMetaKey=isCtrlMetaKey;exports.isKey=isKey;exports.KEY_CODES=void 0;var _array=__webpack_require__(3);var KEY_CODES={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL:17,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88};exports.KEY_CODES=KEY_CODES;function isPrintableChar(keyCode){return keyCode===32||keyCode>=48&&keyCode<=57||keyCode>=96&&keyCode<=111||keyCode>=186&&keyCode<=192||keyCode>=219&&keyCode<=222||keyCode>=226||keyCode>=65&&keyCode<=90;}
function isMetaKey(keyCode){var metaKeys=[KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_UP,KEY_CODES.ARROW_LEFT,KEY_CODES.ARROW_RIGHT,KEY_CODES.HOME,KEY_CODES.END,KEY_CODES.DELETE,KEY_CODES.BACKSPACE,KEY_CODES.F1,KEY_CODES.F2,KEY_CODES.F3,KEY_CODES.F4,KEY_CODES.F5,KEY_CODES.F6,KEY_CODES.F7,KEY_CODES.F8,KEY_CODES.F9,KEY_CODES.F10,KEY_CODES.F11,KEY_CODES.F12,KEY_CODES.TAB,KEY_CODES.PAGE_DOWN,KEY_CODES.PAGE_UP,KEY_CODES.ENTER,KEY_CODES.ESCAPE,KEY_CODES.SHIFT,KEY_CODES.CAPS_LOCK,KEY_CODES.ALT];return metaKeys.indexOf(keyCode)!==-1;}
function isCtrlKey(keyCode){var keys=[];if(window.navigator.platform.includes('Mac')){keys.push(KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX);}else{keys.push(KEY_CODES.CONTROL);}
return keys.includes(keyCode);}
function isCtrlMetaKey(keyCode){return[KEY_CODES.CONTROL,KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX].includes(keyCode);}
function isKey(keyCode,baseCode){var keys=baseCode.split('|');var result=false;(0,_array.arrayEach)(keys,function(key){if(keyCode===KEY_CODES[key]){result=true;return false;}});return result;}}),(function(module,exports){var ceil=Math.ceil;var floor=Math.floor;module.exports=function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it);};}),(function(module,exports,__webpack_require__){var pIE=__webpack_require__(71);var createDesc=__webpack_require__(50);var toIObject=__webpack_require__(29);var toPrimitive=__webpack_require__(44);var has=__webpack_require__(27);var IE8_DOM_DEFINE=__webpack_require__(130);var gOPD=Object.getOwnPropertyDescriptor;exports.f=__webpack_require__(20)?gOPD:function getOwnPropertyDescriptor(O,P){O=toIObject(O);P=toPrimitive(P,true);if(IE8_DOM_DEFINE)try{return gOPD(O,P);}catch(e){}
if(has(O,P))return createDesc(!pIE.f.call(O,P),O[P]);};}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var core=__webpack_require__(21);var fails=__webpack_require__(4);module.exports=function(KEY,exec){var fn=(core.Object||{})[KEY]||Object[KEY];var exp={};exp[KEY]=exec(fn);$export($export.S+$export.F*fails(function(){fn(1);}),'Object',exp);};}),(function(module,exports,__webpack_require__){var ctx=__webpack_require__(37);var IObject=__webpack_require__(70);var toObject=__webpack_require__(24);var toLength=__webpack_require__(16);var asc=__webpack_require__(529);module.exports=function(TYPE,$create){var IS_MAP=TYPE==1;var IS_FILTER=TYPE==2;var IS_SOME=TYPE==3;var IS_EVERY=TYPE==4;var IS_FIND_INDEX=TYPE==6;var NO_HOLES=TYPE==5||IS_FIND_INDEX;var create=$create||asc;return function($this,callbackfn,that){var O=toObject($this);var self=IObject(O);var f=ctx(callbackfn,that,3);var length=toLength(self.length);var index=0;var result=IS_MAP?create($this,length):IS_FILTER?create($this,0):undefined;var val,res;for(;length>index;index++)if(NO_HOLES||index in self){val=self[index];res=f(val,index,O);if(TYPE){if(IS_MAP)result[index]=res;else if(res)switch(TYPE){case 3:return true;case 5:return val;case 6:return index;case 2:result.push(val);}else if(IS_EVERY)return false;}}
return IS_FIND_INDEX?-1:IS_SOME||IS_EVERY?IS_EVERY:result;};};}),(function(module,exports,__webpack_require__){var aFunction=__webpack_require__(38);module.exports=function(fn,that,length){aFunction(fn);if(that===undefined)return fn;switch(length){case 1:return function(a){return fn.call(that,a);};case 2:return function(a,b){return fn.call(that,a,b);};case 3:return function(a,b,c){return fn.call(that,a,b,c);};}
return function(){return fn.apply(that,arguments);};};}),(function(module,exports){module.exports=function(it){if(typeof it!='function')throw TypeError(it+' is not a function!');return it;};}),(function(module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1);};}),(function(module,exports){module.exports=function(it){if(it==undefined)throw TypeError("Can't call method on  "+it);return it;};}),(function(module,exports,__webpack_require__){"use strict";if(__webpack_require__(20)){var LIBRARY=__webpack_require__(52);var global=__webpack_require__(6);var fails=__webpack_require__(4);var $export=__webpack_require__(0);var $typed=__webpack_require__(89);var $buffer=__webpack_require__(118);var ctx=__webpack_require__(37);var anInstance=__webpack_require__(64);var propertyDesc=__webpack_require__(50);var hide=__webpack_require__(28);var redefineAll=__webpack_require__(65);var toInteger=__webpack_require__(33);var toLength=__webpack_require__(16);var toIndex=__webpack_require__(156);var toAbsoluteIndex=__webpack_require__(54);var toPrimitive=__webpack_require__(44);var has=__webpack_require__(27);var classof=__webpack_require__(72);var isObject=__webpack_require__(7);var toObject=__webpack_require__(24);var isArrayIter=__webpack_require__(110);var create=__webpack_require__(55);var getPrototypeOf=__webpack_require__(57);var gOPN=__webpack_require__(56).f;var getIterFn=__webpack_require__(112);var uid=__webpack_require__(51);var wks=__webpack_require__(12);var createArrayMethod=__webpack_require__(36);var createArrayIncludes=__webpack_require__(79);var speciesConstructor=__webpack_require__(73);var ArrayIterators=__webpack_require__(114);var Iterators=__webpack_require__(61);var $iterDetect=__webpack_require__(82);var setSpecies=__webpack_require__(63);var arrayFill=__webpack_require__(113);var arrayCopyWithin=__webpack_require__(147);var $DP=__webpack_require__(17);var $GOPD=__webpack_require__(34);var dP=$DP.f;var gOPD=$GOPD.f;var RangeError=global.RangeError;var TypeError=global.TypeError;var Uint8Array=global.Uint8Array;var ARRAY_BUFFER='ArrayBuffer';var SHARED_BUFFER='Shared'+ARRAY_BUFFER;var BYTES_PER_ELEMENT='BYTES_PER_ELEMENT';var PROTOTYPE='prototype';var ArrayProto=Array[PROTOTYPE];var $ArrayBuffer=$buffer.ArrayBuffer;var $DataView=$buffer.DataView;var arrayForEach=createArrayMethod(0);var arrayFilter=createArrayMethod(2);var arraySome=createArrayMethod(3);var arrayEvery=createArrayMethod(4);var arrayFind=createArrayMethod(5);var arrayFindIndex=createArrayMethod(6);var arrayIncludes=createArrayIncludes(true);var arrayIndexOf=createArrayIncludes(false);var arrayValues=ArrayIterators.values;var arrayKeys=ArrayIterators.keys;var arrayEntries=ArrayIterators.entries;var arrayLastIndexOf=ArrayProto.lastIndexOf;var arrayReduce=ArrayProto.reduce;var arrayReduceRight=ArrayProto.reduceRight;var arrayJoin=ArrayProto.join;var arraySort=ArrayProto.sort;var arraySlice=ArrayProto.slice;var arrayToString=ArrayProto.toString;var arrayToLocaleString=ArrayProto.toLocaleString;var ITERATOR=wks('iterator');var TAG=wks('toStringTag');var TYPED_CONSTRUCTOR=uid('typed_constructor');var DEF_CONSTRUCTOR=uid('def_constructor');var ALL_CONSTRUCTORS=$typed.CONSTR;var TYPED_ARRAY=$typed.TYPED;var VIEW=$typed.VIEW;var WRONG_LENGTH='Wrong length!';var $map=createArrayMethod(1,function(O,length){return allocate(speciesConstructor(O,O[DEF_CONSTRUCTOR]),length);});var LITTLE_ENDIAN=fails(function(){return new Uint8Array(new Uint16Array([1]).buffer)[0]===1;});var FORCED_SET=!!Uint8Array&&!!Uint8Array[PROTOTYPE].set&&fails(function(){new Uint8Array(1).set({});});var toOffset=function(it,BYTES){var offset=toInteger(it);if(offset<0||offset%BYTES)throw RangeError('Wrong offset!');return offset;};var validate=function(it){if(isObject(it)&&TYPED_ARRAY in it)return it;throw TypeError(it+' is not a typed array!');};var allocate=function(C,length){if(!(isObject(C)&&TYPED_CONSTRUCTOR in C)){throw TypeError('It is not a typed array constructor!');}return new C(length);};var speciesFromList=function(O,list){return fromList(speciesConstructor(O,O[DEF_CONSTRUCTOR]),list);};var fromList=function(C,list){var index=0;var length=list.length;var result=allocate(C,length);while(length>index)result[index]=list[index++];return result;};var addGetter=function(it,key,internal){dP(it,key,{get:function(){return this._d[internal];}});};var $from=function from(source){var O=toObject(source);var aLen=arguments.length;var mapfn=aLen>1?arguments[1]:undefined;var mapping=mapfn!==undefined;var iterFn=getIterFn(O);var i,length,values,result,step,iterator;if(iterFn!=undefined&&!isArrayIter(iterFn)){for(iterator=iterFn.call(O),values=[],i=0;!(step=iterator.next()).done;i++){values.push(step.value);}O=values;}
if(mapping&&aLen>2)mapfn=ctx(mapfn,arguments[2],2);for(i=0,length=toLength(O.length),result=allocate(this,length);length>i;i++){result[i]=mapping?mapfn(O[i],i):O[i];}
return result;};var $of=function of(){var index=0;var length=arguments.length;var result=allocate(this,length);while(length>index)result[index]=arguments[index++];return result;};var TO_LOCALE_BUG=!!Uint8Array&&fails(function(){arrayToLocaleString.call(new Uint8Array(1));});var $toLocaleString=function toLocaleString(){return arrayToLocaleString.apply(TO_LOCALE_BUG?arraySlice.call(validate(this)):validate(this),arguments);};var proto={copyWithin:function copyWithin(target,start){return arrayCopyWithin.call(validate(this),target,start,arguments.length>2?arguments[2]:undefined);},every:function every(callbackfn){return arrayEvery(validate(this),callbackfn,arguments.length>1?arguments[1]:undefined);},fill:function fill(value){return arrayFill.apply(validate(this),arguments);},filter:function filter(callbackfn){return speciesFromList(this,arrayFilter(validate(this),callbackfn,arguments.length>1?arguments[1]:undefined));},find:function find(predicate){return arrayFind(validate(this),predicate,arguments.length>1?arguments[1]:undefined);},findIndex:function findIndex(predicate){return arrayFindIndex(validate(this),predicate,arguments.length>1?arguments[1]:undefined);},forEach:function forEach(callbackfn){arrayForEach(validate(this),callbackfn,arguments.length>1?arguments[1]:undefined);},indexOf:function indexOf(searchElement){return arrayIndexOf(validate(this),searchElement,arguments.length>1?arguments[1]:undefined);},includes:function includes(searchElement){return arrayIncludes(validate(this),searchElement,arguments.length>1?arguments[1]:undefined);},join:function join(separator){return arrayJoin.apply(validate(this),arguments);},lastIndexOf:function lastIndexOf(searchElement){return arrayLastIndexOf.apply(validate(this),arguments);},map:function map(mapfn){return $map(validate(this),mapfn,arguments.length>1?arguments[1]:undefined);},reduce:function reduce(callbackfn){return arrayReduce.apply(validate(this),arguments);},reduceRight:function reduceRight(callbackfn){return arrayReduceRight.apply(validate(this),arguments);},reverse:function reverse(){var that=this;var length=validate(that).length;var middle=Math.floor(length/2);var index=0;var value;while(index<middle){value=that[index];that[index++]=that[--length];that[length]=value;}return that;},some:function some(callbackfn){return arraySome(validate(this),callbackfn,arguments.length>1?arguments[1]:undefined);},sort:function sort(comparefn){return arraySort.call(validate(this),comparefn);},subarray:function subarray(begin,end){var O=validate(this);var length=O.length;var $begin=toAbsoluteIndex(begin,length);return new(speciesConstructor(O,O[DEF_CONSTRUCTOR]))(O.buffer,O.byteOffset+$begin*O.BYTES_PER_ELEMENT,toLength((end===undefined?length:toAbsoluteIndex(end,length))-$begin));}};var $slice=function slice(start,end){return speciesFromList(this,arraySlice.call(validate(this),start,end));};var $set=function set(arrayLike){validate(this);var offset=toOffset(arguments[1],1);var length=this.length;var src=toObject(arrayLike);var len=toLength(src.length);var index=0;if(len+offset>length)throw RangeError(WRONG_LENGTH);while(index<len)this[offset+index]=src[index++];};var $iterators={entries:function entries(){return arrayEntries.call(validate(this));},keys:function keys(){return arrayKeys.call(validate(this));},values:function values(){return arrayValues.call(validate(this));}};var isTAIndex=function(target,key){return isObject(target)&&target[TYPED_ARRAY]&&typeof key!='symbol'&&key in target&&String(+key)==String(key);};var $getDesc=function getOwnPropertyDescriptor(target,key){return isTAIndex(target,key=toPrimitive(key,true))?propertyDesc(2,target[key]):gOPD(target,key);};var $setDesc=function defineProperty(target,key,desc){if(isTAIndex(target,key=toPrimitive(key,true))&&isObject(desc)&&has(desc,'value')&&!has(desc,'get')&&!has(desc,'set')&&!desc.configurable&&(!has(desc,'writable')||desc.writable)&&(!has(desc,'enumerable')||desc.enumerable)){target[key]=desc.value;return target;}return dP(target,key,desc);};if(!ALL_CONSTRUCTORS){$GOPD.f=$getDesc;$DP.f=$setDesc;}
$export($export.S+$export.F*!ALL_CONSTRUCTORS,'Object',{getOwnPropertyDescriptor:$getDesc,defineProperty:$setDesc});if(fails(function(){arrayToString.call({});})){arrayToString=arrayToLocaleString=function toString(){return arrayJoin.call(this);};}
var $TypedArrayPrototype$=redefineAll({},proto);redefineAll($TypedArrayPrototype$,$iterators);hide($TypedArrayPrototype$,ITERATOR,$iterators.values);redefineAll($TypedArrayPrototype$,{slice:$slice,set:$set,constructor:function(){},toString:arrayToString,toLocaleString:$toLocaleString});addGetter($TypedArrayPrototype$,'buffer','b');addGetter($TypedArrayPrototype$,'byteOffset','o');addGetter($TypedArrayPrototype$,'byteLength','l');addGetter($TypedArrayPrototype$,'length','e');dP($TypedArrayPrototype$,TAG,{get:function(){return this[TYPED_ARRAY];}});module.exports=function(KEY,BYTES,wrapper,CLAMPED){CLAMPED=!!CLAMPED;var NAME=KEY+(CLAMPED?'Clamped':'')+'Array';var GETTER='get'+KEY;var SETTER='set'+KEY;var TypedArray=global[NAME];var Base=TypedArray||{};var TAC=TypedArray&&getPrototypeOf(TypedArray);var FORCED=!TypedArray||!$typed.ABV;var O={};var TypedArrayPrototype=TypedArray&&TypedArray[PROTOTYPE];var getter=function(that,index){var data=that._d;return data.v[GETTER](index*BYTES+data.o,LITTLE_ENDIAN);};var setter=function(that,index,value){var data=that._d;if(CLAMPED)value=(value=Math.round(value))<0?0:value>0xff?0xff:value&0xff;data.v[SETTER](index*BYTES+data.o,value,LITTLE_ENDIAN);};var addElement=function(that,index){dP(that,index,{get:function(){return getter(this,index);},set:function(value){return setter(this,index,value);},enumerable:true});};if(FORCED){TypedArray=wrapper(function(that,data,$offset,$length){anInstance(that,TypedArray,NAME,'_d');var index=0;var offset=0;var buffer,byteLength,length,klass;if(!isObject(data)){length=toIndex(data);byteLength=length*BYTES;buffer=new $ArrayBuffer(byteLength);}else if(data instanceof $ArrayBuffer||(klass=classof(data))==ARRAY_BUFFER||klass==SHARED_BUFFER){buffer=data;offset=toOffset($offset,BYTES);var $len=data.byteLength;if($length===undefined){if($len%BYTES)throw RangeError(WRONG_LENGTH);byteLength=$len-offset;if(byteLength<0)throw RangeError(WRONG_LENGTH);}else{byteLength=toLength($length)*BYTES;if(byteLength+offset>$len)throw RangeError(WRONG_LENGTH);}
length=byteLength/BYTES;}else if(TYPED_ARRAY in data){return fromList(TypedArray,data);}else{return $from.call(TypedArray,data);}
hide(that,'_d',{b:buffer,o:offset,l:byteLength,e:length,v:new $DataView(buffer)});while(index<length)addElement(that,index++);});TypedArrayPrototype=TypedArray[PROTOTYPE]=create($TypedArrayPrototype$);hide(TypedArrayPrototype,'constructor',TypedArray);}else if(!fails(function(){TypedArray(1);})||!fails(function(){new TypedArray(-1);})||!$iterDetect(function(iter){new TypedArray();new TypedArray(null);new TypedArray(1.5);new TypedArray(iter);},true)){TypedArray=wrapper(function(that,data,$offset,$length){anInstance(that,TypedArray,NAME);var klass;if(!isObject(data))return new Base(toIndex(data));if(data instanceof $ArrayBuffer||(klass=classof(data))==ARRAY_BUFFER||klass==SHARED_BUFFER){return $length!==undefined?new Base(data,toOffset($offset,BYTES),$length):$offset!==undefined?new Base(data,toOffset($offset,BYTES)):new Base(data);}
if(TYPED_ARRAY in data)return fromList(TypedArray,data);return $from.call(TypedArray,data);});arrayForEach(TAC!==Function.prototype?gOPN(Base).concat(gOPN(TAC)):gOPN(Base),function(key){if(!(key in TypedArray))hide(TypedArray,key,Base[key]);});TypedArray[PROTOTYPE]=TypedArrayPrototype;if(!LIBRARY)TypedArrayPrototype.constructor=TypedArray;}
var $nativeIterator=TypedArrayPrototype[ITERATOR];var CORRECT_ITER_NAME=!!$nativeIterator&&($nativeIterator.name=='values'||$nativeIterator.name==undefined);var $iterator=$iterators.values;hide(TypedArray,TYPED_CONSTRUCTOR,true);hide(TypedArrayPrototype,TYPED_ARRAY,NAME);hide(TypedArrayPrototype,VIEW,true);hide(TypedArrayPrototype,DEF_CONSTRUCTOR,TypedArray);if(CLAMPED?new TypedArray(1)[TAG]!=NAME:!(TAG in TypedArrayPrototype)){dP(TypedArrayPrototype,TAG,{get:function(){return NAME;}});}
O[NAME]=TypedArray;$export($export.G+$export.W+$export.F*(TypedArray!=Base),O);$export($export.S,NAME,{BYTES_PER_ELEMENT:BYTES});$export($export.S+$export.F*fails(function(){Base.of.call(TypedArray,1);}),NAME,{from:$from,of:$of});if(!(BYTES_PER_ELEMENT in TypedArrayPrototype))hide(TypedArrayPrototype,BYTES_PER_ELEMENT,BYTES);$export($export.P,NAME,proto);setSpecies(NAME);$export($export.P+$export.F*FORCED_SET,NAME,{set:$set});$export($export.P+$export.F*!CORRECT_ITER_NAME,NAME,$iterators);if(!LIBRARY&&TypedArrayPrototype.toString!=arrayToString)TypedArrayPrototype.toString=arrayToString;$export($export.P+$export.F*fails(function(){new TypedArray(1).slice();}),NAME,{slice:$slice});$export($export.P+$export.F*(fails(function(){return[1,2].toLocaleString()!=new TypedArray([1,2]).toLocaleString();})||!fails(function(){TypedArrayPrototype.toLocaleString.call([1,2]);})),NAME,{toLocaleString:$toLocaleString});Iterators[NAME]=CORRECT_ITER_NAME?$nativeIterator:$iterator;if(!LIBRARY&&!CORRECT_ITER_NAME)hide(TypedArrayPrototype,ITERATOR,$iterator);};}else module.exports=function(){};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.setBrowserMeta=setBrowserMeta;exports.isChrome=isChrome;exports.isEdge=isEdge;exports.isIE=isIE;exports.isIE8=isIE8;exports.isIE9=isIE9;exports.isMSBrowser=isMSBrowser;exports.isMobileBrowser=isMobileBrowser;exports.isSafari=isSafari;var _object=__webpack_require__(2);var tester=function tester(testerFunc){var result={value:false};result.test=function(ua,vendor){result.value=testerFunc(ua,vendor);};return result;};var browsers={chrome:tester(function(ua,vendor){return/Chrome/.test(ua)&&/Google/.test(vendor);}),edge:tester(function(ua){return/Edge/.test(ua);}),ie:tester(function(ua){return/Trident/.test(ua);}),ie8:tester(function(){return!document.createTextNode('test').textContent;}),ie9:tester(function(){return!!document.documentMode;}),mobile:tester(function(ua){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ua);}),safari:tester(function(ua,vendor){return/Safari/.test(ua)&&/Apple Computer/.test(vendor);})};function setBrowserMeta(){var _ref=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref$userAgent=_ref.userAgent,userAgent=_ref$userAgent===void 0?navigator.userAgent:_ref$userAgent,_ref$vendor=_ref.vendor,vendor=_ref$vendor===void 0?navigator.vendor:_ref$vendor;(0,_object.objectEach)(browsers,function(_ref2){var test=_ref2.test;return void test(userAgent,vendor);});}
setBrowserMeta();function isChrome(){return browsers.chrome.value;}
function isEdge(){return browsers.edge.value;}
function isIE(){return browsers.ie.value;}
function isIE8(){return browsers.ie8.value;}
function isIE9(){return browsers.ie9.value;}
function isMSBrowser(){return browsers.ie.value||browsers.edge.value;}
function isMobileBrowser(){return browsers.mobile.value;}
function isSafari(){return browsers.safari.value;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _object=__webpack_require__(2);var _array=__webpack_require__(3);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _core=_interopRequireDefault(__webpack_require__(165));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var registeredOverlays={};var Overlay=function(){_createClass(Overlay,null,[{key:"registerOverlay",value:function registerOverlay(type,overlayClass){if(Overlay.CLONE_TYPES.indexOf(type)===-1){throw new Error("Unsupported overlay (".concat(type,")."));}
registeredOverlays[type]=overlayClass;}},{key:"createOverlay",value:function createOverlay(type,wot){return new registeredOverlays[type](wot);}},{key:"hasOverlay",value:function hasOverlay(type){return registeredOverlays[type]!==void 0;}},{key:"isOverlayTypeOf",value:function isOverlayTypeOf(overlay,type){if(!overlay||!registeredOverlays[type]){return false;}
return overlay instanceof registeredOverlays[type];}},{key:"CLONE_TOP",get:function get(){return'top';}},{key:"CLONE_BOTTOM",get:function get(){return'bottom';}},{key:"CLONE_LEFT",get:function get(){return'left';}},{key:"CLONE_TOP_LEFT_CORNER",get:function get(){return'top_left_corner';}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function get(){return'bottom_left_corner';}},{key:"CLONE_DEBUG",get:function get(){return'debug';}},{key:"CLONE_TYPES",get:function get(){return[Overlay.CLONE_TOP,Overlay.CLONE_BOTTOM,Overlay.CLONE_LEFT,Overlay.CLONE_TOP_LEFT_CORNER,Overlay.CLONE_BOTTOM_LEFT_CORNER,Overlay.CLONE_DEBUG];}}]);function Overlay(wotInstance){_classCallCheck(this,Overlay);(0,_object.defineGetter)(this,'wot',wotInstance,{writable:false});this.instance=this.wot;this.type='';this.mainTableScrollableElement=null;this.TABLE=this.wot.wtTable.TABLE;this.hider=this.wot.wtTable.hider;this.spreader=this.wot.wtTable.spreader;this.holder=this.wot.wtTable.holder;this.wtRootElement=this.wot.wtTable.wtRootElement;this.trimmingContainer=(0,_element.getTrimmingContainer)(this.hider.parentNode.parentNode);this.areElementSizesAdjusted=false;this.updateStateOfRendering();}
_createClass(Overlay,[{key:"updateStateOfRendering",value:function updateStateOfRendering(){var previousState=this.needFullRender;this.needFullRender=this.shouldBeRendered();var changed=previousState!==this.needFullRender;if(changed&&!this.needFullRender){this.reset();}
return changed;}},{key:"shouldBeRendered",value:function shouldBeRendered(){return true;}},{key:"updateTrimmingContainer",value:function updateTrimmingContainer(){this.trimmingContainer=(0,_element.getTrimmingContainer)(this.hider.parentNode.parentNode);}},{key:"updateMainScrollableElement",value:function updateMainScrollableElement(){this.mainTableScrollableElement=(0,_element.getScrollableElement)(this.wot.wtTable.TABLE);}},{key:"makeClone",value:function makeClone(direction){if(Overlay.CLONE_TYPES.indexOf(direction)===-1){throw new Error("Clone type \"".concat(direction,"\" is not supported."));}
var clone=document.createElement('DIV');var clonedTable=document.createElement('TABLE');clone.className="ht_clone_".concat(direction," handsontable");clone.style.position='absolute';clone.style.top=0;clone.style.left=0;clone.style.overflow='hidden';clonedTable.className=this.wot.wtTable.TABLE.className;clone.appendChild(clonedTable);this.type=direction;this.wot.wtTable.wtRootElement.parentNode.appendChild(clone);var preventOverflow=this.wot.getSetting('preventOverflow');if(preventOverflow===true||preventOverflow==='horizontal'&&this.type===Overlay.CLONE_TOP||preventOverflow==='vertical'&&this.type===Overlay.CLONE_LEFT){this.mainTableScrollableElement=window;}else{this.mainTableScrollableElement=(0,_element.getScrollableElement)(this.wot.wtTable.TABLE);}
return new _core.default({cloneSource:this.wot,cloneOverlay:this,table:clonedTable});}},{key:"refresh",value:function refresh(){var fastDraw=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var nextCycleRenderFlag=this.shouldBeRendered();if(this.clone&&(this.needFullRender||nextCycleRenderFlag)){this.clone.draw(fastDraw);}
this.needFullRender=nextCycleRenderFlag;}},{key:"reset",value:function reset(){if(!this.clone){return;}
var holder=this.clone.wtTable.holder;var hider=this.clone.wtTable.hider;var holderStyle=holder.style;var hidderStyle=hider.style;var rootStyle=holder.parentNode.style;(0,_array.arrayEach)([holderStyle,hidderStyle,rootStyle],function(style){style.width='';style.height='';});}},{key:"destroy",value:function destroy(){new _eventManager.default(this.clone).destroy();}}]);return Overlay;}();var _default=Overlay;exports.default=_default;}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);module.exports=function(it,S){if(!isObject(it))return it;var fn,val;if(S&&typeof(fn=it.toString)=='function'&&!isObject(val=fn.call(it)))return val;if(typeof(fn=it.valueOf)=='function'&&!isObject(val=fn.call(it)))return val;if(!S&&typeof(fn=it.toString)=='function'&&!isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to primitive value");};}),(function(module,exports,__webpack_require__){var META=__webpack_require__(51)('meta');var isObject=__webpack_require__(7);var has=__webpack_require__(27);var setDesc=__webpack_require__(17).f;var id=0;var isExtensible=Object.isExtensible||function(){return true;};var FREEZE=!__webpack_require__(4)(function(){return isExtensible(Object.preventExtensions({}));});var setMeta=function(it){setDesc(it,META,{value:{i:'O'+ ++id,w:{}}});};var fastKey=function(it,create){if(!isObject(it))return typeof it=='symbol'?it:(typeof it=='string'?'S':'P')+it;if(!has(it,META)){if(!isExtensible(it))return'F';if(!create)return'E';setMeta(it);}return it[META].i;};var getWeak=function(it,create){if(!has(it,META)){if(!isExtensible(it))return true;if(!create)return false;setMeta(it);}return it[META].w;};var onFreeze=function(it){if(FREEZE&&meta.NEED&&isExtensible(it)&&!has(it,META))setMeta(it);return it;};var meta=module.exports={KEY:META,NEED:false,fastKey:fastKey,getWeak:getWeak,onFreeze:onFreeze};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=staticRegister;exports.collection=void 0;function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
var collection=new Map();exports.collection=collection;function staticRegister(){var namespace=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'common';if(!collection.has(namespace)){collection.set(namespace,new Map());}
var subCollection=collection.get(namespace);function register(name,item){subCollection.set(name,item);}
function getItem(name){return subCollection.get(name);}
function hasItem(name){return subCollection.has(name);}
function getNames(){return _toConsumableArray(subCollection.keys());}
function getValues(){return _toConsumableArray(subCollection.values());}
return{register:register,getItem:getItem,hasItem:hasItem,getNames:getNames,getValues:getValues};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.requestAnimationFrame=requestAnimationFrame;exports.cancelAnimationFrame=cancelAnimationFrame;exports.isTouchSupported=isTouchSupported;exports.isWebComponentSupportedNatively=isWebComponentSupportedNatively;exports.hasCaptionProblem=hasCaptionProblem;exports.getComparisonFunction=getComparisonFunction;function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
var lastTime=0;var vendors=['ms','moz','webkit','o'];var _requestAnimationFrame=window.requestAnimationFrame;var _cancelAnimationFrame=window.cancelAnimationFrame;for(var x=0;x<vendors.length&&!_requestAnimationFrame;++x){_requestAnimationFrame=window["".concat(vendors[x],"RequestAnimationFrame")];_cancelAnimationFrame=window["".concat(vendors[x],"CancelAnimationFrame")]||window["".concat(vendors[x],"CancelRequestAnimationFrame")];}
if(!_requestAnimationFrame){_requestAnimationFrame=function _requestAnimationFrame(callback){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};}
if(!_cancelAnimationFrame){_cancelAnimationFrame=function _cancelAnimationFrame(id){clearTimeout(id);};}
function requestAnimationFrame(callback){return _requestAnimationFrame.call(window,callback);}
function cancelAnimationFrame(id){_cancelAnimationFrame.call(window,id);}
function isTouchSupported(){return'ontouchstart'in window;}
function isWebComponentSupportedNatively(){var test=document.createElement('div');return!!(test.createShadowRoot&&test.createShadowRoot.toString().match(/\[native code\]/));}
var _hasCaptionProblem;function detectCaptionProblem(){var TABLE=document.createElement('TABLE');TABLE.style.borderSpacing='0';TABLE.style.borderWidth='0';TABLE.style.padding='0';var TBODY=document.createElement('TBODY');TABLE.appendChild(TBODY);TBODY.appendChild(document.createElement('TR'));TBODY.firstChild.appendChild(document.createElement('TD'));TBODY.firstChild.firstChild.innerHTML='<tr><td>t<br>t</td></tr>';var CAPTION=document.createElement('CAPTION');CAPTION.innerHTML='c<br>c<br>c<br>c';CAPTION.style.padding='0';CAPTION.style.margin='0';TABLE.insertBefore(CAPTION,TBODY);document.body.appendChild(TABLE);_hasCaptionProblem=TABLE.offsetHeight<2*TABLE.lastChild.offsetHeight;document.body.removeChild(TABLE);}
function hasCaptionProblem(){if(_hasCaptionProblem===void 0){detectCaptionProblem();}
return _hasCaptionProblem;}
var comparisonFunction;function getComparisonFunction(language){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(comparisonFunction){return comparisonFunction;}
if((typeof Intl==="undefined"?"undefined":_typeof(Intl))==='object'){comparisonFunction=new Intl.Collator(language,options).compare;}else if(typeof String.prototype.localeCompare==='function'){comparisonFunction=function comparisonFunction(a,b){return"".concat(a).localeCompare(b);};}else{comparisonFunction=function comparisonFunction(a,b){if(a===b){return 0;}
return a>b?-1:1;};}
return comparisonFunction;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.toUpperCaseFirst=toUpperCaseFirst;exports.equalsIgnoreCase=equalsIgnoreCase;exports.randomString=randomString;exports.isPercentValue=isPercentValue;exports.substitute=substitute;exports.stripTags=stripTags;var _mixed=__webpack_require__(14);function toUpperCaseFirst(string){return string[0].toUpperCase()+string.substr(1);}
function equalsIgnoreCase(){var unique=[];for(var _len=arguments.length,strings=new Array(_len),_key=0;_key<_len;_key++){strings[_key]=arguments[_key];}
var length=strings.length;while(length){length-=1;var string=(0,_mixed.stringify)(strings[length]).toLowerCase();if(unique.indexOf(string)===-1){unique.push(string);}}
return unique.length===1;}
function randomString(){function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
return s4()+s4()+s4()+s4();}
function isPercentValue(value){return/^([0-9][0-9]?%$)|(^100%$)/.test(value);}
function substitute(template){var variables=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return"".concat(template).replace(/(?:\\)?\[([^[\]]+)]/g,function(match,name){if(match.charAt(0)==='\\'){return match.substr(1,match.length-1);}
return variables[name]===void 0?'':variables[name];});}
var STRIP_TAGS_REGEX=/<\/?\w+\/?>|<\w+[\s|/][^>]*>/gi;function stripTags(string){return"".concat(string).replace(STRIP_TAGS_REGEX,'');}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.getValidator=_getItem;exports.getRegisteredValidators=exports.getRegisteredValidatorNames=exports.hasValidator=exports.registerValidator=void 0;var _staticRegister2=_interopRequireDefault(__webpack_require__(46));var _autocompleteValidator=_interopRequireDefault(__webpack_require__(631));var _dateValidator=_interopRequireDefault(__webpack_require__(632));var _numericValidator=_interopRequireDefault(__webpack_require__(633));var _timeValidator=_interopRequireDefault(__webpack_require__(634));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var _staticRegister=(0,_staticRegister2.default)('validators'),register=_staticRegister.register,getItem=_staticRegister.getItem,hasItem=_staticRegister.hasItem,getNames=_staticRegister.getNames,getValues=_staticRegister.getValues;exports.getRegisteredValidators=getValues;exports.getRegisteredValidatorNames=getNames;exports.hasValidator=hasItem;exports.registerValidator=register;register('autocomplete',_autocompleteValidator.default);register('date',_dateValidator.default);register('numeric',_numericValidator.default);register('time',_timeValidator.default);function _getItem(name){if(typeof name==='function'){return name;}
if(!hasItem(name)){throw Error("No registered validator found under \"".concat(name,"\" name"));}
return getItem(name);}}),(function(module,exports){module.exports=function(bitmap,value){return{enumerable:!(bitmap&1),configurable:!(bitmap&2),writable:!(bitmap&4),value:value};};}),(function(module,exports){var id=0;var px=Math.random();module.exports=function(key){return'Symbol('.concat(key===undefined?'':key,')_',(++id+px).toString(36));};}),(function(module,exports){module.exports=false;}),(function(module,exports,__webpack_require__){var $keys=__webpack_require__(132);var enumBugKeys=__webpack_require__(96);module.exports=Object.keys||function keys(O){return $keys(O,enumBugKeys);};}),(function(module,exports,__webpack_require__){var toInteger=__webpack_require__(33);var max=Math.max;var min=Math.min;module.exports=function(index,length){index=toInteger(index);return index<0?max(index+length,0):min(index,length);};}),(function(module,exports,__webpack_require__){var anObject=__webpack_require__(5);var dPs=__webpack_require__(133);var enumBugKeys=__webpack_require__(96);var IE_PROTO=__webpack_require__(95)('IE_PROTO');var Empty=function(){};var PROTOTYPE='prototype';var createDict=function(){var iframe=__webpack_require__(92)('iframe');var i=enumBugKeys.length;var lt='<';var gt='>';var iframeDocument;iframe.style.display='none';__webpack_require__(98).appendChild(iframe);iframe.src='javascript:';iframeDocument=iframe.contentWindow.document;iframeDocument.open();iframeDocument.write(lt+'script'+gt+'document.F=Object'+lt+'/script'+gt);iframeDocument.close();createDict=iframeDocument.F;while(i--)delete createDict[PROTOTYPE][enumBugKeys[i]];return createDict();};module.exports=Object.create||function create(O,Properties){var result;if(O!==null){Empty[PROTOTYPE]=anObject(O);result=new Empty();Empty[PROTOTYPE]=null;result[IE_PROTO]=O;}else result=createDict();return Properties===undefined?result:dPs(result,Properties);};}),(function(module,exports,__webpack_require__){var $keys=__webpack_require__(132);var hiddenKeys=__webpack_require__(96).concat('length','prototype');exports.f=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return $keys(O,hiddenKeys);};}),(function(module,exports,__webpack_require__){var has=__webpack_require__(27);var toObject=__webpack_require__(24);var IE_PROTO=__webpack_require__(95)('IE_PROTO');var ObjectProto=Object.prototype;module.exports=Object.getPrototypeOf||function(O){O=toObject(O);if(has(O,IE_PROTO))return O[IE_PROTO];if(typeof O.constructor=='function'&&O instanceof O.constructor){return O.constructor.prototype;}return O instanceof Object?ObjectProto:null;};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.toSingleLine=toSingleLine;var _array=__webpack_require__(3);function toSingleLine(strings){for(var _len=arguments.length,expressions=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){expressions[_key-1]=arguments[_key];}
var result=(0,_array.arrayReduce)(strings,function(previousValue,currentValue,index){var valueWithoutWhiteSpaces=currentValue.replace(/(?:\r?\n\s+)/g,'');var expressionForIndex=expressions[index]?expressions[index]:'';return previousValue+valueWithoutWhiteSpaces+expressionForIndex;},'');return result.trim();}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.isFunction=isFunction;exports.throttle=throttle;exports.throttleAfterHits=throttleAfterHits;exports.debounce=debounce;exports.pipe=pipe;exports.partial=partial;exports.curry=curry;exports.curryRight=curryRight;var _array=__webpack_require__(3);function isFunction(func){return typeof func==='function';}
function throttle(func){var wait=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200;var lastCalled=0;var result={lastCallThrottled:true};var lastTimer=null;function _throttle(){var _this=this;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
var stamp=Date.now();var needCall=false;result.lastCallThrottled=true;if(!lastCalled){lastCalled=stamp;needCall=true;}
var remaining=wait-(stamp-lastCalled);if(needCall){result.lastCallThrottled=false;func.apply(this,args);}else{if(lastTimer){clearTimeout(lastTimer);}
lastTimer=setTimeout(function(){result.lastCallThrottled=false;func.apply(_this,args);lastCalled=0;lastTimer=void 0;},remaining);}
return result;}
return _throttle;}
function throttleAfterHits(func){var wait=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200;var hits=arguments.length>2&&arguments[2]!==undefined?arguments[2]:10;var funcThrottle=throttle(func,wait);var remainHits=hits;function _clearHits(){remainHits=hits;}
function _throttleAfterHits(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}
if(remainHits){remainHits-=1;return func.apply(this,args);}
return funcThrottle.apply(this,args);}
_throttleAfterHits.clearHits=_clearHits;return _throttleAfterHits;}
function debounce(func){var wait=arguments.length>1&&arguments[1]!==undefined?arguments[1]:200;var lastTimer=null;var result;function _debounce(){var _this2=this;for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3];}
if(lastTimer){clearTimeout(lastTimer);}
lastTimer=setTimeout(function(){result=func.apply(_this2,args);},wait);return result;}
return _debounce;}
function pipe(){for(var _len4=arguments.length,functions=new Array(_len4),_key4=0;_key4<_len4;_key4++){functions[_key4]=arguments[_key4];}
var firstFunc=functions[0],restFunc=functions.slice(1);return function _pipe(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5];}
return(0,_array.arrayReduce)(restFunc,function(acc,fn){return fn(acc);},firstFunc.apply(this,args));};}
function partial(func){for(var _len6=arguments.length,params=new Array(_len6>1?_len6-1:0),_key6=1;_key6<_len6;_key6++){params[_key6-1]=arguments[_key6];}
return function _partial(){for(var _len7=arguments.length,restParams=new Array(_len7),_key7=0;_key7<_len7;_key7++){restParams[_key7]=arguments[_key7];}
return func.apply(this,params.concat(restParams));};}
function curry(func){var argsLength=func.length;function given(argsSoFar){return function _curry(){for(var _len8=arguments.length,params=new Array(_len8),_key8=0;_key8<_len8;_key8++){params[_key8]=arguments[_key8];}
var passedArgsSoFar=argsSoFar.concat(params);var result;if(passedArgsSoFar.length>=argsLength){result=func.apply(this,passedArgsSoFar);}else{result=given(passedArgsSoFar);}
return result;};}
return given([]);}
function curryRight(func){var argsLength=func.length;function given(argsSoFar){return function _curry(){for(var _len9=arguments.length,params=new Array(_len9),_key9=0;_key9<_len9;_key9++){params[_key9]=arguments[_key9];}
var passedArgsSoFar=argsSoFar.concat(params.reverse());var result;if(passedArgsSoFar.length>=argsLength){result=func.apply(this,passedArgsSoFar);}else{result=given(passedArgsSoFar);}
return result;};}
return given([]);}}),(function(module,exports,__webpack_require__){var def=__webpack_require__(17).f;var has=__webpack_require__(27);var TAG=__webpack_require__(12)('toStringTag');module.exports=function(it,tag,stat){if(it&&!has(it=stat?it:it.prototype,TAG))def(it,TAG,{configurable:true,value:tag});};}),(function(module,exports){module.exports={};}),(function(module,exports,__webpack_require__){var UNSCOPABLES=__webpack_require__(12)('unscopables');var ArrayProto=Array.prototype;if(ArrayProto[UNSCOPABLES]==undefined)__webpack_require__(28)(ArrayProto,UNSCOPABLES,{});module.exports=function(key){ArrayProto[UNSCOPABLES][key]=true;};}),(function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(6);var dP=__webpack_require__(17);var DESCRIPTORS=__webpack_require__(20);var SPECIES=__webpack_require__(12)('species');module.exports=function(KEY){var C=global[KEY];if(DESCRIPTORS&&C&&!C[SPECIES])dP.f(C,SPECIES,{configurable:true,get:function(){return this;}});};}),(function(module,exports){module.exports=function(it,Constructor,name,forbiddenField){if(!(it instanceof Constructor)||(forbiddenField!==undefined&&forbiddenField in it)){throw TypeError(name+': incorrect invocation!');}return it;};}),(function(module,exports,__webpack_require__){var redefine=__webpack_require__(23);module.exports=function(target,src,safe){for(var key in src)redefine(target,key,src[key],safe);return target;};}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);module.exports=function(it,TYPE){if(!isObject(it)||it._t!==TYPE)throw TypeError('Incompatible receiver, '+TYPE+' required!');return it;};}),(function(module,exports,__webpack_require__){(function(module){var require;;(function(global,factory){typeof exports==='object'&&typeof module!=='undefined'?module.exports=factory():typeof define==='function'&&define.amd?define(factory):global.moment=factory()}(this,(function(){'use strict';var hookCallback;function hooks(){return hookCallback.apply(null,arguments);}
function setHookCallback(callback){hookCallback=callback;}
function isArray(input){return(input instanceof Array||Object.prototype.toString.call(input)==='[object Array]');}
function isObject(input){return(input!=null&&Object.prototype.toString.call(input)==='[object Object]');}
function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b);}
function isObjectEmpty(obj){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(obj).length===0;}else{var k;for(k in obj){if(hasOwnProp(obj,k)){return false;}}
return true;}}
function isUndefined(input){return input===void 0;}
function isNumber(input){return(typeof input==='number'||Object.prototype.toString.call(input)==='[object Number]');}
function isDate(input){return(input instanceof Date||Object.prototype.toString.call(input)==='[object Date]');}
function map(arr,fn){var res=[],i,arrLen=arr.length;for(i=0;i<arrLen;++i){res.push(fn(arr[i],i));}
return res;}
function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i];}}
if(hasOwnProp(b,'toString')){a.toString=b.toString;}
if(hasOwnProp(b,'valueOf')){a.valueOf=b.valueOf;}
return a;}
function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc();}
function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidEra:null,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],era:null,meridiem:null,rfc2822:false,weekdayMismatch:false,};}
function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags();}
return m._pf;}
var some;if(Array.prototype.some){some=Array.prototype.some;}else{some=function(fun){var t=Object(this),len=t.length>>>0,i;for(i=0;i<len;i++){if(i in t&&fun.call(this,t[i],i,t)){return true;}}
return false;};}
function isValid(m){var flags=null,parsedParts=false,isNowValid=m._d&&!isNaN(m._d.getTime());if(isNowValid){flags=getParsingFlags(m);parsedParts=some.call(flags.parsedDateParts,function(i){return i!=null;});isNowValid=flags.overflow<0&&!flags.empty&&!flags.invalidEra&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||(flags.meridiem&&parsedParts));if(m._strict){isNowValid=isNowValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined;}}
if(Object.isFrozen==null||!Object.isFrozen(m)){m._isValid=isNowValid;}else{return isNowValid;}
return m._isValid;}
function createInvalid(flags){var m=createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags);}else{getParsingFlags(m).userInvalidated=true;}
return m;}
var momentProperties=(hooks.momentProperties=[]),updateInProgress=false;function copyConfig(to,from){var i,prop,val,momentPropertiesLen=momentProperties.length;if(!isUndefined(from._isAMomentObject)){to._isAMomentObject=from._isAMomentObject;}
if(!isUndefined(from._i)){to._i=from._i;}
if(!isUndefined(from._f)){to._f=from._f;}
if(!isUndefined(from._l)){to._l=from._l;}
if(!isUndefined(from._strict)){to._strict=from._strict;}
if(!isUndefined(from._tzm)){to._tzm=from._tzm;}
if(!isUndefined(from._isUTC)){to._isUTC=from._isUTC;}
if(!isUndefined(from._offset)){to._offset=from._offset;}
if(!isUndefined(from._pf)){to._pf=getParsingFlags(from);}
if(!isUndefined(from._locale)){to._locale=from._locale;}
if(momentPropertiesLen>0){for(i=0;i<momentPropertiesLen;i++){prop=momentProperties[i];val=from[prop];if(!isUndefined(val)){to[prop]=val;}}}
return to;}
function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN);}
if(updateInProgress===false){updateInProgress=true;hooks.updateOffset(this);updateInProgress=false;}}
function isMoment(obj){return(obj instanceof Moment||(obj!=null&&obj._isAMomentObject!=null));}
function warn(msg){if(hooks.suppressDeprecationWarnings===false&&typeof console!=='undefined'&&console.warn){console.warn('Deprecation warning: '+msg);}}
function deprecate(msg,fn){var firstTime=true;return extend(function(){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(null,msg);}
if(firstTime){var args=[],arg,i,key,argLen=arguments.length;for(i=0;i<argLen;i++){arg='';if(typeof arguments[i]==='object'){arg+='\n['+i+'] ';for(key in arguments[0]){if(hasOwnProp(arguments[0],key)){arg+=key+': '+arguments[0][key]+', ';}}
arg=arg.slice(0,-2);}else{arg=arguments[i];}
args.push(arg);}
warn(msg+'\nArguments: '+
Array.prototype.slice.call(args).join('')+'\n'+
new Error().stack);firstTime=false;}
return fn.apply(this,arguments);},fn);}
var deprecations={};function deprecateSimple(name,msg){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(name,msg);}
if(!deprecations[name]){warn(msg);deprecations[name]=true;}}
hooks.suppressDeprecationWarnings=false;hooks.deprecationHandler=null;function isFunction(input){return((typeof Function!=='undefined'&&input instanceof Function)||Object.prototype.toString.call(input)==='[object Function]');}
function set(config){var prop,i;for(i in config){if(hasOwnProp(config,i)){prop=config[i];if(isFunction(prop)){this[i]=prop;}else{this['_'+i]=prop;}}}
this._config=config;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+'|'+
/\d{1,2}/.source);}
function mergeConfigs(parentConfig,childConfig){var res=extend({},parentConfig),prop;for(prop in childConfig){if(hasOwnProp(childConfig,prop)){if(isObject(parentConfig[prop])&&isObject(childConfig[prop])){res[prop]={};extend(res[prop],parentConfig[prop]);extend(res[prop],childConfig[prop]);}else if(childConfig[prop]!=null){res[prop]=childConfig[prop];}else{delete res[prop];}}}
for(prop in parentConfig){if(hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])){res[prop]=extend({},res[prop]);}}
return res;}
function Locale(config){if(config!=null){this.set(config);}}
var keys;if(Object.keys){keys=Object.keys;}else{keys=function(obj){var i,res=[];for(i in obj){if(hasOwnProp(obj,i)){res.push(i);}}
return res;};}
var defaultCalendar={sameDay:'[Today at] LT',nextDay:'[Tomorrow at] LT',nextWeek:'dddd [at] LT',lastDay:'[Yesterday at] LT',lastWeek:'[Last] dddd [at] LT',sameElse:'L',};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar['sameElse'];return isFunction(output)?output.call(mom,now):output;}
function zeroFill(number,targetLength,forceSign){var absNumber=''+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return((sign?(forceSign?'+':''):'-')+
Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+
absNumber);}
var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==='string'){func=function(){return this[callback]();};}
if(token){formatTokenFunctions[token]=func;}
if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2]);};}
if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token);};}}
function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,'');}
return input.replace(/\\/g,'');}
function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]];}else{array[i]=removeFormattingTokens(array[i]);}}
return function(mom){var output='',i;for(i=0;i<length;i++){output+=isFunction(array[i])?array[i].call(mom,format):array[i];}
return output;};}
function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate();}
format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m);}
function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input;}
localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1;}
return format;}
var defaultLongDateFormat={LTS:'h:mm:ss A',LT:'h:mm A',L:'MM/DD/YYYY',LL:'MMMM D, YYYY',LLL:'MMMM D, YYYY h:mm A',LLLL:'dddd, MMMM D, YYYY h:mm A',};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format;}
this._longDateFormat[key]=formatUpper.match(formattingTokens).map(function(tok){if(tok==='MMMM'||tok==='MM'||tok==='DD'||tok==='dddd'){return tok.slice(1);}
return tok;}).join('');return this._longDateFormat[key];}
var defaultInvalidDate='Invalid date';function invalidDate(){return this._invalidDate;}
var defaultOrdinal='%d',defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace('%d',number);}
var defaultRelativeTime={future:'in %s',past:'%s ago',s:'a few seconds',ss:'%d seconds',m:'a minute',mm:'%d minutes',h:'an hour',hh:'%d hours',d:'a day',dd:'%d days',w:'a week',ww:'%d weeks',M:'a month',MM:'%d months',y:'a year',yy:'%d years',};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number);}
function pastFuture(diff,output){var format=this._relativeTime[diff>0?'future':'past'];return isFunction(format)?format(output):format.replace(/%s/i,output);}
var aliases={D:'date',dates:'date',date:'date',d:'day',days:'day',day:'day',e:'weekday',weekdays:'weekday',weekday:'weekday',E:'isoWeekday',isoweekdays:'isoWeekday',isoweekday:'isoWeekday',DDD:'dayOfYear',dayofyears:'dayOfYear',dayofyear:'dayOfYear',h:'hour',hours:'hour',hour:'hour',ms:'millisecond',milliseconds:'millisecond',millisecond:'millisecond',m:'minute',minutes:'minute',minute:'minute',M:'month',months:'month',month:'month',Q:'quarter',quarters:'quarter',quarter:'quarter',s:'second',seconds:'second',second:'second',gg:'weekYear',weekyears:'weekYear',weekyear:'weekYear',GG:'isoWeekYear',isoweekyears:'isoWeekYear',isoweekyear:'isoWeekYear',w:'week',weeks:'week',week:'week',W:'isoWeek',isoweeks:'isoWeek',isoweek:'isoWeek',y:'year',years:'year',year:'year',};function normalizeUnits(units){return typeof units==='string'?aliases[units]||aliases[units.toLowerCase()]:undefined;}
function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop];}}}
return normalizedInput;}
var priorities={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1,};function getPrioritizedUnits(unitsObj){var units=[],u;for(u in unitsObj){if(hasOwnProp(unitsObj,u)){units.push({unit:u,priority:priorities[u]});}}
units.sort(function(a,b){return a.priority-b.priority;});return units;}
var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,match1to2NoLeadingZero=/^[1-9]\d?/,match1to2HasZero=/^([1-9]\d|\d)/,regexes;regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex;};}
function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token));}
return regexes[token](config._strict,config._locale);}
function unescapeFormat(s){return regexEscape(s.replace('\\','').replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4;}));}
function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');}
function absFloor(number){if(number<0){return Math.ceil(number)||0;}else{return Math.floor(number);}}
function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber);}
return value;}
var tokens={};function addParseToken(token,callback){var i,func=callback,tokenLen;if(typeof token==='string'){token=[token];}
if(isNumber(callback)){func=function(input,array){array[callback]=toInt(input);};}
tokenLen=token.length;for(i=0;i<tokenLen;i++){tokens[token[i]]=func;}}
function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token);});}
function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token);}}
function isLeapYear(year){return(year%4===0&&year%100!==0)||year%400===0;}
var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;addFormatToken('Y',0,0,function(){var y=this.year();return y<=9999?zeroFill(y,4):'+'+y;});addFormatToken(0,['YY',2],0,function(){return this.year()%100;});addFormatToken(0,['YYYY',4],0,'year');addFormatToken(0,['YYYYY',5],0,'year');addFormatToken(0,['YYYYYY',6,true],0,'year');addRegexToken('Y',matchSigned);addRegexToken('YY',match1to2,match2);addRegexToken('YYYY',match1to4,match4);addRegexToken('YYYYY',match1to6,match6);addRegexToken('YYYYYY',match1to6,match6);addParseToken(['YYYYY','YYYYYY'],YEAR);addParseToken('YYYY',function(input,array){array[YEAR]=input.length===2?hooks.parseTwoDigitYear(input):toInt(input);});addParseToken('YY',function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input);});addParseToken('Y',function(input,array){array[YEAR]=parseInt(input,10);});function daysInYear(year){return isLeapYear(year)?366:365;}
hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2000);};var getSetYear=makeGetSet('FullYear',true);function getIsLeapYear(){return isLeapYear(this.year());}
function makeGetSet(unit,keepTime){return function(value){if(value!=null){set$1(this,unit,value);hooks.updateOffset(this,keepTime);return this;}else{return get(this,unit);}};}
function get(mom,unit){if(!mom.isValid()){return NaN;}
var d=mom._d,isUTC=mom._isUTC;switch(unit){case'Milliseconds':return isUTC?d.getUTCMilliseconds():d.getMilliseconds();case'Seconds':return isUTC?d.getUTCSeconds():d.getSeconds();case'Minutes':return isUTC?d.getUTCMinutes():d.getMinutes();case'Hours':return isUTC?d.getUTCHours():d.getHours();case'Date':return isUTC?d.getUTCDate():d.getDate();case'Day':return isUTC?d.getUTCDay():d.getDay();case'Month':return isUTC?d.getUTCMonth():d.getMonth();case'FullYear':return isUTC?d.getUTCFullYear():d.getFullYear();default:return NaN;}}
function set$1(mom,unit,value){var d,isUTC,year,month,date;if(!mom.isValid()||isNaN(value)){return;}
d=mom._d;isUTC=mom._isUTC;switch(unit){case'Milliseconds':return void(isUTC?d.setUTCMilliseconds(value):d.setMilliseconds(value));case'Seconds':return void(isUTC?d.setUTCSeconds(value):d.setSeconds(value));case'Minutes':return void(isUTC?d.setUTCMinutes(value):d.setMinutes(value));case'Hours':return void(isUTC?d.setUTCHours(value):d.setHours(value));case'Date':return void(isUTC?d.setUTCDate(value):d.setDate(value));case'FullYear':break;default:return;}
year=value;month=mom.month();date=mom.date();date=date===29&&month===1&&!isLeapYear(year)?28:date;void(isUTC?d.setUTCFullYear(year,month,date):d.setFullYear(year,month,date));}
function stringGet(units){units=normalizeUnits(units);if(isFunction(this[units])){return this[units]();}
return this;}
function stringSet(units,value){if(typeof units==='object'){units=normalizeObjectUnits(units);var prioritized=getPrioritizedUnits(units),i,prioritizedLen=prioritized.length;for(i=0;i<prioritizedLen;i++){this[prioritized[i].unit](units[prioritized[i].unit]);}}else{units=normalizeUnits(units);if(isFunction(this[units])){return this[units](value);}}
return this;}
function mod(n,x){return((n%x)+x)%x;}
var indexOf;if(Array.prototype.indexOf){indexOf=Array.prototype.indexOf;}else{indexOf=function(o){var i;for(i=0;i<this.length;++i){if(this[i]===o){return i;}}
return-1;};}
function daysInMonth(year,month){if(isNaN(year)||isNaN(month)){return NaN;}
var modMonth=mod(month,12);year+=(month-modMonth)/12;return modMonth===1?isLeapYear(year)?29:28:31-((modMonth%7)%2);}
addFormatToken('M',['MM',2],'Mo',function(){return this.month()+1;});addFormatToken('MMM',0,0,function(format){return this.localeData().monthsShort(this,format);});addFormatToken('MMMM',0,0,function(format){return this.localeData().months(this,format);});addRegexToken('M',match1to2,match1to2NoLeadingZero);addRegexToken('MM',match1to2,match2);addRegexToken('MMM',function(isStrict,locale){return locale.monthsShortRegex(isStrict);});addRegexToken('MMMM',function(isStrict,locale){return locale.monthsRegex(isStrict);});addParseToken(['M','MM'],function(input,array){array[MONTH]=toInt(input)-1;});addParseToken(['MMM','MMMM'],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month;}else{getParsingFlags(config).invalidMonth=input;}});var defaultLocaleMonths='January_February_March_April_May_June_July_August_September_October_November_December'.split('_'),defaultLocaleMonthsShort='Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_'),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(m,format){if(!m){return isArray(this._months)?this._months:this._months['standalone'];}
return isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?'format':'standalone'][m.month()];}
function localeMonthsShort(m,format){if(!m){return isArray(this._monthsShort)?this._monthsShort:this._monthsShort['standalone'];}
return isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?'format':'standalone'][m.month()];}
function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){mom=createUTC([2000,i]);this._shortMonthsParse[i]=this.monthsShort(mom,'').toLocaleLowerCase();this._longMonthsParse[i]=this.months(mom,'').toLocaleLowerCase();}}
if(strict){if(format==='MMM'){ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null;}}else{if(format==='MMM'){ii=indexOf.call(this._shortMonthsParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._longMonthsParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null;}}}
function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact){return handleStrictParse.call(this,monthName,format,strict);}
if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];}
for(i=0;i<12;i++){mom=createUTC([2000,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp('^'+this.months(mom,'').replace('.','')+'$','i');this._shortMonthsParse[i]=new RegExp('^'+this.monthsShort(mom,'').replace('.','')+'$','i');}
if(!strict&&!this._monthsParse[i]){regex='^'+this.months(mom,'')+'|^'+this.monthsShort(mom,'');this._monthsParse[i]=new RegExp(regex.replace('.',''),'i');}
if(strict&&format==='MMMM'&&this._longMonthsParse[i].test(monthName)){return i;}else if(strict&&format==='MMM'&&this._shortMonthsParse[i].test(monthName)){return i;}else if(!strict&&this._monthsParse[i].test(monthName)){return i;}}}
function setMonth(mom,value){if(!mom.isValid()){return mom;}
if(typeof value==='string'){if(/^\d+$/.test(value)){value=toInt(value);}else{value=mom.localeData().monthsParse(value);if(!isNumber(value)){return mom;}}}
var month=value,date=mom.date();date=date<29?date:Math.min(date,daysInMonth(mom.year(),month));void(mom._isUTC?mom._d.setUTCMonth(month,date):mom._d.setMonth(month,date));return mom;}
function getSetMonth(value){if(value!=null){setMonth(this,value);hooks.updateOffset(this,true);return this;}else{return get(this,'Month');}}
function getDaysInMonth(){return daysInMonth(this.year(),this.month());}
function monthsShortRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,'_monthsRegex')){computeMonthsParse.call(this);}
if(isStrict){return this._monthsShortStrictRegex;}else{return this._monthsShortRegex;}}else{if(!hasOwnProp(this,'_monthsShortRegex')){this._monthsShortRegex=defaultMonthsShortRegex;}
return this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex;}}
function monthsRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,'_monthsRegex')){computeMonthsParse.call(this);}
if(isStrict){return this._monthsStrictRegex;}else{return this._monthsRegex;}}else{if(!hasOwnProp(this,'_monthsRegex')){this._monthsRegex=defaultMonthsRegex;}
return this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex;}}
function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length;}
var shortPieces=[],longPieces=[],mixedPieces=[],i,mom,shortP,longP;for(i=0;i<12;i++){mom=createUTC([2000,i]);shortP=regexEscape(this.monthsShort(mom,''));longP=regexEscape(this.months(mom,''));shortPieces.push(shortP);longPieces.push(longP);mixedPieces.push(longP);mixedPieces.push(shortP);}
shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);this._monthsRegex=new RegExp('^('+mixedPieces.join('|')+')','i');this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp('^('+longPieces.join('|')+')','i');this._monthsShortStrictRegex=new RegExp('^('+shortPieces.join('|')+')','i');}
function createDate(y,m,d,h,M,s,ms){var date;if(y<100&&y>=0){date=new Date(y+400,m,d,h,M,s,ms);if(isFinite(date.getFullYear())){date.setFullYear(y);}}else{date=new Date(y,m,d,h,M,s,ms);}
return date;}
function createUTCDate(y){var date,args;if(y<100&&y>=0){args=Array.prototype.slice.call(arguments);args[0]=y+400;date=new Date(Date.UTC.apply(null,args));if(isFinite(date.getUTCFullYear())){date.setUTCFullYear(y);}}else{date=new Date(Date.UTC.apply(null,arguments));}
return date;}
function firstWeekOffset(year,dow,doy){var
fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1;}
function dayOfYearFromWeeks(year,week,weekday,dow,doy){var localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset,resYear,resDayOfYear;if(dayOfYear<=0){resYear=year-1;resDayOfYear=daysInYear(resYear)+dayOfYear;}else if(dayOfYear>daysInYear(year)){resYear=year+1;resDayOfYear=dayOfYear-daysInYear(year);}else{resYear=year;resDayOfYear=dayOfYear;}
return{year:resYear,dayOfYear:resDayOfYear,};}
function weekOfYear(mom,dow,doy){var weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1,resWeek,resYear;if(week<1){resYear=mom.year()-1;resWeek=week+weeksInYear(resYear,dow,doy);}else if(week>weeksInYear(mom.year(),dow,doy)){resWeek=week-weeksInYear(mom.year(),dow,doy);resYear=mom.year()+1;}else{resYear=mom.year();resWeek=week;}
return{week:resWeek,year:resYear,};}
function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7;}
addFormatToken('w',['ww',2],'wo','week');addFormatToken('W',['WW',2],'Wo','isoWeek');addRegexToken('w',match1to2,match1to2NoLeadingZero);addRegexToken('ww',match1to2,match2);addRegexToken('W',match1to2,match1to2NoLeadingZero);addRegexToken('WW',match1to2,match2);addWeekParseToken(['w','ww','W','WW'],function(input,week,config,token){week[token.substr(0,1)]=toInt(input);});function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week;}
var defaultLocaleWeek={dow:0,doy:6,};function localeFirstDayOfWeek(){return this._week.dow;}
function localeFirstDayOfYear(){return this._week.doy;}
function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,'d');}
function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,'d');}
addFormatToken('d',0,'do','day');addFormatToken('dd',0,0,function(format){return this.localeData().weekdaysMin(this,format);});addFormatToken('ddd',0,0,function(format){return this.localeData().weekdaysShort(this,format);});addFormatToken('dddd',0,0,function(format){return this.localeData().weekdays(this,format);});addFormatToken('e',0,0,'weekday');addFormatToken('E',0,0,'isoWeekday');addRegexToken('d',match1to2);addRegexToken('e',match1to2);addRegexToken('E',match1to2);addRegexToken('dd',function(isStrict,locale){return locale.weekdaysMinRegex(isStrict);});addRegexToken('ddd',function(isStrict,locale){return locale.weekdaysShortRegex(isStrict);});addRegexToken('dddd',function(isStrict,locale){return locale.weekdaysRegex(isStrict);});addWeekParseToken(['dd','ddd','dddd'],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);if(weekday!=null){week.d=weekday;}else{getParsingFlags(config).invalidWeekday=input;}});addWeekParseToken(['d','e','E'],function(input,week,config,token){week[token]=toInt(input);});function parseWeekday(input,locale){if(typeof input!=='string'){return input;}
if(!isNaN(input)){return parseInt(input,10);}
input=locale.weekdaysParse(input);if(typeof input==='number'){return input;}
return null;}
function parseIsoWeekday(input,locale){if(typeof input==='string'){return locale.weekdaysParse(input)%7||7;}
return isNaN(input)?null:input;}
function shiftWeekdays(ws,n){return ws.slice(n,7).concat(ws.slice(0,n));}
var defaultLocaleWeekdays='Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_'),defaultLocaleWeekdaysShort='Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_'),defaultLocaleWeekdaysMin='Su_Mo_Tu_We_Th_Fr_Sa'.split('_'),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(m,format){var weekdays=isArray(this._weekdays)?this._weekdays:this._weekdays[m&&m!==true&&this._weekdays.isFormat.test(format)?'format':'standalone'];return m===true?shiftWeekdays(weekdays,this._week.dow):m?weekdays[m.day()]:weekdays;}
function localeWeekdaysShort(m){return m===true?shiftWeekdays(this._weekdaysShort,this._week.dow):m?this._weekdaysShort[m.day()]:this._weekdaysShort;}
function localeWeekdaysMin(m){return m===true?shiftWeekdays(this._weekdaysMin,this._week.dow):m?this._weekdaysMin[m.day()]:this._weekdaysMin;}
function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){mom=createUTC([2000,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(mom,'').toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(mom,'').toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(mom,'').toLocaleLowerCase();}}
if(strict){if(format==='dddd'){ii=indexOf.call(this._weekdaysParse,llc);return ii!==-1?ii:null;}else if(format==='ddd'){ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}}else{if(format==='dddd'){ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}else if(format==='ddd'){ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._minWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null;}}}
function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact){return handleStrictParse$1.call(this,weekdayName,format,strict);}
if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[];}
for(i=0;i<7;i++){mom=createUTC([2000,1]).day(i);if(strict&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp('^'+this.weekdays(mom,'').replace('.','\\.?')+'$','i');this._shortWeekdaysParse[i]=new RegExp('^'+this.weekdaysShort(mom,'').replace('.','\\.?')+'$','i');this._minWeekdaysParse[i]=new RegExp('^'+this.weekdaysMin(mom,'').replace('.','\\.?')+'$','i');}
if(!this._weekdaysParse[i]){regex='^'+
this.weekdays(mom,'')+'|^'+
this.weekdaysShort(mom,'')+'|^'+
this.weekdaysMin(mom,'');this._weekdaysParse[i]=new RegExp(regex.replace('.',''),'i');}
if(strict&&format==='dddd'&&this._fullWeekdaysParse[i].test(weekdayName)){return i;}else if(strict&&format==='ddd'&&this._shortWeekdaysParse[i].test(weekdayName)){return i;}else if(strict&&format==='dd'&&this._minWeekdaysParse[i].test(weekdayName)){return i;}else if(!strict&&this._weekdaysParse[i].test(weekdayName)){return i;}}}
function getSetDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
var day=get(this,'Day');if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,'d');}else{return day;}}
function getSetLocaleDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,'d');}
function getSetISODayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
if(input!=null){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7);}else{return this.day()||7;}}
function weekdaysRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysStrictRegex;}else{return this._weekdaysRegex;}}else{if(!hasOwnProp(this,'_weekdaysRegex')){this._weekdaysRegex=defaultWeekdaysRegex;}
return this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex;}}
function weekdaysShortRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysShortStrictRegex;}else{return this._weekdaysShortRegex;}}else{if(!hasOwnProp(this,'_weekdaysShortRegex')){this._weekdaysShortRegex=defaultWeekdaysShortRegex;}
return this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;}}
function weekdaysMinRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysMinStrictRegex;}else{return this._weekdaysMinRegex;}}else{if(!hasOwnProp(this,'_weekdaysMinRegex')){this._weekdaysMinRegex=defaultWeekdaysMinRegex;}
return this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;}}
function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length;}
var minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[],i,mom,minp,shortp,longp;for(i=0;i<7;i++){mom=createUTC([2000,1]).day(i);minp=regexEscape(this.weekdaysMin(mom,''));shortp=regexEscape(this.weekdaysShort(mom,''));longp=regexEscape(this.weekdays(mom,''));minPieces.push(minp);shortPieces.push(shortp);longPieces.push(longp);mixedPieces.push(minp);mixedPieces.push(shortp);mixedPieces.push(longp);}
minPieces.sort(cmpLenRev);shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);this._weekdaysRegex=new RegExp('^('+mixedPieces.join('|')+')','i');this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp('^('+longPieces.join('|')+')','i');this._weekdaysShortStrictRegex=new RegExp('^('+shortPieces.join('|')+')','i');this._weekdaysMinStrictRegex=new RegExp('^('+minPieces.join('|')+')','i');}
function hFormat(){return this.hours()%12||12;}
function kFormat(){return this.hours()||24;}
addFormatToken('H',['HH',2],0,'hour');addFormatToken('h',['hh',2],0,hFormat);addFormatToken('k',['kk',2],0,kFormat);addFormatToken('hmm',0,0,function(){return''+hFormat.apply(this)+zeroFill(this.minutes(),2);});addFormatToken('hmmss',0,0,function(){return(''+
hFormat.apply(this)+
zeroFill(this.minutes(),2)+
zeroFill(this.seconds(),2));});addFormatToken('Hmm',0,0,function(){return''+this.hours()+zeroFill(this.minutes(),2);});addFormatToken('Hmmss',0,0,function(){return(''+
this.hours()+
zeroFill(this.minutes(),2)+
zeroFill(this.seconds(),2));});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase);});}
meridiem('a',true);meridiem('A',false);function matchMeridiem(isStrict,locale){return locale._meridiemParse;}
addRegexToken('a',matchMeridiem);addRegexToken('A',matchMeridiem);addRegexToken('H',match1to2,match1to2HasZero);addRegexToken('h',match1to2,match1to2NoLeadingZero);addRegexToken('k',match1to2,match1to2NoLeadingZero);addRegexToken('HH',match1to2,match2);addRegexToken('hh',match1to2,match2);addRegexToken('kk',match1to2,match2);addRegexToken('hmm',match3to4);addRegexToken('hmmss',match5to6);addRegexToken('Hmm',match3to4);addRegexToken('Hmmss',match5to6);addParseToken(['H','HH'],HOUR);addParseToken(['k','kk'],function(input,array,config){var kInput=toInt(input);array[HOUR]=kInput===24?0:kInput;});addParseToken(['a','A'],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input;});addParseToken(['h','hh'],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true;});addParseToken('hmm',function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));getParsingFlags(config).bigHour=true;});addParseToken('hmmss',function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));getParsingFlags(config).bigHour=true;});addParseToken('Hmm',function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));});addParseToken('Hmmss',function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));});function localeIsPM(input){return(input+'').toLowerCase().charAt(0)==='p';}
var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet('Hours',true);function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?'pm':'PM';}else{return isLower?'am':'AM';}}
var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse,};var locales={},localeFamilies={},globalLocale;function commonPrefix(arr1,arr2){var i,minl=Math.min(arr1.length,arr2.length);for(i=0;i<minl;i+=1){if(arr1[i]!==arr2[i]){return i;}}
return minl;}
function normalizeLocale(key){return key?key.toLowerCase().replace('_','-'):key;}
function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split('-');j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split('-'):null;while(j>0){locale=loadLocale(split.slice(0,j).join('-'));if(locale){return locale;}
if(next&&next.length>=j&&commonPrefix(split,next)>=j-1){break;}
j--;}
i++;}
return globalLocale;}
function isLocaleNameSane(name){return!!(name&&name.match('^[^/\\\\]*$'));}
function loadLocale(name){var oldLocale=null,aliasedRequire;if(locales[name]===undefined&&typeof module!=='undefined'&&module&&module.exports&&isLocaleNameSane(name)){try{oldLocale=globalLocale._abbr;aliasedRequire=require;aliasedRequire('./locale/'+name);getSetGlobalLocale(oldLocale);}catch(e){locales[name]=null;}}
return locales[name];}
function getSetGlobalLocale(key,values){var data;if(key){if(isUndefined(values)){data=getLocale(key);}else{data=defineLocale(key,values);}
if(data){globalLocale=data;}else{if(typeof console!=='undefined'&&console.warn){console.warn('Locale '+key+' not found. Did you forget to load it?');}}}
return globalLocale._abbr;}
function defineLocale(name,config){if(config!==null){var locale,parentConfig=baseConfig;config.abbr=name;if(locales[name]!=null){deprecateSimple('defineLocaleOverride','use moment.updateLocale(localeName, config) to change '+'an existing locale. moment.defineLocale(localeName, '+'config) should only be used for creating a new locale '+'See http://momentjs.com/guides/#/warnings/define-locale/ for more info.');parentConfig=locales[name]._config;}else if(config.parentLocale!=null){if(locales[config.parentLocale]!=null){parentConfig=locales[config.parentLocale]._config;}else{locale=loadLocale(config.parentLocale);if(locale!=null){parentConfig=locale._config;}else{if(!localeFamilies[config.parentLocale]){localeFamilies[config.parentLocale]=[];}
localeFamilies[config.parentLocale].push({name:name,config:config,});return null;}}}
locales[name]=new Locale(mergeConfigs(parentConfig,config));if(localeFamilies[name]){localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config);});}
getSetGlobalLocale(name);return locales[name];}else{delete locales[name];return null;}}
function updateLocale(name,config){if(config!=null){var locale,tmpLocale,parentConfig=baseConfig;if(locales[name]!=null&&locales[name].parentLocale!=null){locales[name].set(mergeConfigs(locales[name]._config,config));}else{tmpLocale=loadLocale(name);if(tmpLocale!=null){parentConfig=tmpLocale._config;}
config=mergeConfigs(parentConfig,config);if(tmpLocale==null){config.abbr=name;}
locale=new Locale(config);locale.parentLocale=locales[name];locales[name]=locale;}
getSetGlobalLocale(name);}else{if(locales[name]!=null){if(locales[name].parentLocale!=null){locales[name]=locales[name].parentLocale;if(name===getSetGlobalLocale()){getSetGlobalLocale(name);}}else if(locales[name]!=null){delete locales[name];}}}
return locales[name];}
function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr;}
if(!key){return globalLocale;}
if(!isArray(key)){locale=loadLocale(key);if(locale){return locale;}
key=[key];}
return chooseLocale(key);}
function listLocales(){return keys(locales);}
function checkOverflow(m){var overflow,a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||(a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0))?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE;}
if(getParsingFlags(m)._overflowWeeks&&overflow===-1){overflow=WEEK;}
if(getParsingFlags(m)._overflowWeekday&&overflow===-1){overflow=WEEKDAY;}
getParsingFlags(m).overflow=overflow;}
return m;}
var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[['YYYYYY-MM-DD',/[+-]\d{6}-\d\d-\d\d/],['YYYY-MM-DD',/\d{4}-\d\d-\d\d/],['GGGG-[W]WW-E',/\d{4}-W\d\d-\d/],['GGGG-[W]WW',/\d{4}-W\d\d/,false],['YYYY-DDD',/\d{4}-\d{3}/],['YYYY-MM',/\d{4}-\d\d/,false],['YYYYYYMMDD',/[+-]\d{10}/],['YYYYMMDD',/\d{8}/],['GGGG[W]WWE',/\d{4}W\d{3}/],['GGGG[W]WW',/\d{4}W\d{2}/,false],['YYYYDDD',/\d{7}/],['YYYYMM',/\d{6}/,false],['YYYY',/\d{4}/,false],],isoTimes=[['HH:mm:ss.SSSS',/\d\d:\d\d:\d\d\.\d+/],['HH:mm:ss,SSSS',/\d\d:\d\d:\d\d,\d+/],['HH:mm:ss',/\d\d:\d\d:\d\d/],['HH:mm',/\d\d:\d\d/],['HHmmss.SSSS',/\d\d\d\d\d\d\.\d+/],['HHmmss,SSSS',/\d\d\d\d\d\d,\d+/],['HHmmss',/\d\d\d\d\d\d/],['HHmm',/\d\d\d\d/],['HH',/\d\d/],],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60,};function configFromISO(config){var i,l,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),allowTime,dateFormat,timeFormat,tzFormat,isoDatesLen=isoDates.length,isoTimesLen=isoTimes.length;if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDatesLen;i<l;i++){if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0];allowTime=isoDates[i][2]!==false;break;}}
if(dateFormat==null){config._isValid=false;return;}
if(match[3]){for(i=0,l=isoTimesLen;i<l;i++){if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||' ')+isoTimes[i][0];break;}}
if(timeFormat==null){config._isValid=false;return;}}
if(!allowTime&&timeFormat!=null){config._isValid=false;return;}
if(match[4]){if(tzRegex.exec(match[4])){tzFormat='Z';}else{config._isValid=false;return;}}
config._f=dateFormat+(timeFormat||'')+(tzFormat||'');configFromStringAndFormat(config);}else{config._isValid=false;}}
function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10),];if(secondStr){result.push(parseInt(secondStr,10));}
return result;}
function untruncateYear(yearStr){var year=parseInt(yearStr,10);if(year<=49){return 2000+year;}else if(year<=999){return 1900+year;}
return year;}
function preprocessRFC2822(s){return s.replace(/\([^()]*\)|[\n\t]/g,' ').replace(/(\s\s+)/g,' ').replace(/^\s\s*/,'').replace(/\s\s*$/,'');}
function checkWeekday(weekdayStr,parsedInput,config){if(weekdayStr){var weekdayProvided=defaultLocaleWeekdaysShort.indexOf(weekdayStr),weekdayActual=new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay();if(weekdayProvided!==weekdayActual){getParsingFlags(config).weekdayMismatch=true;config._isValid=false;return false;}}
return true;}
function calculateOffset(obsOffset,militaryOffset,numOffset){if(obsOffset){return obsOffsets[obsOffset];}else if(militaryOffset){return 0;}else{var hm=parseInt(numOffset,10),m=hm%100,h=(hm-m)/100;return h*60+m;}}
function configFromRFC2822(config){var match=rfc2822.exec(preprocessRFC2822(config._i)),parsedArray;if(match){parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]);if(!checkWeekday(match[1],parsedArray,config)){return;}
config._a=parsedArray;config._tzm=calculateOffset(match[8],match[9],match[10]);config._d=createUTCDate.apply(null,config._a);config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);getParsingFlags(config).rfc2822=true;}else{config._isValid=false;}}
function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return;}
configFromISO(config);if(config._isValid===false){delete config._isValid;}else{return;}
configFromRFC2822(config);if(config._isValid===false){delete config._isValid;}else{return;}
if(config._strict){config._isValid=false;}else{hooks.createFromInputFallback(config);}}
hooks.createFromInputFallback=deprecate('value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), '+'which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are '+'discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.',function(config){config._d=new Date(config._i+(config._useUTC?' UTC':''));});function defaults(a,b,c){if(a!=null){return a;}
if(b!=null){return b;}
return c;}
function currentDateArray(config){var nowValue=new Date(hooks.now());if(config._useUTC){return[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate(),];}
return[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()];}
function configFromArray(config){var i,date,input=[],currentDate,expectedWeekday,yearToUse;if(config._d){return;}
currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config);}
if(config._dayOfYear!=null){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)||config._dayOfYear===0){getParsingFlags(config)._overflowDayOfYear=true;}
date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate();}
for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i];}
for(;i<7;i++){config._a[i]=input[i]=config._a[i]==null?(i===2?1:0):config._a[i];}
if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0;}
config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay();if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);}
if(config._nextDay){config._a[HOUR]=24;}
if(config._w&&typeof config._w.d!=='undefined'&&config._w.d!==expectedWeekday){getParsingFlags(config).weekdayMismatch=true;}}
function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow,curWeek;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1);if(weekday<1||weekday>7){weekdayOverflow=true;}}else{dow=config._locale._week.dow;doy=config._locale._week.doy;curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults(w.gg,config._a[YEAR],curWeek.year);week=defaults(w.w,curWeek.week);if(w.d!=null){weekday=w.d;if(weekday<0||weekday>6){weekdayOverflow=true;}}else if(w.e!=null){weekday=w.e+dow;if(w.e<0||w.e>6){weekdayOverflow=true;}}else{weekday=dow;}}
if(week<1||week>weeksInYear(weekYear,dow,doy)){getParsingFlags(config)._overflowWeeks=true;}else if(weekdayOverflow!=null){getParsingFlags(config)._overflowWeekday=true;}else{temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear;}}
hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(config){if(config._f===hooks.ISO_8601){configFromISO(config);return;}
if(config._f===hooks.RFC_2822){configFromRFC2822(config);return;}
config._a=[];getParsingFlags(config).empty=true;var string=''+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0,era,tokenLen;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];tokenLen=tokens.length;for(i=0;i<tokenLen;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped);}
string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length;}
if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false;}else{getParsingFlags(config).unusedTokens.push(token);}
addTimeToArrayFromToken(token,parsedInput,config);}else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token);}}
getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string);}
if(config._a[HOUR]<=12&&getParsingFlags(config).bigHour===true&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined;}
getParsingFlags(config).parsedDateParts=config._a.slice(0);getParsingFlags(config).meridiem=config._meridiem;config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);era=getParsingFlags(config).era;if(era!==null){config._a[YEAR]=config._locale.erasConvertYear(era,config._a[YEAR]);}
configFromArray(config);checkOverflow(config);}
function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour;}
if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem);}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12;}
if(!isPm&&hour===12){hour=0;}
return hour;}else{return hour;}}
function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore,validFormatFound,bestFormatIsValid=false,configfLen=config._f.length;if(configfLen===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return;}
for(i=0;i<configfLen;i++){currentScore=0;validFormatFound=false;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC;}
tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(isValid(tempConfig)){validFormatFound=true;}
currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(!bestFormatIsValid){if(scoreToBeat==null||currentScore<scoreToBeat||validFormatFound){scoreToBeat=currentScore;bestMoment=tempConfig;if(validFormatFound){bestFormatIsValid=true;}}}else{if(currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig;}}}
extend(config,bestMoment||tempConfig);}
function configFromObject(config){if(config._d){return;}
var i=normalizeObjectUnits(config._i),dayOrDate=i.day===undefined?i.date:i.day;config._a=map([i.year,i.month,dayOrDate,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10);});configFromArray(config);}
function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,'d');res._nextDay=undefined;}
return res;}
function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||getLocale(config._l);if(input===null||(format===undefined&&input==='')){return createInvalid({nullInput:true});}
if(typeof input==='string'){config._i=input=config._locale.preparse(input);}
if(isMoment(input)){return new Moment(checkOverflow(input));}else if(isDate(input)){config._d=input;}else if(isArray(format)){configFromStringAndArray(config);}else if(format){configFromStringAndFormat(config);}else{configFromInput(config);}
if(!isValid(config)){config._d=null;}
return config;}
function configFromInput(config){var input=config._i;if(isUndefined(input)){config._d=new Date(hooks.now());}else if(isDate(input)){config._d=new Date(input.valueOf());}else if(typeof input==='string'){configFromString(config);}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10);});configFromArray(config);}else if(isObject(input)){configFromObject(config);}else if(isNumber(input)){config._d=new Date(input);}else{hooks.createFromInputFallback(config);}}
function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(format===true||format===false){strict=format;format=undefined;}
if(locale===true||locale===false){strict=locale;locale=undefined;}
if((isObject(input)&&isObjectEmpty(input))||(isArray(input)&&input.length===0)){input=undefined;}
c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c);}
function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false);}
var prototypeMin=deprecate('moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/',function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other<this?this:other;}else{return createInvalid();}}),prototypeMax=deprecate('moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/',function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other>this?this:other;}else{return createInvalid();}});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0];}
if(!moments.length){return createLocal();}
res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i];}}
return res;}
function min(){var args=[].slice.call(arguments,0);return pickBy('isBefore',args);}
function max(){var args=[].slice.call(arguments,0);return pickBy('isAfter',args);}
var now=function(){return Date.now?Date.now():+new Date();};var ordering=['year','quarter','month','week','day','hour','minute','second','millisecond',];function isDurationValid(m){var key,unitHasDecimal=false,i,orderLen=ordering.length;for(key in m){if(hasOwnProp(m,key)&&!(indexOf.call(ordering,key)!==-1&&(m[key]==null||!isNaN(m[key])))){return false;}}
for(i=0;i<orderLen;++i){if(m[ordering[i]]){if(unitHasDecimal){return false;}
if(parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])){unitHasDecimal=true;}}}
return true;}
function isValid$1(){return this._isValid;}
function createInvalid$1(){return createDuration(NaN);}
function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||normalizedInput.isoWeek||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=isDurationValid(normalizedInput);this._milliseconds=+milliseconds+
seconds*1e3+
minutes*6e4+
hours*1000*60*60;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=getLocale();this._bubble();}
function isDuration(obj){return obj instanceof Duration;}
function absRound(number){if(number<0){return Math.round(-1*number)*-1;}else{return Math.round(number);}}
function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if((dontConvert&&array1[i]!==array2[i])||(!dontConvert&&toInt(array1[i])!==toInt(array2[i]))){diffs++;}}
return diffs+lengthDiff;}
function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset(),sign='+';if(offset<0){offset=-offset;sign='-';}
return(sign+
zeroFill(~~(offset/60),2)+
separator+
zeroFill(~~offset%60,2));});}
offset('Z',':');offset('ZZ','');addRegexToken('Z',matchShortOffset);addRegexToken('ZZ',matchShortOffset);addParseToken(['Z','ZZ'],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(matchShortOffset,input);});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||'').match(matcher),chunk,parts,minutes;if(matches===null){return null;}
chunk=matches[matches.length-1]||[];parts=(chunk+'').match(chunkOffset)||['-',0,0];minutes=+(parts[1]*60)+toInt(parts[2]);return minutes===0?0:parts[0]==='+'?minutes:-minutes;}
function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf();res._d.setTime(res._d.valueOf()+diff);hooks.updateOffset(res,false);return res;}else{return createLocal(input).local();}}
function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset());}
hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime,keepMinutes){var offset=this._offset||0,localAdjust;if(!this.isValid()){return input!=null?this:NaN;}
if(input!=null){if(typeof input==='string'){input=offsetFromString(matchShortOffset,input);if(input===null){return this;}}else if(Math.abs(input)<16&&!keepMinutes){input=input*60;}
if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this);}
this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,'m');}
if(offset!==input){if(!keepLocalTime||this._changeInProgress){addSubtract(this,createDuration(input-offset,'m'),1,false);}else if(!this._changeInProgress){this._changeInProgress=true;hooks.updateOffset(this,true);this._changeInProgress=null;}}
return this;}else{return this._isUTC?offset:getDateOffset(this);}}
function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=='string'){input=-input;}
this.utcOffset(input,keepLocalTime);return this;}else{return-this.utcOffset();}}
function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime);}
function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),'m');}}
return this;}
function setOffsetToParsedOffset(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true);}else if(typeof this._i==='string'){var tZone=offsetFromString(matchOffset,this._i);if(tZone!=null){this.utcOffset(tZone);}else{this.utcOffset(0,true);}}
return this;}
function hasAlignedHourOffset(input){if(!this.isValid()){return false;}
input=input?createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0;}
function isDaylightSavingTime(){return(this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset());}
function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted)){return this._isDSTShifted;}
var c={},other;copyConfig(c,this);c=prepareConfig(c);if(c._a){other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0;}else{this._isDSTShifted=false;}
return this._isDSTShifted;}
function isLocal(){return this.isValid()?!this._isUTC:false;}
function isUtcOffset(){return this.isValid()?this._isUTC:false;}
function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:false;}
var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months,};}else if(isNumber(input)||!isNaN(+input)){duration={};if(key){duration[key]=+input;}else{duration.milliseconds=+input;}}else if((match=aspNetRegex.exec(input))){sign=match[1]==='-'?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(match[MILLISECOND]*1000))*sign,};}else if((match=isoRegex.exec(input))){sign=match[1]==='-'?-1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign),};}else if(duration==null){duration={};}else if(typeof duration==='object'&&('from'in duration||'to'in duration)){diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months;}
ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,'_locale')){ret._locale=input._locale;}
if(isDuration(input)&&hasOwnProp(input,'_isValid')){ret._isValid=input._isValid;}
return ret;}
createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(',','.'));return(isNaN(res)?0:res)*sign;}
function positiveMomentsDifference(base,other){var res={};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,'M').isAfter(other)){--res.months;}
res.milliseconds=+other-+base.clone().add(res.months,'M');return res;}
function momentsDifference(base,other){var res;if(!(base.isValid()&&other.isValid())){return{milliseconds:0,months:0};}
other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other);}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months;}
return res;}
function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,'moment().'+
name+'(period, number) is deprecated. Please use moment().'+
name+'(number, period). '+'See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.');tmp=val;val=period;period=tmp;}
dur=createDuration(val,period);addSubtract(this,dur,direction);return this;};}
function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);if(!mom.isValid()){return;}
updateOffset=updateOffset==null?true:updateOffset;if(months){setMonth(mom,get(mom,'Month')+months*isAdding);}
if(days){set$1(mom,'Date',get(mom,'Date')+days*isAdding);}
if(milliseconds){mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding);}
if(updateOffset){hooks.updateOffset(mom,days||months);}}
var add=createAdder(1,'add'),subtract=createAdder(-1,'subtract');function isString(input){return typeof input==='string'||input instanceof String;}
function isMomentInput(input){return(isMoment(input)||isDate(input)||isString(input)||isNumber(input)||isNumberOrStringArray(input)||isMomentInputObject(input)||input===null||input===undefined);}
function isMomentInputObject(input){var objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=false,properties=['years','year','y','months','month','M','days','day','d','dates','date','D','hours','hour','h','minutes','minute','m','seconds','second','s','milliseconds','millisecond','ms',],i,property,propertyLen=properties.length;for(i=0;i<propertyLen;i+=1){property=properties[i];propertyTest=propertyTest||hasOwnProp(input,property);}
return objectTest&&propertyTest;}
function isNumberOrStringArray(input){var arrayTest=isArray(input),dataTypeTest=false;if(arrayTest){dataTypeTest=input.filter(function(item){return!isNumber(item)&&isString(input);}).length===0;}
return arrayTest&&dataTypeTest;}
function isCalendarSpec(input){var objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=false,properties=['sameDay','nextDay','lastDay','nextWeek','lastWeek','sameElse',],i,property;for(i=0;i<properties.length;i+=1){property=properties[i];propertyTest=propertyTest||hasOwnProp(input,property);}
return objectTest&&propertyTest;}
function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,'days',true);return diff<-6?'sameElse':diff<-1?'lastWeek':diff<0?'lastDay':diff<1?'sameDay':diff<2?'nextDay':diff<7?'nextWeek':'sameElse';}
function calendar$1(time,formats){if(arguments.length===1){if(!arguments[0]){time=undefined;formats=undefined;}else if(isMomentInput(arguments[0])){time=arguments[0];formats=undefined;}else if(isCalendarSpec(arguments[0])){formats=arguments[0];time=undefined;}}
var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf('day'),format=hooks.calendarFormat(this,sod)||'sameElse',output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)));}
function clone(){return new Moment(this);}
function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(units)||'millisecond';if(units==='millisecond'){return this.valueOf()>localInput.valueOf();}else{return localInput.valueOf()<this.clone().startOf(units).valueOf();}}
function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(units)||'millisecond';if(units==='millisecond'){return this.valueOf()<localInput.valueOf();}else{return this.clone().endOf(units).valueOf()<localInput.valueOf();}}
function isBetween(from,to,units,inclusivity){var localFrom=isMoment(from)?from:createLocal(from),localTo=isMoment(to)?to:createLocal(to);if(!(this.isValid()&&localFrom.isValid()&&localTo.isValid())){return false;}
inclusivity=inclusivity||'()';return((inclusivity[0]==='('?this.isAfter(localFrom,units):!this.isBefore(localFrom,units))&&(inclusivity[1]===')'?this.isBefore(localTo,units):!this.isAfter(localTo,units)));}
function isSame(input,units){var localInput=isMoment(input)?input:createLocal(input),inputMs;if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(units)||'millisecond';if(units==='millisecond'){return this.valueOf()===localInput.valueOf();}else{inputMs=localInput.valueOf();return(this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf());}}
function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units);}
function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units);}
function diff(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid()){return NaN;}
that=cloneWithOffset(input,this);if(!that.isValid()){return NaN;}
zoneDelta=(that.utcOffset()-this.utcOffset())*6e4;units=normalizeUnits(units);switch(units){case'year':output=monthDiff(this,that)/12;break;case'month':output=monthDiff(this,that);break;case'quarter':output=monthDiff(this,that)/3;break;case'second':output=(this-that)/1e3;break;case'minute':output=(this-that)/6e4;break;case'hour':output=(this-that)/36e5;break;case'day':output=(this-that-zoneDelta)/864e5;break;case'week':output=(this-that-zoneDelta)/6048e5;break;default:output=this-that;}
return asFloat?output:absFloor(output);}
function monthDiff(a,b){if(a.date()<b.date()){return-monthDiff(b,a);}
var wholeMonthDiff=(b.year()-a.year())*12+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,'months'),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,'months');adjust=(b-anchor)/(anchor-anchor2);}else{anchor2=a.clone().add(wholeMonthDiff+1,'months');adjust=(b-anchor)/(anchor2-anchor);}
return-(wholeMonthDiff+adjust)||0;}
hooks.defaultFormat='YYYY-MM-DDTHH:mm:ssZ';hooks.defaultFormatUtc='YYYY-MM-DDTHH:mm:ss[Z]';function toString(){return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');}
function toISOString(keepOffset){if(!this.isValid()){return null;}
var utc=keepOffset!==true,m=utc?this.clone().utc():this;if(m.year()<0||m.year()>9999){return formatMoment(m,utc?'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]':'YYYYYY-MM-DD[T]HH:mm:ss.SSSZ');}
if(isFunction(Date.prototype.toISOString)){if(utc){return this.toDate().toISOString();}else{return new Date(this.valueOf()+this.utcOffset()*60*1000).toISOString().replace('Z',formatMoment(m,'Z'));}}
return formatMoment(m,utc?'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]':'YYYY-MM-DD[T]HH:mm:ss.SSSZ');}
function inspect(){if(!this.isValid()){return'moment.invalid(/* '+this._i+' */)';}
var func='moment',zone='',prefix,year,datetime,suffix;if(!this.isLocal()){func=this.utcOffset()===0?'moment.utc':'moment.parseZone';zone='Z';}
prefix='['+func+'("]';year=0<=this.year()&&this.year()<=9999?'YYYY':'YYYYYY';datetime='-MM-DD[T]HH:mm:ss.SSS';suffix=zone+'[")]';return this.format(prefix+year+datetime+suffix);}
function format(inputString){if(!inputString){inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat;}
var output=formatMoment(this,inputString);return this.localeData().postformat(output);}
function from(time,withoutSuffix){if(this.isValid()&&((isMoment(time)&&time.isValid())||createLocal(time).isValid())){return createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix);}else{return this.localeData().invalidDate();}}
function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix);}
function to(time,withoutSuffix){if(this.isValid()&&((isMoment(time)&&time.isValid())||createLocal(time).isValid())){return createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix);}else{return this.localeData().invalidDate();}}
function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix);}
function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr;}else{newLocaleData=getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData;}
return this;}}
var lang=deprecate('moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',function(key){if(key===undefined){return this.localeData();}else{return this.locale(key);}});function localeData(){return this._locale;}
var MS_PER_SECOND=1000,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(dividend,divisor){return((dividend%divisor)+divisor)%divisor;}
function localStartOfDate(y,m,d){if(y<100&&y>=0){return new Date(y+400,m,d)-MS_PER_400_YEARS;}else{return new Date(y,m,d).valueOf();}}
function utcStartOfDate(y,m,d){if(y<100&&y>=0){return Date.UTC(y+400,m,d)-MS_PER_400_YEARS;}else{return Date.UTC(y,m,d);}}
function startOf(units){var time,startOfDate;units=normalizeUnits(units);if(units===undefined||units==='millisecond'||!this.isValid()){return this;}
startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case'year':time=startOfDate(this.year(),0,1);break;case'quarter':time=startOfDate(this.year(),this.month()-(this.month()%3),1);break;case'month':time=startOfDate(this.year(),this.month(),1);break;case'week':time=startOfDate(this.year(),this.month(),this.date()-this.weekday());break;case'isoWeek':time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case'day':case'date':time=startOfDate(this.year(),this.month(),this.date());break;case'hour':time=this._d.valueOf();time-=mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case'minute':time=this._d.valueOf();time-=mod$1(time,MS_PER_MINUTE);break;case'second':time=this._d.valueOf();time-=mod$1(time,MS_PER_SECOND);break;}
this._d.setTime(time);hooks.updateOffset(this,true);return this;}
function endOf(units){var time,startOfDate;units=normalizeUnits(units);if(units===undefined||units==='millisecond'||!this.isValid()){return this;}
startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case'year':time=startOfDate(this.year()+1,0,1)-1;break;case'quarter':time=startOfDate(this.year(),this.month()-(this.month()%3)+3,1)-1;break;case'month':time=startOfDate(this.year(),this.month()+1,1)-1;break;case'week':time=startOfDate(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case'isoWeek':time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case'day':case'date':time=startOfDate(this.year(),this.month(),this.date()+1)-1;break;case'hour':time=this._d.valueOf();time+=MS_PER_HOUR-
mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-
1;break;case'minute':time=this._d.valueOf();time+=MS_PER_MINUTE-mod$1(time,MS_PER_MINUTE)-1;break;case'second':time=this._d.valueOf();time+=MS_PER_SECOND-mod$1(time,MS_PER_SECOND)-1;break;}
this._d.setTime(time);hooks.updateOffset(this,true);return this;}
function valueOf(){return this._d.valueOf()-(this._offset||0)*60000;}
function unix(){return Math.floor(this.valueOf()/1000);}
function toDate(){return new Date(this.valueOf());}
function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond(),];}
function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds(),};}
function toJSON(){return this.isValid()?this.toISOString():null;}
function isValid$2(){return isValid(this);}
function parsingFlags(){return extend({},getParsingFlags(this));}
function invalidAt(){return getParsingFlags(this).overflow;}
function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict,};}
addFormatToken('N',0,0,'eraAbbr');addFormatToken('NN',0,0,'eraAbbr');addFormatToken('NNN',0,0,'eraAbbr');addFormatToken('NNNN',0,0,'eraName');addFormatToken('NNNNN',0,0,'eraNarrow');addFormatToken('y',['y',1],'yo','eraYear');addFormatToken('y',['yy',2],0,'eraYear');addFormatToken('y',['yyy',3],0,'eraYear');addFormatToken('y',['yyyy',4],0,'eraYear');addRegexToken('N',matchEraAbbr);addRegexToken('NN',matchEraAbbr);addRegexToken('NNN',matchEraAbbr);addRegexToken('NNNN',matchEraName);addRegexToken('NNNNN',matchEraNarrow);addParseToken(['N','NN','NNN','NNNN','NNNNN'],function(input,array,config,token){var era=config._locale.erasParse(input,token,config._strict);if(era){getParsingFlags(config).era=era;}else{getParsingFlags(config).invalidEra=input;}});addRegexToken('y',matchUnsigned);addRegexToken('yy',matchUnsigned);addRegexToken('yyy',matchUnsigned);addRegexToken('yyyy',matchUnsigned);addRegexToken('yo',matchEraYearOrdinal);addParseToken(['y','yy','yyy','yyyy'],YEAR);addParseToken(['yo'],function(input,array,config,token){var match;if(config._locale._eraYearOrdinalRegex){match=input.match(config._locale._eraYearOrdinalRegex);}
if(config._locale.eraYearOrdinalParse){array[YEAR]=config._locale.eraYearOrdinalParse(input,match);}else{array[YEAR]=parseInt(input,10);}});function localeEras(m,format){var i,l,date,eras=this._eras||getLocale('en')._eras;for(i=0,l=eras.length;i<l;++i){switch(typeof eras[i].since){case'string':date=hooks(eras[i].since).startOf('day');eras[i].since=date.valueOf();break;}
switch(typeof eras[i].until){case'undefined':eras[i].until=+Infinity;break;case'string':date=hooks(eras[i].until).startOf('day').valueOf();eras[i].until=date.valueOf();break;}}
return eras;}
function localeErasParse(eraName,format,strict){var i,l,eras=this.eras(),name,abbr,narrow;eraName=eraName.toUpperCase();for(i=0,l=eras.length;i<l;++i){name=eras[i].name.toUpperCase();abbr=eras[i].abbr.toUpperCase();narrow=eras[i].narrow.toUpperCase();if(strict){switch(format){case'N':case'NN':case'NNN':if(abbr===eraName){return eras[i];}
break;case'NNNN':if(name===eraName){return eras[i];}
break;case'NNNNN':if(narrow===eraName){return eras[i];}
break;}}else if([name,abbr,narrow].indexOf(eraName)>=0){return eras[i];}}}
function localeErasConvertYear(era,year){var dir=era.since<=era.until?+1:-1;if(year===undefined){return hooks(era.since).year();}else{return hooks(era.since).year()+(year-era.offset)*dir;}}
function getEraName(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf('day').valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].name;}
if(eras[i].until<=val&&val<=eras[i].since){return eras[i].name;}}
return'';}
function getEraNarrow(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf('day').valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].narrow;}
if(eras[i].until<=val&&val<=eras[i].since){return eras[i].narrow;}}
return'';}
function getEraAbbr(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf('day').valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].abbr;}
if(eras[i].until<=val&&val<=eras[i].since){return eras[i].abbr;}}
return'';}
function getEraYear(){var i,l,dir,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){dir=eras[i].since<=eras[i].until?+1:-1;val=this.clone().startOf('day').valueOf();if((eras[i].since<=val&&val<=eras[i].until)||(eras[i].until<=val&&val<=eras[i].since)){return((this.year()-hooks(eras[i].since).year())*dir+
eras[i].offset);}}
return this.year();}
function erasNameRegex(isStrict){if(!hasOwnProp(this,'_erasNameRegex')){computeErasParse.call(this);}
return isStrict?this._erasNameRegex:this._erasRegex;}
function erasAbbrRegex(isStrict){if(!hasOwnProp(this,'_erasAbbrRegex')){computeErasParse.call(this);}
return isStrict?this._erasAbbrRegex:this._erasRegex;}
function erasNarrowRegex(isStrict){if(!hasOwnProp(this,'_erasNarrowRegex')){computeErasParse.call(this);}
return isStrict?this._erasNarrowRegex:this._erasRegex;}
function matchEraAbbr(isStrict,locale){return locale.erasAbbrRegex(isStrict);}
function matchEraName(isStrict,locale){return locale.erasNameRegex(isStrict);}
function matchEraNarrow(isStrict,locale){return locale.erasNarrowRegex(isStrict);}
function matchEraYearOrdinal(isStrict,locale){return locale._eraYearOrdinalRegex||matchUnsigned;}
function computeErasParse(){var abbrPieces=[],namePieces=[],narrowPieces=[],mixedPieces=[],i,l,erasName,erasAbbr,erasNarrow,eras=this.eras();for(i=0,l=eras.length;i<l;++i){erasName=regexEscape(eras[i].name);erasAbbr=regexEscape(eras[i].abbr);erasNarrow=regexEscape(eras[i].narrow);namePieces.push(erasName);abbrPieces.push(erasAbbr);narrowPieces.push(erasNarrow);mixedPieces.push(erasName);mixedPieces.push(erasAbbr);mixedPieces.push(erasNarrow);}
this._erasRegex=new RegExp('^('+mixedPieces.join('|')+')','i');this._erasNameRegex=new RegExp('^('+namePieces.join('|')+')','i');this._erasAbbrRegex=new RegExp('^('+abbrPieces.join('|')+')','i');this._erasNarrowRegex=new RegExp('^('+narrowPieces.join('|')+')','i');}
addFormatToken(0,['gg',2],0,function(){return this.weekYear()%100;});addFormatToken(0,['GG',2],0,function(){return this.isoWeekYear()%100;});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter);}
addWeekYearFormatToken('gggg','weekYear');addWeekYearFormatToken('ggggg','weekYear');addWeekYearFormatToken('GGGG','isoWeekYear');addWeekYearFormatToken('GGGGG','isoWeekYear');addRegexToken('G',matchSigned);addRegexToken('g',matchSigned);addRegexToken('GG',match1to2,match2);addRegexToken('gg',match1to2,match2);addRegexToken('GGGG',match1to4,match4);addRegexToken('gggg',match1to4,match4);addRegexToken('GGGGG',match1to6,match6);addRegexToken('ggggg',match1to6,match6);addWeekParseToken(['gggg','ggggg','GGGG','GGGGG'],function(input,week,config,token){week[token.substr(0,2)]=toInt(input);});addWeekParseToken(['gg','GG'],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input);});function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy);}
function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4);}
function getISOWeeksInYear(){return weeksInYear(this.year(),1,4);}
function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4);}
function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy);}
function getWeeksInWeekYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.weekYear(),weekInfo.dow,weekInfo.doy);}
function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;if(input==null){return weekOfYear(this,dow,doy).year;}else{weeksTarget=weeksInYear(input,dow,doy);if(week>weeksTarget){week=weeksTarget;}
return setWeekAll.call(this,input,week,weekday,dow,doy);}}
function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);this.year(date.getUTCFullYear());this.month(date.getUTCMonth());this.date(date.getUTCDate());return this;}
addFormatToken('Q',0,'Qo','quarter');addRegexToken('Q',match1);addParseToken('Q',function(input,array){array[MONTH]=(toInt(input)-1)*3;});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+(this.month()%3));}
addFormatToken('D',['DD',2],'Do','date');addRegexToken('D',match1to2,match1to2NoLeadingZero);addRegexToken('DD',match1to2,match2);addRegexToken('Do',function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient;});addParseToken(['D','DD'],DATE);addParseToken('Do',function(input,array){array[DATE]=toInt(input.match(match1to2)[0]);});var getSetDayOfMonth=makeGetSet('Date',true);addFormatToken('DDD',['DDDD',3],'DDDo','dayOfYear');addRegexToken('DDD',match1to3);addRegexToken('DDDD',match3);addParseToken(['DDD','DDDD'],function(input,array,config){config._dayOfYear=toInt(input);});function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf('day')-this.clone().startOf('year'))/864e5)+1;return input==null?dayOfYear:this.add(input-dayOfYear,'d');}
addFormatToken('m',['mm',2],0,'minute');addRegexToken('m',match1to2,match1to2HasZero);addRegexToken('mm',match1to2,match2);addParseToken(['m','mm'],MINUTE);var getSetMinute=makeGetSet('Minutes',false);addFormatToken('s',['ss',2],0,'second');addRegexToken('s',match1to2,match1to2HasZero);addRegexToken('ss',match1to2,match2);addParseToken(['s','ss'],SECOND);var getSetSecond=makeGetSet('Seconds',false);addFormatToken('S',0,0,function(){return~~(this.millisecond()/100);});addFormatToken(0,['SS',2],0,function(){return~~(this.millisecond()/10);});addFormatToken(0,['SSS',3],0,'millisecond');addFormatToken(0,['SSSS',4],0,function(){return this.millisecond()*10;});addFormatToken(0,['SSSSS',5],0,function(){return this.millisecond()*100;});addFormatToken(0,['SSSSSS',6],0,function(){return this.millisecond()*1000;});addFormatToken(0,['SSSSSSS',7],0,function(){return this.millisecond()*10000;});addFormatToken(0,['SSSSSSSS',8],0,function(){return this.millisecond()*100000;});addFormatToken(0,['SSSSSSSSS',9],0,function(){return this.millisecond()*1000000;});addRegexToken('S',match1to3,match1);addRegexToken('SS',match1to3,match2);addRegexToken('SSS',match1to3,match3);var token,getSetMillisecond;for(token='SSSS';token.length<=9;token+='S'){addRegexToken(token,matchUnsigned);}
function parseMs(input,array){array[MILLISECOND]=toInt(('0.'+input)*1000);}
for(token='S';token.length<=9;token+='S'){addParseToken(token,parseMs);}
getSetMillisecond=makeGetSet('Milliseconds',false);addFormatToken('z',0,0,'zoneAbbr');addFormatToken('zz',0,0,'zoneName');function getZoneAbbr(){return this._isUTC?'UTC':'';}
function getZoneName(){return this._isUTC?'Coordinated Universal Time':'';}
var proto=Moment.prototype;proto.add=add;proto.calendar=calendar$1;proto.clone=clone;proto.diff=diff;proto.endOf=endOf;proto.format=format;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;if(typeof Symbol!=='undefined'&&Symbol.for!=null){proto[Symbol.for('nodejs.util.inspect.custom')]=function(){return'Moment<'+this.format()+'>';};}
proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.eraName=getEraName;proto.eraNarrow=getEraNarrow;proto.eraAbbr=getEraAbbr;proto.eraYear=getEraYear;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.weeksInWeekYear=getWeeksInWeekYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate('dates accessor is deprecated. Use date instead.',getSetDayOfMonth);proto.months=deprecate('months accessor is deprecated. Use month instead',getSetMonth);proto.years=deprecate('years accessor is deprecated. Use year instead',getSetYear);proto.zone=deprecate('moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/',getSetZone);proto.isDSTShifted=deprecate('isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information',isDaylightSavingTimeShifted);function createUnix(input){return createLocal(input*1000);}
function createInZone(){return createLocal.apply(null,arguments).parseZone();}
function preParsePostFormat(string){return string;}
var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set;proto$1.eras=localeEras;proto$1.erasParse=localeErasParse;proto$1.erasConvertYear=localeErasConvertYear;proto$1.erasAbbrRegex=erasAbbrRegex;proto$1.erasNameRegex=erasNameRegex;proto$1.erasNarrowRegex=erasNarrowRegex;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(format,index,field,setter){var locale=getLocale(),utc=createUTC().set(setter,index);return locale[field](utc,format);}
function listMonthsImpl(format,index,field){if(isNumber(format)){index=format;format=undefined;}
format=format||'';if(index!=null){return get$1(format,index,field,'month');}
var i,out=[];for(i=0;i<12;i++){out[i]=get$1(format,i,field,'month');}
return out;}
function listWeekdaysImpl(localeSorted,format,index,field){if(typeof localeSorted==='boolean'){if(isNumber(format)){index=format;format=undefined;}
format=format||'';}else{format=localeSorted;index=format;localeSorted=false;if(isNumber(format)){index=format;format=undefined;}
format=format||'';}
var locale=getLocale(),shift=localeSorted?locale._week.dow:0,i,out=[];if(index!=null){return get$1(format,(index+shift)%7,field,'day');}
for(i=0;i<7;i++){out[i]=get$1(format,(i+shift)%7,field,'day');}
return out;}
function listMonths(format,index){return listMonthsImpl(format,index,'months');}
function listMonthsShort(format,index){return listMonthsImpl(format,index,'monthsShort');}
function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdays');}
function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdaysShort');}
function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdaysMin');}
getSetGlobalLocale('en',{eras:[{since:'0001-01-01',until:+Infinity,offset:1,name:'Anno Domini',narrow:'AD',abbr:'AD',},{since:'0000-12-31',until:-Infinity,offset:1,name:'Before Christ',narrow:'BC',abbr:'BC',},],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=toInt((number%100)/10)===1?'th':b===1?'st':b===2?'nd':b===3?'rd':'th';return number+output;},});hooks.lang=deprecate('moment.lang is deprecated. Use moment.locale instead.',getSetGlobalLocale);hooks.langData=deprecate('moment.langData is deprecated. Use moment.localeData instead.',getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this;}
function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble();}
function add$1(input,value){return addSubtract$1(this,input,value,1);}
function subtract$1(input,value){return addSubtract$1(this,input,value,-1);}
function absCeil(number){if(number<0){return Math.floor(number);}else{return Math.ceil(number);}}
function bubble(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years,monthsFromDays;if(!((milliseconds>=0&&days>=0&&months>=0)||(milliseconds<=0&&days<=0&&months<=0))){milliseconds+=absCeil(monthsToDays(months)+days)*864e5;days=0;months=0;}
data.milliseconds=milliseconds%1000;seconds=absFloor(milliseconds/1000);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);monthsFromDays=absFloor(daysToMonths(days));months+=monthsFromDays;days-=absCeil(monthsToDays(monthsFromDays));years=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this;}
function daysToMonths(days){return(days*4800)/146097;}
function monthsToDays(months){return(months*146097)/4800;}
function as(units){if(!this.isValid()){return NaN;}
var days,months,milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==='month'||units==='quarter'||units==='year'){days=this._days+milliseconds/864e5;months=this._months+daysToMonths(days);switch(units){case'month':return months;case'quarter':return months/3;case'year':return months/12;}}else{days=this._days+Math.round(monthsToDays(this._months));switch(units){case'week':return days/7+milliseconds/6048e5;case'day':return days+milliseconds/864e5;case'hour':return days*24+milliseconds/36e5;case'minute':return days*1440+milliseconds/6e4;case'second':return days*86400+milliseconds/1000;case'millisecond':return Math.floor(days*864e5)+milliseconds;default:throw new Error('Unknown unit '+units);}}}
function makeAs(alias){return function(){return this.as(alias);};}
var asMilliseconds=makeAs('ms'),asSeconds=makeAs('s'),asMinutes=makeAs('m'),asHours=makeAs('h'),asDays=makeAs('d'),asWeeks=makeAs('w'),asMonths=makeAs('M'),asQuarters=makeAs('Q'),asYears=makeAs('y'),valueOf$1=asMilliseconds;function clone$1(){return createDuration(this);}
function get$2(units){units=normalizeUnits(units);return this.isValid()?this[units+'s']():NaN;}
function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN;};}
var milliseconds=makeGetter('milliseconds'),seconds=makeGetter('seconds'),minutes=makeGetter('minutes'),hours=makeGetter('hours'),days=makeGetter('days'),months=makeGetter('months'),years=makeGetter('years');function weeks(){return absFloor(this.days()/7);}
var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11,};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture);}
function relativeTime$1(posNegDuration,withoutSuffix,thresholds,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as('s')),minutes=round(duration.as('m')),hours=round(duration.as('h')),days=round(duration.as('d')),months=round(duration.as('M')),weeks=round(duration.as('w')),years=round(duration.as('y')),a=(seconds<=thresholds.ss&&['s',seconds])||(seconds<thresholds.s&&['ss',seconds])||(minutes<=1&&['m'])||(minutes<thresholds.m&&['mm',minutes])||(hours<=1&&['h'])||(hours<thresholds.h&&['hh',hours])||(days<=1&&['d'])||(days<thresholds.d&&['dd',days]);if(thresholds.w!=null){a=a||(weeks<=1&&['w'])||(weeks<thresholds.w&&['ww',weeks]);}
a=a||(months<=1&&['M'])||(months<thresholds.M&&['MM',months])||(years<=1&&['y'])||['yy',years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a);}
function getSetRelativeTimeRounding(roundingFunction){if(roundingFunction===undefined){return round;}
if(typeof roundingFunction==='function'){round=roundingFunction;return true;}
return false;}
function getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false;}
if(limit===undefined){return thresholds[threshold];}
thresholds[threshold]=limit;if(threshold==='s'){thresholds.ss=limit-1;}
return true;}
function humanize(argWithSuffix,argThresholds){if(!this.isValid()){return this.localeData().invalidDate();}
var withSuffix=false,th=thresholds,locale,output;if(typeof argWithSuffix==='object'){argThresholds=argWithSuffix;argWithSuffix=false;}
if(typeof argWithSuffix==='boolean'){withSuffix=argWithSuffix;}
if(typeof argThresholds==='object'){th=Object.assign({},thresholds,argThresholds);if(argThresholds.s!=null&&argThresholds.ss==null){th.ss=argThresholds.s-1;}}
locale=this.localeData();output=relativeTime$1(this,!withSuffix,th,locale);if(withSuffix){output=locale.pastFuture(+this,output);}
return locale.postformat(output);}
var abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x;}
function toISOString$1(){if(!this.isValid()){return this.localeData().invalidDate();}
var seconds=abs$1(this._milliseconds)/1000,days=abs$1(this._days),months=abs$1(this._months),minutes,hours,years,s,total=this.asSeconds(),totalSign,ymSign,daysSign,hmsSign;if(!total){return'P0D';}
minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;s=seconds?seconds.toFixed(3).replace(/\.?0+$/,''):'';totalSign=total<0?'-':'';ymSign=sign(this._months)!==sign(total)?'-':'';daysSign=sign(this._days)!==sign(total)?'-':'';hmsSign=sign(this._milliseconds)!==sign(total)?'-':'';return(totalSign+'P'+
(years?ymSign+years+'Y':'')+
(months?ymSign+months+'M':'')+
(days?daysSign+days+'D':'')+
(hours||minutes||seconds?'T':'')+
(hours?hmsSign+hours+'H':'')+
(minutes?hmsSign+minutes+'M':'')+
(seconds?hmsSign+s+'S':''));}
var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs;proto$2.add=add$1;proto$2.subtract=subtract$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asQuarters=asQuarters;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)',toISOString$1);proto$2.lang=lang;addFormatToken('X',0,0,'unix');addFormatToken('x',0,0,'valueOf');addRegexToken('x',matchSigned);addRegexToken('X',matchTimestamp);addParseToken('X',function(input,array,config){config._d=new Date(parseFloat(input)*1000);});addParseToken('x',function(input,array,config){config._d=new Date(toInt(input));});hooks.version='2.30.1';setHookCallback(createLocal);hooks.fn=proto;hooks.min=min;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:'YYYY-MM-DDTHH:mm',DATETIME_LOCAL_SECONDS:'YYYY-MM-DDTHH:mm:ss',DATETIME_LOCAL_MS:'YYYY-MM-DDTHH:mm:ss.SSS',DATE:'YYYY-MM-DD',TIME:'HH:mm',TIME_SECONDS:'HH:mm:ss',TIME_MS:'HH:mm:ss.SSS',WEEK:'GGGG-[W]WW',MONTH:'YYYY-MM',};return hooks;})));window['moment']=__webpack_require__(67);}.call(exports,__webpack_require__(166)(module)))}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _array=__webpack_require__(3);var _object=__webpack_require__(2);var MIXIN_NAME='localHooks';var localHooks={_localHooks:Object.create(null),addLocalHook:function addLocalHook(key,callback){if(!this._localHooks[key]){this._localHooks[key]=[];}
this._localHooks[key].push(callback);return this;},runLocalHooks:function runLocalHooks(key){var _this=this;for(var _len=arguments.length,params=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){params[_key-1]=arguments[_key];}
if(this._localHooks[key]){(0,_array.arrayEach)(this._localHooks[key],function(callback){return callback.apply(_this,params);});}},clearLocalHooks:function clearLocalHooks(){this._localHooks={};return this;}};(0,_object.defineGetter)(localHooks,'MIXIN_NAME',MIXIN_NAME,{writable:false,enumerable:false});var _default=localHooks;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.createId=createId;exports.createDefaultCustomBorder=createDefaultCustomBorder;exports.createSingleEmptyBorder=createSingleEmptyBorder;exports.createDefaultHtBorder=createDefaultHtBorder;exports.createEmptyBorders=createEmptyBorders;exports.extendDefaultBorder=extendDefaultBorder;exports.checkSelectionBorders=checkSelectionBorders;exports.markSelected=markSelected;var _object=__webpack_require__(2);var _array=__webpack_require__(3);function createId(row,col){return"border_row".concat(row,"col").concat(col);}
function createDefaultCustomBorder(){return{width:1,color:'#000'};}
function createSingleEmptyBorder(){return{hide:true};}
function createDefaultHtBorder(){return{width:1,color:'#000',cornerVisible:false};}
function createEmptyBorders(row,col){return{id:createId(row,col),border:createDefaultHtBorder(),row:row,col:col,top:createSingleEmptyBorder(),right:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),left:createSingleEmptyBorder()};}
function extendDefaultBorder(defaultBorder,customBorder){if((0,_object.hasOwnProperty)(customBorder,'border')){defaultBorder.border=customBorder.border;}
if((0,_object.hasOwnProperty)(customBorder,'top')){if(customBorder.top){if(!(0,_object.isObject)(customBorder.top)){customBorder.top=createDefaultCustomBorder();}
defaultBorder.top=customBorder.top;}else{customBorder.top=createSingleEmptyBorder();defaultBorder.top=customBorder.top;}}
if((0,_object.hasOwnProperty)(customBorder,'right')){if(customBorder.right){if(!(0,_object.isObject)(customBorder.right)){customBorder.right=createDefaultCustomBorder();}
defaultBorder.right=customBorder.right;}else{customBorder.right=createSingleEmptyBorder();defaultBorder.right=customBorder.right;}}
if((0,_object.hasOwnProperty)(customBorder,'bottom')){if(customBorder.bottom){if(!(0,_object.isObject)(customBorder.bottom)){customBorder.bottom=createDefaultCustomBorder();}
defaultBorder.bottom=customBorder.bottom;}else{customBorder.bottom=createSingleEmptyBorder();defaultBorder.bottom=customBorder.bottom;}}
if((0,_object.hasOwnProperty)(customBorder,'left')){if(customBorder.left){if(!(0,_object.isObject)(customBorder.left)){customBorder.left=createDefaultCustomBorder();}
defaultBorder.left=customBorder.left;}else{customBorder.left=createSingleEmptyBorder();defaultBorder.left=customBorder.left;}}
return defaultBorder;}
function checkSelectionBorders(hot,direction){var atLeastOneHasBorder=false;(0,_array.arrayEach)(hot.getSelectedRange(),function(range){range.forAll(function(r,c){var metaBorders=hot.getCellMeta(r,c).borders;if(metaBorders){if(direction){if(!(0,_object.hasOwnProperty)(metaBorders[direction],'hide')||metaBorders[direction].hide===false){atLeastOneHasBorder=true;return false;}}else{atLeastOneHasBorder=true;return false;}}});});return atLeastOneHasBorder;}
function markSelected(label){return"<span class=\"selected\">".concat(String.fromCharCode(10003),"</span>").concat(label);}}),(function(module,exports,__webpack_require__){var cof=__webpack_require__(39);module.exports=Object('z').propertyIsEnumerable(0)?Object:function(it){return cof(it)=='String'?it.split(''):Object(it);};}),(function(module,exports){exports.f={}.propertyIsEnumerable;}),(function(module,exports,__webpack_require__){var cof=__webpack_require__(39);var TAG=__webpack_require__(12)('toStringTag');var ARG=cof(function(){return arguments;}())=='Arguments';var tryGet=function(it,key){try{return it[key];}catch(e){}};module.exports=function(it){var O,T,B;return it===undefined?'Undefined':it===null?'Null':typeof(T=tryGet(O=Object(it),TAG))=='string'?T:ARG?cof(O):(B=cof(O))=='Object'&&typeof O.callee=='function'?'Arguments':B;};}),(function(module,exports,__webpack_require__){var anObject=__webpack_require__(5);var aFunction=__webpack_require__(38);var SPECIES=__webpack_require__(12)('species');module.exports=function(O,D){var C=anObject(O).constructor;var S;return C===undefined||(S=anObject(C)[SPECIES])==undefined?D:aFunction(S);};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=exports.EditorState=void 0;var _src=__webpack_require__(8);var _mixed=__webpack_require__(14);var EditorState={VIRGIN:'STATE_VIRGIN',EDITING:'STATE_EDITING',WAITING:'STATE_WAITING',FINISHED:'STATE_FINISHED'};exports.EditorState=EditorState;function BaseEditor(instance){this.instance=instance;this.state=EditorState.VIRGIN;this._opened=false;this._fullEditMode=false;this._closeCallback=null;this.init();}
BaseEditor.prototype._fireCallbacks=function(result){if(this._closeCallback){this._closeCallback(result);this._closeCallback=null;}};BaseEditor.prototype.init=function(){};BaseEditor.prototype.getValue=function(){throw Error('Editor getValue() method unimplemented');};BaseEditor.prototype.setValue=function(){throw Error('Editor setValue() method unimplemented');};BaseEditor.prototype.open=function(){throw Error('Editor open() method unimplemented');};BaseEditor.prototype.close=function(){throw Error('Editor close() method unimplemented');};BaseEditor.prototype.prepare=function(row,col,prop,td,originalValue,cellProperties){this.TD=td;this.row=row;this.col=col;this.prop=prop;this.originalValue=originalValue;this.cellProperties=cellProperties;this.state=EditorState.VIRGIN;};BaseEditor.prototype.extend=function(){var baseClass=this.constructor;function Editor(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
baseClass.apply(this,args);}
function inherit(Child,Parent){function Bridge(){}
Bridge.prototype=Parent.prototype;Child.prototype=new Bridge();Child.prototype.constructor=Child;return Child;}
return inherit(Editor,baseClass);};BaseEditor.prototype.saveValue=function(value,ctrlDown){var selection;var tmp;if(ctrlDown){selection=this.instance.getSelectedLast();if(selection[0]>selection[2]){tmp=selection[0];selection[0]=selection[2];selection[2]=tmp;}
if(selection[1]>selection[3]){tmp=selection[1];selection[1]=selection[3];selection[3]=tmp;}}else{selection=[this.row,this.col,null,null];}
this.instance.populateFromArray(selection[0],selection[1],value,selection[2],selection[3],'edit');};BaseEditor.prototype.beginEditing=function(newInitialValue,event){if(this.state!==EditorState.VIRGIN){return;}
this.instance.view.scrollViewport(new _src.CellCoords(this.row,this.col));this.state=EditorState.EDITING;if(this.isInFullEditMode()){var stringifiedInitialValue=typeof newInitialValue==='string'?newInitialValue:(0,_mixed.stringify)(this.originalValue);this.setValue(stringifiedInitialValue);}
this.open(event);this._opened=true;this.focus();this.instance.view.render();this.instance.runHooks('afterBeginEditing',this.row,this.col);};BaseEditor.prototype.finishEditing=function(restoreOriginalValue,ctrlDown,callback){var _this=this;var val;if(callback){var previousCloseCallback=this._closeCallback;this._closeCallback=function(result){if(previousCloseCallback){previousCloseCallback(result);}
callback(result);_this.instance.view.render();};}
if(this.isWaiting()){return;}
if(this.state===EditorState.VIRGIN){this.instance._registerTimeout(function(){_this._fireCallbacks(true);});return;}
if(this.state===EditorState.EDITING){if(restoreOriginalValue){this.cancelChanges();this.instance.view.render();return;}
var value=this.getValue();if(this.instance.getSettings().trimWhitespace){val=[[typeof value==='string'?String.prototype.trim.call(value||''):value]];}else{val=[[value]];}
this.state=EditorState.WAITING;this.saveValue(val,ctrlDown);if(this.instance.getCellValidator(this.cellProperties)){this.instance.addHookOnce('postAfterValidate',function(result){_this.state=EditorState.FINISHED;_this.discardEditor(result);});}else{this.state=EditorState.FINISHED;this.discardEditor(true);}}};BaseEditor.prototype.cancelChanges=function(){this.state=EditorState.FINISHED;this.discardEditor();};BaseEditor.prototype.discardEditor=function(result){if(this.state!==EditorState.FINISHED){return;}
if(result===false&&this.cellProperties.allowInvalid!==true){this.instance.selectCell(this.row,this.col);this.focus();this.state=EditorState.EDITING;this._fireCallbacks(false);}else{this.close();this._opened=false;this._fullEditMode=false;this.state=EditorState.VIRGIN;this._fireCallbacks(true);}};BaseEditor.prototype.enableFullEditMode=function(){this._fullEditMode=true;};BaseEditor.prototype.isInFullEditMode=function(){return this._fullEditMode;};BaseEditor.prototype.isOpened=function(){return this._opened;};BaseEditor.prototype.isWaiting=function(){return this.state===EditorState.WAITING;};BaseEditor.prototype.checkEditorSection=function(){var totalRows=this.instance.countRows();var section='';if(this.row<this.instance.getSettings().fixedRowsTop){if(this.col<this.instance.getSettings().fixedColumnsLeft){section='top-left-corner';}else{section='top';}}else if(this.instance.getSettings().fixedRowsBottom&&this.row>=totalRows-this.instance.getSettings().fixedRowsBottom){if(this.col<this.instance.getSettings().fixedColumnsLeft){section='bottom-left-corner';}else{section='bottom';}}else if(this.col<this.instance.getSettings().fixedColumnsLeft){section='left';}
return section;};var _default=BaseEditor;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var CellCoords=function(){function CellCoords(row,column){_classCallCheck(this,CellCoords);this.row=null;this.col=null;if(typeof row!=='undefined'&&typeof column!=='undefined'){this.row=row;this.col=column;}}
_createClass(CellCoords,[{key:"isValid",value:function isValid(wot){if(this.row<0||this.col<0){return false;}
if(this.row>=wot.getSetting('totalRows')||this.col>=wot.getSetting('totalColumns')){return false;}
return true;}},{key:"isEqual",value:function isEqual(cellCoords){if(cellCoords===this){return true;}
return this.row===cellCoords.row&&this.col===cellCoords.col;}},{key:"isSouthEastOf",value:function isSouthEastOf(testedCoords){return this.row>=testedCoords.row&&this.col>=testedCoords.col;}},{key:"isNorthWestOf",value:function isNorthWestOf(testedCoords){return this.row<=testedCoords.row&&this.col<=testedCoords.col;}},{key:"isSouthWestOf",value:function isSouthWestOf(testedCoords){return this.row>=testedCoords.row&&this.col<=testedCoords.col;}},{key:"isNorthEastOf",value:function isNorthEastOf(testedCoords){return this.row<=testedCoords.row&&this.col>=testedCoords.col;}},{key:"toObject",value:function toObject(){return{row:this.row,col:this.col};}}]);return CellCoords;}();var _default=CellCoords;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.log=log;exports.warn=warn;exports.info=info;exports.error=error;var _mixed=__webpack_require__(14);function log(){if((0,_mixed.isDefined)(console)){var _console;(_console=console).log.apply(_console,arguments);}}
function warn(){if((0,_mixed.isDefined)(console)){var _console2;(_console2=console).warn.apply(_console2,arguments);}}
function info(){if((0,_mixed.isDefined)(console)){var _console3;(_console3=console).info.apply(_console3,arguments);}}
function error(){if((0,_mixed.isDefined)(console)){var _console4;(_console4=console).error.apply(_console4,arguments);}}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _autoResize=_interopRequireDefault(__webpack_require__(613));var _browser=__webpack_require__(42);var _baseEditor=_interopRequireWildcard(__webpack_require__(74));var _eventManager=_interopRequireDefault(__webpack_require__(10));var _unicode=__webpack_require__(32);var _event=__webpack_require__(18);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var TextEditor=_baseEditor.default.prototype.extend();TextEditor.prototype.init=function(){var that=this;this.createElements();this.eventManager=new _eventManager.default(this);this.bindEvents();this.autoResize=(0,_autoResize.default)();this.holderZIndex=-1;this.instance.addHook('afterDestroy',function(){that.destroy();});};TextEditor.prototype.prepare=function(row,col,prop,td,originalValue,cellProperties){var _this=this;var previousState=this.state;for(var _len=arguments.length,args=new Array(_len>6?_len-6:0),_key=6;_key<_len;_key++){args[_key-6]=arguments[_key];}
_baseEditor.default.prototype.prepare.apply(this,[row,col,prop,td,originalValue,cellProperties].concat(args));if(!cellProperties.readOnly){this.refreshDimensions(true);var allowInvalid=cellProperties.allowInvalid,fragmentSelection=cellProperties.fragmentSelection;if(allowInvalid){this.TEXTAREA.value='';}
if(previousState!==_baseEditor.EditorState.FINISHED){this.hideEditableElement();}
var restoreFocus=!fragmentSelection;if(restoreFocus&&!(0,_browser.isMobileBrowser)()){this.instance._registerImmediate(function(){return _this.focus();});}}};TextEditor.prototype.hideEditableElement=function(){this.textareaParentStyle.top='-9999px';this.textareaParentStyle.left='-9999px';this.textareaParentStyle.zIndex='-1';this.textareaParentStyle.position='fixed';};TextEditor.prototype.showEditableElement=function(){this.textareaParentStyle.zIndex=this.holderZIndex>=0?this.holderZIndex:'';this.textareaParentStyle.position='';};TextEditor.prototype.getValue=function(){return this.TEXTAREA.value;};TextEditor.prototype.setValue=function(newValue){this.TEXTAREA.value=newValue;};TextEditor.prototype.beginEditing=function(){if(this.state!==_baseEditor.EditorState.VIRGIN){return;}
this.TEXTAREA.value='';for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}
_baseEditor.default.prototype.beginEditing.apply(this,args);};var onBeforeKeyDown=function onBeforeKeyDown(event){var instance=this;var that=instance.getActiveEditor();var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(event.target!==that.TEXTAREA||(0,_event.isImmediatePropagationStopped)(event)){return;}
switch(event.keyCode){case _unicode.KEY_CODES.ARROW_RIGHT:if(that.isInFullEditMode()){if(!that.isWaiting()&&!that.allowKeyEventPropagation||!that.isWaiting()&&that.allowKeyEventPropagation&&!that.allowKeyEventPropagation(event.keyCode)){(0,_event.stopImmediatePropagation)(event);}}
break;case _unicode.KEY_CODES.ARROW_LEFT:if(that.isInFullEditMode()){if(!that.isWaiting()&&!that.allowKeyEventPropagation||!that.isWaiting()&&that.allowKeyEventPropagation&&!that.allowKeyEventPropagation(event.keyCode)){(0,_event.stopImmediatePropagation)(event);}}
break;case _unicode.KEY_CODES.ARROW_UP:case _unicode.KEY_CODES.ARROW_DOWN:if(that.isInFullEditMode()){if(!that.isWaiting()&&!that.allowKeyEventPropagation||!that.isWaiting()&&that.allowKeyEventPropagation&&!that.allowKeyEventPropagation(event.keyCode)){(0,_event.stopImmediatePropagation)(event);}}
break;case _unicode.KEY_CODES.ENTER:{var isMultipleSelection=this.selection.isMultiple();if(ctrlDown&&!isMultipleSelection||event.altKey){if(that.isOpened()){var caretPosition=(0,_element.getCaretPosition)(that.TEXTAREA);var value=that.getValue();var newValue="".concat(value.slice(0,caretPosition),"\n").concat(value.slice(caretPosition));that.setValue(newValue);(0,_element.setCaretPosition)(that.TEXTAREA,caretPosition+1);}else{that.beginEditing("".concat(that.originalValue,"\n"));}
(0,_event.stopImmediatePropagation)(event);}
event.preventDefault();break;}
case _unicode.KEY_CODES.BACKSPACE:case _unicode.KEY_CODES.DELETE:case _unicode.KEY_CODES.HOME:case _unicode.KEY_CODES.END:(0,_event.stopImmediatePropagation)(event);break;default:break;}
if([_unicode.KEY_CODES.ARROW_UP,_unicode.KEY_CODES.ARROW_RIGHT,_unicode.KEY_CODES.ARROW_DOWN,_unicode.KEY_CODES.ARROW_LEFT].indexOf(event.keyCode)===-1){that.autoResize.resize(String.fromCharCode(event.keyCode));}};TextEditor.prototype.open=function(){this.refreshDimensions();this.showEditableElement();this.instance.addHook('beforeKeyDown',onBeforeKeyDown);};TextEditor.prototype.close=function(){this.autoResize.unObserve();if(document.activeElement===this.TEXTAREA){this.instance.listen();}
this.hideEditableElement();this.instance.removeHook('beforeKeyDown',onBeforeKeyDown);};TextEditor.prototype.focus=function(){this.TEXTAREA.select();(0,_element.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length);};TextEditor.prototype.createElements=function(){this.TEXTAREA=document.createElement('TEXTAREA');this.TEXTAREA.tabIndex=-1;(0,_element.addClass)(this.TEXTAREA,'handsontableInput');this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement('DIV');(0,_element.addClass)(this.TEXTAREA_PARENT,'handsontableInputHolder');this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.zIndex='-1';this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);};TextEditor.prototype.getEditedCell=function(){var editorSection=this.checkEditorSection();var editedCell;switch(editorSection){case'top':editedCell=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.holderZIndex=101;break;case'top-left-corner':editedCell=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.holderZIndex=103;break;case'bottom-left-corner':editedCell=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.holderZIndex=103;break;case'left':editedCell=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.holderZIndex=102;break;case'bottom':editedCell=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.holderZIndex=102;break;default:editedCell=this.instance.getCell(this.row,this.col);this.holderZIndex=-1;break;}
return editedCell!==-1&&editedCell!==-2?editedCell:void 0;};TextEditor.prototype.refreshValue=function(){var physicalRow=this.instance.toPhysicalRow(this.row);var sourceData=this.instance.getSourceDataAtCell(physicalRow,this.col);this.originalValue=sourceData;this.setValue(sourceData);this.refreshDimensions();};TextEditor.prototype.refreshDimensions=function(){var force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.state!==_baseEditor.EditorState.EDITING&&!force){return;}
this.TD=this.getEditedCell();if(!this.TD){if(!force){this.close(true);}
return;}
var currentOffset=(0,_element.offset)(this.TD);var containerOffset=(0,_element.offset)(this.instance.rootElement);var scrollableContainerTop=this.instance.view.wt.wtOverlays.topOverlay.mainTableScrollableElement;var scrollableContainerLeft=this.instance.view.wt.wtOverlays.leftOverlay.mainTableScrollableElement;var totalRowsCount=this.instance.countRows();var containerScrollTop=scrollableContainerTop!==window?scrollableContainerTop.scrollTop:0;var containerScrollLeft=scrollableContainerLeft!==window?scrollableContainerLeft.scrollLeft:0;var editorSection=this.checkEditorSection();var scrollTop=['','left'].includes(editorSection)?containerScrollTop:0;var scrollLeft=['','top','bottom'].includes(editorSection)?containerScrollLeft:0;var editTopModifier=currentOffset.top===containerOffset.top?0:1;var settings=this.instance.getSettings();var colHeadersCount=this.instance.hasColHeaders();var backgroundColor=this.TD.style.backgroundColor;var editTop=currentOffset.top-containerOffset.top-editTopModifier-scrollTop;var editLeft=currentOffset.left-containerOffset.left-1-scrollLeft;var cssTransformOffset;switch(editorSection){case'top':cssTransformOffset=(0,_element.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case'left':cssTransformOffset=(0,_element.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case'top-left-corner':cssTransformOffset=(0,_element.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case'bottom-left-corner':cssTransformOffset=(0,_element.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case'bottom':cssTransformOffset=(0,_element.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode);break;default:break;}
if(colHeadersCount&&this.instance.getSelectedLast()[0]===0||settings.fixedRowsBottom&&this.instance.getSelectedLast()[0]===totalRowsCount-settings.fixedRowsBottom){editTop+=1;}
if(this.instance.getSelectedLast()[1]===0){editLeft+=1;}
if(cssTransformOffset&&cssTransformOffset!==-1){this.textareaParentStyle[cssTransformOffset[0]]=cssTransformOffset[1];}else{(0,_element.resetCssTransform)(this.TEXTAREA_PARENT);}
this.textareaParentStyle.top="".concat(editTop,"px");this.textareaParentStyle.left="".concat(editLeft,"px");this.showEditableElement();var firstRowOffset=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition;var firstColumnOffset=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition;var horizontalScrollPosition=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition();var verticalScrollPosition=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition();var scrollbarWidth=(0,_element.getScrollbarWidth)();var cellTopOffset=this.TD.offsetTop+firstRowOffset-verticalScrollPosition;var cellLeftOffset=this.TD.offsetLeft+firstColumnOffset-horizontalScrollPosition;var width=(0,_element.innerWidth)(this.TD)-8;var actualVerticalScrollbarWidth=(0,_element.hasVerticalScrollbar)(scrollableContainerTop)?scrollbarWidth:0;var actualHorizontalScrollbarWidth=(0,_element.hasHorizontalScrollbar)(scrollableContainerLeft)?scrollbarWidth:0;var maxWidth=this.instance.view.maximumVisibleElementWidth(cellLeftOffset)-9-actualVerticalScrollbarWidth;var height=this.TD.scrollHeight+1;var maxHeight=Math.max(this.instance.view.maximumVisibleElementHeight(cellTopOffset)-actualHorizontalScrollbarWidth,23);var cellComputedStyle=(0,_element.getComputedStyle)(this.TD);this.TEXTAREA.style.fontSize=cellComputedStyle.fontSize;this.TEXTAREA.style.fontFamily=cellComputedStyle.fontFamily;this.TEXTAREA.style.backgroundColor=backgroundColor;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(height,maxHeight),maxHeight:maxHeight,minWidth:Math.min(width,maxWidth),maxWidth:maxWidth},true);};TextEditor.prototype.bindEvents=function(){var editor=this;this.eventManager.addEventListener(this.TEXTAREA,'cut',function(event){(0,_event.stopPropagation)(event);});this.eventManager.addEventListener(this.TEXTAREA,'paste',function(event){(0,_event.stopPropagation)(event);});this.instance.addHook('afterScrollHorizontally',function(){editor.refreshDimensions();});this.instance.addHook('afterScrollVertically',function(){editor.refreshDimensions();});this.instance.addHook('afterColumnResize',function(){editor.refreshDimensions();editor.focus();});this.instance.addHook('afterRowResize',function(){editor.refreshDimensions();editor.focus();});this.instance.addHook('afterDestroy',function(){editor.eventManager.destroy();});};TextEditor.prototype.destroy=function(){this.eventManager.destroy();};var _default=TextEditor;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;var _registry=__webpack_require__(433);exports.registerRootComparator=_registry.registerRootComparator;exports.getRootComparator=_registry.getRootComparator;exports.getCompareFunctionFactory=_registry.getCompareFunctionFactory;var _engine=__webpack_require__(679);exports.FIRST_AFTER_SECOND=_engine.FIRST_AFTER_SECOND;exports.FIRST_BEFORE_SECOND=_engine.FIRST_BEFORE_SECOND;exports.DO_NOT_SWAP=_engine.DO_NOT_SWAP;exports.sort=_engine.sort;}),(function(module,exports,__webpack_require__){var toIObject=__webpack_require__(29);var toLength=__webpack_require__(16);var toAbsoluteIndex=__webpack_require__(54);module.exports=function(IS_INCLUDES){return function($this,el,fromIndex){var O=toIObject($this);var length=toLength(O.length);var index=toAbsoluteIndex(fromIndex,length);var value;if(IS_INCLUDES&&el!=el)while(length>index){value=O[index++];if(value!=value)return true;}else for(;length>index;index++)if(IS_INCLUDES||index in O){if(O[index]===el)return IS_INCLUDES||index||0;}return!IS_INCLUDES&&-1;};};}),(function(module,exports){exports.f=Object.getOwnPropertySymbols;}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var defined=__webpack_require__(40);var fails=__webpack_require__(4);var spaces=__webpack_require__(100);var space='['+spaces+']';var non='\u200b\u0085';var ltrim=RegExp('^'+space+space+'*');var rtrim=RegExp(space+space+'*$');var exporter=function(KEY,exec,ALIAS){var exp={};var FORCE=fails(function(){return!!spaces[KEY]()||non[KEY]()!=non;});var fn=exp[KEY]=FORCE?exec(trim):spaces[KEY];if(ALIAS)exp[ALIAS]=fn;$export($export.P+$export.F*FORCE,'String',exp);};var trim=exporter.trim=function(string,TYPE){string=String(defined(string));if(TYPE&1)string=string.replace(ltrim,'');if(TYPE&2)string=string.replace(rtrim,'');return string;};module.exports=exporter;}),(function(module,exports,__webpack_require__){var ITERATOR=__webpack_require__(12)('iterator');var SAFE_CLOSING=false;try{var riter=[7][ITERATOR]();riter['return']=function(){SAFE_CLOSING=true;};Array.from(riter,function(){throw 2;});}catch(e){}
module.exports=function(exec,skipClosing){if(!skipClosing&&!SAFE_CLOSING)return false;var safe=false;try{var arr=[7];var iter=arr[ITERATOR]();iter.next=function(){return{done:safe=true};};arr[ITERATOR]=function(){return iter;};exec(arr);}catch(e){}
return safe;};}),(function(module,exports,__webpack_require__){"use strict";var anObject=__webpack_require__(5);module.exports=function(){var that=anObject(this);var result='';if(that.global)result+='g';if(that.ignoreCase)result+='i';if(that.multiline)result+='m';if(that.unicode)result+='u';if(that.sticky)result+='y';return result;};}),(function(module,exports,__webpack_require__){"use strict";var classof=__webpack_require__(72);var builtinExec=RegExp.prototype.exec;module.exports=function(R,S){var exec=R.exec;if(typeof exec==='function'){var result=exec.call(R,S);if(typeof result!=='object'){throw new TypeError('RegExp exec method returned something other than an Object or null');}
return result;}
if(classof(R)!=='RegExp'){throw new TypeError('RegExp#exec called on incompatible receiver');}
return builtinExec.call(R,S);};}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(149);var redefine=__webpack_require__(23);var hide=__webpack_require__(28);var fails=__webpack_require__(4);var defined=__webpack_require__(40);var wks=__webpack_require__(12);var regexpExec=__webpack_require__(115);var SPECIES=wks('species');var REPLACE_SUPPORTS_NAMED_GROUPS=!fails(function(){var re=/./;re.exec=function(){var result=[];result.groups={a:'7'};return result;};return''.replace(re,'$<a>')!=='7';});var SPLIT_WORKS_WITH_OVERWRITTEN_EXEC=(function(){var re=/(?:)/;var originalExec=re.exec;re.exec=function(){return originalExec.apply(this,arguments);};var result='ab'.split(re);return result.length===2&&result[0]==='a'&&result[1]==='b';})();module.exports=function(KEY,length,exec){var SYMBOL=wks(KEY);var DELEGATES_TO_SYMBOL=!fails(function(){var O={};O[SYMBOL]=function(){return 7;};return''[KEY](O)!=7;});var DELEGATES_TO_EXEC=DELEGATES_TO_SYMBOL?!fails(function(){var execCalled=false;var re=/a/;re.exec=function(){execCalled=true;return null;};if(KEY==='split'){re.constructor={};re.constructor[SPECIES]=function(){return re;};}
re[SYMBOL]('');return!execCalled;}):undefined;if(!DELEGATES_TO_SYMBOL||!DELEGATES_TO_EXEC||(KEY==='replace'&&!REPLACE_SUPPORTS_NAMED_GROUPS)||(KEY==='split'&&!SPLIT_WORKS_WITH_OVERWRITTEN_EXEC)){var nativeRegExpMethod=/./[SYMBOL];var fns=exec(defined,SYMBOL,''[KEY],function maybeCallNative(nativeMethod,regexp,str,arg2,forceStringMethod){if(regexp.exec===regexpExec){if(DELEGATES_TO_SYMBOL&&!forceStringMethod){return{done:true,value:nativeRegExpMethod.call(regexp,str,arg2)};}
return{done:true,value:nativeMethod.call(str,regexp,arg2)};}
return{done:false};});var strfn=fns[0];var rxfn=fns[1];redefine(String.prototype,KEY,strfn);hide(RegExp.prototype,SYMBOL,length==2?function(string,arg){return rxfn.call(string,this,arg);}:function(string){return rxfn.call(string,this);});}};}),(function(module,exports,__webpack_require__){var ctx=__webpack_require__(37);var call=__webpack_require__(145);var isArrayIter=__webpack_require__(110);var anObject=__webpack_require__(5);var toLength=__webpack_require__(16);var getIterFn=__webpack_require__(112);var BREAK={};var RETURN={};var exports=module.exports=function(iterable,entries,fn,that,ITERATOR){var iterFn=ITERATOR?function(){return iterable;}:getIterFn(iterable);var f=ctx(fn,that,entries?2:1);var index=0;var length,step,iterator,result;if(typeof iterFn!='function')throw TypeError(iterable+' is not iterable!');if(isArrayIter(iterFn))for(length=toLength(iterable.length);length>index;index++){result=entries?f(anObject(step=iterable[index])[0],step[1]):f(iterable[index]);if(result===BREAK||result===RETURN)return result;}else for(iterator=iterFn.call(iterable);!(step=iterator.next()).done;){result=call(iterator,f,step.value,entries);if(result===BREAK||result===RETURN)return result;}};exports.BREAK=BREAK;exports.RETURN=RETURN;}),(function(module,exports,__webpack_require__){var global=__webpack_require__(6);var navigator=global.navigator;module.exports=navigator&&navigator.userAgent||'';}),(function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(6);var $export=__webpack_require__(0);var redefine=__webpack_require__(23);var redefineAll=__webpack_require__(65);var meta=__webpack_require__(45);var forOf=__webpack_require__(86);var anInstance=__webpack_require__(64);var isObject=__webpack_require__(7);var fails=__webpack_require__(4);var $iterDetect=__webpack_require__(82);var setToStringTag=__webpack_require__(60);var inheritIfRequired=__webpack_require__(101);module.exports=function(NAME,wrapper,methods,common,IS_MAP,IS_WEAK){var Base=global[NAME];var C=Base;var ADDER=IS_MAP?'set':'add';var proto=C&&C.prototype;var O={};var fixMethod=function(KEY){var fn=proto[KEY];redefine(proto,KEY,KEY=='delete'?function(a){return IS_WEAK&&!isObject(a)?false:fn.call(this,a===0?0:a);}:KEY=='has'?function has(a){return IS_WEAK&&!isObject(a)?false:fn.call(this,a===0?0:a);}:KEY=='get'?function get(a){return IS_WEAK&&!isObject(a)?undefined:fn.call(this,a===0?0:a);}:KEY=='add'?function add(a){fn.call(this,a===0?0:a);return this;}:function set(a,b){fn.call(this,a===0?0:a,b);return this;});};if(typeof C!='function'||!(IS_WEAK||proto.forEach&&!fails(function(){new C().entries().next();}))){C=common.getConstructor(wrapper,NAME,IS_MAP,ADDER);redefineAll(C.prototype,methods);meta.NEED=true;}else{var instance=new C();var HASNT_CHAINING=instance[ADDER](IS_WEAK?{}:-0,1)!=instance;var THROWS_ON_PRIMITIVES=fails(function(){instance.has(1);});var ACCEPT_ITERABLES=$iterDetect(function(iter){new C(iter);});var BUGGY_ZERO=!IS_WEAK&&fails(function(){var $instance=new C();var index=5;while(index--)$instance[ADDER](index,index);return!$instance.has(-0);});if(!ACCEPT_ITERABLES){C=wrapper(function(target,iterable){anInstance(target,C,NAME);var that=inheritIfRequired(new Base(),target,C);if(iterable!=undefined)forOf(iterable,IS_MAP,that[ADDER],that);return that;});C.prototype=proto;proto.constructor=C;}
if(THROWS_ON_PRIMITIVES||BUGGY_ZERO){fixMethod('delete');fixMethod('has');IS_MAP&&fixMethod('get');}
if(BUGGY_ZERO||HASNT_CHAINING)fixMethod(ADDER);if(IS_WEAK&&proto.clear)delete proto.clear;}
setToStringTag(C,NAME);O[NAME]=C;$export($export.G+$export.W+$export.F*(C!=Base),O);if(!IS_WEAK)common.setStrong(C,NAME,IS_MAP);return C;};}),(function(module,exports,__webpack_require__){var global=__webpack_require__(6);var hide=__webpack_require__(28);var uid=__webpack_require__(51);var TYPED=uid('typed_array');var VIEW=uid('view');var ABV=!!(global.ArrayBuffer&&global.DataView);var CONSTR=ABV;var i=0;var l=9;var Typed;var TypedArrayConstructors=('Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array').split(',');while(i<l){if(Typed=global[TypedArrayConstructors[i++]]){hide(Typed.prototype,TYPED,true);hide(Typed.prototype,VIEW,true);}else CONSTR=false;}
module.exports={ABV:ABV,CONSTR:CONSTR,TYPED:TYPED,VIEW:VIEW};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.registerLanguageDictionary=registerLanguage;exports.getLanguageDictionary=getLanguage;exports.hasLanguageDictionary=hasLanguage;exports.getDefaultLanguageDictionary=getDefaultLanguage;exports.getLanguagesDictionaries=getLanguages;exports.DEFAULT_LANGUAGE_CODE=void 0;var _object=__webpack_require__(2);var _utils=__webpack_require__(428);var _staticRegister2=_interopRequireDefault(__webpack_require__(46));var _enUS=_interopRequireDefault(__webpack_require__(650));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var DEFAULT_LANGUAGE_CODE=_enUS.default.languageCode;exports.DEFAULT_LANGUAGE_CODE=DEFAULT_LANGUAGE_CODE;var _staticRegister=(0,_staticRegister2.default)('languagesDictionaries'),registerGloballyLanguageDictionary=_staticRegister.register,getGlobalLanguageDictionary=_staticRegister.getItem,hasGlobalLanguageDictionary=_staticRegister.hasItem,getGlobalLanguagesDictionaries=_staticRegister.getValues;function registerLanguage(languageCodeOrDictionary,dictionary){var languageCode=languageCodeOrDictionary;var dictionaryObject=dictionary;if((0,_object.isObject)(languageCodeOrDictionary)){dictionaryObject=languageCodeOrDictionary;languageCode=dictionaryObject.languageCode;}
extendLanguageDictionary(languageCode,dictionaryObject);registerGloballyLanguageDictionary(languageCode,(0,_object.deepClone)(dictionaryObject));return(0,_object.deepClone)(dictionaryObject);}
function getLanguage(languageCode){if(!hasLanguage(languageCode)){return null;}
return(0,_object.deepClone)(getGlobalLanguageDictionary(languageCode));}
function hasLanguage(languageCode){return hasGlobalLanguageDictionary(languageCode);}
function getDefaultLanguage(){return _enUS.default;}
function extendLanguageDictionary(languageCode,dictionary){if(languageCode!==DEFAULT_LANGUAGE_CODE){(0,_utils.extendNotExistingKeys)(dictionary,getGlobalLanguageDictionary(DEFAULT_LANGUAGE_CODE));}}
function getLanguages(){return getGlobalLanguagesDictionaries();}
registerLanguage(_enUS.default);}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.detectSelectionType=detectSelectionType;exports.normalizeSelectionFactory=normalizeSelectionFactory;exports.transformSelectionToColumnDistance=transformSelectionToColumnDistance;exports.transformSelectionToRowDistance=transformSelectionToRowDistance;exports.isValidCoord=isValidCoord;exports.SELECTION_TYPES=exports.SELECTION_TYPE_OBJECT=exports.SELECTION_TYPE_ARRAY=exports.SELECTION_TYPE_EMPTY=exports.SELECTION_TYPE_UNRECOGNIZED=void 0;var _src=__webpack_require__(8);var _array=__webpack_require__(3);var _mixed=__webpack_require__(14);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
var SELECTION_TYPE_UNRECOGNIZED=0;exports.SELECTION_TYPE_UNRECOGNIZED=SELECTION_TYPE_UNRECOGNIZED;var SELECTION_TYPE_EMPTY=1;exports.SELECTION_TYPE_EMPTY=SELECTION_TYPE_EMPTY;var SELECTION_TYPE_ARRAY=2;exports.SELECTION_TYPE_ARRAY=SELECTION_TYPE_ARRAY;var SELECTION_TYPE_OBJECT=3;exports.SELECTION_TYPE_OBJECT=SELECTION_TYPE_OBJECT;var SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY];exports.SELECTION_TYPES=SELECTION_TYPES;var ARRAY_TYPE_PATTERN=[['number'],['number','string'],['number','undefined'],['number','string','undefined']];var rootCall=Symbol('root');var childCall=Symbol('child');function detectSelectionType(selectionRanges){var _callSymbol=arguments.length>1&&arguments[1]!==undefined?arguments[1]:rootCall;if(_callSymbol!==rootCall&&_callSymbol!==childCall){throw new Error('The second argument is used internally only and cannot be overwritten.');}
var isArray=Array.isArray(selectionRanges);var isRootCall=_callSymbol===rootCall;var result=SELECTION_TYPE_UNRECOGNIZED;if(isArray){var firstItem=selectionRanges[0];if(selectionRanges.length===0){result=SELECTION_TYPE_EMPTY;}else if(isRootCall&&firstItem instanceof _src.CellRange){result=SELECTION_TYPE_OBJECT;}else if(isRootCall&&Array.isArray(firstItem)){result=detectSelectionType(firstItem,childCall);}else if(selectionRanges.length>=2&&selectionRanges.length<=4){var isArrayType=!selectionRanges.some(function(value,index){return!ARRAY_TYPE_PATTERN[index].includes(_typeof(value));});if(isArrayType){result=SELECTION_TYPE_ARRAY;}}}
return result;}
function normalizeSelectionFactory(type){var _ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref$keepDirection=_ref.keepDirection,keepDirection=_ref$keepDirection===void 0?false:_ref$keepDirection,propToCol=_ref.propToCol;if(!SELECTION_TYPES.includes(type)){throw new Error('Unsupported selection ranges schema type was provided.');}
return function(selection){var isObjectType=type===SELECTION_TYPE_OBJECT;var rowStart=isObjectType?selection.from.row:selection[0];var columnStart=isObjectType?selection.from.col:selection[1];var rowEnd=isObjectType?selection.to.row:selection[2];var columnEnd=isObjectType?selection.to.col:selection[3];if(typeof propToCol==='function'){if(typeof columnStart==='string'){columnStart=propToCol(columnStart);}
if(typeof columnEnd==='string'){columnEnd=propToCol(columnEnd);}}
if((0,_mixed.isUndefined)(rowEnd)){rowEnd=rowStart;}
if((0,_mixed.isUndefined)(columnEnd)){columnEnd=columnStart;}
if(!keepDirection){var origRowStart=rowStart;var origColumnStart=columnStart;var origRowEnd=rowEnd;var origColumnEnd=columnEnd;rowStart=Math.min(origRowStart,origRowEnd);columnStart=Math.min(origColumnStart,origColumnEnd);rowEnd=Math.max(origRowStart,origRowEnd);columnEnd=Math.max(origColumnStart,origColumnEnd);}
return[rowStart,columnStart,rowEnd,columnEnd];};}
function transformSelectionToColumnDistance(selectionRanges){var selectionType=detectSelectionType(selectionRanges);if(selectionType===SELECTION_TYPE_UNRECOGNIZED||selectionType===SELECTION_TYPE_EMPTY){return[];}
var selectionSchemaNormalizer=normalizeSelectionFactory(selectionType);var unorderedIndexes=new Set();(0,_array.arrayEach)(selectionRanges,function(selection){var _selectionSchemaNorma=selectionSchemaNormalizer(selection),_selectionSchemaNorma2=_slicedToArray(_selectionSchemaNorma,4),columnStart=_selectionSchemaNorma2[1],columnEnd=_selectionSchemaNorma2[3];var amount=columnEnd-columnStart+1;(0,_array.arrayEach)(Array.from(new Array(amount),function(_,i){return columnStart+i;}),function(index){if(!unorderedIndexes.has(index)){unorderedIndexes.add(index);}});});var orderedIndexes=Array.from(unorderedIndexes).sort(function(a,b){return a-b;});var normalizedColumnRanges=(0,_array.arrayReduce)(orderedIndexes,function(acc,visualColumnIndex,index,array){if(index!==0&&visualColumnIndex===array[index-1]+1){acc[acc.length-1][1]+=1;}else{acc.push([visualColumnIndex,1]);}
return acc;},[]);return normalizedColumnRanges;}
function transformSelectionToRowDistance(selectionRanges){var selectionType=detectSelectionType(selectionRanges);if(selectionType===SELECTION_TYPE_UNRECOGNIZED||selectionType===SELECTION_TYPE_EMPTY){return[];}
var selectionSchemaNormalizer=normalizeSelectionFactory(selectionType);var unorderedIndexes=new Set();(0,_array.arrayEach)(selectionRanges,function(selection){var _selectionSchemaNorma3=selectionSchemaNormalizer(selection),_selectionSchemaNorma4=_slicedToArray(_selectionSchemaNorma3,3),rowStart=_selectionSchemaNorma4[0],rowEnd=_selectionSchemaNorma4[2];var amount=rowEnd-rowStart+1;(0,_array.arrayEach)(Array.from(new Array(amount),function(_,i){return rowStart+i;}),function(index){if(!unorderedIndexes.has(index)){unorderedIndexes.add(index);}});});var orderedIndexes=Array.from(unorderedIndexes).sort(function(a,b){return a-b;});var normalizedRowRanges=(0,_array.arrayReduce)(orderedIndexes,function(acc,rowIndex,index,array){if(index!==0&&rowIndex===array[index-1]+1){acc[acc.length-1][1]+=1;}else{acc.push([rowIndex,1]);}
return acc;},[]);return normalizedRowRanges;}
function isValidCoord(coord){var maxTableItemsCount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Infinity;return typeof coord==='number'&&coord>=0&&coord<maxTableItemsCount;}}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);var document=__webpack_require__(6).document;var is=isObject(document)&&isObject(document.createElement);module.exports=function(it){return is?document.createElement(it):{};};}),(function(module,exports,__webpack_require__){var core=__webpack_require__(21);var global=__webpack_require__(6);var SHARED='__core-js_shared__';var store=global[SHARED]||(global[SHARED]={});(module.exports=function(key,value){return store[key]||(store[key]=value!==undefined?value:{});})('versions',[]).push({version:core.version,mode:__webpack_require__(52)?'pure':'global',copyright:'© 2018 Denis Pushkarev (zloirock.ru)'});}),(function(module,exports,__webpack_require__){exports.f=__webpack_require__(12);}),(function(module,exports,__webpack_require__){var shared=__webpack_require__(93)('keys');var uid=__webpack_require__(51);module.exports=function(key){return shared[key]||(shared[key]=uid(key));};}),(function(module,exports){module.exports=('constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf').split(',');}),(function(module,exports,__webpack_require__){var cof=__webpack_require__(39);module.exports=Array.isArray||function isArray(arg){return cof(arg)=='Array';};}),(function(module,exports,__webpack_require__){var document=__webpack_require__(6).document;module.exports=document&&document.documentElement;}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);var anObject=__webpack_require__(5);var check=function(O,proto){anObject(O);if(!isObject(proto)&&proto!==null)throw TypeError(proto+": can't set as prototype!");};module.exports={set:Object.setPrototypeOf||('__proto__'in{}?function(test,buggy,set){try{set=__webpack_require__(37)(Function.call,__webpack_require__(34).f(Object.prototype,'__proto__').set,2);set(test,[]);buggy=!(test instanceof Array);}catch(e){buggy=true;}
return function setPrototypeOf(O,proto){check(O,proto);if(buggy)O.__proto__=proto;else set(O,proto);return O;};}({},false):undefined),check:check};}),(function(module,exports){module.exports='\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003'+'\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF';}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);var setPrototypeOf=__webpack_require__(99).set;module.exports=function(that,target,C){var S=target.constructor;var P;if(S!==C&&typeof S=='function'&&(P=S.prototype)!==C.prototype&&isObject(P)&&setPrototypeOf){setPrototypeOf(that,P);}return that;};}),(function(module,exports,__webpack_require__){"use strict";var toInteger=__webpack_require__(33);var defined=__webpack_require__(40);module.exports=function repeat(count){var str=String(defined(this));var res='';var n=toInteger(count);if(n<0||n==Infinity)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(str+=str))if(n&1)res+=str;return res;};}),(function(module,exports){module.exports=Math.sign||function sign(x){return(x=+x)==0||x!=x?x:x<0?-1:1;};}),(function(module,exports){var $expm1=Math.expm1;module.exports=(!$expm1||$expm1(10)>22025.465794806719||$expm1(10)<22025.4657948067165168||$expm1(-2e-17)!=-2e-17)?function expm1(x){return(x=+x)==0?x:x>-1e-6&&x<1e-6?x+x*x/2:Math.exp(x)-1;}:$expm1;}),(function(module,exports,__webpack_require__){var toInteger=__webpack_require__(33);var defined=__webpack_require__(40);module.exports=function(TO_STRING){return function(that,pos){var s=String(defined(that));var i=toInteger(pos);var l=s.length;var a,b;if(i<0||i>=l)return TO_STRING?'':undefined;a=s.charCodeAt(i);return a<0xd800||a>0xdbff||i+1===l||(b=s.charCodeAt(i+1))<0xdc00||b>0xdfff?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):(a-0xd800<<10)+(b-0xdc00)+0x10000;};};}),(function(module,exports,__webpack_require__){"use strict";var LIBRARY=__webpack_require__(52);var $export=__webpack_require__(0);var redefine=__webpack_require__(23);var hide=__webpack_require__(28);var Iterators=__webpack_require__(61);var $iterCreate=__webpack_require__(144);var setToStringTag=__webpack_require__(60);var getPrototypeOf=__webpack_require__(57);var ITERATOR=__webpack_require__(12)('iterator');var BUGGY=!([].keys&&'next'in[].keys());var FF_ITERATOR='@@iterator';var KEYS='keys';var VALUES='values';var returnThis=function(){return this;};module.exports=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){$iterCreate(Constructor,NAME,next);var getMethod=function(kind){if(!BUGGY&&kind in proto)return proto[kind];switch(kind){case KEYS:return function keys(){return new Constructor(this,kind);};case VALUES:return function values(){return new Constructor(this,kind);};}return function entries(){return new Constructor(this,kind);};};var TAG=NAME+' Iterator';var DEF_VALUES=DEFAULT==VALUES;var VALUES_BUG=false;var proto=Base.prototype;var $native=proto[ITERATOR]||proto[FF_ITERATOR]||DEFAULT&&proto[DEFAULT];var $default=$native||getMethod(DEFAULT);var $entries=DEFAULT?!DEF_VALUES?$default:getMethod('entries'):undefined;var $anyNative=NAME=='Array'?proto.entries||$native:$native;var methods,key,IteratorPrototype;if($anyNative){IteratorPrototype=getPrototypeOf($anyNative.call(new Base()));if(IteratorPrototype!==Object.prototype&&IteratorPrototype.next){setToStringTag(IteratorPrototype,TAG,true);if(!LIBRARY&&typeof IteratorPrototype[ITERATOR]!='function')hide(IteratorPrototype,ITERATOR,returnThis);}}
if(DEF_VALUES&&$native&&$native.name!==VALUES){VALUES_BUG=true;$default=function values(){return $native.call(this);};}
if((!LIBRARY||FORCED)&&(BUGGY||VALUES_BUG||!proto[ITERATOR])){hide(proto,ITERATOR,$default);}
Iterators[NAME]=$default;Iterators[TAG]=returnThis;if(DEFAULT){methods={values:DEF_VALUES?$default:getMethod(VALUES),keys:IS_SET?$default:getMethod(KEYS),entries:$entries};if(FORCED)for(key in methods){if(!(key in proto))redefine(proto,key,methods[key]);}else $export($export.P+$export.F*(BUGGY||VALUES_BUG),NAME,methods);}
return methods;};}),(function(module,exports,__webpack_require__){var isRegExp=__webpack_require__(108);var defined=__webpack_require__(40);module.exports=function(that,searchString,NAME){if(isRegExp(searchString))throw TypeError('String#'+NAME+" doesn't accept regex!");return String(defined(that));};}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);var cof=__webpack_require__(39);var MATCH=__webpack_require__(12)('match');module.exports=function(it){var isRegExp;return isObject(it)&&((isRegExp=it[MATCH])!==undefined?!!isRegExp:cof(it)=='RegExp');};}),(function(module,exports,__webpack_require__){var MATCH=__webpack_require__(12)('match');module.exports=function(KEY){var re=/./;try{'/./'[KEY](re);}catch(e){try{re[MATCH]=false;return!'/./'[KEY](re);}catch(f){}}return true;};}),(function(module,exports,__webpack_require__){var Iterators=__webpack_require__(61);var ITERATOR=__webpack_require__(12)('iterator');var ArrayProto=Array.prototype;module.exports=function(it){return it!==undefined&&(Iterators.Array===it||ArrayProto[ITERATOR]===it);};}),(function(module,exports,__webpack_require__){"use strict";var $defineProperty=__webpack_require__(17);var createDesc=__webpack_require__(50);module.exports=function(object,index,value){if(index in object)$defineProperty.f(object,index,createDesc(0,value));else object[index]=value;};}),(function(module,exports,__webpack_require__){var classof=__webpack_require__(72);var ITERATOR=__webpack_require__(12)('iterator');var Iterators=__webpack_require__(61);module.exports=__webpack_require__(21).getIteratorMethod=function(it){if(it!=undefined)return it[ITERATOR]||it['@@iterator']||Iterators[classof(it)];};}),(function(module,exports,__webpack_require__){"use strict";var toObject=__webpack_require__(24);var toAbsoluteIndex=__webpack_require__(54);var toLength=__webpack_require__(16);module.exports=function fill(value){var O=toObject(this);var length=toLength(O.length);var aLen=arguments.length;var index=toAbsoluteIndex(aLen>1?arguments[1]:undefined,length);var end=aLen>2?arguments[2]:undefined;var endPos=end===undefined?length:toAbsoluteIndex(end,length);while(endPos>index)O[index++]=value;return O;};}),(function(module,exports,__webpack_require__){"use strict";var addToUnscopables=__webpack_require__(62);var step=__webpack_require__(148);var Iterators=__webpack_require__(61);var toIObject=__webpack_require__(29);module.exports=__webpack_require__(106)(Array,'Array',function(iterated,kind){this._t=toIObject(iterated);this._i=0;this._k=kind;},function(){var O=this._t;var kind=this._k;var index=this._i++;if(!O||index>=O.length){this._t=undefined;return step(1);}
if(kind=='keys')return step(0,index);if(kind=='values')return step(0,O[index]);return step(0,[index,O[index]]);},'values');Iterators.Arguments=Iterators.Array;addToUnscopables('keys');addToUnscopables('values');addToUnscopables('entries');}),(function(module,exports,__webpack_require__){"use strict";var regexpFlags=__webpack_require__(83);var nativeExec=RegExp.prototype.exec;var nativeReplace=String.prototype.replace;var patchedExec=nativeExec;var LAST_INDEX='lastIndex';var UPDATES_LAST_INDEX_WRONG=(function(){var re1=/a/,re2=/b*/g;nativeExec.call(re1,'a');nativeExec.call(re2,'a');return re1[LAST_INDEX]!==0||re2[LAST_INDEX]!==0;})();var NPCG_INCLUDED=/()??/.exec('')[1]!==undefined;var PATCH=UPDATES_LAST_INDEX_WRONG||NPCG_INCLUDED;if(PATCH){patchedExec=function exec(str){var re=this;var lastIndex,reCopy,match,i;if(NPCG_INCLUDED){reCopy=new RegExp('^'+re.source+'$(?!\\s)',regexpFlags.call(re));}
if(UPDATES_LAST_INDEX_WRONG)lastIndex=re[LAST_INDEX];match=nativeExec.call(re,str);if(UPDATES_LAST_INDEX_WRONG&&match){re[LAST_INDEX]=re.global?match.index+match[0].length:lastIndex;}
if(NPCG_INCLUDED&&match&&match.length>1){nativeReplace.call(match[0],reCopy,function(){for(i=1;i<arguments.length-2;i++){if(arguments[i]===undefined)match[i]=undefined;}});}
return match;};}
module.exports=patchedExec;}),(function(module,exports,__webpack_require__){"use strict";var at=__webpack_require__(105)(true);module.exports=function(S,index,unicode){return index+(unicode?at(S,index).length:1);};}),(function(module,exports,__webpack_require__){var ctx=__webpack_require__(37);var invoke=__webpack_require__(138);var html=__webpack_require__(98);var cel=__webpack_require__(92);var global=__webpack_require__(6);var process=global.process;var setTask=global.setImmediate;var clearTask=global.clearImmediate;var MessageChannel=global.MessageChannel;var Dispatch=global.Dispatch;var counter=0;var queue={};var ONREADYSTATECHANGE='onreadystatechange';var defer,channel,port;var run=function(){var id=+this;if(queue.hasOwnProperty(id)){var fn=queue[id];delete queue[id];fn();}};var listener=function(event){run.call(event.data);};if(!setTask||!clearTask){setTask=function setImmediate(fn){var args=[];var i=1;while(arguments.length>i)args.push(arguments[i++]);queue[++counter]=function(){invoke(typeof fn=='function'?fn:Function(fn),args);};defer(counter);return counter;};clearTask=function clearImmediate(id){delete queue[id];};if(__webpack_require__(39)(process)=='process'){defer=function(id){process.nextTick(ctx(run,id,1));};}else if(Dispatch&&Dispatch.now){defer=function(id){Dispatch.now(ctx(run,id,1));};}else if(MessageChannel){channel=new MessageChannel();port=channel.port2;channel.port1.onmessage=listener;defer=ctx(port.postMessage,port,1);}else if(global.addEventListener&&typeof postMessage=='function'&&!global.importScripts){defer=function(id){global.postMessage(id+'','*');};global.addEventListener('message',listener,false);}else if(ONREADYSTATECHANGE in cel('script')){defer=function(id){html.appendChild(cel('script'))[ONREADYSTATECHANGE]=function(){html.removeChild(this);run.call(id);};};}else{defer=function(id){setTimeout(ctx(run,id,1),0);};}}
module.exports={set:setTask,clear:clearTask};}),(function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(6);var DESCRIPTORS=__webpack_require__(20);var LIBRARY=__webpack_require__(52);var $typed=__webpack_require__(89);var hide=__webpack_require__(28);var redefineAll=__webpack_require__(65);var fails=__webpack_require__(4);var anInstance=__webpack_require__(64);var toInteger=__webpack_require__(33);var toLength=__webpack_require__(16);var toIndex=__webpack_require__(156);var gOPN=__webpack_require__(56).f;var dP=__webpack_require__(17).f;var arrayFill=__webpack_require__(113);var setToStringTag=__webpack_require__(60);var ARRAY_BUFFER='ArrayBuffer';var DATA_VIEW='DataView';var PROTOTYPE='prototype';var WRONG_LENGTH='Wrong length!';var WRONG_INDEX='Wrong index!';var $ArrayBuffer=global[ARRAY_BUFFER];var $DataView=global[DATA_VIEW];var Math=global.Math;var RangeError=global.RangeError;var Infinity=global.Infinity;var BaseBuffer=$ArrayBuffer;var abs=Math.abs;var pow=Math.pow;var floor=Math.floor;var log=Math.log;var LN2=Math.LN2;var BUFFER='buffer';var BYTE_LENGTH='byteLength';var BYTE_OFFSET='byteOffset';var $BUFFER=DESCRIPTORS?'_b':BUFFER;var $LENGTH=DESCRIPTORS?'_l':BYTE_LENGTH;var $OFFSET=DESCRIPTORS?'_o':BYTE_OFFSET;function packIEEE754(value,mLen,nBytes){var buffer=new Array(nBytes);var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?pow(2,-24)-pow(2,-77):0;var i=0;var s=value<0||value===0&&1/value<0?1:0;var e,m,c;value=abs(value);if(value!=value||value===Infinity){m=value!=value?1:0;e=eMax;}else{e=floor(log(value)/LN2);if(value*(c=pow(2,-e))<1){e--;c*=2;}
if(e+eBias>=1){value+=rt/c;}else{value+=rt*pow(2,1-eBias);}
if(value*c>=2){e++;c/=2;}
if(e+eBias>=eMax){m=0;e=eMax;}else if(e+eBias>=1){m=(value*c-1)*pow(2,mLen);e=e+eBias;}else{m=value*pow(2,eBias-1)*pow(2,mLen);e=0;}}
for(;mLen>=8;buffer[i++]=m&255,m/=256,mLen-=8);e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[i++]=e&255,e/=256,eLen-=8);buffer[--i]|=s*128;return buffer;}
function unpackIEEE754(buffer,mLen,nBytes){var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=eLen-7;var i=nBytes-1;var s=buffer[i--];var e=s&127;var m;s>>=7;for(;nBits>0;e=e*256+buffer[i],i--,nBits-=8);m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[i],i--,nBits-=8);if(e===0){e=1-eBias;}else if(e===eMax){return m?NaN:s?-Infinity:Infinity;}else{m=m+pow(2,mLen);e=e-eBias;}return(s?-1:1)*m*pow(2,e-mLen);}
function unpackI32(bytes){return bytes[3]<<24|bytes[2]<<16|bytes[1]<<8|bytes[0];}
function packI8(it){return[it&0xff];}
function packI16(it){return[it&0xff,it>>8&0xff];}
function packI32(it){return[it&0xff,it>>8&0xff,it>>16&0xff,it>>24&0xff];}
function packF64(it){return packIEEE754(it,52,8);}
function packF32(it){return packIEEE754(it,23,4);}
function addGetter(C,key,internal){dP(C[PROTOTYPE],key,{get:function(){return this[internal];}});}
function get(view,bytes,index,isLittleEndian){var numIndex=+index;var intIndex=toIndex(numIndex);if(intIndex+bytes>view[$LENGTH])throw RangeError(WRONG_INDEX);var store=view[$BUFFER]._b;var start=intIndex+view[$OFFSET];var pack=store.slice(start,start+bytes);return isLittleEndian?pack:pack.reverse();}
function set(view,bytes,index,conversion,value,isLittleEndian){var numIndex=+index;var intIndex=toIndex(numIndex);if(intIndex+bytes>view[$LENGTH])throw RangeError(WRONG_INDEX);var store=view[$BUFFER]._b;var start=intIndex+view[$OFFSET];var pack=conversion(+value);for(var i=0;i<bytes;i++)store[start+i]=pack[isLittleEndian?i:bytes-i-1];}
if(!$typed.ABV){$ArrayBuffer=function ArrayBuffer(length){anInstance(this,$ArrayBuffer,ARRAY_BUFFER);var byteLength=toIndex(length);this._b=arrayFill.call(new Array(byteLength),0);this[$LENGTH]=byteLength;};$DataView=function DataView(buffer,byteOffset,byteLength){anInstance(this,$DataView,DATA_VIEW);anInstance(buffer,$ArrayBuffer,DATA_VIEW);var bufferLength=buffer[$LENGTH];var offset=toInteger(byteOffset);if(offset<0||offset>bufferLength)throw RangeError('Wrong offset!');byteLength=byteLength===undefined?bufferLength-offset:toLength(byteLength);if(offset+byteLength>bufferLength)throw RangeError(WRONG_LENGTH);this[$BUFFER]=buffer;this[$OFFSET]=offset;this[$LENGTH]=byteLength;};if(DESCRIPTORS){addGetter($ArrayBuffer,BYTE_LENGTH,'_l');addGetter($DataView,BUFFER,'_b');addGetter($DataView,BYTE_LENGTH,'_l');addGetter($DataView,BYTE_OFFSET,'_o');}
redefineAll($DataView[PROTOTYPE],{getInt8:function getInt8(byteOffset){return get(this,1,byteOffset)[0]<<24>>24;},getUint8:function getUint8(byteOffset){return get(this,1,byteOffset)[0];},getInt16:function getInt16(byteOffset){var bytes=get(this,2,byteOffset,arguments[1]);return(bytes[1]<<8|bytes[0])<<16>>16;},getUint16:function getUint16(byteOffset){var bytes=get(this,2,byteOffset,arguments[1]);return bytes[1]<<8|bytes[0];},getInt32:function getInt32(byteOffset){return unpackI32(get(this,4,byteOffset,arguments[1]));},getUint32:function getUint32(byteOffset){return unpackI32(get(this,4,byteOffset,arguments[1]))>>>0;},getFloat32:function getFloat32(byteOffset){return unpackIEEE754(get(this,4,byteOffset,arguments[1]),23,4);},getFloat64:function getFloat64(byteOffset){return unpackIEEE754(get(this,8,byteOffset,arguments[1]),52,8);},setInt8:function setInt8(byteOffset,value){set(this,1,byteOffset,packI8,value);},setUint8:function setUint8(byteOffset,value){set(this,1,byteOffset,packI8,value);},setInt16:function setInt16(byteOffset,value){set(this,2,byteOffset,packI16,value,arguments[2]);},setUint16:function setUint16(byteOffset,value){set(this,2,byteOffset,packI16,value,arguments[2]);},setInt32:function setInt32(byteOffset,value){set(this,4,byteOffset,packI32,value,arguments[2]);},setUint32:function setUint32(byteOffset,value){set(this,4,byteOffset,packI32,value,arguments[2]);},setFloat32:function setFloat32(byteOffset,value){set(this,4,byteOffset,packF32,value,arguments[2]);},setFloat64:function setFloat64(byteOffset,value){set(this,8,byteOffset,packF64,value,arguments[2]);}});}else{if(!fails(function(){$ArrayBuffer(1);})||!fails(function(){new $ArrayBuffer(-1);})||fails(function(){new $ArrayBuffer();new $ArrayBuffer(1.5);new $ArrayBuffer(NaN);return $ArrayBuffer.name!=ARRAY_BUFFER;})){$ArrayBuffer=function ArrayBuffer(length){anInstance(this,$ArrayBuffer);return new BaseBuffer(toIndex(length));};var ArrayBufferProto=$ArrayBuffer[PROTOTYPE]=BaseBuffer[PROTOTYPE];for(var keys=gOPN(BaseBuffer),j=0,key;keys.length>j;){if(!((key=keys[j++])in $ArrayBuffer))hide($ArrayBuffer,key,BaseBuffer[key]);}
if(!LIBRARY)ArrayBufferProto.constructor=$ArrayBuffer;}
var view=new $DataView(new $ArrayBuffer(2));var $setInt8=$DataView[PROTOTYPE].setInt8;view.setInt8(0,2147483648);view.setInt8(1,2147483649);if(view.getInt8(0)||!view.getInt8(1))redefineAll($DataView[PROTOTYPE],{setInt8:function setInt8(byteOffset,value){$setInt8.call(this,byteOffset,value<<24>>24);},setUint8:function setUint8(byteOffset,value){$setInt8.call(this,byteOffset,value<<24>>24);}},true);}
setToStringTag($ArrayBuffer,ARRAY_BUFFER);setToStringTag($DataView,DATA_VIEW);hide($DataView[PROTOTYPE],$typed.VIEW,true);exports[ARRAY_BUFFER]=$ArrayBuffer;exports[DATA_VIEW]=$DataView;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.registerCellType=_register;exports.getCellType=_getItem;exports.getRegisteredCellTypes=exports.getRegisteredCellTypeNames=exports.hasCellType=void 0;var _staticRegister2=_interopRequireDefault(__webpack_require__(46));var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var _validators=__webpack_require__(49);var _autocompleteType=_interopRequireDefault(__webpack_require__(635));var _checkboxType=_interopRequireDefault(__webpack_require__(636));var _dateType=_interopRequireDefault(__webpack_require__(637));var _dropdownType=_interopRequireDefault(__webpack_require__(638));var _handsontableType=_interopRequireDefault(__webpack_require__(639));var _numericType=_interopRequireDefault(__webpack_require__(640));var _passwordType=_interopRequireDefault(__webpack_require__(641));var _textType=_interopRequireDefault(__webpack_require__(642));var _timeType=_interopRequireDefault(__webpack_require__(643));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var _staticRegister=(0,_staticRegister2.default)('cellTypes'),register=_staticRegister.register,getItem=_staticRegister.getItem,hasItem=_staticRegister.hasItem,getNames=_staticRegister.getNames,getValues=_staticRegister.getValues;exports.getRegisteredCellTypes=getValues;exports.getRegisteredCellTypeNames=getNames;exports.hasCellType=hasItem;_register('autocomplete',_autocompleteType.default);_register('checkbox',_checkboxType.default);_register('date',_dateType.default);_register('dropdown',_dropdownType.default);_register('handsontable',_handsontableType.default);_register('numeric',_numericType.default);_register('password',_passwordType.default);_register('text',_textType.default);_register('time',_timeType.default);function _getItem(name){if(!hasItem(name)){throw Error("You declared cell type \"".concat(name,"\" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by \"Handsontable.cellTypes.registerCellType\" method"));}
return getItem(name);}
function _register(name,type){var editor=type.editor,renderer=type.renderer,validator=type.validator;if(editor){(0,_editors.registerEditor)(name,editor);}
if(renderer){(0,_renderers.registerRenderer)(name,renderer);}
if(validator){(0,_validators.registerValidator)(name,validator);}
register(name,type);}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=Core;var _element=__webpack_require__(1);var _setting=__webpack_require__(121);var _function=__webpack_require__(59);var _console=__webpack_require__(76);var _mixed=__webpack_require__(14);var _browser=__webpack_require__(42);var _dataMap=_interopRequireDefault(__webpack_require__(644));var _editorManager=_interopRequireDefault(__webpack_require__(647));var _eventManager=_interopRequireDefault(__webpack_require__(10));var _object=__webpack_require__(2);var _array=__webpack_require__(3);var _templateLiteralTag=__webpack_require__(58);var _plugins=__webpack_require__(13);var _renderers=__webpack_require__(19);var _validators=__webpack_require__(49);var _string=__webpack_require__(48);var _number=__webpack_require__(9);var _tableView=_interopRequireDefault(__webpack_require__(648));var _dataSource=_interopRequireDefault(__webpack_require__(649));var _data=__webpack_require__(122);var _recordTranslator=__webpack_require__(424);var _rootInstance=__webpack_require__(425);var _src=__webpack_require__(8);var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _defaultSettings=_interopRequireDefault(__webpack_require__(426));var _cellTypes=__webpack_require__(119);var _i18n=__webpack_require__(427);var _dictionariesManager=__webpack_require__(90);var _utils=__webpack_require__(428);var _keyStateObserver=__webpack_require__(123);var _selection=__webpack_require__(429);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _templateObject(){var data=_taggedTemplateLiteral(["Deprecation warning: This method is going to be removed in the next release.\n      If you want to select a cell using props, please use the `selectCell` method."],["Deprecation warning: This method is going to be removed in the next release.\n      If you want to select a cell using props, please use the \\`selectCell\\` method."]);_templateObject=function _templateObject(){return data;};return data;}
function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0);}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
var activeGuid=null;function Core(rootElement,userSettings){var _this=this;var rootInstanceSymbol=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var preventScrollingToCell=false;var instance=this;var GridSettings=function GridSettings(){};var eventManager=new _eventManager.default(instance);var priv;var datamap;var dataSource;var grid;var editorManager;(0,_object.extend)(GridSettings.prototype,_defaultSettings.default.prototype);(0,_object.extend)(GridSettings.prototype,userSettings);(0,_object.extend)(GridSettings.prototype,expandType(userSettings));(0,_utils.applyLanguageSetting)(GridSettings.prototype,userSettings.language);if((0,_rootInstance.hasValidParameter)(rootInstanceSymbol)){(0,_rootInstance.registerAsRootInstance)(this);}
(0,_keyStateObserver.startObserving)();this.isDestroyed=false;this.rootElement=rootElement;this.isHotTableEnv=(0,_element.isChildOfWebComponentTable)(this.rootElement);_eventManager.default.isHotTableEnv=this.isHotTableEnv;this.container=document.createElement('div');this.renderCall=false;rootElement.insertBefore(this.container,rootElement.firstChild);if(false){(0,_mixed._injectProductInfo)(userSettings.licenseKey,rootElement);}
this.guid="ht_".concat((0,_string.randomString)());var recordTranslator=(0,_recordTranslator.getTranslator)(instance);dataSource=new _dataSource.default(instance);if(!this.rootElement.id||this.rootElement.id.substring(0,3)==='ht_'){this.rootElement.id=this.guid;}
priv={cellSettings:[],columnSettings:[],columnsSettingConflicts:['data','width','language'],settings:new GridSettings(),selRange:null,isPopulated:null,scrollable:null,firstRun:true};var selection=new _selection.Selection(priv.settings,{countCols:function countCols(){return instance.countCols();},countRows:function countRows(){return instance.countRows();},propToCol:function propToCol(prop){return datamap.propToCol(prop);},isEditorOpened:function isEditorOpened(){return instance.getActiveEditor()?instance.getActiveEditor().isOpened():false;}});this.selection=selection;this.selection.addLocalHook('beforeSetRangeStart',function(cellCoords){_this.runHooks('beforeSetRangeStart',cellCoords);});this.selection.addLocalHook('beforeSetRangeStartOnly',function(cellCoords){_this.runHooks('beforeSetRangeStartOnly',cellCoords);});this.selection.addLocalHook('beforeSetRangeEnd',function(cellCoords){_this.runHooks('beforeSetRangeEnd',cellCoords);if(cellCoords.row<0){cellCoords.row=_this.view.wt.wtTable.getFirstVisibleRow();}
if(cellCoords.col<0){cellCoords.col=_this.view.wt.wtTable.getFirstVisibleColumn();}});this.selection.addLocalHook('afterSetRangeEnd',function(cellCoords){var preventScrolling=(0,_object.createObjectPropListener)(false);var selectionRange=_this.selection.getSelectedRange();var _selectionRange$curre=selectionRange.current(),from=_selectionRange$curre.from,to=_selectionRange$curre.to;var selectionLayerLevel=selectionRange.size()-1;_this.runHooks('afterSelection',from.row,from.col,to.row,to.col,preventScrolling,selectionLayerLevel);_this.runHooks('afterSelectionByProp',from.row,instance.colToProp(from.col),to.row,instance.colToProp(to.col),preventScrolling,selectionLayerLevel);var isSelectedByAnyHeader=_this.selection.isSelectedByAnyHeader();var currentSelectedRange=_this.selection.selectedRange.current();var scrollToCell=true;if(preventScrollingToCell){scrollToCell=false;}
if(preventScrolling.isTouched()){scrollToCell=!preventScrolling.value;}
var isSelectedByRowHeader=_this.selection.isSelectedByRowHeader();var isSelectedByColumnHeader=_this.selection.isSelectedByColumnHeader();if(scrollToCell!==false){if(!isSelectedByAnyHeader){if(currentSelectedRange&&!_this.selection.isMultiple()){_this.view.scrollViewport(currentSelectedRange.from);}else{_this.view.scrollViewport(cellCoords);}}else if(isSelectedByRowHeader){_this.view.scrollViewportVertically(cellCoords.row);}else if(isSelectedByColumnHeader){_this.view.scrollViewportHorizontally(cellCoords.col);}}
if(isSelectedByRowHeader&&isSelectedByColumnHeader){(0,_element.addClass)(_this.rootElement,['ht__selection--rows','ht__selection--columns']);}else if(isSelectedByRowHeader){(0,_element.removeClass)(_this.rootElement,'ht__selection--columns');(0,_element.addClass)(_this.rootElement,'ht__selection--rows');}else if(isSelectedByColumnHeader){(0,_element.removeClass)(_this.rootElement,'ht__selection--rows');(0,_element.addClass)(_this.rootElement,'ht__selection--columns');}else{(0,_element.removeClass)(_this.rootElement,['ht__selection--rows','ht__selection--columns']);}
_this._refreshBorders(null);});this.selection.addLocalHook('afterSelectionFinished',function(cellRanges){var selectionLayerLevel=cellRanges.length-1;var _cellRanges$selection=cellRanges[selectionLayerLevel],from=_cellRanges$selection.from,to=_cellRanges$selection.to;_this.runHooks('afterSelectionEnd',from.row,from.col,to.row,to.col,selectionLayerLevel);_this.runHooks('afterSelectionEndByProp',from.row,instance.colToProp(from.col),to.row,instance.colToProp(to.col),selectionLayerLevel);});this.selection.addLocalHook('afterIsMultipleSelection',function(isMultiple){var changedIsMultiple=_this.runHooks('afterIsMultipleSelection',isMultiple.value);if(isMultiple.value){isMultiple.value=changedIsMultiple;}});this.selection.addLocalHook('beforeModifyTransformStart',function(cellCoordsDelta){_this.runHooks('modifyTransformStart',cellCoordsDelta);});this.selection.addLocalHook('afterModifyTransformStart',function(coords,rowTransformDir,colTransformDir){_this.runHooks('afterModifyTransformStart',coords,rowTransformDir,colTransformDir);});this.selection.addLocalHook('beforeModifyTransformEnd',function(cellCoordsDelta){_this.runHooks('modifyTransformEnd',cellCoordsDelta);});this.selection.addLocalHook('afterModifyTransformEnd',function(coords,rowTransformDir,colTransformDir){_this.runHooks('afterModifyTransformEnd',coords,rowTransformDir,colTransformDir);});this.selection.addLocalHook('afterDeselect',function(){editorManager.destroyEditor();_this._refreshBorders();(0,_element.removeClass)(_this.rootElement,['ht__selection--rows','ht__selection--columns']);_this.runHooks('afterDeselect');});this.selection.addLocalHook('insertRowRequire',function(totalRows){_this.alter('insert_row',totalRows,1,'auto');});this.selection.addLocalHook('insertColRequire',function(totalCols){_this.alter('insert_col',totalCols,1,'auto');});grid={alter:function alter(action,index){var amount=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var source=arguments.length>3?arguments[3]:undefined;var keepEmptyRows=arguments.length>4?arguments[4]:undefined;var delta;function spliceWith(data,startIndex,count,toInject){var valueFactory=function valueFactory(){var result;if(toInject==='array'){result=[];}else if(toInject==='object'){result={};}
return result;};var spliceArgs=(0,_array.arrayMap)(new Array(count),function(){return valueFactory();});spliceArgs.unshift(startIndex,0);data.splice.apply(data,_toConsumableArray(spliceArgs));}
var normalizeIndexesGroup=function normalizeIndexesGroup(indexes){if(indexes.length===0){return[];}
var sortedIndexes=_toConsumableArray(indexes);sortedIndexes.sort(function(_ref,_ref2){var _ref3=_slicedToArray(_ref,1),indexA=_ref3[0];var _ref4=_slicedToArray(_ref2,1),indexB=_ref4[0];if(indexA===indexB){return 0;}
return indexA>indexB?1:-1;});var normalizedIndexes=(0,_array.arrayReduce)(sortedIndexes,function(acc,_ref5){var _ref6=_slicedToArray(_ref5,2),groupIndex=_ref6[0],groupAmount=_ref6[1];var previousItem=acc[acc.length-1];var _previousItem=_slicedToArray(previousItem,2),prevIndex=_previousItem[0],prevAmount=_previousItem[1];var prevLastIndex=prevIndex+prevAmount;if(groupIndex<=prevLastIndex){var amountToAdd=Math.max(groupAmount-(prevLastIndex-groupIndex),0);previousItem[1]+=amountToAdd;}else{acc.push([groupIndex,groupAmount]);}
return acc;},[sortedIndexes[0]]);return normalizedIndexes;};switch(action){case'insert_row':var numberOfSourceRows=instance.countSourceRows();if(instance.getSettings().maxRows===numberOfSourceRows){return;}
index=(0,_mixed.isDefined)(index)?index:numberOfSourceRows;delta=datamap.createRow(index,amount,source);spliceWith(priv.cellSettings,index,amount,'array');if(delta){if(selection.isSelected()&&selection.selectedRange.current().from.row>=index){selection.selectedRange.current().from.row+=delta;selection.transformEnd(delta,0);}else{instance._refreshBorders();}}
break;case'insert_col':delta=datamap.createCol(index,amount,source);for(var row=0,len=instance.countSourceRows();row<len;row++){if(priv.cellSettings[row]){spliceWith(priv.cellSettings[row],index,amount);}}
if(delta){if(Array.isArray(instance.getSettings().colHeaders)){var spliceArray=[index,0];spliceArray.length+=delta;Array.prototype.splice.apply(instance.getSettings().colHeaders,spliceArray);}
if(selection.isSelected()&&selection.selectedRange.current().from.col>=index){selection.selectedRange.current().from.col+=delta;selection.transformEnd(0,delta);}else{instance._refreshBorders();}}
break;case'remove_row':var removeRow=function removeRow(indexes){var offset=0;(0,_array.arrayEach)(indexes,function(_ref7){var _ref8=_slicedToArray(_ref7,2),groupIndex=_ref8[0],groupAmount=_ref8[1];var calcIndex=(0,_mixed.isEmpty)(groupIndex)?instance.countRows()-1:Math.max(groupIndex-offset,0);if(Number.isInteger(groupIndex)){groupIndex=Math.max(groupIndex-offset,0);}
datamap.removeRow(groupIndex,groupAmount,source);priv.cellSettings.splice(calcIndex,amount);var totalRows=instance.countRows();var fixedRowsTop=instance.getSettings().fixedRowsTop;if(fixedRowsTop>=calcIndex+1){instance.getSettings().fixedRowsTop-=Math.min(groupAmount,fixedRowsTop-calcIndex);}
var fixedRowsBottom=instance.getSettings().fixedRowsBottom;if(fixedRowsBottom&&calcIndex>=totalRows-fixedRowsBottom){instance.getSettings().fixedRowsBottom-=Math.min(groupAmount,fixedRowsBottom);}
offset+=groupAmount;});};if(Array.isArray(index)){removeRow(normalizeIndexesGroup(index));}else{removeRow([[index,amount]]);}
grid.adjustRowsAndCols();instance._refreshBorders();break;case'remove_col':var removeCol=function removeCol(indexes){var offset=0;(0,_array.arrayEach)(indexes,function(_ref9){var _ref10=_slicedToArray(_ref9,2),groupIndex=_ref10[0],groupAmount=_ref10[1];var calcIndex=(0,_mixed.isEmpty)(groupIndex)?instance.countCols()-1:Math.max(groupIndex-offset,0);var visualColumnIndex=recordTranslator.toPhysicalColumn(calcIndex);if(Number.isInteger(groupIndex)){groupIndex=Math.max(groupIndex-offset,0);}
datamap.removeCol(groupIndex,groupAmount,source);for(var _row=0,_len=instance.countSourceRows();_row<_len;_row++){if(priv.cellSettings[_row]){priv.cellSettings[_row].splice(visualColumnIndex,groupAmount);}}
var fixedColumnsLeft=instance.getSettings().fixedColumnsLeft;if(fixedColumnsLeft>=calcIndex+1){instance.getSettings().fixedColumnsLeft-=Math.min(groupAmount,fixedColumnsLeft-calcIndex);}
if(Array.isArray(instance.getSettings().colHeaders)){if(typeof visualColumnIndex==='undefined'){visualColumnIndex=-1;}
instance.getSettings().colHeaders.splice(visualColumnIndex,groupAmount);}
offset+=groupAmount;});};if(Array.isArray(index)){removeCol(normalizeIndexesGroup(index));}else{removeCol([[index,amount]]);}
grid.adjustRowsAndCols();instance._refreshBorders();break;default:throw new Error("There is no such action \"".concat(action,"\""));}
if(!keepEmptyRows){grid.adjustRowsAndCols();}},adjustRowsAndCols:function adjustRowsAndCols(){if(priv.settings.minRows){var rows=instance.countRows();if(rows<priv.settings.minRows){for(var r=0,minRows=priv.settings.minRows;r<minRows-rows;r++){datamap.createRow(instance.countRows(),1,'auto');}}}
if(priv.settings.minSpareRows){var emptyRows=instance.countEmptyRows(true);if(emptyRows<priv.settings.minSpareRows){for(;emptyRows<priv.settings.minSpareRows&&instance.countSourceRows()<priv.settings.maxRows;emptyRows++){datamap.createRow(instance.countRows(),1,'auto');}}}
{var emptyCols;if(priv.settings.minCols||priv.settings.minSpareCols){emptyCols=instance.countEmptyCols(true);}
if(priv.settings.minCols&&!priv.settings.columns&&instance.countCols()<priv.settings.minCols){for(;instance.countCols()<priv.settings.minCols;emptyCols++){datamap.createCol(instance.countCols(),1,'auto');}}
if(priv.settings.minSpareCols&&!priv.settings.columns&&instance.dataType==='array'&&emptyCols<priv.settings.minSpareCols){for(;emptyCols<priv.settings.minSpareCols&&instance.countCols()<priv.settings.maxCols;emptyCols++){datamap.createCol(instance.countCols(),1,'auto');}}}
var rowCount=instance.countRows();var colCount=instance.countCols();if(rowCount===0||colCount===0){selection.deselect();}
if(selection.isSelected()){(0,_array.arrayEach)(selection.selectedRange,function(range){var selectionChanged=false;var fromRow=range.from.row;var fromCol=range.from.col;var toRow=range.to.row;var toCol=range.to.col;if(fromRow>rowCount-1){fromRow=rowCount-1;selectionChanged=true;if(toRow>fromRow){toRow=fromRow;}}else if(toRow>rowCount-1){toRow=rowCount-1;selectionChanged=true;if(fromRow>toRow){fromRow=toRow;}}
if(fromCol>colCount-1){fromCol=colCount-1;selectionChanged=true;if(toCol>fromCol){toCol=fromCol;}}else if(toCol>colCount-1){toCol=colCount-1;selectionChanged=true;if(fromCol>toCol){fromCol=toCol;}}
if(selectionChanged){instance.selectCell(fromRow,fromCol,toRow,toCol);}});}
if(instance.view){instance.view.wt.wtOverlays.adjustElementsSize();}},populateFromArray:function populateFromArray(start,input,end,source,method,direction,deltas){var r;var rlen;var c;var clen;var setData=[];var current={};rlen=input.length;if(rlen===0){return false;}
var repeatCol;var repeatRow;var cmax;var rmax;switch(method){case'shift_down':repeatCol=end?end.col-start.col+1:0;repeatRow=end?end.row-start.row+1:0;input=(0,_data.translateRowsToColumns)(input);for(c=0,clen=input.length,cmax=Math.max(clen,repeatCol);c<cmax;c++){if(c<clen){var _instance;for(r=0,rlen=input[c].length;r<repeatRow-rlen;r++){input[c].push(input[c][r%rlen]);}
input[c].unshift(start.col+c,start.row,0);(_instance=instance).spliceCol.apply(_instance,_toConsumableArray(input[c]));}else{var _instance2;input[c%clen][0]=start.col+c;(_instance2=instance).spliceCol.apply(_instance2,_toConsumableArray(input[c%clen]));}}
break;case'shift_right':repeatCol=end?end.col-start.col+1:0;repeatRow=end?end.row-start.row+1:0;for(r=0,rlen=input.length,rmax=Math.max(rlen,repeatRow);r<rmax;r++){if(r<rlen){var _instance3;for(c=0,clen=input[r].length;c<repeatCol-clen;c++){input[r].push(input[r][c%clen]);}
input[r].unshift(start.row+r,start.col,0);(_instance3=instance).spliceRow.apply(_instance3,_toConsumableArray(input[r]));}else{var _instance4;input[r%rlen][0]=start.row+r;(_instance4=instance).spliceRow.apply(_instance4,_toConsumableArray(input[r%rlen]));}}
break;case'overwrite':default:current.row=start.row;current.col=start.col;var selected={row:end&&start?end.row-start.row+1:1,col:end&&start?end.col-start.col+1:1};var skippedRow=0;var skippedColumn=0;var pushData=true;var cellMeta;var getInputValue=function getInputValue(row){var col=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var rowValue=input[row%input.length];if(col!==null){return rowValue[col%rowValue.length];}
return rowValue;};var rowInputLength=input.length;var rowSelectionLength=end?end.row-start.row+1:0;if(end){rlen=rowSelectionLength;}else{rlen=Math.max(rowInputLength,rowSelectionLength);}
for(r=0;r<rlen;r++){if(end&&current.row>end.row&&rowSelectionLength>rowInputLength||!priv.settings.allowInsertRow&&current.row>instance.countRows()-1||current.row>=priv.settings.maxRows){break;}
var visualRow=r-skippedRow;var colInputLength=getInputValue(visualRow).length;var colSelectionLength=end?end.col-start.col+1:0;if(end){clen=colSelectionLength;}else{clen=Math.max(colInputLength,colSelectionLength);}
current.col=start.col;cellMeta=instance.getCellMeta(current.row,current.col);if((source==='CopyPaste.paste'||source==='Autofill.autofill')&&cellMeta.skipRowOnPaste){skippedRow+=1;current.row+=1;rlen+=1;continue;}
skippedColumn=0;for(c=0;c<clen;c++){if(end&&current.col>end.col&&colSelectionLength>colInputLength||!priv.settings.allowInsertColumn&&current.col>instance.countCols()-1||current.col>=priv.settings.maxCols){break;}
cellMeta=instance.getCellMeta(current.row,current.col);if((source==='CopyPaste.paste'||source==='Autofill.fill')&&cellMeta.skipColumnOnPaste){skippedColumn+=1;current.col+=1;clen+=1;continue;}
if(cellMeta.readOnly){current.col+=1;continue;}
var visualColumn=c-skippedColumn;var value=getInputValue(visualRow,visualColumn);var orgValue=instance.getDataAtCell(current.row,current.col);var index={row:visualRow,col:visualColumn};if(source==='Autofill.fill'){var result=instance.runHooks('beforeAutofillInsidePopulate',index,direction,input,deltas,{},selected);if(result){value=(0,_mixed.isUndefined)(result.value)?value:result.value;}}
if(value!==null&&_typeof(value)==='object'){if(orgValue===null||_typeof(orgValue)!=='object'){pushData=false;}else{var orgValueSchema=(0,_object.duckSchema)(orgValue[0]||orgValue);var valueSchema=(0,_object.duckSchema)(value[0]||value);if((0,_object.isObjectEqual)(orgValueSchema,valueSchema)){value=(0,_object.deepClone)(value);}else{pushData=false;}}}else if(orgValue!==null&&_typeof(orgValue)==='object'){pushData=false;}
if(pushData){setData.push([current.row,current.col,value]);}
pushData=true;current.col+=1;}
current.row+=1;}
instance.setDataAtCell(setData,null,null,source||'populateFromArray');break;}}};function setLanguage(languageCode){var normalizedLanguageCode=(0,_utils.normalizeLanguageCode)(languageCode);if((0,_dictionariesManager.hasLanguageDictionary)(normalizedLanguageCode)){instance.runHooks('beforeLanguageChange',normalizedLanguageCode);GridSettings.prototype.language=normalizedLanguageCode;instance.runHooks('afterLanguageChange',normalizedLanguageCode);}else{(0,_utils.warnUserAboutLanguageRegistration)(languageCode);}}
this.init=function(){dataSource.setData(priv.settings.data);instance.runHooks('beforeInit');if((0,_browser.isMobileBrowser)()){(0,_element.addClass)(instance.rootElement,'mobile');}
this.updateSettings(priv.settings,true);this.view=new _tableView.default(this);editorManager=_editorManager.default.getInstance(instance,priv,selection,datamap);this.forceFullRender=true;instance.runHooks('init');this.view.render();if(_typeof(priv.firstRun)==='object'){instance.runHooks('afterChange',priv.firstRun[0],priv.firstRun[1]);priv.firstRun=false;}
instance.runHooks('afterInit');};function ValidatorsQueue(){var resolved=false;return{validatorsInQueue:0,valid:true,addValidatorToQueue:function addValidatorToQueue(){this.validatorsInQueue+=1;resolved=false;},removeValidatorFormQueue:function removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty();},onQueueEmpty:function onQueueEmpty(){},checkIfQueueIsEmpty:function checkIfQueueIsEmpty(){if(this.validatorsInQueue===0&&resolved===false){resolved=true;this.onQueueEmpty(this.valid);}}};}
function getParsedNumber(numericData){var unifiedNumericData=numericData.replace(',','.');if(isNaN(parseFloat(unifiedNumericData))===false){return parseFloat(unifiedNumericData);}
return numericData;}
function validateChanges(changes,source,callback){var waitingForValidator=new ValidatorsQueue();var isNumericData=function isNumericData(value){return value.length>0&&/^\s*[+-.]?\s*(?:(?:\d+(?:(\.|,)\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/.test(value);};waitingForValidator.onQueueEmpty=resolve;for(var i=changes.length-1;i>=0;i--){if(changes[i]===null){changes.splice(i,1);}else{var _changes$i=_slicedToArray(changes[i],4),row=_changes$i[0],prop=_changes$i[1],newValue=_changes$i[3];var col=datamap.propToCol(prop);var cellProperties=instance.getCellMeta(row,col);if(cellProperties.type==='numeric'&&typeof newValue==='string'&&isNumericData(newValue)){changes[i][3]=getParsedNumber(newValue);}
if(instance.getCellValidator(cellProperties)){waitingForValidator.addValidatorToQueue();instance.validateCell(changes[i][3],cellProperties,function(index,cellPropertiesReference){return function(result){if(typeof result!=='boolean'){throw new Error('Validation error: result is not boolean');}
if(result===false&&cellPropertiesReference.allowInvalid===false){changes.splice(index,1);cellPropertiesReference.valid=true;var cell=instance.getCell(cellPropertiesReference.visualRow,cellPropertiesReference.visualCol);if(cell!==null){(0,_element.removeClass)(cell,instance.getSettings().invalidCellClassName);}}
waitingForValidator.removeValidatorFormQueue();};}(i,cellProperties),source);}}}
waitingForValidator.checkIfQueueIsEmpty();function resolve(){var beforeChangeResult;if(changes.length){beforeChangeResult=instance.runHooks('beforeChange',changes,source||'edit');if((0,_function.isFunction)(beforeChangeResult)){(0,_console.warn)('Your beforeChange callback returns a function. It\'s not supported since Handsontable 0.12.1 (and the returned function will not be executed).');}else if(beforeChangeResult===false){changes.splice(0,changes.length);}}
callback();}}
function applyChanges(changes,source){var i=changes.length-1;if(i<0){return;}
for(;i>=0;i--){var skipThisChange=false;if(changes[i]===null){changes.splice(i,1);continue;}
if((changes[i][2]===null||changes[i][2]===void 0)&&(changes[i][3]===null||changes[i][3]===void 0)){continue;}
if(priv.settings.allowInsertRow){while(changes[i][0]>instance.countRows()-1){var numberOfCreatedRows=datamap.createRow(void 0,void 0,source);if(numberOfCreatedRows===0){skipThisChange=true;break;}}}
if(skipThisChange){continue;}
if(instance.dataType==='array'&&(!priv.settings.columns||priv.settings.columns.length===0)&&priv.settings.allowInsertColumn){while(datamap.propToCol(changes[i][1])>instance.countCols()-1){datamap.createCol(void 0,void 0,source);}}
datamap.set(changes[i][0],changes[i][1],changes[i][3]);}
instance.forceFullRender=true;grid.adjustRowsAndCols();instance.runHooks('beforeChangeRender',changes,source);editorManager.lockEditor();instance._refreshBorders(null);editorManager.unlockEditor();instance.view.wt.wtOverlays.adjustElementsSize();instance.runHooks('afterChange',changes,source||'edit');var activeEditor=instance.getActiveEditor();if(activeEditor&&(0,_mixed.isDefined)(activeEditor.refreshValue)){activeEditor.refreshValue();}}
this.validateCell=function(value,cellProperties,callback,source){var validator=instance.getCellValidator(cellProperties);function done(valid){var canBeValidated=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(!canBeValidated||cellProperties.hidden===true){callback(valid);return;}
var col=cellProperties.visualCol;var row=cellProperties.visualRow;var td=instance.getCell(row,col,true);if(td&&td.nodeName!=='TH'){instance.view.wt.wtSettings.settings.cellRenderer(row,col,td);}
callback(valid);}
if((0,_mixed.isRegExp)(validator)){validator=function(expression){return function(cellValue,validatorCallback){validatorCallback(expression.test(cellValue));};}(validator);}
if((0,_function.isFunction)(validator)){value=instance.runHooks('beforeValidate',value,cellProperties.visualRow,cellProperties.prop,source);instance._registerTimeout(setTimeout(function(){validator.call(cellProperties,value,function(valid){valid=instance.runHooks('afterValidate',valid,value,cellProperties.visualRow,cellProperties.prop,source);cellProperties.valid=valid;done(valid);instance.runHooks('postAfterValidate',valid,value,cellProperties.visualRow,cellProperties.prop,source);});},0));}else{instance._registerTimeout(setTimeout(function(){cellProperties.valid=true;done(cellProperties.valid,false);},0));}};function setDataInputToArray(row,propOrCol,value){if(_typeof(row)==='object'){return row;}
return[[row,propOrCol,value]];}
this.setDataAtCell=function(row,column,value,source){var input=setDataInputToArray(row,column,value);var changes=[];var changeSource=source;var i;var ilen;var prop;for(i=0,ilen=input.length;i<ilen;i++){if(_typeof(input[i])!=='object'){throw new Error('Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter');}
if(typeof input[i][1]!=='number'){throw new Error('Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`');}
prop=datamap.colToProp(input[i][1]);changes.push([input[i][0],prop,dataSource.getAtCell(recordTranslator.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]]);}
if(!changeSource&&_typeof(row)==='object'){changeSource=column;}
instance.runHooks('afterSetDataAtCell',changes,changeSource);validateChanges(changes,changeSource,function(){applyChanges(changes,changeSource);});};this.setDataAtRowProp=function(row,prop,value,source){var input=setDataInputToArray(row,prop,value);var changes=[];var changeSource=source;var i;var ilen;for(i=0,ilen=input.length;i<ilen;i++){changes.push([input[i][0],input[i][1],dataSource.getAtCell(recordTranslator.toPhysicalRow(input[i][0]),input[i][1]),input[i][2]]);}
if(!changeSource&&_typeof(row)==='object'){changeSource=prop;}
instance.runHooks('afterSetDataAtRowProp',changes,changeSource);validateChanges(changes,changeSource,function(){applyChanges(changes,changeSource);});};this.listen=function(){var modifyDocumentFocus=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(modifyDocumentFocus){var invalidActiveElement=!document.activeElement||document.activeElement&&document.activeElement.nodeName===void 0;if(document.activeElement&&document.activeElement!==document.body&&!invalidActiveElement){document.activeElement.blur();}else if(invalidActiveElement){document.body.focus();}}
if(instance&&!instance.isListening()){activeGuid=instance.guid;instance.runHooks('afterListen');}};this.unlisten=function(){if(this.isListening()){activeGuid=null;instance.runHooks('afterUnlisten');}};this.isListening=function(){return activeGuid===instance.guid;};this.destroyEditor=function(){var revertOriginal=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var prepareEditorIfNeeded=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;instance._refreshBorders(revertOriginal,prepareEditorIfNeeded);};this.populateFromArray=function(row,column,input,endRow,endCol,source,method,direction,deltas){if(!(_typeof(input)==='object'&&_typeof(input[0])==='object')){throw new Error('populateFromArray parameter `input` must be an array of arrays');}
var c=typeof endRow==='number'?new _src.CellCoords(endRow,endCol):null;return grid.populateFromArray(new _src.CellCoords(row,column),input,c,source,method,direction,deltas);};this.spliceCol=function(column,index,amount){var _datamap;for(var _len2=arguments.length,elements=new Array(_len2>3?_len2-3:0),_key=3;_key<_len2;_key++){elements[_key-3]=arguments[_key];}
return(_datamap=datamap).spliceCol.apply(_datamap,[column,index,amount].concat(elements));};this.spliceRow=function(row,index,amount){var _datamap2;for(var _len3=arguments.length,elements=new Array(_len3>3?_len3-3:0),_key2=3;_key2<_len3;_key2++){elements[_key2-3]=arguments[_key2];}
return(_datamap2=datamap).spliceRow.apply(_datamap2,[row,index,amount].concat(elements));};this.getSelected=function(){if(selection.isSelected()){return(0,_array.arrayMap)(selection.getSelectedRange(),function(_ref11){var from=_ref11.from,to=_ref11.to;return[from.row,from.col,to.row,to.col];});}};this.getSelectedLast=function(){var selected=this.getSelected();var result;if(selected&&selected.length>0){result=selected[selected.length-1];}
return result;};this.getSelectedRange=function(){if(selection.isSelected()){return Array.from(selection.getSelectedRange());}};this.getSelectedRangeLast=function(){var selectedRange=this.getSelectedRange();var result;if(selectedRange&&selectedRange.length>0){result=selectedRange[selectedRange.length-1];}
return result;};this.emptySelectedCells=function(){var _this2=this;if(!selection.isSelected()){return;}
var changes=[];(0,_array.arrayEach)(selection.getSelectedRange(),function(cellRange){var topLeft=cellRange.getTopLeftCorner();var bottomRight=cellRange.getBottomRightCorner();(0,_number.rangeEach)(topLeft.row,bottomRight.row,function(row){(0,_number.rangeEach)(topLeft.col,bottomRight.col,function(column){if(!_this2.getCellMeta(row,column).readOnly){changes.push([row,column,'']);}});});});if(changes.length>0){this.setDataAtCell(changes);}};this.render=function(){if(instance.view){instance.renderCall=true;instance.forceFullRender=true;editorManager.lockEditor();instance._refreshBorders(null);editorManager.unlockEditor();}};this.loadData=function(data){if(Array.isArray(priv.settings.dataSchema)){instance.dataType='array';}else if((0,_function.isFunction)(priv.settings.dataSchema)){instance.dataType='function';}else{instance.dataType='object';}
if(datamap){datamap.destroy();}
datamap=new _dataMap.default(instance,priv,GridSettings);if(_typeof(data)==='object'&&data!==null){if(!(data.push&&data.splice)){data=[data];}}else if(data===null){var dataSchema=datamap.getSchema();data=[];var row;var r=0;var rlen=0;for(r=0,rlen=priv.settings.startRows;r<rlen;r++){if((instance.dataType==='object'||instance.dataType==='function')&&priv.settings.dataSchema){row=(0,_object.deepClone)(dataSchema);data.push(row);}else if(instance.dataType==='array'){row=(0,_object.deepClone)(dataSchema[0]);data.push(row);}else{row=[];for(var c=0,clen=priv.settings.startCols;c<clen;c++){row.push(null);}
data.push(row);}}}else{throw new Error("loadData only accepts array of objects or array of arrays (".concat(_typeof(data)," given)"));}
priv.isPopulated=false;GridSettings.prototype.data=data;if(Array.isArray(data[0])){instance.dataType='array';}
datamap.dataSource=data;dataSource.data=data;dataSource.dataType=instance.dataType;dataSource.colToProp=datamap.colToProp.bind(datamap);dataSource.propToCol=datamap.propToCol.bind(datamap);clearCellSettingCache();grid.adjustRowsAndCols();instance.runHooks('afterLoadData',priv.firstRun);if(priv.firstRun){priv.firstRun=[null,'loadData'];}else{instance.runHooks('afterChange',null,'loadData');instance.render();}
priv.isPopulated=true;function clearCellSettingCache(){priv.cellSettings.length=0;}};this.getData=function(row,column,row2,column2){if((0,_mixed.isUndefined)(row)){return datamap.getAll();}
return datamap.getRange(new _src.CellCoords(row,column),new _src.CellCoords(row2,column2),datamap.DESTINATION_RENDERER);};this.getCopyableText=function(startRow,startCol,endRow,endCol){return datamap.getCopyableText(new _src.CellCoords(startRow,startCol),new _src.CellCoords(endRow,endCol));};this.getCopyableData=function(row,column){return datamap.getCopyable(row,datamap.colToProp(column));};this.getSchema=function(){return datamap.getSchema();};this.updateSettings=function(settings){var init=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var columnsAsFunc=false;var i;var j;var clen;if((0,_mixed.isDefined)(settings.rows)){throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');}
if((0,_mixed.isDefined)(settings.cols)){throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');}
for(i in settings){if(i==='data'){continue;}else if(i==='language'){setLanguage(settings.language);continue;}else if(_pluginHooks.default.getSingleton().getRegistered().indexOf(i)>-1){if((0,_function.isFunction)(settings[i])||Array.isArray(settings[i])){settings[i].initialHook=true;instance.addHook(i,settings[i]);}}else if(!init&&(0,_object.hasOwnProperty)(settings,i)){GridSettings.prototype[i]=settings[i];}}
if(settings.data===void 0&&priv.settings.data===void 0){instance.loadData(null);}else if(settings.data!==void 0){instance.loadData(settings.data);}else if(settings.columns!==void 0){datamap.createMap();}
clen=instance.countCols();var columnSetting=settings.columns||GridSettings.prototype.columns;if(columnSetting&&(0,_function.isFunction)(columnSetting)){clen=instance.countSourceCols();columnsAsFunc=true;}
if(settings.cell!==void 0||settings.cells!==void 0||settings.columns!==void 0){priv.cellSettings.length=0;}
if(clen>0){var proto;var column;for(i=0,j=0;i<clen;i++){if(columnsAsFunc&&!columnSetting(i)){continue;}
priv.columnSettings[j]=(0,_setting.columnFactory)(GridSettings,priv.columnsSettingConflicts);proto=priv.columnSettings[j].prototype;if(columnSetting){if(columnsAsFunc){column=columnSetting(i);}else{column=columnSetting[j];}
if(column){(0,_object.extend)(proto,column);(0,_object.extend)(proto,expandType(column));}}
j+=1;}}
if((0,_mixed.isDefined)(settings.cell)){(0,_object.objectEach)(settings.cell,function(cell){instance.setCellMetaObject(cell.row,cell.col,cell);});}
instance.runHooks('afterCellMetaReset');if((0,_mixed.isDefined)(settings.className)){if(GridSettings.prototype.className){(0,_element.removeClass)(instance.rootElement,GridSettings.prototype.className);}
if(settings.className){(0,_element.addClass)(instance.rootElement,settings.className);}}
var currentHeight=instance.rootElement.style.height;if(currentHeight!==''){currentHeight=parseInt(instance.rootElement.style.height,10);}
var height=settings.height;if((0,_function.isFunction)(height)){height=height();}
if(init){var initialStyle=instance.rootElement.getAttribute('style');if(initialStyle){instance.rootElement.setAttribute('data-initialstyle',instance.rootElement.getAttribute('style'));}}
if(height===null){var _initialStyle=instance.rootElement.getAttribute('data-initialstyle');if(_initialStyle&&(_initialStyle.indexOf('height')>-1||_initialStyle.indexOf('overflow')>-1)){instance.rootElement.setAttribute('style',_initialStyle);}else{instance.rootElement.style.height='';instance.rootElement.style.overflow='';}}else if(height!==void 0){instance.rootElement.style.height="".concat(height,"px");instance.rootElement.style.overflow='hidden';}
if(typeof settings.width!=='undefined'){var width=settings.width;if((0,_function.isFunction)(width)){width=width();}
instance.rootElement.style.width="".concat(width,"px");}
if(!init){datamap.clearLengthCache();if(instance.view){instance.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked();}
instance.runHooks('afterUpdateSettings',settings);}
grid.adjustRowsAndCols();if(instance.view&&!priv.firstRun){instance.forceFullRender=true;editorManager.lockEditor();instance._refreshBorders(null);editorManager.unlockEditor();}
if(!init&&instance.view&&(currentHeight===''||height===''||height===void 0)&&currentHeight!==height){instance.view.wt.wtOverlays.updateMainScrollableElements();}};this.getValue=function(){var sel=instance.getSelectedLast();if(GridSettings.prototype.getValue){if((0,_function.isFunction)(GridSettings.prototype.getValue)){return GridSettings.prototype.getValue.call(instance);}else if(sel){return instance.getData()[sel[0][0]][GridSettings.prototype.getValue];}}else if(sel){return instance.getDataAtCell(sel[0],sel[1]);}};function expandType(obj){if(!(0,_object.hasOwnProperty)(obj,'type')){return;}
var expandedType={};var type;if(_typeof(obj.type)==='object'){type=obj.type;}else if(typeof obj.type==='string'){type=(0,_cellTypes.getCellType)(obj.type);}
for(var i in type){if((0,_object.hasOwnProperty)(type,i)&&!(0,_object.hasOwnProperty)(obj,i)){expandedType[i]=type[i];}}
return expandedType;}
this.getSettings=function(){return priv.settings;};this.clear=function(){this.selectAll();this.emptySelectedCells();};this.alter=function(action,index,amount,source,keepEmptyRows){grid.alter(action,index,amount,source,keepEmptyRows);};this.getCell=function(row,column){var topmost=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return instance.view.getCellAtCoords(new _src.CellCoords(row,column),topmost);};this.getCoords=function(element){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,element);};this.colToProp=function(column){return datamap.colToProp(column);};this.propToCol=function(prop){return datamap.propToCol(prop);};this.toVisualRow=function(row){return recordTranslator.toVisualRow(row);};this.toVisualColumn=function(column){return recordTranslator.toVisualColumn(column);};this.toPhysicalRow=function(row){return recordTranslator.toPhysicalRow(row);};this.toPhysicalColumn=function(column){return recordTranslator.toPhysicalColumn(column);};this.getDataAtCell=function(row,column){return datamap.get(row,datamap.colToProp(column));};this.getDataAtRowProp=function(row,prop){return datamap.get(row,prop);};this.getDataAtCol=function(column){var _ref12;return(_ref12=[]).concat.apply(_ref12,_toConsumableArray(datamap.getRange(new _src.CellCoords(0,column),new _src.CellCoords(priv.settings.data.length-1,column),datamap.DESTINATION_RENDERER)));};this.getDataAtProp=function(prop){var _ref13;var range=datamap.getRange(new _src.CellCoords(0,datamap.propToCol(prop)),new _src.CellCoords(priv.settings.data.length-1,datamap.propToCol(prop)),datamap.DESTINATION_RENDERER);return(_ref13=[]).concat.apply(_ref13,_toConsumableArray(range));};this.getSourceData=function(row,column,row2,column2){var data;if(row===void 0){data=dataSource.getData();}else{data=dataSource.getByRange(new _src.CellCoords(row,column),new _src.CellCoords(row2,column2));}
return data;};this.getSourceDataArray=function(row,column,row2,column2){var data;if(row===void 0){data=dataSource.getData(true);}else{data=dataSource.getByRange(new _src.CellCoords(row,column),new _src.CellCoords(row2,column2),true);}
return data;};this.getSourceDataAtCol=function(column){return dataSource.getAtColumn(column);};this.getSourceDataAtRow=function(row){return dataSource.getAtRow(row);};this.getSourceDataAtCell=function(row,column){return dataSource.getAtCell(row,column);};this.getDataAtRow=function(row){var data=datamap.getRange(new _src.CellCoords(row,0),new _src.CellCoords(row,this.countCols()-1),datamap.DESTINATION_RENDERER);return data[0]||[];};this.getDataType=function(rowFrom,columnFrom,rowTo,columnTo){var _this3=this;var coords=rowFrom===void 0?[0,0,this.countRows(),this.countCols()]:[rowFrom,columnFrom,rowTo,columnTo];var rowStart=coords[0],columnStart=coords[1];var rowEnd=coords[2],columnEnd=coords[3];var previousType=null;var currentType=null;if(rowEnd===void 0){rowEnd=rowStart;}
if(columnEnd===void 0){columnEnd=columnStart;}
var type='mixed';(0,_number.rangeEach)(Math.min(rowStart,rowEnd),Math.max(rowStart,rowEnd),function(row){var isTypeEqual=true;(0,_number.rangeEach)(Math.min(columnStart,columnEnd),Math.max(columnStart,columnEnd),function(column){var cellType=_this3.getCellMeta(row,column);currentType=cellType.type;if(previousType){isTypeEqual=previousType===currentType;}else{previousType=currentType;}
return isTypeEqual;});type=isTypeEqual?currentType:'mixed';return isTypeEqual;});return type;};this.removeCellMeta=function(row,column,key){var _recordTranslator$toP=recordTranslator.toPhysical(row,column),_recordTranslator$toP2=_slicedToArray(_recordTranslator$toP,2),physicalRow=_recordTranslator$toP2[0],physicalColumn=_recordTranslator$toP2[1];var cachedValue=priv.cellSettings[physicalRow][physicalColumn][key];var hookResult=instance.runHooks('beforeRemoveCellMeta',row,column,key,cachedValue);if(hookResult!==false){delete priv.cellSettings[physicalRow][physicalColumn][key];instance.runHooks('afterRemoveCellMeta',row,column,key,cachedValue);}
cachedValue=null;};this.spliceCellsMeta=function(index,deleteAmount){var _priv$cellSettings;for(var _len4=arguments.length,items=new Array(_len4>2?_len4-2:0),_key3=2;_key3<_len4;_key3++){items[_key3-2]=arguments[_key3];}
(_priv$cellSettings=priv.cellSettings).splice.apply(_priv$cellSettings,[index,deleteAmount].concat(items));};this.setCellMetaObject=function(row,column,prop){var _this4=this;if(_typeof(prop)==='object'){(0,_object.objectEach)(prop,function(value,key){_this4.setCellMeta(row,column,key,value);});}};this.setCellMeta=function(row,column,key,value){var _recordTranslator$toP3=recordTranslator.toPhysical(row,column),_recordTranslator$toP4=_slicedToArray(_recordTranslator$toP3,2),physicalRow=_recordTranslator$toP4[0],physicalColumn=_recordTranslator$toP4[1];if(!priv.columnSettings[physicalColumn]){priv.columnSettings[physicalColumn]=(0,_setting.columnFactory)(GridSettings,priv.columnsSettingConflicts);}
if(!priv.cellSettings[physicalRow]){priv.cellSettings[physicalRow]=[];}
if(!priv.cellSettings[physicalRow][physicalColumn]){priv.cellSettings[physicalRow][physicalColumn]=new priv.columnSettings[physicalColumn]();}
priv.cellSettings[physicalRow][physicalColumn][key]=value;instance.runHooks('afterSetCellMeta',row,column,key,value);};this.getCellsMeta=function(){return(0,_array.arrayFlatten)(priv.cellSettings);};this.getCellMeta=function(row,column){var prop=datamap.colToProp(column);var _recordTranslator$toP5=recordTranslator.toPhysical(row,column),_recordTranslator$toP6=_slicedToArray(_recordTranslator$toP5,2),potentialPhysicalRow=_recordTranslator$toP6[0],physicalColumn=_recordTranslator$toP6[1];var physicalRow=potentialPhysicalRow;if(physicalRow===null){physicalRow=row;}
if(!priv.columnSettings[physicalColumn]){priv.columnSettings[physicalColumn]=(0,_setting.columnFactory)(GridSettings,priv.columnsSettingConflicts);}
if(!priv.cellSettings[physicalRow]){priv.cellSettings[physicalRow]=[];}
if(!priv.cellSettings[physicalRow][physicalColumn]){priv.cellSettings[physicalRow][physicalColumn]=new priv.columnSettings[physicalColumn]();}
var cellProperties=priv.cellSettings[physicalRow][physicalColumn];cellProperties.row=physicalRow;cellProperties.col=physicalColumn;cellProperties.visualRow=row;cellProperties.visualCol=column;cellProperties.prop=prop;cellProperties.instance=instance;instance.runHooks('beforeGetCellMeta',row,column,cellProperties);(0,_object.extend)(cellProperties,expandType(cellProperties));if(cellProperties.cells){var settings=cellProperties.cells.call(cellProperties,physicalRow,physicalColumn,prop);if(settings){(0,_object.extend)(cellProperties,settings);(0,_object.extend)(cellProperties,expandType(settings));}}
instance.runHooks('afterGetCellMeta',row,column,cellProperties);return cellProperties;};this.getCellMetaAtRow=function(row){return priv.cellSettings[row];};this.isColumnModificationAllowed=function(){return!(instance.dataType==='object'||instance.getSettings().columns);};var rendererLookup=(0,_data.cellMethodLookupFactory)('renderer');this.getCellRenderer=function(row,column){return(0,_renderers.getRenderer)(rendererLookup.call(this,row,column));};this.getCellEditor=(0,_data.cellMethodLookupFactory)('editor');var validatorLookup=(0,_data.cellMethodLookupFactory)('validator');this.getCellValidator=function(row,column){var validator=validatorLookup.call(this,row,column);if(typeof validator==='string'){validator=(0,_validators.getValidator)(validator);}
return validator;};this.validateCells=function(callback){this._validateCells(callback);};this.validateRows=function(rows,callback){if(!Array.isArray(rows)){throw new Error('validateRows parameter `rows` must be an array');}
this._validateCells(callback,rows);};this.validateColumns=function(columns,callback){if(!Array.isArray(columns)){throw new Error('validateColumns parameter `columns` must be an array');}
this._validateCells(callback,undefined,columns);};this._validateCells=function(callback,rows,columns){var waitingForValidator=new ValidatorsQueue();if(callback){waitingForValidator.onQueueEmpty=callback;}
var i=instance.countRows()-1;while(i>=0){if(rows!==undefined&&rows.indexOf(i)===-1){i-=1;continue;}
var j=instance.countCols()-1;while(j>=0){if(columns!==undefined&&columns.indexOf(j)===-1){j-=1;continue;}
waitingForValidator.addValidatorToQueue();instance.validateCell(instance.getDataAtCell(i,j),instance.getCellMeta(i,j),function(result){if(typeof result!=='boolean'){throw new Error('Validation error: result is not boolean');}
if(result===false){waitingForValidator.valid=false;}
waitingForValidator.removeValidatorFormQueue();},'validateCells');j-=1;}
i-=1;}
waitingForValidator.checkIfQueueIsEmpty();};this.getRowHeader=function(row){var rowHeader=priv.settings.rowHeaders;var physicalRow=row;if(physicalRow!==void 0){physicalRow=instance.runHooks('modifyRowHeader',physicalRow);}
if(physicalRow===void 0){rowHeader=[];(0,_number.rangeEach)(instance.countRows()-1,function(i){rowHeader.push(instance.getRowHeader(i));});}else if(Array.isArray(rowHeader)&&rowHeader[physicalRow]!==void 0){rowHeader=rowHeader[physicalRow];}else if((0,_function.isFunction)(rowHeader)){rowHeader=rowHeader(physicalRow);}else if(rowHeader&&typeof rowHeader!=='string'&&typeof rowHeader!=='number'){rowHeader=physicalRow+1;}
return rowHeader;};this.hasRowHeaders=function(){return!!priv.settings.rowHeaders;};this.hasColHeaders=function(){if(priv.settings.colHeaders!==void 0&&priv.settings.colHeaders!==null){return!!priv.settings.colHeaders;}
for(var i=0,ilen=instance.countCols();i<ilen;i++){if(instance.getColHeader(i)){return true;}}
return false;};this.getColHeader=function(column){var columnsAsFunc=priv.settings.columns&&(0,_function.isFunction)(priv.settings.columns);var columnIndex=instance.runHooks('modifyColHeader',column);var result=priv.settings.colHeaders;if(columnIndex===void 0){var out=[];var ilen=columnsAsFunc?instance.countSourceCols():instance.countCols();for(var i=0;i<ilen;i++){out.push(instance.getColHeader(i));}
result=out;}else{var translateVisualIndexToColumns=function translateVisualIndexToColumns(visualColumnIndex){var arr=[];var columnsLen=instance.countSourceCols();var index=0;for(;index<columnsLen;index++){if((0,_function.isFunction)(instance.getSettings().columns)&&instance.getSettings().columns(index)){arr.push(index);}}
return arr[visualColumnIndex];};var baseCol=columnIndex;var physicalColumn=instance.runHooks('modifyCol',baseCol);var prop=translateVisualIndexToColumns(physicalColumn);if(priv.settings.colHeaders===false){result=null;}else if(priv.settings.columns&&(0,_function.isFunction)(priv.settings.columns)&&priv.settings.columns(prop)&&priv.settings.columns(prop).title){result=priv.settings.columns(prop).title;}else if(priv.settings.columns&&priv.settings.columns[physicalColumn]&&priv.settings.columns[physicalColumn].title){result=priv.settings.columns[physicalColumn].title;}else if(Array.isArray(priv.settings.colHeaders)&&priv.settings.colHeaders[physicalColumn]!==void 0){result=priv.settings.colHeaders[physicalColumn];}else if((0,_function.isFunction)(priv.settings.colHeaders)){result=priv.settings.colHeaders(physicalColumn);}else if(priv.settings.colHeaders&&typeof priv.settings.colHeaders!=='string'&&typeof priv.settings.colHeaders!=='number'){result=(0,_data.spreadsheetColumnLabel)(baseCol);}}
return result;};this._getColWidthFromSettings=function(col){var cellProperties=instance.getCellMeta(0,col);var width=cellProperties.width;if(width===void 0||width===priv.settings.width){width=cellProperties.colWidths;}
if(width!==void 0&&width!==null){switch(_typeof(width)){case'object':width=width[col];break;case'function':width=width(col);break;default:break;}
if(typeof width==='string'){width=parseInt(width,10);}}
return width;};this.getColWidth=function(column){var width=instance._getColWidthFromSettings(column);width=instance.runHooks('modifyColWidth',width,column);if(width===void 0){width=_src.ViewportColumnsCalculator.DEFAULT_WIDTH;}
return width;};this._getRowHeightFromSettings=function(row){var height=priv.settings.rowHeights;if(height!==void 0&&height!==null){switch(_typeof(height)){case'object':height=height[row];break;case'function':height=height(row);break;default:break;}
if(typeof height==='string'){height=parseInt(height,10);}}
return height;};this.getRowHeight=function(row){var height=instance._getRowHeightFromSettings(row);height=instance.runHooks('modifyRowHeight',height,row);return height;};this.countSourceRows=function(){var sourceLength=instance.runHooks('modifySourceLength');return sourceLength||(instance.getSourceData()?instance.getSourceData().length:0);};this.countSourceCols=function(){var len=0;var obj=instance.getSourceData()&&instance.getSourceData()[0]?instance.getSourceData()[0]:[];if((0,_object.isObject)(obj)){len=(0,_object.deepObjectSize)(obj);}else{len=obj.length||0;}
return len;};this.countRows=function(){return datamap.getLength();};this.countCols=function(){var maxCols=this.getSettings().maxCols;var dataHasLength=false;var dataLen=0;if(instance.dataType==='array'){dataHasLength=priv.settings.data&&priv.settings.data[0]&&priv.settings.data[0].length;}
if(dataHasLength){dataLen=priv.settings.data[0].length;}
if(priv.settings.columns){var columnsIsFunction=(0,_function.isFunction)(priv.settings.columns);if(columnsIsFunction){if(instance.dataType==='array'){var columnLen=0;for(var i=0;i<dataLen;i++){if(priv.settings.columns(i)){columnLen+=1;}}
dataLen=columnLen;}else if(instance.dataType==='object'||instance.dataType==='function'){dataLen=datamap.colToPropCache.length;}}else{dataLen=priv.settings.columns.length;}}else if(instance.dataType==='object'||instance.dataType==='function'){dataLen=datamap.colToPropCache.length;}
return Math.min(maxCols,dataLen);};this.rowOffset=function(){return instance.view.wt.wtTable.getFirstRenderedRow();};this.colOffset=function(){return instance.view.wt.wtTable.getFirstRenderedColumn();};this.countRenderedRows=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.getRenderedRowsCount():-1;};this.countVisibleRows=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.getVisibleRowsCount():-1;};this.countRenderedCols=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.getRenderedColumnsCount():-1;};this.countVisibleCols=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.getVisibleColumnsCount():-1;};this.countEmptyRows=function(){var ending=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var emptyRows=0;(0,_number.rangeEachReverse)(instance.countRows()-1,function(visualIndex){if(instance.isEmptyRow(visualIndex)){emptyRows+=1;}else if(ending===true){return false;}});return emptyRows;};this.countEmptyCols=function(){var ending=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(instance.countRows()<1){return 0;}
var emptyColumns=0;(0,_number.rangeEachReverse)(instance.countCols()-1,function(visualIndex){if(instance.isEmptyCol(visualIndex)){emptyColumns+=1;}else if(ending===true){return false;}});return emptyColumns;};this.isEmptyRow=function(row){return priv.settings.isEmptyRow.call(instance,row);};this.isEmptyCol=function(column){return priv.settings.isEmptyCol.call(instance,column);};this.selectCell=function(row,column,endRow,endColumn){var scrollToCell=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;var changeListener=arguments.length>5&&arguments[5]!==undefined?arguments[5]:true;if((0,_mixed.isUndefined)(row)||(0,_mixed.isUndefined)(column)){return false;}
return this.selectCells([[row,column,endRow,endColumn]],scrollToCell,changeListener);};this.selectCells=function(){var coords=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[[]];var scrollToCell=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var changeListener=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(scrollToCell===false){preventScrollingToCell=true;}
var wasSelected=selection.selectCells(coords);if(wasSelected&&changeListener){instance.listen();}
preventScrollingToCell=false;return wasSelected;};this.selectCellByProp=function(row,prop,endRow,endProp){var scrollToCell=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;var changeListener=arguments.length>5&&arguments[5]!==undefined?arguments[5]:true;(0,_console.warn)((0,_templateLiteralTag.toSingleLine)(_templateObject()));return this.selectCells([[row,prop,endRow,endProp]],scrollToCell,changeListener);};this.selectColumns=function(startColumn){var endColumn=arguments.length>1&&arguments[1]!==undefined?arguments[1]:startColumn;return selection.selectColumns(startColumn,endColumn);};this.selectRows=function(startRow){var endRow=arguments.length>1&&arguments[1]!==undefined?arguments[1]:startRow;return selection.selectRows(startRow,endRow);};this.deselectCell=function(){selection.deselect();};this.selectAll=function(){preventScrollingToCell=true;selection.selectAll();preventScrollingToCell=false;};this.scrollViewportTo=function(row,column){var snapToBottom=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var snapToRight=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var snapToTop=!snapToBottom;var snapToLeft=!snapToRight;var result=false;if(row!==void 0&&column!==void 0){result=instance.view.scrollViewport(new _src.CellCoords(row,column),snapToTop,snapToRight,snapToBottom,snapToLeft);}
if(typeof row==='number'&&typeof column!=='number'){result=instance.view.scrollViewportVertically(row,snapToTop,snapToBottom);}
if(typeof column==='number'&&typeof row!=='number'){result=instance.view.scrollViewportHorizontally(column,snapToRight,snapToLeft);}
return result;};this.destroy=function(){instance._clearTimeouts();instance._clearImmediates();if(instance.view){instance.view.destroy();}
if(dataSource){dataSource.destroy();}
dataSource=null;(0,_keyStateObserver.stopObserving)();if(false){var licenseInfo=document.querySelector('#hot-display-license-info');if(licenseInfo){licenseInfo.parentNode.removeChild(licenseInfo);}}
(0,_element.empty)(instance.rootElement);eventManager.destroy();if(editorManager){editorManager.destroy();}
instance.runHooks('afterDestroy');_pluginHooks.default.getSingleton().destroy(instance);(0,_object.objectEach)(instance,function(property,key,obj){if((0,_function.isFunction)(property)){obj[key]=postMortem(key);}else if(key!=='guid'){obj[key]=null;}});instance.isDestroyed=true;if(datamap){datamap.destroy();}
datamap=null;priv=null;grid=null;selection=null;editorManager=null;instance=null;GridSettings=null;};function postMortem(method){return function(){throw new Error("The \"".concat(method,"\" method cannot be called because this Handsontable instance has been destroyed"));};}
this.getActiveEditor=function(){return editorManager.getActiveEditor();};this.getPlugin=function(pluginName){return(0,_plugins.getPlugin)(this,pluginName);};this.getInstance=function(){return instance;};this.addHook=function(key,callback){_pluginHooks.default.getSingleton().add(key,callback,instance);};this.hasHook=function(key){return _pluginHooks.default.getSingleton().has(key,instance);};this.addHookOnce=function(key,callback){_pluginHooks.default.getSingleton().once(key,callback,instance);};this.removeHook=function(key,callback){_pluginHooks.default.getSingleton().remove(key,callback,instance);};this.runHooks=function(key,p1,p2,p3,p4,p5,p6){return _pluginHooks.default.getSingleton().run(instance,key,p1,p2,p3,p4,p5,p6);};this.getTranslatedPhrase=function(dictionaryKey,extraArguments){return(0,_i18n.getTranslatedPhrase)(priv.settings.language,dictionaryKey,extraArguments);};this.timeouts=[];this._registerTimeout=function(handle){var delay=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var handleFunc=handle;if(typeof handleFunc==='function'){handleFunc=setTimeout(handleFunc,delay);}
this.timeouts.push(handleFunc);};this._clearTimeouts=function(){(0,_array.arrayEach)(this.timeouts,function(handler){clearTimeout(handler);});};this.immediates=[];this._registerImmediate=function(callback){this.immediates.push(setImmediate(callback));};this._clearImmediates=function(){(0,_array.arrayEach)(this.immediates,function(handler){clearImmediate(handler);});};this._refreshBorders=function(){var revertOriginal=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var prepareEditorIfNeeded=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;editorManager.destroyEditor(revertOriginal);instance.view.render();if(prepareEditorIfNeeded&&selection.isSelected()){editorManager.prepareEditor();}};_pluginHooks.default.getSingleton().run(instance,'construct');}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.columnFactory=columnFactory;var _object=__webpack_require__(2);function columnFactory(GridSettings,conflictList){function ColumnSettings(){}
(0,_object.inherit)(ColumnSettings,GridSettings);for(var i=0,len=conflictList.length;i<len;i++){ColumnSettings.prototype[conflictList[i]]=void 0;}
return ColumnSettings;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.spreadsheetColumnLabel=spreadsheetColumnLabel;exports.spreadsheetColumnIndex=spreadsheetColumnIndex;exports.createSpreadsheetData=createSpreadsheetData;exports.createSpreadsheetObjectData=createSpreadsheetObjectData;exports.createEmptySpreadsheetData=createEmptySpreadsheetData;exports.translateRowsToColumns=translateRowsToColumns;exports.cellMethodLookupFactory=cellMethodLookupFactory;var _cellTypes=__webpack_require__(119);var _object=__webpack_require__(2);var COLUMN_LABEL_BASE='ABCDEFGHIJKLMNOPQRSTUVWXYZ';var COLUMN_LABEL_BASE_LENGTH=COLUMN_LABEL_BASE.length;function spreadsheetColumnLabel(index){var dividend=index+1;var columnLabel='';var modulo;while(dividend>0){modulo=(dividend-1)%COLUMN_LABEL_BASE_LENGTH;columnLabel=String.fromCharCode(65+modulo)+columnLabel;dividend=parseInt((dividend-modulo)/COLUMN_LABEL_BASE_LENGTH,10);}
return columnLabel;}
function spreadsheetColumnIndex(label){var result=0;if(label){for(var i=0,j=label.length-1;i<label.length;i+=1,j-=1){result+=Math.pow(COLUMN_LABEL_BASE_LENGTH,j)*(COLUMN_LABEL_BASE.indexOf(label[i])+1);}}
result-=1;return result;}
function createSpreadsheetData(){var rows=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;var columns=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4;var _rows=[];var i;var j;for(i=0;i<rows;i++){var row=[];for(j=0;j<columns;j++){row.push(spreadsheetColumnLabel(j)+(i+1));}
_rows.push(row);}
return _rows;}
function createSpreadsheetObjectData(){var rows=arguments.length>0&&arguments[0]!==undefined?arguments[0]:100;var colCount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4;var _rows=[];var i;var j;for(i=0;i<rows;i++){var row={};for(j=0;j<colCount;j++){row["prop".concat(j)]=spreadsheetColumnLabel(j)+(i+1);}
_rows.push(row);}
return _rows;}
function createEmptySpreadsheetData(rows,columns){var data=[];var row;for(var i=0;i<rows;i++){row=[];for(var j=0;j<columns;j++){row.push('');}
data.push(row);}
return data;}
function translateRowsToColumns(input){var output=[];var i;var ilen;var j;var jlen;var olen=0;for(i=0,ilen=input.length;i<ilen;i++){for(j=0,jlen=input[i].length;j<jlen;j++){if(j===olen){output.push([]);olen+=1;}
output[j].push(input[i][j]);}}
return output;}
function cellMethodLookupFactory(methodName,allowUndefined){var isUndefinedAllowed=typeof allowUndefined==='undefined'?true:allowUndefined;return function cellMethodLookup(row,col){return function getMethodFromProperties(properties){if(!properties){return;}else if((0,_object.hasOwnProperty)(properties,methodName)&&properties[methodName]!==void 0){return properties[methodName];}else if((0,_object.hasOwnProperty)(properties,'type')&&properties.type){if(typeof properties.type!=='string'){throw new Error('Cell type must be a string ');}
var type=(0,_cellTypes.getCellType)(properties.type);if((0,_object.hasOwnProperty)(type,methodName)){return type[methodName];}else if(isUndefinedAllowed){return;}}
return getMethodFromProperties(Object.getPrototypeOf(properties));}(typeof row==='number'?this.getCellMeta(row,col):row);};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports._getRefCount=_getRefCount;exports._resetState=_resetState;exports.isPressed=isPressed;exports.isPressedCtrlKey=isPressedCtrlKey;exports.startObserving=startObserving;exports.stopObserving=stopObserving;var _eventManager=_interopRequireDefault(__webpack_require__(10));var _unicode=__webpack_require__(32);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var eventManager=new _eventManager.default();var pressedKeys=new Set();var refCount=0;function startObserving(){if(refCount===0){eventManager.addEventListener(document,'keydown',function(event){if(!pressedKeys.has(event.keyCode)){pressedKeys.add(event.keyCode);}});eventManager.addEventListener(document,'keyup',function(event){if(pressedKeys.has(event.keyCode)){pressedKeys.delete(event.keyCode);}});eventManager.addEventListener(document,'visibilitychange',function(){if(document.hidden){pressedKeys.clear();}});eventManager.addEventListener(window,'blur',function(){pressedKeys.clear();});}
refCount+=1;}
function stopObserving(){if(refCount>0){refCount-=1;}
if(refCount===0){_resetState();}}
function _resetState(){eventManager.clearEvents();pressedKeys.clear();refCount=0;}
function isPressed(keyCodes){return Array.from(pressedKeys.values()).some(function(_keyCode){return(0,_unicode.isKey)(_keyCode,keyCodes);});}
function isPressedCtrlKey(){var values=Array.from(pressedKeys.values());return values.some(function(_keyCode){return(0,_unicode.isCtrlMetaKey)(_keyCode);});}
function _getRefCount(){return refCount;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _array=__webpack_require__(3);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var GhostTable=function(){function GhostTable(hotInstance){_classCallCheck(this,GhostTable);this.hot=hotInstance;this.container=null;this.injected=false;this.rows=[];this.columns=[];this.samples=null;this.settings={useHeaders:true};}
_createClass(GhostTable,[{key:"addRow",value:function addRow(row,samples){if(this.columns.length){throw new Error('Doesn\'t support multi-dimensional table');}
if(!this.rows.length){this.container=this.createContainer(this.hot.rootElement.className);}
var rowObject={row:row};this.rows.push(rowObject);this.samples=samples;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tr.appendChild(this.createRow(row));this.container.container.appendChild(this.table.fragment);rowObject.table=this.table.table;}},{key:"addColumnHeadersRow",value:function addColumnHeadersRow(samples){var colHeader=this.hot.getColHeader(0);if(colHeader!==null&&colHeader!==void 0){var rowObject={row:-1};this.rows.push(rowObject);this.container=this.createContainer(this.hot.rootElement.className);this.samples=samples;this.table=this.createTable(this.hot.table.className);this.table.colGroup.appendChild(this.createColGroupsCol());this.table.tHead.appendChild(this.createColumnHeadersRow());this.container.container.appendChild(this.table.fragment);rowObject.table=this.table.table;}}},{key:"addColumn",value:function addColumn(column,samples){if(this.rows.length){throw new Error('Doesn\'t support multi-dimensional table');}
if(!this.columns.length){this.container=this.createContainer(this.hot.rootElement.className);}
var columnObject={col:column};this.columns.push(columnObject);this.samples=samples;this.table=this.createTable(this.hot.table.className);if(this.getSetting('useHeaders')&&this.hot.getColHeader(column)!==null){this.hot.view.appendColHeader(column,this.table.th);}
this.table.tBody.appendChild(this.createCol(column));this.container.container.appendChild(this.table.fragment);columnObject.table=this.table.table;}},{key:"getHeights",value:function getHeights(callback){if(!this.injected){this.injectTable();}
(0,_array.arrayEach)(this.rows,function(row){callback(row.row,(0,_element.outerHeight)(row.table)-1);});}},{key:"getWidths",value:function getWidths(callback){if(!this.injected){this.injectTable();}
(0,_array.arrayEach)(this.columns,function(column){callback(column.col,(0,_element.outerWidth)(column.table));});}},{key:"setSettings",value:function setSettings(settings){this.settings=settings;}},{key:"setSetting",value:function setSetting(name,value){if(!this.settings){this.settings={};}
this.settings[name]=value;}},{key:"getSettings",value:function getSettings(){return this.settings;}},{key:"getSetting",value:function getSetting(name){if(this.settings){return this.settings[name];}
return null;}},{key:"createColGroupsCol",value:function createColGroupsCol(){var _this=this;var d=document;var fragment=d.createDocumentFragment();if(this.hot.hasRowHeaders()){fragment.appendChild(this.createColElement(-1));}
this.samples.forEach(function(sample){(0,_array.arrayEach)(sample.strings,function(string){fragment.appendChild(_this.createColElement(string.col));});});return fragment;}},{key:"createRow",value:function createRow(row){var _this2=this;var d=document;var fragment=d.createDocumentFragment();var th=d.createElement('th');if(this.hot.hasRowHeaders()){this.hot.view.appendRowHeader(row,th);fragment.appendChild(th);}
this.samples.forEach(function(sample){(0,_array.arrayEach)(sample.strings,function(string){var column=string.col;var cellProperties=_this2.hot.getCellMeta(row,column);cellProperties.col=column;cellProperties.row=row;var renderer=_this2.hot.getCellRenderer(cellProperties);var td=d.createElement('td');renderer(_this2.hot,td,row,column,_this2.hot.colToProp(column),string.value,cellProperties);fragment.appendChild(td);});});return fragment;}},{key:"createColumnHeadersRow",value:function createColumnHeadersRow(){var _this3=this;var d=document;var fragment=d.createDocumentFragment();if(this.hot.hasRowHeaders()){var th=d.createElement('th');this.hot.view.appendColHeader(-1,th);fragment.appendChild(th);}
this.samples.forEach(function(sample){(0,_array.arrayEach)(sample.strings,function(string){var column=string.col;var th=d.createElement('th');_this3.hot.view.appendColHeader(column,th);fragment.appendChild(th);});});return fragment;}},{key:"createCol",value:function createCol(column){var _this4=this;var d=document;var fragment=d.createDocumentFragment();this.samples.forEach(function(sample){(0,_array.arrayEach)(sample.strings,function(string){var row=string.row;var cellProperties=_this4.hot.getCellMeta(row,column);cellProperties.col=column;cellProperties.row=row;var renderer=_this4.hot.getCellRenderer(cellProperties);var td=d.createElement('td');var tr=d.createElement('tr');td.setAttribute('ghost-table',1);renderer(_this4.hot,td,row,column,_this4.hot.colToProp(column),string.value,cellProperties);tr.appendChild(td);fragment.appendChild(tr);});});return fragment;}},{key:"clean",value:function clean(){this.rows.length=0;this.rows[-1]=void 0;this.columns.length=0;if(this.samples){this.samples.clear();}
this.samples=null;this.removeTable();}},{key:"injectTable",value:function injectTable(){var parent=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!this.injected){(parent||this.hot.rootElement).appendChild(this.container.fragment);this.injected=true;}}},{key:"removeTable",value:function removeTable(){if(this.injected&&this.container.container.parentNode){this.container.container.parentNode.removeChild(this.container.container);this.container=null;this.injected=false;}}},{key:"createColElement",value:function createColElement(column){var d=document;var col=d.createElement('col');col.style.width="".concat(this.hot.view.wt.wtTable.getStretchedColumnWidth(column),"px");return col;}},{key:"createTable",value:function createTable(){var className=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var d=document;var fragment=d.createDocumentFragment();var table=d.createElement('table');var tHead=d.createElement('thead');var tBody=d.createElement('tbody');var colGroup=d.createElement('colgroup');var tr=d.createElement('tr');var th=d.createElement('th');if(this.isVertical()){table.appendChild(colGroup);}
if(this.isHorizontal()){tr.appendChild(th);tHead.appendChild(tr);table.style.tableLayout='auto';table.style.width='auto';}
table.appendChild(tHead);if(this.isVertical()){tBody.appendChild(tr);}
table.appendChild(tBody);(0,_element.addClass)(table,className);fragment.appendChild(table);return{fragment:fragment,table:table,tHead:tHead,tBody:tBody,colGroup:colGroup,tr:tr,th:th};}},{key:"createContainer",value:function createContainer(){var className=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var d=document;var fragment=d.createDocumentFragment();var container=d.createElement('div');var containerClassName="htGhostTable htAutoSize ".concat(className.trim());(0,_element.addClass)(container,containerClassName);fragment.appendChild(container);return{fragment:fragment,container:container};}},{key:"isVertical",value:function isVertical(){return!!(this.rows.length&&!this.columns.length);}},{key:"isHorizontal",value:function isHorizontal(){return!!(this.columns.length&&!this.rows.length);}}]);return GhostTable;}();var _default=GhostTable;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _array=__webpack_require__(3);var _object=__webpack_require__(2);var _number=__webpack_require__(9);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
var MIXIN_NAME='arrayMapper';var arrayMapper={_arrayMap:[],getValueByIndex:function getValueByIndex(physicalIndex){var length=this._arrayMap.length;var translatedIndex=null;if(physicalIndex<length){translatedIndex=this._arrayMap[physicalIndex];}
return translatedIndex;},getIndexByValue:function getIndexByValue(translatedIndex){var physicalIndex;return(physicalIndex=this._arrayMap.indexOf(translatedIndex))===-1?null:physicalIndex;},insertItems:function insertItems(physicalIndex){var _this=this;var amount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var newIndex=(0,_array.arrayMax)(this._arrayMap)+1;var addedItems=[];(0,_number.rangeEach)(amount-1,function(count){addedItems.push(_this._arrayMap.splice(physicalIndex+count,0,newIndex+count));});return addedItems;},removeItems:function removeItems(physicalIndex){var amount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var removedItems=[];if(Array.isArray(physicalIndex)){var mapCopy=[].concat(this._arrayMap);physicalIndex.sort(function(a,b){return b-a;});for(var i=0,length=physicalIndex.length;i<length;i++){var indexToRemove=physicalIndex[i];this._arrayMap.splice(indexToRemove,1);removedItems.push(mapCopy[indexToRemove]);}}else{removedItems=this._arrayMap.splice(physicalIndex,amount);}
return removedItems;},unshiftItems:function unshiftItems(physicalIndex){var amount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var removedItems=this.removeItems(physicalIndex,amount);function countRowShift(logicalRow){return(0,_array.arrayReduce)(removedItems,function(count,removedLogicalRow){var result=count;if(logicalRow>removedLogicalRow){result+=1;}
return result;},0);}
this._arrayMap=(0,_array.arrayMap)(this._arrayMap,function(logicalRow){var logicalRowIndex=logicalRow;var rowShift=countRowShift(logicalRowIndex);if(rowShift){logicalRowIndex-=rowShift;}
return logicalRowIndex;});},shiftItems:function shiftItems(physicalIndex){var _this2=this;var amount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this._arrayMap=(0,_array.arrayMap)(this._arrayMap,function(row){var physicalRowIndex=row;if(physicalRowIndex>=physicalIndex){physicalRowIndex+=amount;}
return physicalRowIndex;});(0,_number.rangeEach)(amount-1,function(count){_this2._arrayMap.splice(physicalIndex+count,0,physicalIndex+count);});},swapIndexes:function swapIndexes(physicalIndexFrom,physicalIndexTo){var _this$_arrayMap;(_this$_arrayMap=this._arrayMap).splice.apply(_this$_arrayMap,[physicalIndexTo,0].concat(_toConsumableArray(this._arrayMap.splice(physicalIndexFrom,1))));},clearMap:function clearMap(){this._arrayMap.length=0;}};(0,_object.defineGetter)(arrayMapper,'MIXIN_NAME',MIXIN_NAME,{writable:false,enumerable:false});var _default=arrayMapper;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=separatorItem;exports.KEY=void 0;var KEY='---------';exports.KEY=KEY;function separatorItem(){return{name:KEY};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.predefinedItems=predefinedItems;exports.addItem=addItem;exports.ITEMS=exports.UNDO=exports.SEPARATOR=exports.ROW_BELOW=exports.ROW_ABOVE=exports.REMOVE_ROW=exports.REMOVE_COLUMN=exports.REDO=exports.READ_ONLY=exports.COLUMN_RIGHT=exports.COLUMN_LEFT=exports.CLEAR_COLUMN=exports.ALIGNMENT=void 0;var _object=__webpack_require__(2);var _alignment=_interopRequireWildcard(__webpack_require__(689));exports.ALIGNMENT=_alignment.KEY;var _clearColumn=_interopRequireWildcard(__webpack_require__(690));exports.CLEAR_COLUMN=_clearColumn.KEY;var _columnLeft=_interopRequireWildcard(__webpack_require__(691));exports.COLUMN_LEFT=_columnLeft.KEY;var _columnRight=_interopRequireWildcard(__webpack_require__(692));exports.COLUMN_RIGHT=_columnRight.KEY;var _readOnly=_interopRequireWildcard(__webpack_require__(693));exports.READ_ONLY=_readOnly.KEY;var _redo=_interopRequireWildcard(__webpack_require__(694));exports.REDO=_redo.KEY;var _removeColumn=_interopRequireWildcard(__webpack_require__(695));exports.REMOVE_COLUMN=_removeColumn.KEY;var _removeRow=_interopRequireWildcard(__webpack_require__(696));exports.REMOVE_ROW=_removeRow.KEY;var _rowAbove=_interopRequireWildcard(__webpack_require__(697));exports.ROW_ABOVE=_rowAbove.KEY;var _rowBelow=_interopRequireWildcard(__webpack_require__(698));exports.ROW_BELOW=_rowBelow.KEY;var _separator=_interopRequireWildcard(__webpack_require__(126));exports.SEPARATOR=_separator.KEY;var _undo=_interopRequireWildcard(__webpack_require__(699));exports.UNDO=_undo.KEY;var _predefinedItems2;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
var ITEMS=[_rowAbove.KEY,_rowBelow.KEY,_columnLeft.KEY,_columnRight.KEY,_clearColumn.KEY,_removeRow.KEY,_removeColumn.KEY,_undo.KEY,_redo.KEY,_readOnly.KEY,_alignment.KEY,_separator.KEY];exports.ITEMS=ITEMS;var _predefinedItems=(_predefinedItems2={},_defineProperty(_predefinedItems2,_separator.KEY,_separator.default),_defineProperty(_predefinedItems2,_rowAbove.KEY,_rowAbove.default),_defineProperty(_predefinedItems2,_rowBelow.KEY,_rowBelow.default),_defineProperty(_predefinedItems2,_columnLeft.KEY,_columnLeft.default),_defineProperty(_predefinedItems2,_columnRight.KEY,_columnRight.default),_defineProperty(_predefinedItems2,_clearColumn.KEY,_clearColumn.default),_defineProperty(_predefinedItems2,_removeRow.KEY,_removeRow.default),_defineProperty(_predefinedItems2,_removeColumn.KEY,_removeColumn.default),_defineProperty(_predefinedItems2,_undo.KEY,_undo.default),_defineProperty(_predefinedItems2,_redo.KEY,_redo.default),_defineProperty(_predefinedItems2,_readOnly.KEY,_readOnly.default),_defineProperty(_predefinedItems2,_alignment.KEY,_alignment.default),_predefinedItems2);function predefinedItems(){var items={};(0,_object.objectEach)(_predefinedItems,function(itemFactory,key){items[key]=itemFactory();});return items;}
function addItem(key,item){if(ITEMS.indexOf(key)===-1){_predefinedItems[key]=item;}}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _index=__webpack_require__(8);var _templateLiteralTag=__webpack_require__(58);function _templateObject4(){var data=_taggedTemplateLiteral(["The merged cell declared at [",", ","] has \"rowspan\" or \"colspan\" declared as \n      \"0\", which is not supported. It cannot be added to the collection."]);_templateObject4=function _templateObject4(){return data;};return data;}
function _templateObject3(){var data=_taggedTemplateLiteral(["The merged cell declared at [",", ","] has both \"rowspan\" \n     and \"colspan\" declared as \"1\", which makes it a single cell. It cannot be added to the collection."]);_templateObject3=function _templateObject3(){return data;};return data;}
function _templateObject2(){var data=_taggedTemplateLiteral(["The merged cell declared at [",", ","] is positioned (or positioned partially) \n       outside of the table range. It was not added to the table, please fix your setup."]);_templateObject2=function _templateObject2(){return data;};return data;}
function _templateObject(){var data=_taggedTemplateLiteral(["The merged cell declared with {row: ",", col: ",", rowspan: \n    ",", colspan: ","} contains negative values, which is not supported. It \n    will not be added to the collection."]);_templateObject=function _templateObject(){return data;};return data;}
function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0);}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var MergedCellCoords=function(){function MergedCellCoords(row,column,rowspan,colspan){_classCallCheck(this,MergedCellCoords);this.row=row;this.col=column;this.rowspan=rowspan;this.colspan=colspan;this.removed=false;}
_createClass(MergedCellCoords,[{key:"normalize",value:function normalize(hotInstance){var totalRows=hotInstance.countRows();var totalColumns=hotInstance.countCols();if(this.row<0){this.row=0;}else if(this.row>totalRows-1){this.row=totalRows-1;}
if(this.col<0){this.col=0;}else if(this.col>totalColumns-1){this.col=totalColumns-1;}
if(this.row+this.rowspan>totalRows-1){this.rowspan=totalRows-this.row;}
if(this.col+this.colspan>totalColumns-1){this.colspan=totalColumns-this.col;}}},{key:"includes",value:function includes(row,column){return this.row<=row&&this.col<=column&&this.row+this.rowspan-1>=row&&this.col+this.colspan-1>=column;}},{key:"includesHorizontally",value:function includesHorizontally(column){return this.col<=column&&this.col+this.colspan-1>=column;}},{key:"includesVertically",value:function includesVertically(row){return this.row<=row&&this.row+this.rowspan-1>=row;}},{key:"shift",value:function shift(shiftVector,indexOfChange){var shiftValue=shiftVector[0]||shiftVector[1];var shiftedIndex=indexOfChange+Math.abs(shiftVector[0]||shiftVector[1])-1;var span=shiftVector[0]?'colspan':'rowspan';var index=shiftVector[0]?'col':'row';var changeStart=Math.min(indexOfChange,shiftedIndex);var changeEnd=Math.max(indexOfChange,shiftedIndex);var mergeStart=this[index];var mergeEnd=this[index]+this[span]-1;if(mergeStart>=indexOfChange){this[index]+=shiftValue;}
if(shiftValue>0){if(indexOfChange<=mergeEnd&&indexOfChange>mergeStart){this[span]+=shiftValue;}}else if(shiftValue<0){if(changeStart<=mergeStart&&changeEnd>=mergeEnd){this.removed=true;return false;}else if(mergeStart>=changeStart&&mergeStart<=changeEnd){var removedOffset=changeEnd-mergeStart+1;var preRemovedOffset=Math.abs(shiftValue)-removedOffset;this[index]-=preRemovedOffset+shiftValue;this[span]-=removedOffset;}else if(mergeStart<=changeStart&&mergeEnd>=changeEnd){this[span]+=shiftValue;}else if(mergeStart<=changeStart&&mergeEnd>=changeStart&&mergeEnd<changeEnd){var removedPart=mergeEnd-changeStart+1;this[span]-=removedPart;}}
return true;}},{key:"isFarther",value:function isFarther(mergedCell,direction){if(!mergedCell){return true;}
if(direction==='down'){return mergedCell.row+mergedCell.rowspan-1<this.row+this.rowspan-1;}else if(direction==='up'){return mergedCell.row>this.row;}else if(direction==='right'){return mergedCell.col+mergedCell.colspan-1<this.col+this.colspan-1;}else if(direction==='left'){return mergedCell.col>this.col;}
return null;}},{key:"getLastRow",value:function getLastRow(){return this.row+this.rowspan-1;}},{key:"getLastColumn",value:function getLastColumn(){return this.col+this.colspan-1;}},{key:"getRange",value:function getRange(){return new _index.CellRange(new _index.CellCoords(this.row,this.col),new _index.CellCoords(this.row,this.col),new _index.CellCoords(this.getLastRow(),this.getLastColumn()));}}],[{key:"NEGATIVE_VALUES_WARNING",value:function NEGATIVE_VALUES_WARNING(newMergedCell){return(0,_templateLiteralTag.toSingleLine)(_templateObject(),newMergedCell.row,newMergedCell.col,newMergedCell.rowspan,newMergedCell.colspan);}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function IS_OUT_OF_BOUNDS_WARNING(newMergedCell){return(0,_templateLiteralTag.toSingleLine)(_templateObject2(),newMergedCell.row,newMergedCell.col);}},{key:"IS_SINGLE_CELL",value:function IS_SINGLE_CELL(newMergedCell){return(0,_templateLiteralTag.toSingleLine)(_templateObject3(),newMergedCell.row,newMergedCell.col);}},{key:"ZERO_SPAN_WARNING",value:function ZERO_SPAN_WARNING(newMergedCell){return(0,_templateLiteralTag.toSingleLine)(_templateObject4(),newMergedCell.row,newMergedCell.col);}},{key:"containsNegativeValues",value:function containsNegativeValues(mergedCellInfo){return mergedCellInfo.row<0||mergedCellInfo.col<0||mergedCellInfo.rowspan<0||mergedCellInfo.colspan<0;}},{key:"isSingleCell",value:function isSingleCell(mergedCellInfo){return mergedCellInfo.colspan===1&&mergedCellInfo.rowspan===1;}},{key:"containsZeroSpan",value:function containsZeroSpan(mergedCellInfo){return mergedCellInfo.colspan===0||mergedCellInfo.rowspan===0;}},{key:"isOutOfBounds",value:function isOutOfBounds(mergeCell,rowCount,columnCount){return mergeCell.row<0||mergeCell.col<0||mergeCell.row>=rowCount||mergeCell.row+mergeCell.rowspan-1>=rowCount||mergeCell.col>=columnCount||mergeCell.col+mergeCell.colspan-1>=columnCount;}}]);return MergedCellCoords;}();var _default=MergedCellCoords;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(438);__webpack_require__(581);__webpack_require__(583);__webpack_require__(585);__webpack_require__(587);__webpack_require__(589);__webpack_require__(591);__webpack_require__(593);__webpack_require__(595);__webpack_require__(597);__webpack_require__(601);}),(function(module,exports,__webpack_require__){module.exports=!__webpack_require__(20)&&!__webpack_require__(4)(function(){return Object.defineProperty(__webpack_require__(92)('div'),'a',{get:function(){return 7;}}).a!=7;});}),(function(module,exports,__webpack_require__){var global=__webpack_require__(6);var core=__webpack_require__(21);var LIBRARY=__webpack_require__(52);var wksExt=__webpack_require__(94);var defineProperty=__webpack_require__(17).f;module.exports=function(name){var $Symbol=core.Symbol||(core.Symbol=LIBRARY?{}:global.Symbol||{});if(name.charAt(0)!='_'&&!(name in $Symbol))defineProperty($Symbol,name,{value:wksExt.f(name)});};}),(function(module,exports,__webpack_require__){var has=__webpack_require__(27);var toIObject=__webpack_require__(29);var arrayIndexOf=__webpack_require__(79)(false);var IE_PROTO=__webpack_require__(95)('IE_PROTO');module.exports=function(object,names){var O=toIObject(object);var i=0;var result=[];var key;for(key in O)if(key!=IE_PROTO)has(O,key)&&result.push(key);while(names.length>i)if(has(O,key=names[i++])){~arrayIndexOf(result,key)||result.push(key);}
return result;};}),(function(module,exports,__webpack_require__){var dP=__webpack_require__(17);var anObject=__webpack_require__(5);var getKeys=__webpack_require__(53);module.exports=__webpack_require__(20)?Object.defineProperties:function defineProperties(O,Properties){anObject(O);var keys=getKeys(Properties);var length=keys.length;var i=0;var P;while(length>i)dP.f(O,P=keys[i++],Properties[P]);return O;};}),(function(module,exports,__webpack_require__){var toIObject=__webpack_require__(29);var gOPN=__webpack_require__(56).f;var toString={}.toString;var windowNames=typeof window=='object'&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var getWindowNames=function(it){try{return gOPN(it);}catch(e){return windowNames.slice();}};module.exports.f=function getOwnPropertyNames(it){return windowNames&&toString.call(it)=='[object Window]'?getWindowNames(it):gOPN(toIObject(it));};}),(function(module,exports,__webpack_require__){"use strict";var getKeys=__webpack_require__(53);var gOPS=__webpack_require__(80);var pIE=__webpack_require__(71);var toObject=__webpack_require__(24);var IObject=__webpack_require__(70);var $assign=Object.assign;module.exports=!$assign||__webpack_require__(4)(function(){var A={};var B={};var S=Symbol();var K='abcdefghijklmnopqrst';A[S]=7;K.split('').forEach(function(k){B[k]=k;});return $assign({},A)[S]!=7||Object.keys($assign({},B)).join('')!=K;})?function assign(target,source){var T=toObject(target);var aLen=arguments.length;var index=1;var getSymbols=gOPS.f;var isEnum=pIE.f;while(aLen>index){var S=IObject(arguments[index++]);var keys=getSymbols?getKeys(S).concat(getSymbols(S)):getKeys(S);var length=keys.length;var j=0;var key;while(length>j)if(isEnum.call(S,key=keys[j++]))T[key]=S[key];}return T;}:$assign;}),(function(module,exports){module.exports=Object.is||function is(x,y){return x===y?x!==0||1/x===1/y:x!=x&&y!=y;};}),(function(module,exports,__webpack_require__){"use strict";var aFunction=__webpack_require__(38);var isObject=__webpack_require__(7);var invoke=__webpack_require__(138);var arraySlice=[].slice;var factories={};var construct=function(F,len,args){if(!(len in factories)){for(var n=[],i=0;i<len;i++)n[i]='a['+i+']';factories[len]=Function('F,a','return new F('+n.join(',')+')');}return factories[len](F,args);};module.exports=Function.bind||function bind(that){var fn=aFunction(this);var partArgs=arraySlice.call(arguments,1);var bound=function(){var args=partArgs.concat(arraySlice.call(arguments));return this instanceof bound?construct(fn,args.length,args):invoke(fn,args,that);};if(isObject(fn.prototype))bound.prototype=fn.prototype;return bound;};}),(function(module,exports){module.exports=function(fn,args,that){var un=that===undefined;switch(args.length){case 0:return un?fn():fn.call(that);case 1:return un?fn(args[0]):fn.call(that,args[0]);case 2:return un?fn(args[0],args[1]):fn.call(that,args[0],args[1]);case 3:return un?fn(args[0],args[1],args[2]):fn.call(that,args[0],args[1],args[2]);case 4:return un?fn(args[0],args[1],args[2],args[3]):fn.call(that,args[0],args[1],args[2],args[3]);}return fn.apply(that,args);};}),(function(module,exports,__webpack_require__){var $parseInt=__webpack_require__(6).parseInt;var $trim=__webpack_require__(81).trim;var ws=__webpack_require__(100);var hex=/^[-+]?0[xX]/;module.exports=$parseInt(ws+'08')!==8||$parseInt(ws+'0x16')!==22?function parseInt(str,radix){var string=$trim(String(str),3);return $parseInt(string,(radix>>>0)||(hex.test(string)?16:10));}:$parseInt;}),(function(module,exports,__webpack_require__){var $parseFloat=__webpack_require__(6).parseFloat;var $trim=__webpack_require__(81).trim;module.exports=1/$parseFloat(__webpack_require__(100)+'-0')!==-Infinity?function parseFloat(str){var string=$trim(String(str),3);var result=$parseFloat(string);return result===0&&string.charAt(0)=='-'?-0:result;}:$parseFloat;}),(function(module,exports,__webpack_require__){var cof=__webpack_require__(39);module.exports=function(it,msg){if(typeof it!='number'&&cof(it)!='Number')throw TypeError(msg);return+it;};}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);var floor=Math.floor;module.exports=function isInteger(it){return!isObject(it)&&isFinite(it)&&floor(it)===it;};}),(function(module,exports){module.exports=Math.log1p||function log1p(x){return(x=+x)>-1e-8&&x<1e-8?x-x*x/2:Math.log(1+x);};}),(function(module,exports,__webpack_require__){"use strict";var create=__webpack_require__(55);var descriptor=__webpack_require__(50);var setToStringTag=__webpack_require__(60);var IteratorPrototype={};__webpack_require__(28)(IteratorPrototype,__webpack_require__(12)('iterator'),function(){return this;});module.exports=function(Constructor,NAME,next){Constructor.prototype=create(IteratorPrototype,{next:descriptor(1,next)});setToStringTag(Constructor,NAME+' Iterator');};}),(function(module,exports,__webpack_require__){var anObject=__webpack_require__(5);module.exports=function(iterator,fn,value,entries){try{return entries?fn(anObject(value)[0],value[1]):fn(value);}catch(e){var ret=iterator['return'];if(ret!==undefined)anObject(ret.call(iterator));throw e;}};}),(function(module,exports,__webpack_require__){var aFunction=__webpack_require__(38);var toObject=__webpack_require__(24);var IObject=__webpack_require__(70);var toLength=__webpack_require__(16);module.exports=function(that,callbackfn,aLen,memo,isRight){aFunction(callbackfn);var O=toObject(that);var self=IObject(O);var length=toLength(O.length);var index=isRight?length-1:0;var i=isRight?-1:1;if(aLen<2)for(;;){if(index in self){memo=self[index];index+=i;break;}
index+=i;if(isRight?index<0:length<=index){throw TypeError('Reduce of empty array with no initial value');}}
for(;isRight?index>=0:length>index;index+=i)if(index in self){memo=callbackfn(memo,self[index],index,O);}
return memo;};}),(function(module,exports,__webpack_require__){"use strict";var toObject=__webpack_require__(24);var toAbsoluteIndex=__webpack_require__(54);var toLength=__webpack_require__(16);module.exports=[].copyWithin||function copyWithin(target,start){var O=toObject(this);var len=toLength(O.length);var to=toAbsoluteIndex(target,len);var from=toAbsoluteIndex(start,len);var end=arguments.length>2?arguments[2]:undefined;var count=Math.min((end===undefined?len:toAbsoluteIndex(end,len))-from,len-to);var inc=1;if(from<to&&to<from+count){inc=-1;from+=count-1;to+=count-1;}
while(count-->0){if(from in O)O[to]=O[from];else delete O[to];to+=inc;from+=inc;}return O;};}),(function(module,exports){module.exports=function(done,value){return{value:value,done:!!done};};}),(function(module,exports,__webpack_require__){"use strict";var regexpExec=__webpack_require__(115);__webpack_require__(0)({target:'RegExp',proto:true,forced:regexpExec!==/./.exec},{exec:regexpExec});}),(function(module,exports,__webpack_require__){if(__webpack_require__(20)&&/./g.flags!='g')__webpack_require__(17).f(RegExp.prototype,'flags',{configurable:true,get:__webpack_require__(83)});}),(function(module,exports,__webpack_require__){"use strict";var LIBRARY=__webpack_require__(52);var global=__webpack_require__(6);var ctx=__webpack_require__(37);var classof=__webpack_require__(72);var $export=__webpack_require__(0);var isObject=__webpack_require__(7);var aFunction=__webpack_require__(38);var anInstance=__webpack_require__(64);var forOf=__webpack_require__(86);var speciesConstructor=__webpack_require__(73);var task=__webpack_require__(117).set;var microtask=__webpack_require__(550)();var newPromiseCapabilityModule=__webpack_require__(152);var perform=__webpack_require__(551);var userAgent=__webpack_require__(87);var promiseResolve=__webpack_require__(153);var PROMISE='Promise';var TypeError=global.TypeError;var process=global.process;var versions=process&&process.versions;var v8=versions&&versions.v8||'';var $Promise=global[PROMISE];var isNode=classof(process)=='process';var empty=function(){};var Internal,newGenericPromiseCapability,OwnPromiseCapability,Wrapper;var newPromiseCapability=newGenericPromiseCapability=newPromiseCapabilityModule.f;var USE_NATIVE=!!function(){try{var promise=$Promise.resolve(1);var FakePromise=(promise.constructor={})[__webpack_require__(12)('species')]=function(exec){exec(empty,empty);};return(isNode||typeof PromiseRejectionEvent=='function')&&promise.then(empty)instanceof FakePromise&&v8.indexOf('6.6')!==0&&userAgent.indexOf('Chrome/66')===-1;}catch(e){}}();var isThenable=function(it){var then;return isObject(it)&&typeof(then=it.then)=='function'?then:false;};var notify=function(promise,isReject){if(promise._n)return;promise._n=true;var chain=promise._c;microtask(function(){var value=promise._v;var ok=promise._s==1;var i=0;var run=function(reaction){var handler=ok?reaction.ok:reaction.fail;var resolve=reaction.resolve;var reject=reaction.reject;var domain=reaction.domain;var result,then,exited;try{if(handler){if(!ok){if(promise._h==2)onHandleUnhandled(promise);promise._h=1;}
if(handler===true)result=value;else{if(domain)domain.enter();result=handler(value);if(domain){domain.exit();exited=true;}}
if(result===reaction.promise){reject(TypeError('Promise-chain cycle'));}else if(then=isThenable(result)){then.call(result,resolve,reject);}else resolve(result);}else reject(value);}catch(e){if(domain&&!exited)domain.exit();reject(e);}};while(chain.length>i)run(chain[i++]);promise._c=[];promise._n=false;if(isReject&&!promise._h)onUnhandled(promise);});};var onUnhandled=function(promise){task.call(global,function(){var value=promise._v;var unhandled=isUnhandled(promise);var result,handler,console;if(unhandled){result=perform(function(){if(isNode){process.emit('unhandledRejection',value,promise);}else if(handler=global.onunhandledrejection){handler({promise:promise,reason:value});}else if((console=global.console)&&console.error){console.error('Unhandled promise rejection',value);}});promise._h=isNode||isUnhandled(promise)?2:1;}promise._a=undefined;if(unhandled&&result.e)throw result.v;});};var isUnhandled=function(promise){return promise._h!==1&&(promise._a||promise._c).length===0;};var onHandleUnhandled=function(promise){task.call(global,function(){var handler;if(isNode){process.emit('rejectionHandled',promise);}else if(handler=global.onrejectionhandled){handler({promise:promise,reason:promise._v});}});};var $reject=function(value){var promise=this;if(promise._d)return;promise._d=true;promise=promise._w||promise;promise._v=value;promise._s=2;if(!promise._a)promise._a=promise._c.slice();notify(promise,true);};var $resolve=function(value){var promise=this;var then;if(promise._d)return;promise._d=true;promise=promise._w||promise;try{if(promise===value)throw TypeError("Promise can't be resolved itself");if(then=isThenable(value)){microtask(function(){var wrapper={_w:promise,_d:false};try{then.call(value,ctx($resolve,wrapper,1),ctx($reject,wrapper,1));}catch(e){$reject.call(wrapper,e);}});}else{promise._v=value;promise._s=1;notify(promise,false);}}catch(e){$reject.call({_w:promise,_d:false},e);}};if(!USE_NATIVE){$Promise=function Promise(executor){anInstance(this,$Promise,PROMISE,'_h');aFunction(executor);Internal.call(this);try{executor(ctx($resolve,this,1),ctx($reject,this,1));}catch(err){$reject.call(this,err);}};Internal=function Promise(executor){this._c=[];this._a=undefined;this._s=0;this._d=false;this._v=undefined;this._h=0;this._n=false;};Internal.prototype=__webpack_require__(65)($Promise.prototype,{then:function then(onFulfilled,onRejected){var reaction=newPromiseCapability(speciesConstructor(this,$Promise));reaction.ok=typeof onFulfilled=='function'?onFulfilled:true;reaction.fail=typeof onRejected=='function'&&onRejected;reaction.domain=isNode?process.domain:undefined;this._c.push(reaction);if(this._a)this._a.push(reaction);if(this._s)notify(this,false);return reaction.promise;},'catch':function(onRejected){return this.then(undefined,onRejected);}});OwnPromiseCapability=function(){var promise=new Internal();this.promise=promise;this.resolve=ctx($resolve,promise,1);this.reject=ctx($reject,promise,1);};newPromiseCapabilityModule.f=newPromiseCapability=function(C){return C===$Promise||C===Wrapper?new OwnPromiseCapability(C):newGenericPromiseCapability(C);};}
$export($export.G+$export.W+$export.F*!USE_NATIVE,{Promise:$Promise});__webpack_require__(60)($Promise,PROMISE);__webpack_require__(63)(PROMISE);Wrapper=__webpack_require__(21)[PROMISE];$export($export.S+$export.F*!USE_NATIVE,PROMISE,{reject:function reject(r){var capability=newPromiseCapability(this);var $$reject=capability.reject;$$reject(r);return capability.promise;}});$export($export.S+$export.F*(LIBRARY||!USE_NATIVE),PROMISE,{resolve:function resolve(x){return promiseResolve(LIBRARY&&this===Wrapper?$Promise:this,x);}});$export($export.S+$export.F*!(USE_NATIVE&&__webpack_require__(82)(function(iter){$Promise.all(iter)['catch'](empty);})),PROMISE,{all:function all(iterable){var C=this;var capability=newPromiseCapability(C);var resolve=capability.resolve;var reject=capability.reject;var result=perform(function(){var values=[];var index=0;var remaining=1;forOf(iterable,false,function(promise){var $index=index++;var alreadyCalled=false;values.push(undefined);remaining++;C.resolve(promise).then(function(value){if(alreadyCalled)return;alreadyCalled=true;values[$index]=value;--remaining||resolve(values);},reject);});--remaining||resolve(values);});if(result.e)reject(result.v);return capability.promise;},race:function race(iterable){var C=this;var capability=newPromiseCapability(C);var reject=capability.reject;var result=perform(function(){forOf(iterable,false,function(promise){C.resolve(promise).then(capability.resolve,reject);});});if(result.e)reject(result.v);return capability.promise;}});}),(function(module,exports,__webpack_require__){"use strict";var aFunction=__webpack_require__(38);function PromiseCapability(C){var resolve,reject;this.promise=new C(function($$resolve,$$reject){if(resolve!==undefined||reject!==undefined)throw TypeError('Bad Promise constructor');resolve=$$resolve;reject=$$reject;});this.resolve=aFunction(resolve);this.reject=aFunction(reject);}
module.exports.f=function(C){return new PromiseCapability(C);};}),(function(module,exports,__webpack_require__){var anObject=__webpack_require__(5);var isObject=__webpack_require__(7);var newPromiseCapability=__webpack_require__(152);module.exports=function(C,x){anObject(C);if(isObject(x)&&x.constructor===C)return x;var promiseCapability=newPromiseCapability.f(C);var resolve=promiseCapability.resolve;resolve(x);return promiseCapability.promise;};}),(function(module,exports,__webpack_require__){"use strict";var dP=__webpack_require__(17).f;var create=__webpack_require__(55);var redefineAll=__webpack_require__(65);var ctx=__webpack_require__(37);var anInstance=__webpack_require__(64);var forOf=__webpack_require__(86);var $iterDefine=__webpack_require__(106);var step=__webpack_require__(148);var setSpecies=__webpack_require__(63);var DESCRIPTORS=__webpack_require__(20);var fastKey=__webpack_require__(45).fastKey;var validate=__webpack_require__(66);var SIZE=DESCRIPTORS?'_s':'size';var getEntry=function(that,key){var index=fastKey(key);var entry;if(index!=='F')return that._i[index];for(entry=that._f;entry;entry=entry.n){if(entry.k==key)return entry;}};module.exports={getConstructor:function(wrapper,NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){anInstance(that,C,NAME,'_i');that._t=NAME;that._i=create(null);that._f=undefined;that._l=undefined;that[SIZE]=0;if(iterable!=undefined)forOf(iterable,IS_MAP,that[ADDER],that);});redefineAll(C.prototype,{clear:function clear(){for(var that=validate(this,NAME),data=that._i,entry=that._f;entry;entry=entry.n){entry.r=true;if(entry.p)entry.p=entry.p.n=undefined;delete data[entry.i];}
that._f=that._l=undefined;that[SIZE]=0;},'delete':function(key){var that=validate(this,NAME);var entry=getEntry(that,key);if(entry){var next=entry.n;var prev=entry.p;delete that._i[entry.i];entry.r=true;if(prev)prev.n=next;if(next)next.p=prev;if(that._f==entry)that._f=next;if(that._l==entry)that._l=prev;that[SIZE]--;}return!!entry;},forEach:function forEach(callbackfn){validate(this,NAME);var f=ctx(callbackfn,arguments.length>1?arguments[1]:undefined,3);var entry;while(entry=entry?entry.n:this._f){f(entry.v,entry.k,this);while(entry&&entry.r)entry=entry.p;}},has:function has(key){return!!getEntry(validate(this,NAME),key);}});if(DESCRIPTORS)dP(C.prototype,'size',{get:function(){return validate(this,NAME)[SIZE];}});return C;},def:function(that,key,value){var entry=getEntry(that,key);var prev,index;if(entry){entry.v=value;}else{that._l=entry={i:index=fastKey(key,true),k:key,v:value,p:prev=that._l,n:undefined,r:false};if(!that._f)that._f=entry;if(prev)prev.n=entry;that[SIZE]++;if(index!=='F')that._i[index]=entry;}return that;},getEntry:getEntry,setStrong:function(C,NAME,IS_MAP){$iterDefine(C,NAME,function(iterated,kind){this._t=validate(iterated,NAME);this._k=kind;this._l=undefined;},function(){var that=this;var kind=that._k;var entry=that._l;while(entry&&entry.r)entry=entry.p;if(!that._t||!(that._l=entry=entry?entry.n:that._t._f)){that._t=undefined;return step(1);}
if(kind=='keys')return step(0,entry.k);if(kind=='values')return step(0,entry.v);return step(0,[entry.k,entry.v]);},IS_MAP?'entries':'values',!IS_MAP,true);setSpecies(NAME);}};}),(function(module,exports,__webpack_require__){"use strict";var redefineAll=__webpack_require__(65);var getWeak=__webpack_require__(45).getWeak;var anObject=__webpack_require__(5);var isObject=__webpack_require__(7);var anInstance=__webpack_require__(64);var forOf=__webpack_require__(86);var createArrayMethod=__webpack_require__(36);var $has=__webpack_require__(27);var validate=__webpack_require__(66);var arrayFind=createArrayMethod(5);var arrayFindIndex=createArrayMethod(6);var id=0;var uncaughtFrozenStore=function(that){return that._l||(that._l=new UncaughtFrozenStore());};var UncaughtFrozenStore=function(){this.a=[];};var findUncaughtFrozen=function(store,key){return arrayFind(store.a,function(it){return it[0]===key;});};UncaughtFrozenStore.prototype={get:function(key){var entry=findUncaughtFrozen(this,key);if(entry)return entry[1];},has:function(key){return!!findUncaughtFrozen(this,key);},set:function(key,value){var entry=findUncaughtFrozen(this,key);if(entry)entry[1]=value;else this.a.push([key,value]);},'delete':function(key){var index=arrayFindIndex(this.a,function(it){return it[0]===key;});if(~index)this.a.splice(index,1);return!!~index;}};module.exports={getConstructor:function(wrapper,NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){anInstance(that,C,NAME,'_i');that._t=NAME;that._i=id++;that._l=undefined;if(iterable!=undefined)forOf(iterable,IS_MAP,that[ADDER],that);});redefineAll(C.prototype,{'delete':function(key){if(!isObject(key))return false;var data=getWeak(key);if(data===true)return uncaughtFrozenStore(validate(this,NAME))['delete'](key);return data&&$has(data,this._i)&&delete data[this._i];},has:function has(key){if(!isObject(key))return false;var data=getWeak(key);if(data===true)return uncaughtFrozenStore(validate(this,NAME)).has(key);return data&&$has(data,this._i);}});return C;},def:function(that,key,value){var data=getWeak(anObject(key),true);if(data===true)uncaughtFrozenStore(that).set(key,value);else data[that._i]=value;return that;},ufstore:uncaughtFrozenStore};}),(function(module,exports,__webpack_require__){var toInteger=__webpack_require__(33);var toLength=__webpack_require__(16);module.exports=function(it){if(it===undefined)return 0;var number=toInteger(it);var length=toLength(number);if(number!==length)throw RangeError('Wrong length!');return length;};}),(function(module,exports,__webpack_require__){var gOPN=__webpack_require__(56);var gOPS=__webpack_require__(80);var anObject=__webpack_require__(5);var Reflect=__webpack_require__(6).Reflect;module.exports=Reflect&&Reflect.ownKeys||function ownKeys(it){var keys=gOPN.f(anObject(it));var getSymbols=gOPS.f;return getSymbols?keys.concat(getSymbols(it)):keys;};}),(function(module,exports,__webpack_require__){var toLength=__webpack_require__(16);var repeat=__webpack_require__(102);var defined=__webpack_require__(40);module.exports=function(that,maxLength,fillString,left){var S=String(defined(that));var stringLength=S.length;var fillStr=fillString===undefined?' ':String(fillString);var intMaxLength=toLength(maxLength);if(intMaxLength<=stringLength||fillStr=='')return S;var fillLen=intMaxLength-stringLength;var stringFiller=repeat.call(fillStr,Math.ceil(fillLen/fillStr.length));if(stringFiller.length>fillLen)stringFiller=stringFiller.slice(0,fillLen);return left?stringFiller+S:S+stringFiller;};}),(function(module,exports,__webpack_require__){var getKeys=__webpack_require__(53);var toIObject=__webpack_require__(29);var isEnum=__webpack_require__(71).f;module.exports=function(isEntries){return function(it){var O=toIObject(it);var keys=getKeys(O);var length=keys.length;var i=0;var result=[];var key;while(length>i)if(isEnum.call(O,key=keys[i++])){result.push(isEntries?[key,O[key]]:O[key]);}return result;};};}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var privatePool=new WeakMap();var ViewportColumnsCalculator=function(){_createClass(ViewportColumnsCalculator,null,[{key:"DEFAULT_WIDTH",get:function get(){return 50;}}]);function ViewportColumnsCalculator(viewportWidth,scrollOffset,totalColumns,columnWidthFn,overrideFn,onlyFullyVisible,stretchH){var stretchingColumnWidthFn=arguments.length>7&&arguments[7]!==undefined?arguments[7]:function(width){return width;};_classCallCheck(this,ViewportColumnsCalculator);privatePool.set(this,{viewportWidth:viewportWidth,scrollOffset:scrollOffset,totalColumns:totalColumns,columnWidthFn:columnWidthFn,overrideFn:overrideFn,onlyFullyVisible:onlyFullyVisible,stretchingColumnWidthFn:stretchingColumnWidthFn});this.count=0;this.startColumn=null;this.endColumn=null;this.startPosition=null;this.stretchAllRatio=0;this.stretchLastWidth=0;this.stretch=stretchH;this.totalTargetWidth=0;this.needVerifyLastColumnWidth=true;this.stretchAllColumnsWidth=[];this.calculate();}
_createClass(ViewportColumnsCalculator,[{key:"calculate",value:function calculate(){var sum=0;var needReverse=true;var startPositions=[];var columnWidth;var priv=privatePool.get(this);var onlyFullyVisible=priv.onlyFullyVisible;var overrideFn=priv.overrideFn;var scrollOffset=priv.scrollOffset;var totalColumns=priv.totalColumns;var viewportWidth=priv.viewportWidth;for(var i=0;i<totalColumns;i++){columnWidth=this._getColumnWidth(i);if(sum<=scrollOffset&&!onlyFullyVisible){this.startColumn=i;}
var compensatedViewportWidth=scrollOffset>0?viewportWidth+1:viewportWidth;if(sum>=scrollOffset&&sum+columnWidth<=scrollOffset+compensatedViewportWidth){if(this.startColumn===null||this.startColumn===void 0){this.startColumn=i;}
this.endColumn=i;}
startPositions.push(sum);sum+=columnWidth;if(!onlyFullyVisible){this.endColumn=i;}
if(sum>=scrollOffset+viewportWidth){needReverse=false;break;}}
if(this.endColumn===totalColumns-1&&needReverse){this.startColumn=this.endColumn;while(this.startColumn>0){var viewportSum=startPositions[this.endColumn]+columnWidth-startPositions[this.startColumn-1];if(viewportSum<=viewportWidth||!onlyFullyVisible){this.startColumn-=1;}
if(viewportSum>viewportWidth){break;}}}
if(this.startColumn!==null&&overrideFn){overrideFn(this);}
this.startPosition=startPositions[this.startColumn];if(this.startPosition===void 0){this.startPosition=null;}
if(this.startColumn!==null){this.count=this.endColumn-this.startColumn+1;}}},{key:"refreshStretching",value:function refreshStretching(totalWidth){if(this.stretch==='none'){return;}
var totalColumnsWidth=totalWidth;this.totalTargetWidth=totalColumnsWidth;var priv=privatePool.get(this);var totalColumns=priv.totalColumns;var sumAll=0;for(var i=0;i<totalColumns;i++){var columnWidth=this._getColumnWidth(i);var permanentColumnWidth=priv.stretchingColumnWidthFn(void 0,i);if(typeof permanentColumnWidth==='number'){totalColumnsWidth-=permanentColumnWidth;}else{sumAll+=columnWidth;}}
var remainingSize=totalColumnsWidth-sumAll;if(this.stretch==='all'&&remainingSize>0){this.stretchAllRatio=totalColumnsWidth/sumAll;this.stretchAllColumnsWidth=[];this.needVerifyLastColumnWidth=true;}else if(this.stretch==='last'&&totalColumnsWidth!==Infinity){var _columnWidth=this._getColumnWidth(totalColumns-1);var lastColumnWidth=remainingSize+_columnWidth;this.stretchLastWidth=lastColumnWidth>=0?lastColumnWidth:_columnWidth;}}},{key:"getStretchedColumnWidth",value:function getStretchedColumnWidth(column,baseWidth){var result=null;if(this.stretch==='all'&&this.stretchAllRatio!==0){result=this._getStretchedAllColumnWidth(column,baseWidth);}else if(this.stretch==='last'&&this.stretchLastWidth!==0){result=this._getStretchedLastColumnWidth(column);}
return result;}},{key:"_getStretchedAllColumnWidth",value:function _getStretchedAllColumnWidth(column,baseWidth){var sumRatioWidth=0;var priv=privatePool.get(this);var totalColumns=priv.totalColumns;if(!this.stretchAllColumnsWidth[column]){var stretchedWidth=Math.round(baseWidth*this.stretchAllRatio);var newStretchedWidth=priv.stretchingColumnWidthFn(stretchedWidth,column);if(newStretchedWidth===void 0){this.stretchAllColumnsWidth[column]=stretchedWidth;}else{this.stretchAllColumnsWidth[column]=isNaN(newStretchedWidth)?this._getColumnWidth(column):newStretchedWidth;}}
if(this.stretchAllColumnsWidth.length===totalColumns&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=false;for(var i=0;i<this.stretchAllColumnsWidth.length;i++){sumRatioWidth+=this.stretchAllColumnsWidth[i];}
if(sumRatioWidth!==this.totalTargetWidth){this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-sumRatioWidth;}}
return this.stretchAllColumnsWidth[column];}},{key:"_getStretchedLastColumnWidth",value:function _getStretchedLastColumnWidth(column){var priv=privatePool.get(this);var totalColumns=priv.totalColumns;if(column===totalColumns-1){return this.stretchLastWidth;}
return null;}},{key:"_getColumnWidth",value:function _getColumnWidth(column){var width=privatePool.get(this).columnWidthFn(column);if(isNaN(width)){width=ViewportColumnsCalculator.DEFAULT_WIDTH;}
return width;}}]);return ViewportColumnsCalculator;}();var _default=ViewportColumnsCalculator;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var privatePool=new WeakMap();var ViewportRowsCalculator=function(){_createClass(ViewportRowsCalculator,null,[{key:"DEFAULT_HEIGHT",get:function get(){return 23;}}]);function ViewportRowsCalculator(viewportHeight,scrollOffset,totalRows,rowHeightFn,overrideFn,onlyFullyVisible,horizontalScrollbarHeight){_classCallCheck(this,ViewportRowsCalculator);privatePool.set(this,{viewportHeight:viewportHeight,scrollOffset:scrollOffset,totalRows:totalRows,rowHeightFn:rowHeightFn,overrideFn:overrideFn,onlyFullyVisible:onlyFullyVisible,horizontalScrollbarHeight:horizontalScrollbarHeight});this.count=0;this.startRow=null;this.endRow=null;this.startPosition=null;this.calculate();}
_createClass(ViewportRowsCalculator,[{key:"calculate",value:function calculate(){var sum=0;var needReverse=true;var startPositions=[];var priv=privatePool.get(this);var onlyFullyVisible=priv.onlyFullyVisible;var overrideFn=priv.overrideFn;var rowHeightFn=priv.rowHeightFn;var scrollOffset=priv.scrollOffset;var totalRows=priv.totalRows;var viewportHeight=priv.viewportHeight;var horizontalScrollbarHeight=priv.horizontalScrollbarHeight||0;var rowHeight;for(var i=0;i<totalRows;i++){rowHeight=rowHeightFn(i);if(isNaN(rowHeight)){rowHeight=ViewportRowsCalculator.DEFAULT_HEIGHT;}
if(sum<=scrollOffset&&!onlyFullyVisible){this.startRow=i;}
if(sum>=scrollOffset&&sum+rowHeight<=scrollOffset+viewportHeight-horizontalScrollbarHeight){if(this.startRow===null){this.startRow=i;}
this.endRow=i;}
startPositions.push(sum);sum+=rowHeight;if(!onlyFullyVisible){this.endRow=i;}
if(sum>=scrollOffset+viewportHeight-horizontalScrollbarHeight){needReverse=false;break;}}
if(this.endRow===totalRows-1&&needReverse){this.startRow=this.endRow;while(this.startRow>0){var viewportSum=startPositions[this.endRow]+rowHeight-startPositions[this.startRow-1];if(viewportSum<=viewportHeight-horizontalScrollbarHeight||!onlyFullyVisible){this.startRow-=1;}
if(viewportSum>=viewportHeight-horizontalScrollbarHeight){break;}}}
if(this.startRow!==null&&overrideFn){overrideFn(this);}
this.startPosition=startPositions[this.startRow];if(this.startPosition===void 0){this.startPosition=null;}
if(this.startRow!==null){this.count=this.endRow-this.startRow+1;}}}]);return ViewportRowsCalculator;}();var _default=ViewportRowsCalculator;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _coords=_interopRequireDefault(__webpack_require__(75));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var CellRange=function(){function CellRange(highlight){var from=arguments.length>1&&arguments[1]!==undefined?arguments[1]:highlight;var to=arguments.length>2&&arguments[2]!==undefined?arguments[2]:highlight;_classCallCheck(this,CellRange);this.highlight=highlight;this.from=from;this.to=to;}
_createClass(CellRange,[{key:"setHighlight",value:function setHighlight(coords){this.highlight=coords;return this;}},{key:"setFrom",value:function setFrom(coords){this.from=coords;return this;}},{key:"setTo",value:function setTo(coords){this.to=coords;return this;}},{key:"isValid",value:function isValid(wot){return this.from.isValid(wot)&&this.to.isValid(wot);}},{key:"isSingle",value:function isSingle(){return this.from.row===this.to.row&&this.from.col===this.to.col;}},{key:"getHeight",value:function getHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1;}},{key:"getWidth",value:function getWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1;}},{key:"includes",value:function includes(cellCoords){var row=cellCoords.row,col=cellCoords.col;var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();return topLeft.row<=row&&bottomRight.row>=row&&topLeft.col<=col&&bottomRight.col>=col;}},{key:"includesRange",value:function includesRange(cellRange){return this.includes(cellRange.getTopLeftCorner())&&this.includes(cellRange.getBottomRightCorner());}},{key:"isEqual",value:function isEqual(cellRange){return Math.min(this.from.row,this.to.row)===Math.min(cellRange.from.row,cellRange.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(cellRange.from.row,cellRange.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(cellRange.from.col,cellRange.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(cellRange.from.col,cellRange.to.col);}},{key:"overlaps",value:function overlaps(cellRange){return cellRange.isSouthEastOf(this.getTopLeftCorner())&&cellRange.isNorthWestOf(this.getBottomRightCorner());}},{key:"isSouthEastOf",value:function isSouthEastOf(cellRange){return this.getTopLeftCorner().isSouthEastOf(cellRange)||this.getBottomRightCorner().isSouthEastOf(cellRange);}},{key:"isNorthWestOf",value:function isNorthWestOf(cellRange){return this.getTopLeftCorner().isNorthWestOf(cellRange)||this.getBottomRightCorner().isNorthWestOf(cellRange);}},{key:"isOverlappingHorizontally",value:function isOverlappingHorizontally(cellRange){return this.getTopRightCorner().col>=cellRange.getTopLeftCorner().col&&this.getTopRightCorner().col<=cellRange.getTopRightCorner().col||this.getTopLeftCorner().col<=cellRange.getTopRightCorner().col&&this.getTopLeftCorner().col>=cellRange.getTopLeftCorner().col;}},{key:"isOverlappingVertically",value:function isOverlappingVertically(cellRange){return this.getBottomRightCorner().row>=cellRange.getTopRightCorner().row&&this.getBottomRightCorner().row<=cellRange.getBottomRightCorner().row||this.getTopRightCorner().row<=cellRange.getBottomRightCorner().row&&this.getTopRightCorner().row>=cellRange.getTopRightCorner().row;}},{key:"expand",value:function expand(cellCoords){var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();if(cellCoords.row<topLeft.row||cellCoords.col<topLeft.col||cellCoords.row>bottomRight.row||cellCoords.col>bottomRight.col){this.from=new _coords.default(Math.min(topLeft.row,cellCoords.row),Math.min(topLeft.col,cellCoords.col));this.to=new _coords.default(Math.max(bottomRight.row,cellCoords.row),Math.max(bottomRight.col,cellCoords.col));return true;}
return false;}},{key:"expandByRange",value:function expandByRange(expandingRange){if(this.includesRange(expandingRange)||!this.overlaps(expandingRange)){return false;}
var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();var initialDirection=this.getDirection();var expandingTopLeft=expandingRange.getTopLeftCorner();var expandingBottomRight=expandingRange.getBottomRightCorner();var resultTopRow=Math.min(topLeft.row,expandingTopLeft.row);var resultTopCol=Math.min(topLeft.col,expandingTopLeft.col);var resultBottomRow=Math.max(bottomRight.row,expandingBottomRight.row);var resultBottomCol=Math.max(bottomRight.col,expandingBottomRight.col);var finalFrom=new _coords.default(resultTopRow,resultTopCol);var finalTo=new _coords.default(resultBottomRow,resultBottomCol);this.from=finalFrom;this.to=finalTo;this.setDirection(initialDirection);if(this.highlight.row===this.getBottomRightCorner().row&&this.getVerticalDirection()==='N-S'){this.flipDirectionVertically();}
if(this.highlight.col===this.getTopRightCorner().col&&this.getHorizontalDirection()==='W-E'){this.flipDirectionHorizontally();}
return true;}},{key:"getDirection",value:function getDirection(){if(this.from.isNorthWestOf(this.to)){return'NW-SE';}else if(this.from.isNorthEastOf(this.to)){return'NE-SW';}else if(this.from.isSouthEastOf(this.to)){return'SE-NW';}else if(this.from.isSouthWestOf(this.to)){return'SW-NE';}}},{key:"setDirection",value:function setDirection(direction){switch(direction){case'NW-SE':var _ref=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=_ref[0];this.to=_ref[1];break;case'NE-SW':var _ref2=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=_ref2[0];this.to=_ref2[1];break;case'SE-NW':var _ref3=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=_ref3[0];this.to=_ref3[1];break;case'SW-NE':var _ref4=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=_ref4[0];this.to=_ref4[1];break;default:break;}}},{key:"getVerticalDirection",value:function getVerticalDirection(){return['NE-SW','NW-SE'].indexOf(this.getDirection())>-1?'N-S':'S-N';}},{key:"getHorizontalDirection",value:function getHorizontalDirection(){return['NW-SE','SW-NE'].indexOf(this.getDirection())>-1?'W-E':'E-W';}},{key:"flipDirectionVertically",value:function flipDirectionVertically(){var direction=this.getDirection();switch(direction){case'NW-SE':this.setDirection('SW-NE');break;case'NE-SW':this.setDirection('SE-NW');break;case'SE-NW':this.setDirection('NE-SW');break;case'SW-NE':this.setDirection('NW-SE');break;default:break;}}},{key:"flipDirectionHorizontally",value:function flipDirectionHorizontally(){var direction=this.getDirection();switch(direction){case'NW-SE':this.setDirection('NE-SW');break;case'NE-SW':this.setDirection('NW-SE');break;case'SE-NW':this.setDirection('SW-NE');break;case'SW-NE':this.setDirection('SE-NW');break;default:break;}}},{key:"getTopLeftCorner",value:function getTopLeftCorner(){return new _coords.default(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col));}},{key:"getBottomRightCorner",value:function getBottomRightCorner(){return new _coords.default(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col));}},{key:"getTopRightCorner",value:function getTopRightCorner(){return new _coords.default(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col));}},{key:"getBottomLeftCorner",value:function getBottomLeftCorner(){return new _coords.default(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col));}},{key:"isCorner",value:function isCorner(coords,expandedRange){if(expandedRange&&expandedRange.includes(coords)&&(this.getTopLeftCorner().isEqual(new _coords.default(expandedRange.from.row,expandedRange.from.col))||this.getTopRightCorner().isEqual(new _coords.default(expandedRange.from.row,expandedRange.to.col))||this.getBottomLeftCorner().isEqual(new _coords.default(expandedRange.to.row,expandedRange.from.col))||this.getBottomRightCorner().isEqual(new _coords.default(expandedRange.to.row,expandedRange.to.col)))){return true;}
return coords.isEqual(this.getTopLeftCorner())||coords.isEqual(this.getTopRightCorner())||coords.isEqual(this.getBottomLeftCorner())||coords.isEqual(this.getBottomRightCorner());}},{key:"getOppositeCorner",value:function getOppositeCorner(coords,expandedRange){if(!(coords instanceof _coords.default)){return false;}
if(expandedRange){if(expandedRange.includes(coords)){if(this.getTopLeftCorner().isEqual(new _coords.default(expandedRange.from.row,expandedRange.from.col))){return this.getBottomRightCorner();}
if(this.getTopRightCorner().isEqual(new _coords.default(expandedRange.from.row,expandedRange.to.col))){return this.getBottomLeftCorner();}
if(this.getBottomLeftCorner().isEqual(new _coords.default(expandedRange.to.row,expandedRange.from.col))){return this.getTopRightCorner();}
if(this.getBottomRightCorner().isEqual(new _coords.default(expandedRange.to.row,expandedRange.to.col))){return this.getTopLeftCorner();}}}
if(coords.isEqual(this.getBottomRightCorner())){return this.getTopLeftCorner();}else if(coords.isEqual(this.getTopLeftCorner())){return this.getBottomRightCorner();}else if(coords.isEqual(this.getTopRightCorner())){return this.getBottomLeftCorner();}else if(coords.isEqual(this.getBottomLeftCorner())){return this.getTopRightCorner();}}},{key:"getBordersSharedWith",value:function getBordersSharedWith(range){if(!this.includesRange(range)){return[];}
var thisBorders={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)};var rangeBorders={top:Math.min(range.from.row,range.to.row),bottom:Math.max(range.from.row,range.to.row),left:Math.min(range.from.col,range.to.col),right:Math.max(range.from.col,range.to.col)};var result=[];if(thisBorders.top===rangeBorders.top){result.push('top');}
if(thisBorders.right===rangeBorders.right){result.push('right');}
if(thisBorders.bottom===rangeBorders.bottom){result.push('bottom');}
if(thisBorders.left===rangeBorders.left){result.push('left');}
return result;}},{key:"getInner",value:function getInner(){var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();var out=[];for(var r=topLeft.row;r<=bottomRight.row;r++){for(var c=topLeft.col;c<=bottomRight.col;c++){if(!(this.from.row===r&&this.from.col===c)&&!(this.to.row===r&&this.to.col===c)){out.push(new _coords.default(r,c));}}}
return out;}},{key:"getAll",value:function getAll(){var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();var out=[];for(var r=topLeft.row;r<=bottomRight.row;r++){for(var c=topLeft.col;c<=bottomRight.col;c++){if(topLeft.row===r&&topLeft.col===c){out.push(topLeft);}else if(bottomRight.row===r&&bottomRight.col===c){out.push(bottomRight);}else{out.push(new _coords.default(r,c));}}}
return out;}},{key:"forAll",value:function forAll(callback){var topLeft=this.getTopLeftCorner();var bottomRight=this.getBottomRightCorner();for(var r=topLeft.row;r<=bottomRight.row;r++){for(var c=topLeft.col;c<=bottomRight.col;c++){var breakIteration=callback(r,c);if(breakIteration===false){return;}}}}},{key:"toObject",value:function toObject(){return{from:this.from.toObject(),to:this.to.toObject()};}}]);return CellRange;}();var _default=CellRange;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var ColumnFilter=function(){function ColumnFilter(offset,total,countTH){_classCallCheck(this,ColumnFilter);this.offset=offset;this.total=total;this.countTH=countTH;}
_createClass(ColumnFilter,[{key:"offsetted",value:function offsetted(index){return index+this.offset;}},{key:"unOffsetted",value:function unOffsetted(index){return index-this.offset;}},{key:"renderedToSource",value:function renderedToSource(index){return this.offsetted(index);}},{key:"sourceToRendered",value:function sourceToRendered(index){return this.unOffsetted(index);}},{key:"offsettedTH",value:function offsettedTH(index){return index-this.countTH;}},{key:"unOffsettedTH",value:function unOffsettedTH(index){return index+this.countTH;}},{key:"visibleRowHeadedColumnToSourceColumn",value:function visibleRowHeadedColumnToSourceColumn(index){return this.renderedToSource(this.offsettedTH(index));}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function sourceColumnToVisibleRowHeadedColumn(index){return this.unOffsettedTH(this.sourceToRendered(index));}}]);return ColumnFilter;}();var _default=ColumnFilter;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var RowFilter=function(){function RowFilter(offset,total,countTH){_classCallCheck(this,RowFilter);this.offset=offset;this.total=total;this.countTH=countTH;}
_createClass(RowFilter,[{key:"offsetted",value:function offsetted(index){return index+this.offset;}},{key:"unOffsetted",value:function unOffsetted(index){return index-this.offset;}},{key:"renderedToSource",value:function renderedToSource(index){return this.offsetted(index);}},{key:"sourceToRendered",value:function sourceToRendered(index){return this.unOffsetted(index);}},{key:"offsettedTH",value:function offsettedTH(index){return index-this.countTH;}},{key:"unOffsettedTH",value:function unOffsettedTH(index){return index+this.countTH;}},{key:"visibleColHeadedRowToSourceRow",value:function visibleColHeadedRowToSourceRow(index){return this.renderedToSource(this.offsettedTH(index));}},{key:"sourceRowToVisibleColHeadedRow",value:function sourceRowToVisibleColHeadedRow(index){return this.unOffsettedTH(this.sourceToRendered(index));}}]);return RowFilter;}();var _default=RowFilter;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _object=__webpack_require__(2);var _string=__webpack_require__(48);var _event=_interopRequireDefault(__webpack_require__(286));var _overlays=_interopRequireDefault(__webpack_require__(287));var _scroll=_interopRequireDefault(__webpack_require__(288));var _settings=_interopRequireDefault(__webpack_require__(289));var _table=_interopRequireDefault(__webpack_require__(290));var _viewport=_interopRequireDefault(__webpack_require__(292));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Walkontable=function(){function Walkontable(settings){_classCallCheck(this,Walkontable);var originalHeaders=[];this.guid="wt_".concat((0,_string.randomString)());if(settings.cloneSource){this.cloneSource=settings.cloneSource;this.cloneOverlay=settings.cloneOverlay;this.wtSettings=settings.cloneSource.wtSettings;this.wtTable=new _table.default(this,settings.table,settings.wtRootElement);this.wtScroll=new _scroll.default(this);this.wtViewport=settings.cloneSource.wtViewport;this.wtEvent=new _event.default(this);this.selections=this.cloneSource.selections;}else{this.wtSettings=new _settings.default(this,settings);this.wtTable=new _table.default(this,settings.table);this.wtScroll=new _scroll.default(this);this.wtViewport=new _viewport.default(this);this.wtEvent=new _event.default(this);this.selections=this.getSetting('selections');this.wtOverlays=new _overlays.default(this);this.exportSettingsAsClassNames();}
if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var c=0,clen=this.wtTable.THEAD.childNodes[0].childNodes.length;c<clen;c++){originalHeaders.push(this.wtTable.THEAD.childNodes[0].childNodes[c].innerHTML);}
if(!this.getSetting('columnHeaders').length){this.update('columnHeaders',[function(column,TH){(0,_element.fastInnerText)(TH,originalHeaders[column]);}]);}}
this.drawn=false;this.drawInterrupted=false;}
_createClass(Walkontable,[{key:"draw",value:function draw(){var fastDraw=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.drawInterrupted=false;if(!fastDraw&&!(0,_element.isVisible)(this.wtTable.TABLE)){this.drawInterrupted=true;}else{this.wtTable.draw(fastDraw);}
return this;}},{key:"getCell",value:function getCell(coords){var topmost=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!topmost){return this.wtTable.getCell(coords);}
var totalRows=this.wtSettings.getSetting('totalRows');var fixedRowsTop=this.wtSettings.getSetting('fixedRowsTop');var fixedRowsBottom=this.wtSettings.getSetting('fixedRowsBottom');var fixedColumns=this.wtSettings.getSetting('fixedColumnsLeft');if(coords.row<fixedRowsTop&&coords.col<fixedColumns){return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(coords);}else if(coords.row<fixedRowsTop){return this.wtOverlays.topOverlay.clone.wtTable.getCell(coords);}else if(coords.col<fixedColumns&&coords.row>=totalRows-fixedRowsBottom){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone){return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(coords);}}else if(coords.col<fixedColumns){return this.wtOverlays.leftOverlay.clone.wtTable.getCell(coords);}else if(coords.row<totalRows&&coords.row>totalRows-fixedRowsBottom){if(this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone){return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(coords);}}
return this.wtTable.getCell(coords);}},{key:"update",value:function update(settings,value){return this.wtSettings.update(settings,value);}},{key:"scrollViewport",value:function scrollViewport(coords,snapToTop,snapToRight,snapToBottom,snapToLeft){return this.wtScroll.scrollViewport(coords,snapToTop,snapToRight,snapToBottom,snapToLeft);}},{key:"scrollViewportHorizontally",value:function scrollViewportHorizontally(column,snapToRight,snapToLeft){return this.wtScroll.scrollViewportHorizontally(column,snapToRight,snapToLeft);}},{key:"scrollViewportVertically",value:function scrollViewportVertically(row,snapToTop,snapToBottom){return this.wtScroll.scrollViewportVertically(row,snapToTop,snapToBottom);}},{key:"getViewport",value:function getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()];}},{key:"getOverlayName",value:function getOverlayName(){return this.cloneOverlay?this.cloneOverlay.type:'master';}},{key:"isOverlayName",value:function isOverlayName(name){if(this.cloneOverlay){return this.cloneOverlay.type===name;}
return false;}},{key:"exportSettingsAsClassNames",value:function exportSettingsAsClassNames(){var _this=this;var toExport={rowHeaders:['array'],columnHeaders:['array']};var allClassNames=[];var newClassNames=[];(0,_object.objectEach)(toExport,function(optionType,key){if(optionType.indexOf('array')>-1&&_this.getSetting(key).length){newClassNames.push("ht".concat((0,_string.toUpperCaseFirst)(key)));}
allClassNames.push("ht".concat((0,_string.toUpperCaseFirst)(key)));});(0,_element.removeClass)(this.wtTable.wtRootElement.parentNode,allClassNames);(0,_element.addClass)(this.wtTable.wtRootElement.parentNode,newClassNames);}},{key:"getSetting",value:function getSetting(key,param1,param2,param3,param4){return this.wtSettings.getSetting(key,param1,param2,param3,param4);}},{key:"hasSetting",value:function hasSetting(key){return this.wtSettings.has(key);}},{key:"destroy",value:function destroy(){this.wtOverlays.destroy();this.wtEvent.destroy();}}]);return Walkontable;}();var _default=Walkontable;exports.default=_default;}),(function(module,exports){module.exports=function(module){if(!module.webpackPolyfill){module.deprecate=function(){};module.paths=[];if(!module.children)module.children=[];Object.defineProperty(module,"loaded",{enumerable:true,get:function(){return module.l;}});Object.defineProperty(module,"id",{enumerable:true,get:function(){return module.i;}});module.webpackPolyfill=1;}
return module;};}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _function=__webpack_require__(59);var _feature=__webpack_require__(47);var _browser=__webpack_require__(42);var _eventManager=_interopRequireDefault(__webpack_require__(10));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var privatePool=new WeakMap();var Event=function(){function Event(instance){_classCallCheck(this,Event);this.instance=instance;this.eventManager=new _eventManager.default(instance);privatePool.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]});this.registerEvents();}
_createClass(Event,[{key:"registerEvents",value:function registerEvents(){var _this=this;this.eventManager.addEventListener(this.instance.wtTable.holder,'contextmenu',function(event){return _this.onContextMenu(event);});this.eventManager.addEventListener(this.instance.wtTable.TABLE,'mouseover',function(event){return _this.onMouseOver(event);});this.eventManager.addEventListener(this.instance.wtTable.TABLE,'mouseout',function(event){return _this.onMouseOut(event);});var initTouchEvents=function initTouchEvents(){_this.eventManager.addEventListener(_this.instance.wtTable.holder,'touchstart',function(event){return _this.onTouchStart(event);});_this.eventManager.addEventListener(_this.instance.wtTable.holder,'touchend',function(event){return _this.onTouchEnd(event);});if(!_this.instance.momentumScrolling){_this.instance.momentumScrolling={};}
_this.eventManager.addEventListener(_this.instance.wtTable.holder,'scroll',function(){clearTimeout(_this.instance.momentumScrolling._timeout);if(!_this.instance.momentumScrolling.ongoing){_this.instance.getSetting('onBeforeTouchScroll');}
_this.instance.momentumScrolling.ongoing=true;_this.instance.momentumScrolling._timeout=setTimeout(function(){if(!_this.instance.touchApplied){_this.instance.momentumScrolling.ongoing=false;_this.instance.getSetting('onAfterMomentumScroll');}},200);});};var initMouseEvents=function initMouseEvents(){_this.eventManager.addEventListener(_this.instance.wtTable.holder,'mouseup',function(event){return _this.onMouseUp(event);});_this.eventManager.addEventListener(_this.instance.wtTable.holder,'mousedown',function(event){return _this.onMouseDown(event);});};if((0,_browser.isMobileBrowser)()){initTouchEvents();}else{if((0,_feature.isTouchSupported)()){initTouchEvents();}
initMouseEvents();}
this.eventManager.addEventListener(window,'resize',function(){if(_this.instance.getSetting('stretchH')!=='none'){_this.instance.draw();}});}},{key:"selectedCellWasTouched",value:function selectedCellWasTouched(touchTarget){var priv=privatePool.get(this);var cellUnderFinger=this.parentCell(touchTarget);var coordsOfCellUnderFinger=cellUnderFinger.coords;if(priv.selectedCellBeforeTouchEnd&&coordsOfCellUnderFinger){var _ref=[coordsOfCellUnderFinger.row,priv.selectedCellBeforeTouchEnd.from.row],rowTouched=_ref[0],rowSelected=_ref[1];var _ref2=[coordsOfCellUnderFinger.col,priv.selectedCellBeforeTouchEnd.from.col],colTouched=_ref2[0],colSelected=_ref2[1];return rowTouched===rowSelected&&colTouched===colSelected;}
return false;}},{key:"parentCell",value:function parentCell(elem){var cell={};var TABLE=this.instance.wtTable.TABLE;var TD=(0,_element.closestDown)(elem,['TD','TH'],TABLE);if(TD){cell.coords=this.instance.wtTable.getCoords(TD);cell.TD=TD;}else if((0,_element.hasClass)(elem,'wtBorder')&&(0,_element.hasClass)(elem,'current')){cell.coords=this.instance.selections.getCell().cellRange.highlight;cell.TD=this.instance.wtTable.getCell(cell.coords);}else if((0,_element.hasClass)(elem,'wtBorder')&&(0,_element.hasClass)(elem,'area')){if(this.instance.selections.createOrGetArea().cellRange){cell.coords=this.instance.selections.createOrGetArea().cellRange.to;cell.TD=this.instance.wtTable.getCell(cell.coords);}}
return cell;}},{key:"onMouseDown",value:function onMouseDown(event){var priv=privatePool.get(this);var activeElement=document.activeElement;var getParentNode=(0,_function.partial)(_element.getParent,event.realTarget);var realTarget=event.realTarget;if(realTarget===activeElement||getParentNode(0)===activeElement||getParentNode(1)===activeElement){return;}
var cell=this.parentCell(realTarget);if((0,_element.hasClass)(realTarget,'corner')){this.instance.getSetting('onCellCornerMouseDown',event,realTarget);}else if(cell.TD&&this.instance.hasSetting('onCellMouseDown')){this.instance.getSetting('onCellMouseDown',event,cell.coords,cell.TD,this.instance);}
if(event.button!==2&&cell.TD){priv.dblClickOrigin[0]=cell.TD;clearTimeout(priv.dblClickTimeout[0]);priv.dblClickTimeout[0]=setTimeout(function(){priv.dblClickOrigin[0]=null;},1000);}}},{key:"onContextMenu",value:function onContextMenu(event){if(this.instance.hasSetting('onCellContextMenu')){var cell=this.parentCell(event.realTarget);if(cell.TD){this.instance.getSetting('onCellContextMenu',event,cell.coords,cell.TD,this.instance);}}}},{key:"onMouseOver",value:function onMouseOver(event){if(!this.instance.hasSetting('onCellMouseOver')){return;}
var table=this.instance.wtTable.TABLE;var td=(0,_element.closestDown)(event.realTarget,['TD','TH'],table);var mainWOT=this.instance.cloneSource||this.instance;if(td&&td!==mainWOT.lastMouseOver&&(0,_element.isChildOf)(td,table)){mainWOT.lastMouseOver=td;this.instance.getSetting('onCellMouseOver',event,this.instance.wtTable.getCoords(td),td,this.instance);}}},{key:"onMouseOut",value:function onMouseOut(event){if(!this.instance.hasSetting('onCellMouseOut')){return;}
var table=this.instance.wtTable.TABLE;var lastTD=(0,_element.closestDown)(event.realTarget,['TD','TH'],table);var nextTD=(0,_element.closestDown)(event.relatedTarget,['TD','TH'],table);if(lastTD&&lastTD!==nextTD&&(0,_element.isChildOf)(lastTD,table)){this.instance.getSetting('onCellMouseOut',event,this.instance.wtTable.getCoords(lastTD),lastTD,this.instance);}}},{key:"onMouseUp",value:function onMouseUp(event){if(event.button===2){return;}
var priv=privatePool.get(this);var cell=this.parentCell(event.realTarget);if(cell.TD&&this.instance.hasSetting('onCellMouseUp')){this.instance.getSetting('onCellMouseUp',event,cell.coords,cell.TD,this.instance);}
if(cell.TD===priv.dblClickOrigin[0]&&cell.TD===priv.dblClickOrigin[1]){if((0,_element.hasClass)(event.realTarget,'corner')){this.instance.getSetting('onCellCornerDblClick',event,cell.coords,cell.TD,this.instance);}else{this.instance.getSetting('onCellDblClick',event,cell.coords,cell.TD,this.instance);}
priv.dblClickOrigin[0]=null;priv.dblClickOrigin[1]=null;}else if(cell.TD===priv.dblClickOrigin[0]){priv.dblClickOrigin[1]=cell.TD;clearTimeout(priv.dblClickTimeout[1]);priv.dblClickTimeout[1]=setTimeout(function(){priv.dblClickOrigin[1]=null;},500);}}},{key:"onTouchStart",value:function onTouchStart(event){var priv=privatePool.get(this);priv.selectedCellBeforeTouchEnd=this.instance.selections.getCell().cellRange;this.instance.touchApplied=true;this.onMouseDown(event);}},{key:"onTouchEnd",value:function onTouchEnd(event){var excludeTags=['A','BUTTON','INPUT'];var target=event.target;this.instance.touchApplied=false;if(this.selectedCellWasTouched(target)===false&&excludeTags.includes(target.tagName)){event.preventDefault();}
this.onMouseUp(event);}},{key:"destroy",value:function destroy(){var priv=privatePool.get(this);clearTimeout(priv.dblClickTimeout[0]);clearTimeout(priv.dblClickTimeout[1]);this.eventManager.destroy();}}]);return Event;}();var _default=Event;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _array=__webpack_require__(3);var _unicode=__webpack_require__(32);var _browser=__webpack_require__(42);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _base=_interopRequireDefault(__webpack_require__(43));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Overlays=function(){function Overlays(wotInstance){_classCallCheck(this,Overlays);var BODY_LINE_HEIGHT=parseInt(getComputedStyle(document.body).lineHeight,10);var FALLBACK_BODY_LINE_HEIGHT=parseInt(getComputedStyle(document.body).fontSize,10)*1.2;this.wot=wotInstance;this.instance=this.wot;this.eventManager=new _eventManager.default(this.wot);this.wot.update('scrollbarWidth',(0,_element.getScrollbarWidth)());this.wot.update('scrollbarHeight',(0,_element.getScrollbarWidth)());this.scrollableElement=(0,_element.getScrollableElement)(this.wot.wtTable.TABLE);this.prepareOverlays();this.destroyed=false;this.keyPressed=false;this.spreaderLastSize={width:null,height:null};this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}};this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}};this.verticalScrolling=false;this.horizontalScrolling=false;this.delegatedScrollCallback=false;this.registeredListeners=[];this.browserLineHeight=BODY_LINE_HEIGHT||FALLBACK_BODY_LINE_HEIGHT;this.registerListeners();}
_createClass(Overlays,[{key:"prepareOverlays",value:function prepareOverlays(){var syncScroll=false;if(this.topOverlay){syncScroll=this.topOverlay.updateStateOfRendering()||syncScroll;}else{this.topOverlay=_base.default.createOverlay(_base.default.CLONE_TOP,this.wot);}
if(!_base.default.hasOverlay(_base.default.CLONE_BOTTOM)){this.bottomOverlay={needFullRender:false,updateStateOfRendering:function updateStateOfRendering(){return false;}};}
if(!_base.default.hasOverlay(_base.default.CLONE_BOTTOM_LEFT_CORNER)){this.bottomLeftCornerOverlay={needFullRender:false,updateStateOfRendering:function updateStateOfRendering(){return false;}};}
if(this.bottomOverlay){syncScroll=this.bottomOverlay.updateStateOfRendering()||syncScroll;}else{this.bottomOverlay=_base.default.createOverlay(_base.default.CLONE_BOTTOM,this.wot);}
if(this.leftOverlay){syncScroll=this.leftOverlay.updateStateOfRendering()||syncScroll;}else{this.leftOverlay=_base.default.createOverlay(_base.default.CLONE_LEFT,this.wot);}
if(this.topOverlay.needFullRender&&this.leftOverlay.needFullRender){if(this.topLeftCornerOverlay){syncScroll=this.topLeftCornerOverlay.updateStateOfRendering()||syncScroll;}else{this.topLeftCornerOverlay=_base.default.createOverlay(_base.default.CLONE_TOP_LEFT_CORNER,this.wot);}}
if(this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender){if(this.bottomLeftCornerOverlay){syncScroll=this.bottomLeftCornerOverlay.updateStateOfRendering()||syncScroll;}else{this.bottomLeftCornerOverlay=_base.default.createOverlay(_base.default.CLONE_BOTTOM_LEFT_CORNER,this.wot);}}
if(this.wot.getSetting('debug')&&!this.debug){this.debug=_base.default.createOverlay(_base.default.CLONE_DEBUG,this.wot);}
return syncScroll;}},{key:"refreshAll",value:function refreshAll(){if(!this.wot.drawn){return;}
if(!this.wot.wtTable.holder.parentNode){this.destroy();return;}
this.wot.draw(true);if(this.verticalScrolling){this.leftOverlay.onScroll();}
if(this.horizontalScrolling){this.topOverlay.onScroll();}
this.verticalScrolling=false;this.horizontalScrolling=false;}},{key:"registerListeners",value:function registerListeners(){var _this=this;var topOverlayScrollable=this.topOverlay.mainTableScrollableElement;var leftOverlayScrollable=this.leftOverlay.mainTableScrollableElement;var listenersToRegister=[];listenersToRegister.push([document.documentElement,'keydown',function(event){return _this.onKeyDown(event);}]);listenersToRegister.push([document.documentElement,'keyup',function(){return _this.onKeyUp();}]);listenersToRegister.push([document,'visibilitychange',function(){return _this.onKeyUp();}]);listenersToRegister.push([topOverlayScrollable,'scroll',function(event){return _this.onTableScroll(event);}]);if(topOverlayScrollable!==leftOverlayScrollable){listenersToRegister.push([leftOverlayScrollable,'scroll',function(event){return _this.onTableScroll(event);}]);}
var isHighPixelRatio=window.devicePixelRatio&&window.devicePixelRatio>1;if(isHighPixelRatio||!(0,_browser.isChrome)()){listenersToRegister.push([this.instance.wtTable.wtRootElement.parentNode,'wheel',function(event){return _this.onCloneWheel(event);}]);}else{if(this.topOverlay.needFullRender){listenersToRegister.push([this.topOverlay.clone.wtTable.holder,'wheel',function(event){return _this.onCloneWheel(event);}]);}
if(this.bottomOverlay.needFullRender){listenersToRegister.push([this.bottomOverlay.clone.wtTable.holder,'wheel',function(event){return _this.onCloneWheel(event);}]);}
if(this.leftOverlay.needFullRender){listenersToRegister.push([this.leftOverlay.clone.wtTable.holder,'wheel',function(event){return _this.onCloneWheel(event);}]);}
if(this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender){listenersToRegister.push([this.topLeftCornerOverlay.clone.wtTable.holder,'wheel',function(event){return _this.onCloneWheel(event);}]);}
if(this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender){listenersToRegister.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,'wheel',function(event){return _this.onCloneWheel(event);}]);}}
if(this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window){listenersToRegister.push([window,'wheel',function(event){var overlay;var deltaY=event.wheelDeltaY||event.deltaY;var deltaX=event.wheelDeltaX||event.deltaX;if(_this.topOverlay.clone.wtTable.holder.contains(event.realTarget)){overlay='top';}else if(_this.bottomOverlay.clone&&_this.bottomOverlay.clone.wtTable.holder.contains(event.realTarget)){overlay='bottom';}else if(_this.leftOverlay.clone.wtTable.holder.contains(event.realTarget)){overlay='left';}else if(_this.topLeftCornerOverlay&&_this.topLeftCornerOverlay.clone&&_this.topLeftCornerOverlay.clone.wtTable.holder.contains(event.realTarget)){overlay='topLeft';}else if(_this.bottomLeftCornerOverlay&&_this.bottomLeftCornerOverlay.clone&&_this.bottomLeftCornerOverlay.clone.wtTable.holder.contains(event.realTarget)){overlay='bottomLeft';}
if(overlay==='top'&&deltaY!==0||overlay==='left'&&deltaX!==0||overlay==='bottom'&&deltaY!==0||(overlay==='topLeft'||overlay==='bottomLeft')&&(deltaY!==0||deltaX!==0)){event.preventDefault();}}]);}
while(listenersToRegister.length){var listener=listenersToRegister.pop();this.eventManager.addEventListener(listener[0],listener[1],listener[2]);this.registeredListeners.push(listener);}}},{key:"deregisterListeners",value:function deregisterListeners(){while(this.registeredListeners.length){var listener=this.registeredListeners.pop();this.eventManager.removeEventListener(listener[0],listener[1],listener[2]);}}},{key:"onTableScroll",value:function onTableScroll(event){var masterHorizontal=this.leftOverlay.mainTableScrollableElement;var masterVertical=this.topOverlay.mainTableScrollableElement;var target=event.target;if(this.keyPressed){if(masterVertical!==window&&target!==window&&!event.target.contains(masterVertical)||masterHorizontal!==window&&target!==window&&!event.target.contains(masterHorizontal)){return;}}
this.syncScrollPositions(event);}},{key:"onCloneWheel",value:function onCloneWheel(event){if(this.scrollableElement!==window){event.preventDefault();}
var masterHorizontal=this.leftOverlay.mainTableScrollableElement;var masterVertical=this.topOverlay.mainTableScrollableElement;var target=event.target;var shouldNotWheelVertically=masterVertical!==window&&target!==window&&!event.target.contains(masterVertical);var shouldNotWheelHorizontally=masterHorizontal!==window&&target!==window&&!event.target.contains(masterHorizontal);if(this.keyPressed&&(shouldNotWheelVertically||shouldNotWheelHorizontally)){return;}
this.translateMouseWheelToScroll(event);}},{key:"onKeyDown",value:function onKeyDown(event){this.keyPressed=(0,_unicode.isKey)(event.keyCode,'ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT');}},{key:"onKeyUp",value:function onKeyUp(){this.keyPressed=false;}},{key:"translateMouseWheelToScroll",value:function translateMouseWheelToScroll(event){var deltaY=isNaN(event.deltaY)?-1*event.wheelDeltaY:event.deltaY;var deltaX=isNaN(event.deltaX)?-1*event.wheelDeltaX:event.deltaX;if(event.deltaMode===1){deltaX+=deltaX*this.browserLineHeight;deltaY+=deltaY*this.browserLineHeight;}
this.scrollVertically(deltaY);this.scrollHorizontally(deltaX);return false;}},{key:"scrollVertically",value:function scrollVertically(distance){if(distance===0){return 0;}
this.scrollableElement.scrollTop+=distance;}},{key:"scrollHorizontally",value:function scrollHorizontally(distance){if(distance===0){return 0;}
this.scrollableElement.scrollLeft+=distance;}},{key:"syncScrollPositions",value:function syncScrollPositions(){if(this.destroyed){return;}
var topHolder=this.topOverlay.clone.wtTable.holder;var leftHolder=this.leftOverlay.clone.wtTable.holder;var _ref=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],scrollLeft=_ref[0],scrollTop=_ref[1];this.horizontalScrolling=topHolder.scrollLeft!==scrollLeft;this.verticalScrolling=leftHolder.scrollTop!==scrollTop;if(this.horizontalScrolling){topHolder.scrollLeft=scrollLeft;var bottomHolder=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;if(bottomHolder){bottomHolder.scrollLeft=scrollLeft;}}
if(this.verticalScrolling){leftHolder.scrollTop=scrollTop;}
this.refreshAll();}},{key:"syncScrollWithMaster",value:function syncScrollWithMaster(){var master=this.topOverlay.mainTableScrollableElement;var scrollLeft=master.scrollLeft,scrollTop=master.scrollTop;if(this.topOverlay.needFullRender){this.topOverlay.clone.wtTable.holder.scrollLeft=scrollLeft;}
if(this.bottomOverlay.needFullRender){this.bottomOverlay.clone.wtTable.holder.scrollLeft=scrollLeft;}
if(this.leftOverlay.needFullRender){this.leftOverlay.clone.wtTable.holder.scrollTop=scrollTop;}}},{key:"updateMainScrollableElements",value:function updateMainScrollableElements(){this.deregisterListeners();this.leftOverlay.updateMainScrollableElement();this.topOverlay.updateMainScrollableElement();if(this.bottomOverlay.needFullRender){this.bottomOverlay.updateMainScrollableElement();}
this.scrollableElement=(0,_element.getScrollableElement)(this.wot.wtTable.TABLE);this.registerListeners();}},{key:"destroy",value:function destroy(){this.eventManager.destroy();this.topOverlay.destroy();if(this.bottomOverlay.clone){this.bottomOverlay.destroy();}
this.leftOverlay.destroy();if(this.topLeftCornerOverlay){this.topLeftCornerOverlay.destroy();}
if(this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone){this.bottomLeftCornerOverlay.destroy();}
if(this.debug){this.debug.destroy();}
this.destroyed=true;}},{key:"refresh",value:function refresh(){var fastDraw=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var container=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement;var width=container.clientWidth;var height=container.clientHeight;if(width!==this.spreaderLastSize.width||height!==this.spreaderLastSize.height){this.spreaderLastSize.width=width;this.spreaderLastSize.height=height;this.adjustElementsSize();}}
if(this.bottomOverlay.clone){this.bottomOverlay.refresh(fastDraw);}
this.leftOverlay.refresh(fastDraw);this.topOverlay.refresh(fastDraw);if(this.topLeftCornerOverlay){this.topLeftCornerOverlay.refresh(fastDraw);}
if(this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone){this.bottomLeftCornerOverlay.refresh(fastDraw);}
if(this.debug){this.debug.refresh(fastDraw);}}},{key:"adjustElementsSize",value:function adjustElementsSize(){var force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var totalColumns=this.wot.getSetting('totalColumns');var totalRows=this.wot.getSetting('totalRows');var headerRowSize=this.wot.wtViewport.getRowHeaderWidth();var headerColumnSize=this.wot.wtViewport.getColumnHeaderHeight();var hiderStyle=this.wot.wtTable.hider.style;hiderStyle.width="".concat(headerRowSize+this.leftOverlay.sumCellSizes(0,totalColumns),"px");hiderStyle.height="".concat(headerColumnSize+this.topOverlay.sumCellSizes(0,totalRows)+1,"px");this.topOverlay.adjustElementsSize(force);this.leftOverlay.adjustElementsSize(force);if(this.bottomOverlay.clone){this.bottomOverlay.adjustElementsSize(force);}}},{key:"applyToDOM",value:function applyToDOM(){if(!this.topOverlay.areElementSizesAdjusted||!this.leftOverlay.areElementSizesAdjusted){this.adjustElementsSize();}
this.topOverlay.applyToDOM();if(this.bottomOverlay.clone){this.bottomOverlay.applyToDOM();}
this.leftOverlay.applyToDOM();}},{key:"getParentOverlay",value:function getParentOverlay(element){if(!element){return null;}
var overlays=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay];var result=null;(0,_array.arrayEach)(overlays,function(elem){if(!elem){return;}
if(elem.clone&&elem.clone.wtTable.TABLE.contains(element)){result=elem.clone;}});return result;}}]);return Overlays;}();var _default=Overlays;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _number=__webpack_require__(9);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Scroll=function(){function Scroll(wotInstance){_classCallCheck(this,Scroll);this.wot=wotInstance;this.instance=wotInstance;}
_createClass(Scroll,[{key:"scrollViewport",value:function scrollViewport(coords,snapToTop,snapToRight,snapToBottom,snapToLeft){var scrolledHorizontally=this.scrollViewportHorizontally(coords.col,snapToRight,snapToLeft);var scrolledVertically=this.scrollViewportVertically(coords.row,snapToTop,snapToBottom);return scrolledHorizontally||scrolledVertically;}},{key:"scrollViewportHorizontally",value:function scrollViewportHorizontally(column,snapToRight,snapToLeft){if(!this.wot.drawn){return false;}
var _this$_getVariables=this._getVariables(),fixedColumnsLeft=_this$_getVariables.fixedColumnsLeft,leftOverlay=_this$_getVariables.leftOverlay,totalColumns=_this$_getVariables.totalColumns;var result=false;if(column>=0&&column<=Math.max(totalColumns-1,0)){if(column>=fixedColumnsLeft&&(column<this.getFirstVisibleColumn()||snapToLeft)){result=leftOverlay.scrollTo(column);}else if(column>this.getLastVisibleColumn()||snapToRight){result=leftOverlay.scrollTo(column,true);}}
return result;}},{key:"scrollViewportVertically",value:function scrollViewportVertically(row,snapToTop,snapToBottom){if(!this.wot.drawn){return false;}
var _this$_getVariables2=this._getVariables(),fixedRowsBottom=_this$_getVariables2.fixedRowsBottom,fixedRowsTop=_this$_getVariables2.fixedRowsTop,topOverlay=_this$_getVariables2.topOverlay,totalRows=_this$_getVariables2.totalRows;var result=false;if(row>=0&&row<=Math.max(totalRows-1,0)){if(row>=fixedRowsTop&&(row<this.getFirstVisibleRow()||snapToTop)){result=topOverlay.scrollTo(row);}else if(row>this.getLastVisibleRow()&&row<totalRows-fixedRowsBottom||snapToBottom){result=topOverlay.scrollTo(row,true);}}
return result;}},{key:"getFirstVisibleRow",value:function getFirstVisibleRow(){var _this$_getVariables3=this._getVariables(),topOverlay=_this$_getVariables3.topOverlay,wtTable=_this$_getVariables3.wtTable,wtViewport=_this$_getVariables3.wtViewport,totalRows=_this$_getVariables3.totalRows,fixedRowsTop=_this$_getVariables3.fixedRowsTop;var firstVisibleRow=wtTable.getFirstVisibleRow();if(topOverlay.mainTableScrollableElement===window){var rootElementOffset=(0,_element.offset)(wtTable.wtRootElement);var totalTableHeight=(0,_element.innerHeight)(wtTable.hider);var windowHeight=(0,_element.innerHeight)(window);var windowScrollTop=(0,_element.getScrollTop)(window);if(rootElementOffset.top+totalTableHeight-windowHeight<=windowScrollTop){var rowsHeight=wtViewport.getColumnHeaderHeight();rowsHeight+=topOverlay.sumCellSizes(0,fixedRowsTop);(0,_number.rangeEachReverse)(totalRows,1,function(row){rowsHeight+=topOverlay.sumCellSizes(row-1,row);if(rootElementOffset.top+totalTableHeight-rowsHeight<=windowScrollTop){firstVisibleRow=row;return false;}});}}
return firstVisibleRow;}},{key:"getLastVisibleRow",value:function getLastVisibleRow(){var _this$_getVariables4=this._getVariables(),topOverlay=_this$_getVariables4.topOverlay,wtTable=_this$_getVariables4.wtTable,wtViewport=_this$_getVariables4.wtViewport,totalRows=_this$_getVariables4.totalRows;var lastVisibleRow=wtTable.getLastVisibleRow();if(topOverlay.mainTableScrollableElement===window){var rootElementOffset=(0,_element.offset)(wtTable.wtRootElement);var windowHeight=(0,_element.innerHeight)(window);var windowScrollTop=(0,_element.getScrollTop)(window);if(rootElementOffset.top>windowScrollTop){var rowsHeight=wtViewport.getColumnHeaderHeight();(0,_number.rangeEach)(1,totalRows,function(row){rowsHeight+=topOverlay.sumCellSizes(row-1,row);if(rootElementOffset.top+rowsHeight-windowScrollTop>=windowHeight){lastVisibleRow=row-2;return false;}});}}
return lastVisibleRow;}},{key:"getFirstVisibleColumn",value:function getFirstVisibleColumn(){var _this$_getVariables5=this._getVariables(),leftOverlay=_this$_getVariables5.leftOverlay,wtTable=_this$_getVariables5.wtTable,wtViewport=_this$_getVariables5.wtViewport,totalColumns=_this$_getVariables5.totalColumns;var firstVisibleColumn=wtTable.getFirstVisibleColumn();if(leftOverlay.mainTableScrollableElement===window){var rootElementOffset=(0,_element.offset)(wtTable.wtRootElement);var totalTableWidth=(0,_element.innerWidth)(wtTable.hider);var windowWidth=(0,_element.innerWidth)(window);var windowScrollLeft=(0,_element.getScrollLeft)(window);if(rootElementOffset.left+totalTableWidth-windowWidth<=windowScrollLeft){var columnsWidth=wtViewport.getRowHeaderWidth();(0,_number.rangeEachReverse)(totalColumns,1,function(column){columnsWidth+=leftOverlay.sumCellSizes(column-1,column);if(rootElementOffset.left+totalTableWidth-columnsWidth<=windowScrollLeft){firstVisibleColumn=column;return false;}});}}
return firstVisibleColumn;}},{key:"getLastVisibleColumn",value:function getLastVisibleColumn(){var _this$_getVariables6=this._getVariables(),leftOverlay=_this$_getVariables6.leftOverlay,wtTable=_this$_getVariables6.wtTable,wtViewport=_this$_getVariables6.wtViewport,totalColumns=_this$_getVariables6.totalColumns;var lastVisibleColumn=wtTable.getLastVisibleColumn();if(leftOverlay.mainTableScrollableElement===window){var rootElementOffset=(0,_element.offset)(wtTable.wtRootElement);var windowWidth=(0,_element.innerWidth)(window);var windowScrollLeft=(0,_element.getScrollLeft)(window);if(rootElementOffset.left>windowScrollLeft){var columnsWidth=wtViewport.getRowHeaderWidth();(0,_number.rangeEach)(1,totalColumns,function(column){columnsWidth+=leftOverlay.sumCellSizes(column-1,column);if(rootElementOffset.left+columnsWidth-windowScrollLeft>=windowWidth){lastVisibleColumn=column-2;return false;}});}}
return lastVisibleColumn;}},{key:"_getVariables",value:function _getVariables(){var wot=this.wot;var topOverlay=wot.wtOverlays.topOverlay;var leftOverlay=wot.wtOverlays.leftOverlay;var wtTable=wot.wtTable;var wtViewport=wot.wtViewport;var totalRows=wot.getSetting('totalRows');var totalColumns=wot.getSetting('totalColumns');var fixedRowsTop=wot.getSetting('fixedRowsTop');var fixedRowsBottom=wot.getSetting('fixedRowsBottom');var fixedColumnsLeft=wot.getSetting('fixedColumnsLeft');return{topOverlay:topOverlay,leftOverlay:leftOverlay,wtTable:wtTable,wtViewport:wtViewport,totalRows:totalRows,totalColumns:totalColumns,fixedRowsTop:fixedRowsTop,fixedRowsBottom:fixedRowsBottom,fixedColumnsLeft:fixedColumnsLeft};}}]);return Scroll;}();var _default=Scroll;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _object=__webpack_require__(2);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Settings=function(){function Settings(wotInstance,settings){var _this=this;_classCallCheck(this,Settings);this.wot=wotInstance;this.instance=wotInstance;this.defaults={table:void 0,debug:false,externalRowCalculator:false,stretchH:'none',currentRowClassName:null,currentColumnClassName:null,preventOverflow:function preventOverflow(){return false;},data:void 0,freezeOverlays:false,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function rowHeaders(){return[];},columnHeaders:function columnHeaders(){return[];},totalRows:void 0,totalColumns:void 0,cellRenderer:function cellRenderer(row,column,TD){var cellData=_this.getSetting('data',row,column);(0,_element.fastInnerText)(TD,cellData===void 0||cellData===null?'':cellData);},columnWidth:function columnWidth(){},rowHeight:function rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:false,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function onBeforeStretchingColumnWidth(width){return width;},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:false,groups:false,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null};this.settings={};(0,_object.objectEach)(this.defaults,function(value,key){if(settings[key]!==void 0){_this.settings[key]=settings[key];}else if(value===void 0){throw new Error("A required setting \"".concat(key,"\" was not provided"));}else{_this.settings[key]=value;}});}
_createClass(Settings,[{key:"update",value:function update(settings,value){var _this2=this;if(value===void 0){(0,_object.objectEach)(settings,function(settingValue,key){_this2.settings[key]=settingValue;});}else{this.settings[settings]=value;}
return this.wot;}},{key:"getSetting",value:function getSetting(key,param1,param2,param3,param4){if(typeof this.settings[key]==='function'){return this.settings[key](param1,param2,param3,param4);}else if(param1!==void 0&&Array.isArray(this.settings[key])){return this.settings[key][param1];}
return this.settings[key];}},{key:"has",value:function has(key){return!!this.settings[key];}}]);return Settings;}();var _default=Settings;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _function=__webpack_require__(59);var _coords=_interopRequireDefault(__webpack_require__(75));var _column=_interopRequireDefault(__webpack_require__(163));var _row=_interopRequireDefault(__webpack_require__(164));var _tableRenderer=_interopRequireDefault(__webpack_require__(291));var _base=_interopRequireDefault(__webpack_require__(43));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Table=function(){function Table(wotInstance,table){var _this=this;_classCallCheck(this,Table);this.wot=wotInstance;this.instance=this.wot;this.TABLE=table;this.TBODY=null;this.THEAD=null;this.COLGROUP=null;this.tableOffset=0;this.holderOffset=0;(0,_element.removeTextNodes)(this.TABLE);this.spreader=this.createSpreader(this.TABLE);this.hider=this.createHider(this.spreader);this.holder=this.createHolder(this.hider);this.wtRootElement=this.holder.parentNode;this.alignOverlaysWithTrimmingContainer();this.fixTableDomTree();this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.rowFilter=null;this.columnFilter=null;this.correctHeaderWidth=false;var origRowHeaderWidth=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return _this._modifyRowHeaderWidth(origRowHeaderWidth);};}
_createClass(Table,[{key:"fixTableDomTree",value:function fixTableDomTree(){this.TBODY=this.TABLE.querySelector('tbody');if(!this.TBODY){this.TBODY=document.createElement('tbody');this.TABLE.appendChild(this.TBODY);}
this.THEAD=this.TABLE.querySelector('thead');if(!this.THEAD){this.THEAD=document.createElement('thead');this.TABLE.insertBefore(this.THEAD,this.TBODY);}
this.COLGROUP=this.TABLE.querySelector('colgroup');if(!this.COLGROUP){this.COLGROUP=document.createElement('colgroup');this.TABLE.insertBefore(this.COLGROUP,this.THEAD);}
if(this.wot.getSetting('columnHeaders').length&&!this.THEAD.childNodes.length){this.THEAD.appendChild(document.createElement('TR'));}}},{key:"createSpreader",value:function createSpreader(table){var parent=table.parentNode;var spreader;if(!parent||parent.nodeType!==1||!(0,_element.hasClass)(parent,'wtHolder')){spreader=document.createElement('div');spreader.className='wtSpreader';if(parent){parent.insertBefore(spreader,table);}
spreader.appendChild(table);}
spreader.style.position='relative';return spreader;}},{key:"createHider",value:function createHider(spreader){var parent=spreader.parentNode;var hider;if(!parent||parent.nodeType!==1||!(0,_element.hasClass)(parent,'wtHolder')){hider=document.createElement('div');hider.className='wtHider';if(parent){parent.insertBefore(hider,spreader);}
hider.appendChild(spreader);}
return hider;}},{key:"createHolder",value:function createHolder(hider){var parent=hider.parentNode;var holder;if(!parent||parent.nodeType!==1||!(0,_element.hasClass)(parent,'wtHolder')){holder=document.createElement('div');holder.style.position='relative';holder.className='wtHolder';if(parent){parent.insertBefore(holder,hider);}
if(!this.isWorkingOnClone()){holder.parentNode.className+='ht_master handsontable';}
holder.appendChild(hider);}
return holder;}},{key:"alignOverlaysWithTrimmingContainer",value:function alignOverlaysWithTrimmingContainer(){var trimmingElement=(0,_element.getTrimmingContainer)(this.wtRootElement);if(!this.isWorkingOnClone()){this.holder.parentNode.style.position='relative';if(trimmingElement===window){var preventOverflow=this.wot.getSetting('preventOverflow');if(!preventOverflow){this.holder.style.overflow='visible';this.wtRootElement.style.overflow='visible';}}else{this.holder.style.width=(0,_element.getStyle)(trimmingElement,'width');this.holder.style.height=(0,_element.getStyle)(trimmingElement,'height');this.holder.style.overflow='';}}}},{key:"isWorkingOnClone",value:function isWorkingOnClone(){return!!this.wot.cloneSource;}},{key:"draw",value:function draw(fastDraw){var _this$wot=this.wot,wtOverlays=_this$wot.wtOverlays,wtViewport=_this$wot.wtViewport;var totalRows=this.instance.getSetting('totalRows');var rowHeaders=this.wot.getSetting('rowHeaders').length;var columnHeaders=this.wot.getSetting('columnHeaders').length;var syncScroll=false;var runFastDraw=fastDraw;if(!this.isWorkingOnClone()){this.holderOffset=(0,_element.offset)(this.holder);runFastDraw=wtViewport.createRenderCalculators(runFastDraw);if(rowHeaders&&!this.wot.getSetting('fixedColumnsLeft')){var leftScrollPos=wtOverlays.leftOverlay.getScrollPosition();var previousState=this.correctHeaderWidth;this.correctHeaderWidth=leftScrollPos>0;if(previousState!==this.correctHeaderWidth){runFastDraw=false;}}}
if(!this.isWorkingOnClone()){syncScroll=wtOverlays.prepareOverlays();}
if(runFastDraw){if(!this.isWorkingOnClone()){wtViewport.createVisibleCalculators();}
if(wtOverlays){wtOverlays.refresh(true);}}else{if(this.isWorkingOnClone()){this.tableOffset=this.wot.cloneSource.wtTable.tableOffset;}else{this.tableOffset=(0,_element.offset)(this.TABLE);}
var startRow;if(_base.default.isOverlayTypeOf(this.wot.cloneOverlay,_base.default.CLONE_DEBUG)||_base.default.isOverlayTypeOf(this.wot.cloneOverlay,_base.default.CLONE_TOP)||_base.default.isOverlayTypeOf(this.wot.cloneOverlay,_base.default.CLONE_TOP_LEFT_CORNER)){startRow=0;}else if(_base.default.isOverlayTypeOf(this.instance.cloneOverlay,_base.default.CLONE_BOTTOM)||_base.default.isOverlayTypeOf(this.instance.cloneOverlay,_base.default.CLONE_BOTTOM_LEFT_CORNER)){startRow=Math.max(totalRows-this.wot.getSetting('fixedRowsBottom'),0);}else{startRow=wtViewport.rowsRenderCalculator.startRow;}
var startColumn;if(_base.default.isOverlayTypeOf(this.wot.cloneOverlay,_base.default.CLONE_DEBUG)||_base.default.isOverlayTypeOf(this.wot.cloneOverlay,_base.default.CLONE_LEFT)||_base.default.isOverlayTypeOf(this.wot.cloneOverlay,_base.default.CLONE_TOP_LEFT_CORNER)||_base.default.isOverlayTypeOf(this.wot.cloneOverlay,_base.default.CLONE_BOTTOM_LEFT_CORNER)){startColumn=0;}else{startColumn=wtViewport.columnsRenderCalculator.startColumn;}
this.rowFilter=new _row.default(startRow,totalRows,columnHeaders);this.columnFilter=new _column.default(startColumn,this.wot.getSetting('totalColumns'),rowHeaders);this.alignOverlaysWithTrimmingContainer();this._doDraw();}
this.refreshSelections(runFastDraw);if(!this.isWorkingOnClone()){wtOverlays.topOverlay.resetFixedPosition();if(wtOverlays.bottomOverlay.clone){wtOverlays.bottomOverlay.resetFixedPosition();}
wtOverlays.leftOverlay.resetFixedPosition();if(wtOverlays.topLeftCornerOverlay){wtOverlays.topLeftCornerOverlay.resetFixedPosition();}
if(wtOverlays.bottomLeftCornerOverlay&&wtOverlays.bottomLeftCornerOverlay.clone){wtOverlays.bottomLeftCornerOverlay.resetFixedPosition();}}
if(syncScroll){wtOverlays.syncScrollWithMaster();}
this.wot.drawn=true;return this;}},{key:"_doDraw",value:function _doDraw(){var wtRenderer=new _tableRenderer.default(this);wtRenderer.render();}},{key:"removeClassFromCells",value:function removeClassFromCells(className){var nodes=this.TABLE.querySelectorAll(".".concat(className));for(var i=0,len=nodes.length;i<len;i++){(0,_element.removeClass)(nodes[i],className);}}},{key:"refreshSelections",value:function refreshSelections(fastDraw){if(!this.wot.selections){return;}
var highlights=Array.from(this.wot.selections);var len=highlights.length;if(fastDraw){var classesToRemove=[];for(var i=0;i<len;i++){var _highlights$i$setting=highlights[i].settings,highlightHeaderClassName=_highlights$i$setting.highlightHeaderClassName,highlightRowClassName=_highlights$i$setting.highlightRowClassName,highlightColumnClassName=_highlights$i$setting.highlightColumnClassName;var classNames=highlights[i].classNames;var classNamesLength=classNames.length;for(var j=0;j<classNamesLength;j++){if(!classesToRemove.includes(classNames[j])){classesToRemove.push(classNames[j]);}}
if(highlightHeaderClassName&&!classesToRemove.includes(highlightHeaderClassName)){classesToRemove.push(highlightHeaderClassName);}
if(highlightRowClassName&&!classesToRemove.includes(highlightRowClassName)){classesToRemove.push(highlightRowClassName);}
if(highlightColumnClassName&&!classesToRemove.includes(highlightColumnClassName)){classesToRemove.push(highlightColumnClassName);}}
var additionalClassesToRemove=this.wot.getSetting('onBeforeRemoveCellClassNames');if(Array.isArray(additionalClassesToRemove)){for(var _i=0;_i<additionalClassesToRemove.length;_i++){classesToRemove.push(additionalClassesToRemove[_i]);}}
var classesToRemoveLength=classesToRemove.length;for(var _i2=0;_i2<classesToRemoveLength;_i2++){this.removeClassFromCells(classesToRemove[_i2]);}}
for(var _i3=0;_i3<len;_i3++){highlights[_i3].draw(this.wot,fastDraw);}}},{key:"getCell",value:function getCell(coords){var row=coords.row;var column=coords.col;var hookResult=this.wot.getSetting('onModifyGetCellCoords',row,column);if(hookResult&&Array.isArray(hookResult)){var _hookResult=_slicedToArray(hookResult,2);row=_hookResult[0];column=_hookResult[1];}
if(this.isRowBeforeRenderedRows(row)){return-1;}else if(this.isRowAfterRenderedRows(row)){return-2;}
var TR=this.TBODY.childNodes[this.rowFilter.sourceToRendered(row)];if(TR){return TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(column)];}}},{key:"getColumnHeader",value:function getColumnHeader(col){var level=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var TR=this.THEAD.childNodes[level];if(TR){return TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(col)];}}},{key:"getRowHeader",value:function getRowHeader(row){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0){return null;}
var TR=this.TBODY.childNodes[this.rowFilter.sourceToRendered(row)];if(TR){return TR.childNodes[0];}}},{key:"getCoords",value:function getCoords(TD){var cellElement=TD;if(cellElement.nodeName!=='TD'&&cellElement.nodeName!=='TH'){cellElement=(0,_element.closest)(cellElement,['TD','TH']);}
if(cellElement===null){return null;}
var TR=cellElement.parentNode;var CONTAINER=TR.parentNode;var row=(0,_element.index)(TR);var col=cellElement.cellIndex;if((0,_element.overlayContainsElement)(_base.default.CLONE_TOP_LEFT_CORNER,cellElement)||(0,_element.overlayContainsElement)(_base.default.CLONE_TOP,cellElement)){if(CONTAINER.nodeName==='THEAD'){row-=CONTAINER.childNodes.length;}}else if(CONTAINER===this.THEAD){row=this.rowFilter.visibleColHeadedRowToSourceRow(row);}else{row=this.rowFilter.renderedToSource(row);}
if((0,_element.overlayContainsElement)(_base.default.CLONE_TOP_LEFT_CORNER,cellElement)||(0,_element.overlayContainsElement)(_base.default.CLONE_LEFT,cellElement)){col=this.columnFilter.offsettedTH(col);}else{col=this.columnFilter.visibleRowHeadedColumnToSourceColumn(col);}
return new _coords.default(row,col);}},{key:"getTrForRow",value:function getTrForRow(row){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(row)];}},{key:"getFirstRenderedRow",value:function getFirstRenderedRow(){return this.wot.wtViewport.rowsRenderCalculator.startRow;}},{key:"getFirstVisibleRow",value:function getFirstVisibleRow(){return this.wot.wtViewport.rowsVisibleCalculator.startRow;}},{key:"getFirstRenderedColumn",value:function getFirstRenderedColumn(){return this.wot.wtViewport.columnsRenderCalculator.startColumn;}},{key:"getFirstVisibleColumn",value:function getFirstVisibleColumn(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn;}},{key:"getLastRenderedRow",value:function getLastRenderedRow(){return this.wot.wtViewport.rowsRenderCalculator.endRow;}},{key:"getLastVisibleRow",value:function getLastVisibleRow(){return this.wot.wtViewport.rowsVisibleCalculator.endRow;}},{key:"getLastRenderedColumn",value:function getLastRenderedColumn(){return this.wot.wtViewport.columnsRenderCalculator.endColumn;}},{key:"getLastVisibleColumn",value:function getLastVisibleColumn(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn;}},{key:"isRowBeforeRenderedRows",value:function isRowBeforeRenderedRows(row){return this.rowFilter&&this.rowFilter.sourceToRendered(row)<0&&row>=0;}},{key:"isRowAfterViewport",value:function isRowAfterViewport(row){return this.rowFilter&&this.rowFilter.sourceToRendered(row)>this.getLastVisibleRow();}},{key:"isRowAfterRenderedRows",value:function isRowAfterRenderedRows(row){return this.rowFilter&&this.rowFilter.sourceToRendered(row)>this.getLastRenderedRow();}},{key:"isColumnBeforeViewport",value:function isColumnBeforeViewport(column){return this.columnFilter&&this.columnFilter.sourceToRendered(column)<0&&column>=0;}},{key:"isColumnAfterViewport",value:function isColumnAfterViewport(column){return this.columnFilter&&this.columnFilter.sourceToRendered(column)>this.getLastVisibleColumn();}},{key:"isLastRowFullyVisible",value:function isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow();}},{key:"isLastColumnFullyVisible",value:function isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn();}},{key:"getRenderedColumnsCount",value:function getRenderedColumnsCount(){var columnsCount=this.wot.wtViewport.columnsRenderCalculator.count;var totalColumns=this.wot.getSetting('totalColumns');if(this.wot.isOverlayName(_base.default.CLONE_DEBUG)){columnsCount=totalColumns;}else if(this.wot.isOverlayName(_base.default.CLONE_LEFT)||this.wot.isOverlayName(_base.default.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(_base.default.CLONE_BOTTOM_LEFT_CORNER)){return Math.min(this.wot.getSetting('fixedColumnsLeft'),totalColumns);}
return columnsCount;}},{key:"getRenderedRowsCount",value:function getRenderedRowsCount(){var rowsCount=this.wot.wtViewport.rowsRenderCalculator.count;var totalRows=this.wot.getSetting('totalRows');if(this.wot.isOverlayName(_base.default.CLONE_DEBUG)){rowsCount=totalRows;}else if(this.wot.isOverlayName(_base.default.CLONE_TOP)||this.wot.isOverlayName(_base.default.CLONE_TOP_LEFT_CORNER)){rowsCount=Math.min(this.wot.getSetting('fixedRowsTop'),totalRows);}else if(this.wot.isOverlayName(_base.default.CLONE_BOTTOM)||this.wot.isOverlayName(_base.default.CLONE_BOTTOM_LEFT_CORNER)){rowsCount=Math.min(this.wot.getSetting('fixedRowsBottom'),totalRows);}
return rowsCount;}},{key:"getVisibleRowsCount",value:function getVisibleRowsCount(){return this.wot.wtViewport.rowsVisibleCalculator.count;}},{key:"allRowsInViewport",value:function allRowsInViewport(){return this.wot.getSetting('totalRows')===this.getVisibleRowsCount();}},{key:"getRowHeight",value:function getRowHeight(sourceRow){var height=this.wot.wtSettings.settings.rowHeight(sourceRow);var oversizedHeight=this.wot.wtViewport.oversizedRows[sourceRow];if(oversizedHeight!==void 0){height=height===void 0?oversizedHeight:Math.max(height,oversizedHeight);}
return height;}},{key:"getColumnHeaderHeight",value:function getColumnHeaderHeight(level){var height=this.wot.wtSettings.settings.defaultRowHeight;var oversizedHeight=this.wot.wtViewport.oversizedColumnHeaders[level];if(oversizedHeight!==void 0){height=height?Math.max(height,oversizedHeight):oversizedHeight;}
return height;}},{key:"getVisibleColumnsCount",value:function getVisibleColumnsCount(){return this.wot.wtViewport.columnsVisibleCalculator.count;}},{key:"allColumnsInViewport",value:function allColumnsInViewport(){return this.wot.getSetting('totalColumns')===this.getVisibleColumnsCount();}},{key:"getColumnWidth",value:function getColumnWidth(sourceColumn){var width=this.wot.wtSettings.settings.columnWidth;if(typeof width==='function'){width=width(sourceColumn);}else if(_typeof(width)==='object'){width=width[sourceColumn];}
return width||this.wot.wtSettings.settings.defaultColumnWidth;}},{key:"getStretchedColumnWidth",value:function getStretchedColumnWidth(sourceColumn){var columnWidth=this.getColumnWidth(sourceColumn);var width=columnWidth===null||columnWidth===void 0?this.instance.wtSettings.settings.defaultColumnWidth:columnWidth;var calculator=this.wot.wtViewport.columnsRenderCalculator;if(calculator){var stretchedWidth=calculator.getStretchedColumnWidth(sourceColumn,width);if(stretchedWidth){width=stretchedWidth;}}
return width;}},{key:"_modifyRowHeaderWidth",value:function _modifyRowHeaderWidth(rowHeaderWidthFactory){var widths=(0,_function.isFunction)(rowHeaderWidthFactory)?rowHeaderWidthFactory():null;if(Array.isArray(widths)){widths=_toConsumableArray(widths);widths[widths.length-1]=this._correctRowHeaderWidth(widths[widths.length-1]);}else{widths=this._correctRowHeaderWidth(widths);}
return widths;}},{key:"_correctRowHeaderWidth",value:function _correctRowHeaderWidth(width){var rowHeaderWidth=width;if(typeof width!=='number'){rowHeaderWidth=this.wot.getSetting('defaultColumnWidth');}
if(this.correctHeaderWidth){rowHeaderWidth+=1;}
return rowHeaderWidth;}}]);return Table;}();var _default=Table;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _console=__webpack_require__(76);var _templateLiteralTag=__webpack_require__(58);var _base=_interopRequireDefault(__webpack_require__(43));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _templateObject(){var data=_taggedTemplateLiteral(["Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number \n          of rendered rows by specifying the table height and/or turning off the \"renderAllRows\" option."]);_templateObject=function _templateObject(){return data;};return data;}
function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0);}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var performanceWarningAppeared=false;var TableRenderer=function(){function TableRenderer(wtTable){_classCallCheck(this,TableRenderer);this.wtTable=wtTable;this.wot=wtTable.instance;this.instance=wtTable.instance;this.rowFilter=wtTable.rowFilter;this.columnFilter=wtTable.columnFilter;this.TABLE=wtTable.TABLE;this.THEAD=wtTable.THEAD;this.TBODY=wtTable.TBODY;this.COLGROUP=wtTable.COLGROUP;this.rowHeaders=[];this.rowHeaderCount=0;this.columnHeaders=[];this.columnHeaderCount=0;this.fixedRowsTop=0;this.fixedRowsBottom=0;}
_createClass(TableRenderer,[{key:"render",value:function render(){if(!this.wtTable.isWorkingOnClone()){var skipRender={};this.wot.getSetting('beforeDraw',true,skipRender);if(skipRender.skipRender===true){return;}}
this.rowHeaders=this.wot.getSetting('rowHeaders');this.rowHeaderCount=this.rowHeaders.length;this.fixedRowsTop=this.wot.getSetting('fixedRowsTop');this.fixedRowsBottom=this.wot.getSetting('fixedRowsBottom');this.columnHeaders=this.wot.getSetting('columnHeaders');this.columnHeaderCount=this.columnHeaders.length;var columnsToRender=this.wtTable.getRenderedColumnsCount();var rowsToRender=this.wtTable.getRenderedRowsCount();var totalColumns=this.wot.getSetting('totalColumns');var totalRows=this.wot.getSetting('totalRows');var workspaceWidth;var adjusted=false;if(_base.default.isOverlayTypeOf(this.wot.cloneOverlay,_base.default.CLONE_BOTTOM)||_base.default.isOverlayTypeOf(this.wot.cloneOverlay,_base.default.CLONE_BOTTOM_LEFT_CORNER)){this.columnHeaders=[];this.columnHeaderCount=0;}
if(totalColumns>=0){this.adjustAvailableNodes();adjusted=true;this.renderColumnHeaders();this.renderRows(totalRows,rowsToRender,columnsToRender);if(!this.wtTable.isWorkingOnClone()){workspaceWidth=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtViewport.containerWidth=null;}
this.adjustColumnWidths(columnsToRender);this.markOversizedColumnHeaders();this.adjustColumnHeaderHeights();}
if(!adjusted){this.adjustAvailableNodes();}
this.removeRedundantRows(rowsToRender);if(!this.wtTable.isWorkingOnClone()||this.wot.isOverlayName(_base.default.CLONE_BOTTOM)){this.markOversizedRows();}
if(!this.wtTable.isWorkingOnClone()){this.wot.wtViewport.createVisibleCalculators();this.wot.wtOverlays.refresh(false);this.wot.wtOverlays.applyToDOM();var hiderWidth=(0,_element.outerWidth)(this.wtTable.hider);var tableWidth=(0,_element.outerWidth)(this.wtTable.TABLE);if(hiderWidth!==0&&tableWidth!==hiderWidth){this.adjustColumnWidths(columnsToRender);}
if(workspaceWidth!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var firstRendered=this.wtTable.getFirstRenderedColumn();var lastRendered=this.wtTable.getLastRenderedColumn();var defaultColumnWidth=this.wot.getSetting('defaultColumnWidth');var rowHeaderWidthSetting=this.wot.getSetting('rowHeaderWidth');rowHeaderWidthSetting=this.instance.getSetting('onModifyRowHeaderWidth',rowHeaderWidthSetting);if(rowHeaderWidthSetting!==null&&rowHeaderWidthSetting!==void 0){for(var i=0;i<this.rowHeaderCount;i++){var width=Array.isArray(rowHeaderWidthSetting)?rowHeaderWidthSetting[i]:rowHeaderWidthSetting;width=width===null||width===void 0?defaultColumnWidth:width;this.COLGROUP.childNodes[i].style.width="".concat(width,"px");}}
for(var _i=firstRendered;_i<lastRendered;_i++){var _width=this.wtTable.getStretchedColumnWidth(_i);var renderedIndex=this.columnFilter.sourceToRendered(_i);this.COLGROUP.childNodes[renderedIndex+this.rowHeaderCount].style.width="".concat(_width,"px");}}
this.wot.getSetting('onDraw',true);}else if(this.wot.isOverlayName(_base.default.CLONE_BOTTOM)){this.wot.cloneSource.wtOverlays.adjustElementsSize();}}},{key:"removeRedundantRows",value:function removeRedundantRows(renderedRowsCount){while(this.wtTable.tbodyChildrenLength>renderedRowsCount){this.TBODY.removeChild(this.TBODY.lastChild);this.wtTable.tbodyChildrenLength-=1;}}},{key:"renderRows",value:function renderRows(totalRows,rowsToRender,columnsToRender){var TR;var visibleRowIndex=0;var sourceRowIndex=this.rowFilter.renderedToSource(visibleRowIndex);var isWorkingOnClone=this.wtTable.isWorkingOnClone();while(sourceRowIndex<totalRows&&sourceRowIndex>=0){if(!performanceWarningAppeared&&visibleRowIndex>1000){performanceWarningAppeared=true;(0,_console.warn)((0,_templateLiteralTag.toSingleLine)(_templateObject()));}
if(rowsToRender!==void 0&&visibleRowIndex===rowsToRender){break;}
TR=this.getOrCreateTrForRow(visibleRowIndex,TR);this.renderRowHeaders(sourceRowIndex,TR);this.adjustColumns(TR,columnsToRender+this.rowHeaderCount);this.renderCells(sourceRowIndex,TR,columnsToRender);if(!isWorkingOnClone||this.wot.isOverlayName(_base.default.CLONE_BOTTOM)){this.resetOversizedRow(sourceRowIndex);}
if(TR.firstChild){var height=this.wot.wtTable.getRowHeight(sourceRowIndex);if(height){height-=1;TR.firstChild.style.height="".concat(height,"px");}else{TR.firstChild.style.height='';}}
visibleRowIndex+=1;sourceRowIndex=this.rowFilter.renderedToSource(visibleRowIndex);}}},{key:"resetOversizedRow",value:function resetOversizedRow(sourceRow){if(this.wot.getSetting('externalRowCalculator')){return;}
if(this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[sourceRow]){this.wot.wtViewport.oversizedRows[sourceRow]=void 0;}}},{key:"markOversizedRows",value:function markOversizedRows(){if(this.wot.getSetting('externalRowCalculator')){return;}
var rowCount=this.instance.wtTable.TBODY.childNodes.length;var expectedTableHeight=rowCount*this.instance.wtSettings.settings.defaultRowHeight;var actualTableHeight=(0,_element.innerHeight)(this.instance.wtTable.TBODY)-1;var previousRowHeight;var rowInnerHeight;var sourceRowIndex;var currentTr;var rowHeader;if(expectedTableHeight===actualTableHeight&&!this.instance.getSetting('fixedRowsBottom')){return;}
while(rowCount){rowCount-=1;sourceRowIndex=this.instance.wtTable.rowFilter.renderedToSource(rowCount);previousRowHeight=this.instance.wtTable.getRowHeight(sourceRowIndex);currentTr=this.instance.wtTable.getTrForRow(sourceRowIndex);rowHeader=currentTr.querySelector('th');if(rowHeader){rowInnerHeight=(0,_element.innerHeight)(rowHeader);}else{rowInnerHeight=(0,_element.innerHeight)(currentTr)-1;}
if(!previousRowHeight&&this.instance.wtSettings.settings.defaultRowHeight<rowInnerHeight||previousRowHeight<rowInnerHeight){rowInnerHeight+=1;this.instance.wtViewport.oversizedRows[sourceRowIndex]=rowInnerHeight;}}}},{key:"markOversizedColumnHeaders",value:function markOversizedColumnHeaders(){var overlayName=this.wot.getOverlayName();if(!this.columnHeaderCount||this.wot.wtViewport.hasOversizedColumnHeadersMarked[overlayName]||this.wtTable.isWorkingOnClone()){return;}
var columnCount=this.wtTable.getRenderedColumnsCount();for(var i=0;i<this.columnHeaderCount;i++){for(var renderedColumnIndex=-1*this.rowHeaderCount;renderedColumnIndex<columnCount;renderedColumnIndex++){this.markIfOversizedColumnHeader(renderedColumnIndex);}}
this.wot.wtViewport.hasOversizedColumnHeadersMarked[overlayName]=true;}},{key:"adjustColumnHeaderHeights",value:function adjustColumnHeaderHeights(){var columnHeaders=this.wot.getSetting('columnHeaders');var children=this.wot.wtTable.THEAD.childNodes;var oversizedColumnHeaders=this.wot.wtViewport.oversizedColumnHeaders;for(var i=0,len=columnHeaders.length;i<len;i++){if(oversizedColumnHeaders[i]){if(!children[i]||children[i].childNodes.length===0){return;}
children[i].childNodes[0].style.height="".concat(oversizedColumnHeaders[i],"px");}}}},{key:"markIfOversizedColumnHeader",value:function markIfOversizedColumnHeader(col){var sourceColIndex=this.wot.wtTable.columnFilter.renderedToSource(col);var level=this.columnHeaderCount;var defaultRowHeight=this.wot.wtSettings.settings.defaultRowHeight;var previousColHeaderHeight;var currentHeader;var currentHeaderHeight;var columnHeaderHeightSetting=this.wot.getSetting('columnHeaderHeight')||[];while(level){level-=1;previousColHeaderHeight=this.wot.wtTable.getColumnHeaderHeight(level);currentHeader=this.wot.wtTable.getColumnHeader(sourceColIndex,level);if(!currentHeader){continue;}
currentHeaderHeight=(0,_element.innerHeight)(currentHeader);if(!previousColHeaderHeight&&defaultRowHeight<currentHeaderHeight||previousColHeaderHeight<currentHeaderHeight){this.wot.wtViewport.oversizedColumnHeaders[level]=currentHeaderHeight;}
if(Array.isArray(columnHeaderHeightSetting)){if(columnHeaderHeightSetting[level]!==null&&columnHeaderHeightSetting[level]!==void 0){this.wot.wtViewport.oversizedColumnHeaders[level]=columnHeaderHeightSetting[level];}}else if(!isNaN(columnHeaderHeightSetting)){this.wot.wtViewport.oversizedColumnHeaders[level]=columnHeaderHeightSetting;}
if(this.wot.wtViewport.oversizedColumnHeaders[level]<(columnHeaderHeightSetting[level]||columnHeaderHeightSetting)){this.wot.wtViewport.oversizedColumnHeaders[level]=columnHeaderHeightSetting[level]||columnHeaderHeightSetting;}}}},{key:"renderCells",value:function renderCells(sourceRowIndex,TR,columnsToRender){var TD;var sourceColIndex;for(var visibleColIndex=0;visibleColIndex<columnsToRender;visibleColIndex++){sourceColIndex=this.columnFilter.renderedToSource(visibleColIndex);if(visibleColIndex===0){TD=TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(sourceColIndex)];}else{TD=TD.nextSibling;}
if(TD.nodeName==='TH'){TD=replaceThWithTd(TD,TR);}
if(!(0,_element.hasClass)(TD,'hide')){TD.className='';}
TD.removeAttribute('style');this.wot.wtSettings.settings.cellRenderer(sourceRowIndex,sourceColIndex,TD);}
return TD;}},{key:"adjustColumnWidths",value:function adjustColumnWidths(columnsToRender){var scrollbarCompensation=0;var sourceInstance=this.wot.cloneSource?this.wot.cloneSource:this.wot;var mainHolder=sourceInstance.wtTable.holder;var defaultColumnWidth=this.wot.getSetting('defaultColumnWidth');var rowHeaderWidthSetting=this.wot.getSetting('rowHeaderWidth');if(mainHolder.offsetHeight<mainHolder.scrollHeight){scrollbarCompensation=(0,_element.getScrollbarWidth)();}
this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-scrollbarCompensation);rowHeaderWidthSetting=this.instance.getSetting('onModifyRowHeaderWidth',rowHeaderWidthSetting);if(rowHeaderWidthSetting!==null&&rowHeaderWidthSetting!==void 0){for(var i=0;i<this.rowHeaderCount;i++){var width=Array.isArray(rowHeaderWidthSetting)?rowHeaderWidthSetting[i]:rowHeaderWidthSetting;width=width===null||width===void 0?defaultColumnWidth:width;this.COLGROUP.childNodes[i].style.width="".concat(width,"px");}}
for(var renderedColIndex=0;renderedColIndex<columnsToRender;renderedColIndex++){var _width2=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(renderedColIndex));this.COLGROUP.childNodes[renderedColIndex+this.rowHeaderCount].style.width="".concat(_width2,"px");}}},{key:"appendToTbody",value:function appendToTbody(TR){this.TBODY.appendChild(TR);this.wtTable.tbodyChildrenLength+=1;}},{key:"getOrCreateTrForRow",value:function getOrCreateTrForRow(rowIndex,currentTr){var TR;if(rowIndex>=this.wtTable.tbodyChildrenLength){TR=this.createRow();this.appendToTbody(TR);}else if(rowIndex===0){TR=this.TBODY.firstChild;}else{TR=currentTr.nextSibling;}
if(TR.className){TR.removeAttribute('class');}
return TR;}},{key:"createRow",value:function createRow(){var TR=document.createElement('TR');for(var visibleColIndex=0;visibleColIndex<this.rowHeaderCount;visibleColIndex++){TR.appendChild(document.createElement('TH'));}
return TR;}},{key:"renderRowHeader",value:function renderRowHeader(row,col,TH){TH.className='';TH.removeAttribute('style');this.rowHeaders[col](row,TH,col);}},{key:"renderRowHeaders",value:function renderRowHeaders(row,TR){for(var TH=TR.firstChild,visibleColIndex=0;visibleColIndex<this.rowHeaderCount;visibleColIndex++){if(!TH){TH=document.createElement('TH');TR.appendChild(TH);}else if(TH.nodeName==='TD'){TH=replaceTdWithTh(TH,TR);}
this.renderRowHeader(row,visibleColIndex,TH);TH=TH.nextSibling;}}},{key:"adjustAvailableNodes",value:function adjustAvailableNodes(){this.adjustColGroups();this.adjustThead();}},{key:"renderColumnHeaders",value:function renderColumnHeaders(){if(!this.columnHeaderCount){return;}
var columnCount=this.wtTable.getRenderedColumnsCount();for(var i=0;i<this.columnHeaderCount;i++){var TR=this.getTrForColumnHeaders(i);for(var renderedColumnIndex=-1*this.rowHeaderCount;renderedColumnIndex<columnCount;renderedColumnIndex++){var sourceCol=this.columnFilter.renderedToSource(renderedColumnIndex);this.renderColumnHeader(i,sourceCol,TR.childNodes[renderedColumnIndex+this.rowHeaderCount]);}}}},{key:"adjustColGroups",value:function adjustColGroups(){var columnCount=this.wtTable.getRenderedColumnsCount();while(this.wtTable.colgroupChildrenLength<columnCount+this.rowHeaderCount){this.COLGROUP.appendChild(document.createElement('COL'));this.wtTable.colgroupChildrenLength+=1;}
while(this.wtTable.colgroupChildrenLength>columnCount+this.rowHeaderCount){this.COLGROUP.removeChild(this.COLGROUP.lastChild);this.wtTable.colgroupChildrenLength-=1;}
if(this.rowHeaderCount){(0,_element.addClass)(this.COLGROUP.childNodes[0],'rowHeader');}}},{key:"adjustThead",value:function adjustThead(){var columnCount=this.wtTable.getRenderedColumnsCount();var TR=this.THEAD.firstChild;if(this.columnHeaders.length){for(var i=0,len=this.columnHeaders.length;i<len;i++){TR=this.THEAD.childNodes[i];if(!TR){TR=document.createElement('TR');this.THEAD.appendChild(TR);}
this.theadChildrenLength=TR.childNodes.length;while(this.theadChildrenLength<columnCount+this.rowHeaderCount){TR.appendChild(document.createElement('TH'));this.theadChildrenLength+=1;}
while(this.theadChildrenLength>columnCount+this.rowHeaderCount){TR.removeChild(TR.lastChild);this.theadChildrenLength-=1;}}
var theadChildrenLength=this.THEAD.childNodes.length;if(theadChildrenLength>this.columnHeaders.length){for(var _i2=this.columnHeaders.length;_i2<theadChildrenLength;_i2++){this.THEAD.removeChild(this.THEAD.lastChild);}}}else if(TR){(0,_element.empty)(TR);}}},{key:"getTrForColumnHeaders",value:function getTrForColumnHeaders(index){return this.THEAD.childNodes[index];}},{key:"renderColumnHeader",value:function renderColumnHeader(row,col,TH){TH.className='';TH.removeAttribute('style');return this.columnHeaders[row](col,TH,row);}},{key:"adjustColumns",value:function adjustColumns(TR,desiredCount){var count=TR.childNodes.length;while(count<desiredCount){var TD=document.createElement('TD');TR.appendChild(TD);count+=1;}
while(count>desiredCount){TR.removeChild(TR.lastChild);count-=1;}}},{key:"removeRedundantColumns",value:function removeRedundantColumns(columnsToRender){while(this.wtTable.tbodyChildrenLength>columnsToRender){this.TBODY.removeChild(this.TBODY.lastChild);this.wtTable.tbodyChildrenLength-=1;}}}]);return TableRenderer;}();function replaceTdWithTh(TD,TR){var TH=document.createElement('TH');TR.insertBefore(TH,TD);TR.removeChild(TD);return TH;}
function replaceThWithTd(TH,TR){var TD=document.createElement('TD');TR.insertBefore(TD,TH);TR.removeChild(TH);return TD;}
var _default=TableRenderer;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _object=__webpack_require__(2);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _viewportColumns=_interopRequireDefault(__webpack_require__(160));var _viewportRows=_interopRequireDefault(__webpack_require__(161));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Viewport=function(){function Viewport(wotInstance){var _this=this;_classCallCheck(this,Viewport);this.wot=wotInstance;this.instance=this.wot;this.oversizedRows=[];this.oversizedColumnHeaders=[];this.hasOversizedColumnHeadersMarked={};this.clientHeight=0;this.containerWidth=NaN;this.rowHeaderWidth=NaN;this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;this.eventManager=new _eventManager.default(this.wot);this.eventManager.addEventListener(window,'resize',function(){_this.clientHeight=_this.getWorkspaceHeight();});}
_createClass(Viewport,[{key:"getWorkspaceHeight",value:function getWorkspaceHeight(){var trimmingContainer=this.instance.wtOverlays.topOverlay.trimmingContainer;var elemHeight;var height=0;if(trimmingContainer===window){height=document.documentElement.clientHeight;}else{elemHeight=(0,_element.outerHeight)(trimmingContainer);height=elemHeight>0&&trimmingContainer.clientHeight>0?trimmingContainer.clientHeight:Infinity;}
return height;}},{key:"getWorkspaceWidth",value:function getWorkspaceWidth(){var width;var totalColumns=this.wot.getSetting('totalColumns');var trimmingContainer=this.instance.wtOverlays.leftOverlay.trimmingContainer;var overflow;var stretchSetting=this.wot.getSetting('stretchH');var docOffsetWidth=document.documentElement.offsetWidth;var preventOverflow=this.wot.getSetting('preventOverflow');if(preventOverflow){return(0,_element.outerWidth)(this.instance.wtTable.wtRootElement);}
if(this.wot.getSetting('freezeOverlays')){width=Math.min(docOffsetWidth-this.getWorkspaceOffset().left,docOffsetWidth);}else{width=Math.min(this.getContainerFillWidth(),docOffsetWidth-this.getWorkspaceOffset().left,docOffsetWidth);}
if(trimmingContainer===window&&totalColumns>0&&this.sumColumnWidths(0,totalColumns-1)>width){return document.documentElement.clientWidth;}
if(trimmingContainer!==window){overflow=(0,_element.getStyle)(this.instance.wtOverlays.leftOverlay.trimmingContainer,'overflow');if(overflow==='scroll'||overflow==='hidden'||overflow==='auto'){return Math.max(width,trimmingContainer.clientWidth);}}
if(stretchSetting==='none'||!stretchSetting){return Math.max(width,(0,_element.outerWidth)(this.instance.wtTable.TABLE));}
return width;}},{key:"hasVerticalScroll",value:function hasVerticalScroll(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight();}},{key:"hasHorizontalScroll",value:function hasHorizontalScroll(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth();}},{key:"sumColumnWidths",value:function sumColumnWidths(from,length){var wtTable=this.wot.wtTable;var sum=0;var column=from;while(column<length){sum+=wtTable.getColumnWidth(column);column+=1;}
return sum;}},{key:"getContainerFillWidth",value:function getContainerFillWidth(){if(this.containerWidth){return this.containerWidth;}
var mainContainer=this.instance.wtTable.holder;var dummyElement=document.createElement('div');dummyElement.style.width='100%';dummyElement.style.height='1px';mainContainer.appendChild(dummyElement);var fillWidth=dummyElement.offsetWidth;this.containerWidth=fillWidth;mainContainer.removeChild(dummyElement);return fillWidth;}},{key:"getWorkspaceOffset",value:function getWorkspaceOffset(){return(0,_element.offset)(this.wot.wtTable.TABLE);}},{key:"getWorkspaceActualHeight",value:function getWorkspaceActualHeight(){return(0,_element.outerHeight)(this.wot.wtTable.TABLE);}},{key:"getWorkspaceActualWidth",value:function getWorkspaceActualWidth(){return(0,_element.outerWidth)(this.wot.wtTable.TABLE)||(0,_element.outerWidth)(this.wot.wtTable.TBODY)||(0,_element.outerWidth)(this.wot.wtTable.THEAD);}},{key:"getColumnHeaderHeight",value:function getColumnHeaderHeight(){if(isNaN(this.columnHeaderHeight)){this.columnHeaderHeight=(0,_element.outerHeight)(this.wot.wtTable.THEAD);}
return this.columnHeaderHeight;}},{key:"getViewportHeight",value:function getViewportHeight(){var containerHeight=this.getWorkspaceHeight();if(containerHeight===Infinity){return containerHeight;}
var columnHeaderHeight=this.getColumnHeaderHeight();if(columnHeaderHeight>0){containerHeight-=columnHeaderHeight;}
return containerHeight;}},{key:"getRowHeaderWidth",value:function getRowHeaderWidth(){var rowHeadersHeightSetting=this.instance.getSetting('rowHeaderWidth');var rowHeaders=this.instance.getSetting('rowHeaders');if(rowHeadersHeightSetting){this.rowHeaderWidth=0;for(var i=0,len=rowHeaders.length;i<len;i++){this.rowHeaderWidth+=rowHeadersHeightSetting[i]||rowHeadersHeightSetting;}}
if(this.wot.cloneSource){return this.wot.cloneSource.wtViewport.getRowHeaderWidth();}
if(isNaN(this.rowHeaderWidth)){if(rowHeaders.length){var TH=this.instance.wtTable.TABLE.querySelector('TH');this.rowHeaderWidth=0;for(var _i=0,_len=rowHeaders.length;_i<_len;_i++){if(TH){this.rowHeaderWidth+=(0,_element.outerWidth)(TH);TH=TH.nextSibling;}else{this.rowHeaderWidth+=50;}}}else{this.rowHeaderWidth=0;}}
this.rowHeaderWidth=this.instance.getSetting('onModifyRowHeaderWidth',this.rowHeaderWidth)||this.rowHeaderWidth;return this.rowHeaderWidth;}},{key:"getViewportWidth",value:function getViewportWidth(){var containerWidth=this.getWorkspaceWidth();if(containerWidth===Infinity){return containerWidth;}
var rowHeaderWidth=this.getRowHeaderWidth();if(rowHeaderWidth>0){return containerWidth-rowHeaderWidth;}
return containerWidth;}},{key:"createRowsCalculator",value:function createRowsCalculator(){var _this2=this;var visible=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var height;var scrollbarHeight;var fixedRowsHeight;this.rowHeaderWidth=NaN;if(this.wot.wtSettings.settings.renderAllRows&&!visible){height=Infinity;}else{height=this.getViewportHeight();}
var pos=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset();if(pos<0){pos=0;}
var fixedRowsTop=this.wot.getSetting('fixedRowsTop');var fixedRowsBottom=this.wot.getSetting('fixedRowsBottom');var totalRows=this.wot.getSetting('totalRows');if(fixedRowsTop){fixedRowsHeight=this.wot.wtOverlays.topOverlay.sumCellSizes(0,fixedRowsTop);pos+=fixedRowsHeight;height-=fixedRowsHeight;}
if(fixedRowsBottom&&this.wot.wtOverlays.bottomOverlay.clone){fixedRowsHeight=this.wot.wtOverlays.bottomOverlay.sumCellSizes(totalRows-fixedRowsBottom,totalRows);height-=fixedRowsHeight;}
if(this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight){scrollbarHeight=0;}else{scrollbarHeight=(0,_element.getScrollbarWidth)();}
return new _viewportRows.default(height,pos,this.wot.getSetting('totalRows'),function(sourceRow){return _this2.wot.wtTable.getRowHeight(sourceRow);},visible?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,visible,scrollbarHeight);}},{key:"createColumnsCalculator",value:function createColumnsCalculator(){var _this3=this;var visible=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var width=this.getViewportWidth();var pos=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset();this.columnHeaderHeight=NaN;if(pos<0){pos=0;}
var fixedColumnsLeft=this.wot.getSetting('fixedColumnsLeft');if(fixedColumnsLeft){var fixedColumnsWidth=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,fixedColumnsLeft);pos+=fixedColumnsWidth;width-=fixedColumnsWidth;}
if(this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth){width-=(0,_element.getScrollbarWidth)();}
return new _viewportColumns.default(width,pos,this.wot.getSetting('totalColumns'),function(sourceCol){return _this3.wot.wtTable.getColumnWidth(sourceCol);},visible?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,visible,this.wot.getSetting('stretchH'),function(stretchedWidth,column){return _this3.wot.getSetting('onBeforeStretchingColumnWidth',stretchedWidth,column);});}},{key:"createRenderCalculators",value:function createRenderCalculators(){var fastDraw=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var runFastDraw=fastDraw;if(runFastDraw){var proposedRowsVisibleCalculator=this.createRowsCalculator(true);var proposedColumnsVisibleCalculator=this.createColumnsCalculator(true);if(!(this.areAllProposedVisibleRowsAlreadyRendered(proposedRowsVisibleCalculator)&&this.areAllProposedVisibleColumnsAlreadyRendered(proposedColumnsVisibleCalculator))){runFastDraw=false;}}
if(!runFastDraw){this.rowsRenderCalculator=this.createRowsCalculator();this.columnsRenderCalculator=this.createColumnsCalculator();}
this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;return runFastDraw;}},{key:"createVisibleCalculators",value:function createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(true);this.columnsVisibleCalculator=this.createColumnsCalculator(true);}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function areAllProposedVisibleRowsAlreadyRendered(proposedRowsVisibleCalculator){if(this.rowsVisibleCalculator){if(proposedRowsVisibleCalculator.startRow<this.rowsRenderCalculator.startRow||proposedRowsVisibleCalculator.startRow===this.rowsRenderCalculator.startRow&&proposedRowsVisibleCalculator.startRow>0){return false;}else if(proposedRowsVisibleCalculator.endRow>this.rowsRenderCalculator.endRow||proposedRowsVisibleCalculator.endRow===this.rowsRenderCalculator.endRow&&proposedRowsVisibleCalculator.endRow<this.wot.getSetting('totalRows')-1){return false;}
return true;}
return false;}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function areAllProposedVisibleColumnsAlreadyRendered(proposedColumnsVisibleCalculator){if(this.columnsVisibleCalculator){if(proposedColumnsVisibleCalculator.startColumn<this.columnsRenderCalculator.startColumn||proposedColumnsVisibleCalculator.startColumn===this.columnsRenderCalculator.startColumn&&proposedColumnsVisibleCalculator.startColumn>0){return false;}else if(proposedColumnsVisibleCalculator.endColumn>this.columnsRenderCalculator.endColumn||proposedColumnsVisibleCalculator.endColumn===this.columnsRenderCalculator.endColumn&&proposedColumnsVisibleCalculator.endColumn<this.wot.getSetting('totalColumns')-1){return false;}
return true;}
return false;}},{key:"resetHasOversizedColumnHeadersMarked",value:function resetHasOversizedColumnHeadersMarked(){(0,_object.objectEach)(this.hasOversizedColumnHeadersMarked,function(value,key,object){object[key]=void 0;});}}]);return Viewport;}();var _default=Viewport;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _event=__webpack_require__(18);var _object=__webpack_require__(2);var _browser=__webpack_require__(42);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _coords=_interopRequireDefault(__webpack_require__(75));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Border=function(){function Border(wotInstance,settings){_classCallCheck(this,Border);if(!settings){return;}
this.eventManager=new _eventManager.default(wotInstance);this.instance=wotInstance;this.wot=wotInstance;this.settings=settings;this.mouseDown=false;this.main=null;this.top=null;this.left=null;this.bottom=null;this.right=null;this.topStyle=null;this.leftStyle=null;this.bottomStyle=null;this.rightStyle=null;this.cornerDefaultStyle={width:'6px',height:'6px',borderWidth:'1px',borderStyle:'solid',borderColor:'#FFF'};this.corner=null;this.cornerStyle=null;this.createBorders(settings);this.registerListeners();}
_createClass(Border,[{key:"registerListeners",value:function registerListeners(){var _this2=this;this.eventManager.addEventListener(document.body,'mousedown',function(){return _this2.onMouseDown();});this.eventManager.addEventListener(document.body,'mouseup',function(){return _this2.onMouseUp();});var _loop=function _loop(c,len){_this2.eventManager.addEventListener(_this2.main.childNodes[c],'mouseenter',function(event){return _this2.onMouseEnter(event,_this2.main.childNodes[c]);});};for(var c=0,len=this.main.childNodes.length;c<len;c++){_loop(c,len);}}},{key:"onMouseDown",value:function onMouseDown(){this.mouseDown=true;}},{key:"onMouseUp",value:function onMouseUp(){this.mouseDown=false;}},{key:"onMouseEnter",value:function onMouseEnter(event,parentElement){if(!this.mouseDown||!this.wot.getSetting('hideBorderOnMouseDownOver')){return;}
event.preventDefault();(0,_event.stopImmediatePropagation)(event);var _this=this;var bounds=parentElement.getBoundingClientRect();parentElement.style.display='none';function isOutside(mouseEvent){if(mouseEvent.clientY<Math.floor(bounds.top)){return true;}
if(mouseEvent.clientY>Math.ceil(bounds.top+bounds.height)){return true;}
if(mouseEvent.clientX<Math.floor(bounds.left)){return true;}
if(mouseEvent.clientX>Math.ceil(bounds.left+bounds.width)){return true;}}
function handler(handlerEvent){if(isOutside(handlerEvent)){_this.eventManager.removeEventListener(document.body,'mousemove',handler);parentElement.style.display='block';}}
this.eventManager.addEventListener(document.body,'mousemove',handler);}},{key:"createBorders",value:function createBorders(settings){this.main=document.createElement('div');var borderDivs=['top','left','bottom','right','corner'];var style=this.main.style;style.position='absolute';style.top=0;style.left=0;for(var i=0;i<5;i++){var position=borderDivs[i];var div=document.createElement('div');div.className="wtBorder ".concat(this.settings.className||'');if(this.settings[position]&&this.settings[position].hide){div.className+=' hidden';}
style=div.style;style.backgroundColor=this.settings[position]&&this.settings[position].color?this.settings[position].color:settings.border.color;style.height=this.settings[position]&&this.settings[position].width?"".concat(this.settings[position].width,"px"):"".concat(settings.border.width,"px");style.width=this.settings[position]&&this.settings[position].width?"".concat(this.settings[position].width,"px"):"".concat(settings.border.width,"px");this.main.appendChild(div);}
this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=' corner';this.cornerStyle=this.corner.style;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.height=this.cornerDefaultStyle.height;this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(' ');if((0,_browser.isMobileBrowser)()){this.createMultipleSelectorHandles();}
this.disappear();var bordersHolder=this.wot.wtTable.bordersHolder;if(!bordersHolder){bordersHolder=document.createElement('div');bordersHolder.className='htBorders';this.wot.wtTable.bordersHolder=bordersHolder;this.wot.wtTable.spreader.appendChild(bordersHolder);}
bordersHolder.appendChild(this.main);}},{key:"createMultipleSelectorHandles",value:function createMultipleSelectorHandles(){var _this3=this;this.selectionHandles={topLeft:document.createElement('DIV'),topLeftHitArea:document.createElement('DIV'),bottomRight:document.createElement('DIV'),bottomRightHitArea:document.createElement('DIV')};var width=10;var hitAreaWidth=40;this.selectionHandles.topLeft.className='topLeftSelectionHandle';this.selectionHandles.topLeftHitArea.className='topLeftSelectionHandle-HitArea';this.selectionHandles.bottomRight.className='bottomRightSelectionHandle';this.selectionHandles.bottomRightHitArea.className='bottomRightSelectionHandle-HitArea';this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var hitAreaStyle={position:'absolute',height:"".concat(hitAreaWidth,"px"),width:"".concat(hitAreaWidth,"px"),'border-radius':"".concat(parseInt(hitAreaWidth/1.5,10),"px")};(0,_object.objectEach)(hitAreaStyle,function(value,key){_this3.selectionHandles.styles.bottomRightHitArea[key]=value;_this3.selectionHandles.styles.topLeftHitArea[key]=value;});var handleStyle={position:'absolute',height:"".concat(width,"px"),width:"".concat(width,"px"),'border-radius':"".concat(parseInt(width/1.5,10),"px"),background:'#F5F5FF',border:'1px solid #4285c8'};(0,_object.objectEach)(handleStyle,function(value,key){_this3.selectionHandles.styles.bottomRight[key]=value;_this3.selectionHandles.styles.topLeft[key]=value;});this.main.appendChild(this.selectionHandles.topLeft);this.main.appendChild(this.selectionHandles.bottomRight);this.main.appendChild(this.selectionHandles.topLeftHitArea);this.main.appendChild(this.selectionHandles.bottomRightHitArea);}},{key:"isPartRange",value:function isPartRange(row,col){var areaSelection=this.wot.selections.createOrGetArea();if(areaSelection.cellRange){if(row!==areaSelection.cellRange.to.row||col!==areaSelection.cellRange.to.col){return true;}}
return false;}},{key:"updateMultipleSelectionHandlesPosition",value:function updateMultipleSelectionHandlesPosition(row,col,top,left,width,height){var handleWidth=parseInt(this.selectionHandles.styles.topLeft.width,10);var hitAreaWidth=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top="".concat(parseInt(top-handleWidth,10),"px");this.selectionHandles.styles.topLeft.left="".concat(parseInt(left-handleWidth,10),"px");this.selectionHandles.styles.topLeftHitArea.top="".concat(parseInt(top-hitAreaWidth/4*3,10),"px");this.selectionHandles.styles.topLeftHitArea.left="".concat(parseInt(left-hitAreaWidth/4*3,10),"px");this.selectionHandles.styles.bottomRight.top="".concat(parseInt(top+height,10),"px");this.selectionHandles.styles.bottomRight.left="".concat(parseInt(left+width,10),"px");this.selectionHandles.styles.bottomRightHitArea.top="".concat(parseInt(top+height-hitAreaWidth/4,10),"px");this.selectionHandles.styles.bottomRightHitArea.left="".concat(parseInt(left+width-hitAreaWidth/4,10),"px");if(this.settings.border.cornerVisible&&this.settings.border.cornerVisible()){this.selectionHandles.styles.topLeft.display='block';this.selectionHandles.styles.topLeftHitArea.display='block';if(this.isPartRange(row,col)){this.selectionHandles.styles.bottomRight.display='none';this.selectionHandles.styles.bottomRightHitArea.display='none';}else{this.selectionHandles.styles.bottomRight.display='block';this.selectionHandles.styles.bottomRightHitArea.display='block';}}else{this.selectionHandles.styles.topLeft.display='none';this.selectionHandles.styles.bottomRight.display='none';this.selectionHandles.styles.topLeftHitArea.display='none';this.selectionHandles.styles.bottomRightHitArea.display='none';}
if(row===this.wot.wtSettings.getSetting('fixedRowsTop')||col===this.wot.wtSettings.getSetting('fixedColumnsLeft')){this.selectionHandles.styles.topLeft.zIndex='9999';this.selectionHandles.styles.topLeftHitArea.zIndex='9999';}else{this.selectionHandles.styles.topLeft.zIndex='';this.selectionHandles.styles.topLeftHitArea.zIndex='';}}},{key:"appear",value:function appear(corners){if(this.disabled){return;}
var fromRow;var toRow;var fromColumn;var toColumn;var rowsCount=this.wot.wtTable.getRenderedRowsCount();for(var i=0;i<rowsCount;i+=1){var s=this.wot.wtTable.rowFilter.renderedToSource(i);if(s>=corners[0]&&s<=corners[2]){fromRow=s;break;}}
for(var _i=rowsCount-1;_i>=0;_i-=1){var _s=this.wot.wtTable.rowFilter.renderedToSource(_i);if(_s>=corners[0]&&_s<=corners[2]){toRow=_s;break;}}
var columnsCount=this.wot.wtTable.getRenderedColumnsCount();for(var _i2=0;_i2<columnsCount;_i2+=1){var _s2=this.wot.wtTable.columnFilter.renderedToSource(_i2);if(_s2>=corners[1]&&_s2<=corners[3]){fromColumn=_s2;break;}}
for(var _i3=columnsCount-1;_i3>=0;_i3-=1){var _s3=this.wot.wtTable.columnFilter.renderedToSource(_i3);if(_s3>=corners[1]&&_s3<=corners[3]){toColumn=_s3;break;}}
if(fromRow===void 0||fromColumn===void 0){this.disappear();return;}
var fromTD=this.wot.wtTable.getCell(new _coords.default(fromRow,fromColumn));var isMultiple=fromRow!==toRow||fromColumn!==toColumn;var toTD=isMultiple?this.wot.wtTable.getCell(new _coords.default(toRow,toColumn)):fromTD;var fromOffset=(0,_element.offset)(fromTD);var toOffset=isMultiple?(0,_element.offset)(toTD):fromOffset;var containerOffset=(0,_element.offset)(this.wot.wtTable.TABLE);var minTop=fromOffset.top;var minLeft=fromOffset.left;var left=minLeft-containerOffset.left-1;var width=toOffset.left+(0,_element.outerWidth)(toTD)-minLeft;if(this.isEntireColumnSelected(fromRow,toRow)){var modifiedValues=this.getDimensionsFromHeader('columns',fromColumn,toColumn,containerOffset);var fromTH=null;if(modifiedValues){var _modifiedValues=_slicedToArray(modifiedValues,3);fromTH=_modifiedValues[0];left=_modifiedValues[1];width=_modifiedValues[2];}
if(fromTH){fromTD=fromTH;}}
var top=minTop-containerOffset.top-1;var height=toOffset.top+(0,_element.outerHeight)(toTD)-minTop;if(this.isEntireRowSelected(fromColumn,toColumn)){var _modifiedValues2=this.getDimensionsFromHeader('rows',fromRow,toRow,containerOffset);var _fromTH=null;if(_modifiedValues2){var _modifiedValues3=_slicedToArray(_modifiedValues2,3);_fromTH=_modifiedValues3[0];top=_modifiedValues3[1];height=_modifiedValues3[2];}
if(_fromTH){fromTD=_fromTH;}}
var style=(0,_element.getComputedStyle)(fromTD);if(parseInt(style.borderTopWidth,10)>0){top+=1;height=height>0?height-1:0;}
if(parseInt(style.borderLeftWidth,10)>0){left+=1;width=width>0?width-1:0;}
this.topStyle.top="".concat(top,"px");this.topStyle.left="".concat(left,"px");this.topStyle.width="".concat(width,"px");this.topStyle.display='block';this.leftStyle.top="".concat(top,"px");this.leftStyle.left="".concat(left,"px");this.leftStyle.height="".concat(height,"px");this.leftStyle.display='block';var delta=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(top+height-delta,"px");this.bottomStyle.left="".concat(left,"px");this.bottomStyle.width="".concat(width,"px");this.bottomStyle.display='block';this.rightStyle.top="".concat(top,"px");this.rightStyle.left="".concat(left+width-delta,"px");this.rightStyle.height="".concat(height+1,"px");this.rightStyle.display='block';var cornerVisibleSetting=this.settings.border.cornerVisible;cornerVisibleSetting=typeof cornerVisibleSetting==='function'?cornerVisibleSetting(this.settings.layerLevel):cornerVisibleSetting;var hookResult=this.wot.getSetting('onModifyGetCellCoords',toRow,toColumn);var checkRow=toRow,checkCol=toColumn;if(hookResult&&Array.isArray(hookResult)){var _hookResult=_slicedToArray(hookResult,4);checkRow=_hookResult[2];checkCol=_hookResult[3];}
if((0,_browser.isMobileBrowser)()||!cornerVisibleSetting||this.isPartRange(checkRow,checkCol)){this.cornerStyle.display='none';}else{this.cornerStyle.top="".concat(top+height-4,"px");this.cornerStyle.left="".concat(left+width-4,"px");this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.display='none';var trimmingContainer=(0,_element.getTrimmingContainer)(this.wot.wtTable.TABLE);var trimToWindow=trimmingContainer===window;if(trimToWindow){trimmingContainer=document.documentElement;}
if(toColumn===this.wot.getSetting('totalColumns')-1){var toTdOffsetLeft=trimToWindow?toTD.getBoundingClientRect().left:toTD.offsetLeft;var cornerRightEdge=toTdOffsetLeft+(0,_element.outerWidth)(toTD)+parseInt(this.cornerDefaultStyle.width,10)/2;var cornerOverlappingContainer=cornerRightEdge>=(0,_element.innerWidth)(trimmingContainer);if(cornerOverlappingContainer){this.cornerStyle.left="".concat(Math.floor(left+width-3-parseInt(this.cornerDefaultStyle.width,10)/2),"px");this.cornerStyle.borderRightWidth=0;}}
if(toRow===this.wot.getSetting('totalRows')-1){var toTdOffsetTop=trimToWindow?toTD.getBoundingClientRect().top:toTD.offsetTop;var cornerBottomEdge=toTdOffsetTop+(0,_element.outerHeight)(toTD)+parseInt(this.cornerDefaultStyle.height,10)/2;var _cornerOverlappingContainer=cornerBottomEdge>=(0,_element.innerHeight)(trimmingContainer);if(_cornerOverlappingContainer){this.cornerStyle.top="".concat(Math.floor(top+height-3-parseInt(this.cornerDefaultStyle.height,10)/2),"px");this.cornerStyle.borderBottomWidth=0;}}
this.cornerStyle.display='block';}
if((0,_browser.isMobileBrowser)()){this.updateMultipleSelectionHandlesPosition(toRow,toColumn,top,left,width,height);}}},{key:"isEntireColumnSelected",value:function isEntireColumnSelected(startRowIndex,endRowIndex){return startRowIndex===this.wot.wtTable.getFirstRenderedRow()&&endRowIndex===this.wot.wtTable.getLastRenderedRow();}},{key:"isEntireRowSelected",value:function isEntireRowSelected(startColumnIndex,endColumnIndex){return startColumnIndex===this.wot.wtTable.getFirstRenderedColumn()&&endColumnIndex===this.wot.wtTable.getLastRenderedColumn();}},{key:"getDimensionsFromHeader",value:function getDimensionsFromHeader(direction,fromIndex,toIndex,containerOffset){var _this4=this;var rootHotElement=this.wot.wtTable.wtRootElement.parentNode;var getHeaderFn=null;var dimensionFn=null;var entireSelectionClassname=null;var index=null;var dimension=null;var dimensionProperty=null;var startHeader=null;var endHeader=null;switch(direction){case'rows':getHeaderFn=function getHeaderFn(){var _this4$wot$wtTable;return(_this4$wot$wtTable=_this4.wot.wtTable).getRowHeader.apply(_this4$wot$wtTable,arguments);};dimensionFn=function dimensionFn(){return _element.outerHeight.apply(void 0,arguments);};entireSelectionClassname='ht__selection--rows';dimensionProperty='top';break;case'columns':getHeaderFn=function getHeaderFn(){var _this4$wot$wtTable2;return(_this4$wot$wtTable2=_this4.wot.wtTable).getColumnHeader.apply(_this4$wot$wtTable2,arguments);};dimensionFn=function dimensionFn(){return _element.outerWidth.apply(void 0,arguments);};entireSelectionClassname='ht__selection--columns';dimensionProperty='left';break;default:}
if(rootHotElement.className.includes(entireSelectionClassname)){var columnHeaderLevelCount=this.wot.getSetting('columnHeaders').length;startHeader=getHeaderFn(fromIndex,columnHeaderLevelCount-1);endHeader=getHeaderFn(toIndex,columnHeaderLevelCount-1);if(!startHeader||!endHeader){return false;}
var startHeaderOffset=(0,_element.offset)(startHeader);var endOffset=(0,_element.offset)(endHeader);if(startHeader&&endHeader){index=startHeaderOffset[dimensionProperty]-containerOffset[dimensionProperty]-1;dimension=endOffset[dimensionProperty]+dimensionFn(endHeader)-startHeaderOffset[dimensionProperty];}
return[startHeader,index,dimension];}
return false;}},{key:"changeBorderStyle",value:function changeBorderStyle(borderElement,border){var style=this[borderElement].style;var borderStyle=border[borderElement];if(!borderStyle||borderStyle.hide){(0,_element.addClass)(this[borderElement],'hidden');}else{if((0,_element.hasClass)(this[borderElement],'hidden')){(0,_element.removeClass)(this[borderElement],'hidden');}
style.backgroundColor=borderStyle.color;if(borderElement==='top'||borderElement==='bottom'){style.height="".concat(borderStyle.width,"px");}
if(borderElement==='right'||borderElement==='left'){style.width="".concat(borderStyle.width,"px");}}}},{key:"changeBorderToDefaultStyle",value:function changeBorderToDefaultStyle(position){var defaultBorder={width:1,color:'#000'};var style=this[position].style;style.backgroundColor=defaultBorder.color;style.width="".concat(defaultBorder.width,"px");style.height="".concat(defaultBorder.width,"px");}},{key:"toggleHiddenClass",value:function toggleHiddenClass(borderElement,remove){this.changeBorderToDefaultStyle(borderElement);if(remove){(0,_element.addClass)(this[borderElement],'hidden');}else{(0,_element.removeClass)(this[borderElement],'hidden');}}},{key:"disappear",value:function disappear(){this.topStyle.display='none';this.leftStyle.display='none';this.bottomStyle.display='none';this.rightStyle.display='none';this.cornerStyle.display='none';if((0,_browser.isMobileBrowser)()){this.selectionHandles.styles.topLeft.display='none';this.selectionHandles.styles.bottomRight.display='none';}}}]);return Border;}();var _default=Border;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _unicode=__webpack_require__(32);var _mixed=__webpack_require__(14);var _string=__webpack_require__(48);var _array=__webpack_require__(3);var _element=__webpack_require__(1);var _handsontableEditor=_interopRequireDefault(__webpack_require__(295));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var AutocompleteEditor=_handsontableEditor.default.prototype.extend();AutocompleteEditor.prototype.init=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
_handsontableEditor.default.prototype.init.apply(this,args);this.query=null;this.strippedChoices=[];this.rawChoices=[];};AutocompleteEditor.prototype.getValue=function(){var _this2=this;var selectedValue=this.rawChoices.find(function(value){var strippedValue=_this2.stripValueIfNeeded(value);return strippedValue===_this2.TEXTAREA.value;});if((0,_mixed.isDefined)(selectedValue)){return selectedValue;}
return this.TEXTAREA.value;};AutocompleteEditor.prototype.createElements=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}
_handsontableEditor.default.prototype.createElements.apply(this,args);(0,_element.addClass)(this.htContainer,'autocompleteEditor');(0,_element.addClass)(this.htContainer,window.navigator.platform.indexOf('Mac')===-1?'':'htMacScroll');};var skipOne=false;function onBeforeKeyDown(event){skipOne=false;var editor=this.getActiveEditor();if((0,_unicode.isPrintableChar)(event.keyCode)||event.keyCode===_unicode.KEY_CODES.BACKSPACE||event.keyCode===_unicode.KEY_CODES.DELETE||event.keyCode===_unicode.KEY_CODES.INSERT){var timeOffset=0;if(event.keyCode===_unicode.KEY_CODES.C&&(event.ctrlKey||event.metaKey)){return;}
if(!editor.isOpened()){timeOffset+=10;}
if(editor.htEditor){editor.instance._registerTimeout(function(){editor.queryChoices(editor.TEXTAREA.value);skipOne=true;},timeOffset);}}}
AutocompleteEditor.prototype.prepare=function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3];}
_handsontableEditor.default.prototype.prepare.apply(this,args);};AutocompleteEditor.prototype.open=function(){this.instance.addHook('beforeKeyDown',onBeforeKeyDown);this.TEXTAREA_PARENT.style.overflow='auto';for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4];}
_handsontableEditor.default.prototype.open.apply(this,args);this.TEXTAREA_PARENT.style.overflow='';var choicesListHot=this.htEditor.getInstance();var _this=this;var trimDropdown=this.cellProperties.trimDropdown===void 0?true:this.cellProperties.trimDropdown;this.showEditableElement();this.focus();choicesListHot.updateSettings({colWidths:trimDropdown?[(0,_element.outerWidth)(this.TEXTAREA)-2]:void 0,width:trimDropdown?(0,_element.outerWidth)(this.TEXTAREA)+(0,_element.getScrollbarWidth)()+2:void 0,afterRenderer:function afterRenderer(TD,row,col,prop,value){var _this$cellProperties=_this.cellProperties,filteringCaseSensitive=_this$cellProperties.filteringCaseSensitive,allowHtml=_this$cellProperties.allowHtml;var cellValue=(0,_mixed.stringify)(value);var indexOfMatch;var match;if(cellValue&&!allowHtml){indexOfMatch=filteringCaseSensitive===true?cellValue.indexOf(this.query):cellValue.toLowerCase().indexOf(_this.query.toLowerCase());if(indexOfMatch!==-1){match=cellValue.substr(indexOfMatch,_this.query.length);cellValue=cellValue.replace(match,"<strong>".concat(match,"</strong>"));}}
TD.innerHTML=cellValue;},autoColumnSize:true,modifyColWidth:function modifyColWidth(width,col){var autoWidths=this.getPlugin('autoColumnSize').widths;var columnWidth=width;if(autoWidths[col]){columnWidth=autoWidths[col];}
return trimDropdown?columnWidth:columnWidth+15;}});this.htEditor.view.wt.wtTable.holder.parentNode.style['padding-right']="".concat((0,_element.getScrollbarWidth)()+2,"px");if(skipOne){skipOne=false;}
_this.instance._registerTimeout(function(){_this.queryChoices(_this.TEXTAREA.value);});};AutocompleteEditor.prototype.queryChoices=function(query){var _this3=this;this.query=query;var source=this.cellProperties.source;if(typeof source==='function'){source.call(this.cellProperties,query,function(choices){_this3.rawChoices=choices;_this3.updateChoicesList(_this3.stripValuesIfNeeded(choices));});}else if(Array.isArray(source)){this.rawChoices=source;this.updateChoicesList(this.stripValuesIfNeeded(source));}else{this.updateChoicesList([]);}};AutocompleteEditor.prototype.updateChoicesList=function(choicesList){var pos=(0,_element.getCaretPosition)(this.TEXTAREA);var endPos=(0,_element.getSelectionEndPosition)(this.TEXTAREA);var sortByRelevanceSetting=this.cellProperties.sortByRelevance;var filterSetting=this.cellProperties.filter;var orderByRelevance=null;var highlightIndex=null;var choices=choicesList;if(sortByRelevanceSetting){orderByRelevance=AutocompleteEditor.sortByRelevance(this.stripValueIfNeeded(this.getValue()),choices,this.cellProperties.filteringCaseSensitive);}
var orderByRelevanceLength=Array.isArray(orderByRelevance)?orderByRelevance.length:0;if(filterSetting===false){if(orderByRelevanceLength){highlightIndex=orderByRelevance[0];}}else{var sorted=[];for(var i=0,choicesCount=choices.length;i<choicesCount;i++){if(sortByRelevanceSetting&&orderByRelevanceLength<=i){break;}
if(orderByRelevanceLength){sorted.push(choices[orderByRelevance[i]]);}else{sorted.push(choices[i]);}}
highlightIndex=0;choices=sorted;}
this.strippedChoices=choices;this.htEditor.loadData((0,_array.pivot)([choices]));this.updateDropdownHeight();this.flipDropdownIfNeeded();if(this.cellProperties.strict===true){this.highlightBestMatchingChoice(highlightIndex);}
this.instance.listen(false);(0,_element.setCaretPosition)(this.TEXTAREA,pos,pos===endPos?void 0:endPos);};AutocompleteEditor.prototype.flipDropdownIfNeeded=function(){var textareaOffset=(0,_element.offset)(this.TEXTAREA);var textareaHeight=(0,_element.outerHeight)(this.TEXTAREA);var dropdownHeight=this.getDropdownHeight();var trimmingContainer=(0,_element.getTrimmingContainer)(this.instance.view.wt.wtTable.TABLE);var trimmingContainerScrollTop=trimmingContainer.scrollTop;var headersHeight=(0,_element.outerHeight)(this.instance.view.wt.wtTable.THEAD);var containerOffset={row:0,col:0};if(trimmingContainer!==window){containerOffset=(0,_element.offset)(trimmingContainer);}
var spaceAbove=textareaOffset.top-containerOffset.top-headersHeight+trimmingContainerScrollTop;var spaceBelow=trimmingContainer.scrollHeight-spaceAbove-headersHeight-textareaHeight;var flipNeeded=dropdownHeight>spaceBelow&&spaceAbove>spaceBelow;if(flipNeeded){this.flipDropdown(dropdownHeight);}else{this.unflipDropdown();}
this.limitDropdownIfNeeded(flipNeeded?spaceAbove:spaceBelow,dropdownHeight);return flipNeeded;};AutocompleteEditor.prototype.limitDropdownIfNeeded=function(spaceAvailable,dropdownHeight){if(dropdownHeight>spaceAvailable){var tempHeight=0;var i=0;var lastRowHeight=0;var height=null;do{lastRowHeight=this.htEditor.getRowHeight(i)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight;tempHeight+=lastRowHeight;i+=1;}while(tempHeight<spaceAvailable);height=tempHeight-lastRowHeight;if(this.htEditor.flipped){this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+dropdownHeight-height,"px");}
this.setDropdownHeight(tempHeight-lastRowHeight);}};AutocompleteEditor.prototype.flipDropdown=function(dropdownHeight){var dropdownStyle=this.htEditor.rootElement.style;dropdownStyle.position='absolute';dropdownStyle.top="".concat(-dropdownHeight,"px");this.htEditor.flipped=true;};AutocompleteEditor.prototype.unflipDropdown=function(){var dropdownStyle=this.htEditor.rootElement.style;if(dropdownStyle.position==='absolute'){dropdownStyle.position='';dropdownStyle.top='';}
this.htEditor.flipped=void 0;};AutocompleteEditor.prototype.updateDropdownHeight=function(){var currentDropdownWidth=this.htEditor.getColWidth(0)+(0,_element.getScrollbarWidth)()+2;var trimDropdown=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:trimDropdown?void 0:currentDropdownWidth});this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer();};AutocompleteEditor.prototype.setDropdownHeight=function(height){this.htEditor.updateSettings({height:height});};AutocompleteEditor.prototype.finishEditing=function(restoreOriginalValue){for(var _len5=arguments.length,args=new Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++){args[_key5-1]=arguments[_key5];}
_handsontableEditor.default.prototype.finishEditing.apply(this,[restoreOriginalValue].concat(args));};AutocompleteEditor.prototype.highlightBestMatchingChoice=function(index){if(typeof index==='number'){this.htEditor.selectCell(index,0,void 0,void 0,void 0,false);}else{this.htEditor.deselectCell();}};AutocompleteEditor.sortByRelevance=function(value,choices,caseSensitive){var choicesRelevance=[];var currentItem;var valueLength=value.length;var valueIndex;var charsLeft;var result=[];var i;var choicesCount=choices.length;if(valueLength===0){for(i=0;i<choicesCount;i++){result.push(i);}
return result;}
for(i=0;i<choicesCount;i++){currentItem=(0,_string.stripTags)((0,_mixed.stringify)(choices[i]));if(caseSensitive){valueIndex=currentItem.indexOf(value);}else{valueIndex=currentItem.toLowerCase().indexOf(value.toLowerCase());}
if(valueIndex!==-1){charsLeft=currentItem.length-valueIndex-valueLength;choicesRelevance.push({baseIndex:i,index:valueIndex,charsLeft:charsLeft,value:currentItem});}}
choicesRelevance.sort(function(a,b){if(b.index===-1){return-1;}
if(a.index===-1){return 1;}
if(a.index<b.index){return-1;}else if(b.index<a.index){return 1;}else if(a.index===b.index){if(a.charsLeft<b.charsLeft){return-1;}else if(a.charsLeft>b.charsLeft){return 1;}}
return 0;});for(i=0,choicesCount=choicesRelevance.length;i<choicesCount;i++){result.push(choicesRelevance[i].baseIndex);}
return result;};AutocompleteEditor.prototype.getDropdownHeight=function(){var firstRowHeight=this.htEditor.getInstance().getRowHeight(0)||23;var visibleRows=this.cellProperties.visibleRows;return this.strippedChoices.length>=visibleRows?visibleRows*firstRowHeight:this.strippedChoices.length*firstRowHeight+8;};AutocompleteEditor.prototype.stripValueIfNeeded=function(value){return this.stripValuesIfNeeded([value])[0];};AutocompleteEditor.prototype.stripValuesIfNeeded=function(values){var allowHtml=this.cellProperties.allowHtml;var stringifiedValues=(0,_array.arrayMap)(values,function(value){return(0,_mixed.stringify)(value);});var strippedValues=(0,_array.arrayMap)(stringifiedValues,function(value){return allowHtml?value:(0,_string.stripTags)(value);});return strippedValues;};AutocompleteEditor.prototype.allowKeyEventPropagation=function(keyCode){var selectedRange=this.htEditor.getSelectedRangeLast();var selected={row:selectedRange?selectedRange.from.row:-1};var allowed=false;if(keyCode===_unicode.KEY_CODES.ARROW_DOWN&&selected.row>0&&selected.row<this.htEditor.countRows()-1){allowed=true;}
if(keyCode===_unicode.KEY_CODES.ARROW_UP&&selected.row>-1){allowed=true;}
return allowed;};AutocompleteEditor.prototype.close=function(){this.instance.removeHook('beforeKeyDown',onBeforeKeyDown);for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++){args[_key6]=arguments[_key6];}
_handsontableEditor.default.prototype.close.apply(this,args);};AutocompleteEditor.prototype.discardEditor=function(){for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++){args[_key7]=arguments[_key7];}
_handsontableEditor.default.prototype.discardEditor.apply(this,args);this.instance.view.render();};var _default=AutocompleteEditor;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _unicode=__webpack_require__(32);var _object=__webpack_require__(2);var _element=__webpack_require__(1);var _event=__webpack_require__(18);var _textEditor=_interopRequireDefault(__webpack_require__(77));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var HandsontableEditor=_textEditor.default.prototype.extend();HandsontableEditor.prototype.createElements=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
_textEditor.default.prototype.createElements.apply(this,args);var DIV=document.createElement('DIV');DIV.className='handsontableEditor';this.TEXTAREA_PARENT.appendChild(DIV);this.htContainer=DIV;this.assignHooks();};HandsontableEditor.prototype.prepare=function(td,row,col,prop,value,cellProperties){for(var _len2=arguments.length,args=new Array(_len2>6?_len2-6:0),_key2=6;_key2<_len2;_key2++){args[_key2-6]=arguments[_key2];}
_textEditor.default.prototype.prepare.apply(this,[td,row,col,prop,value,cellProperties].concat(args));var parent=this;var options={startRows:0,startCols:0,minRows:0,minCols:0,className:'listbox',copyPaste:false,autoColumnSize:false,autoRowSize:false,readOnly:true,fillHandle:false,autoWrapCol:false,autoWrapRow:false,afterOnCellMouseDown:function afterOnCellMouseDown(_,coords){var sourceValue=this.getSourceData(coords.row,coords.col);if(sourceValue!==void 0){parent.setValue(sourceValue);}
parent.instance.destroyEditor();}};if(this.cellProperties.handsontable){(0,_object.extend)(options,cellProperties.handsontable);}
this.htOptions=options;};var onBeforeKeyDown=function onBeforeKeyDown(event){if((0,_event.isImmediatePropagationStopped)(event)){return;}
var editor=this.getActiveEditor();var innerHOT=editor.htEditor.getInstance();var rowToSelect;var selectedRow;if(event.keyCode===_unicode.KEY_CODES.ARROW_DOWN){if(!innerHOT.getSelectedLast()&&!innerHOT.flipped){rowToSelect=0;}else if(innerHOT.getSelectedLast()){if(innerHOT.flipped){rowToSelect=innerHOT.getSelectedLast()[0]+1;}else if(!innerHOT.flipped){var lastRow=innerHOT.countRows()-1;selectedRow=innerHOT.getSelectedLast()[0];rowToSelect=Math.min(lastRow,selectedRow+1);}}}else if(event.keyCode===_unicode.KEY_CODES.ARROW_UP){if(!innerHOT.getSelectedLast()&&innerHOT.flipped){rowToSelect=innerHOT.countRows()-1;}else if(innerHOT.getSelectedLast()){if(innerHOT.flipped){selectedRow=innerHOT.getSelectedLast()[0];rowToSelect=Math.max(0,selectedRow-1);}else{selectedRow=innerHOT.getSelectedLast()[0];rowToSelect=selectedRow-1;}}}
if(rowToSelect!==void 0){if(rowToSelect<0||innerHOT.flipped&&rowToSelect>innerHOT.countRows()-1){innerHOT.deselectCell();}else{innerHOT.selectCell(rowToSelect,0);}
if(innerHOT.getData().length){event.preventDefault();(0,_event.stopImmediatePropagation)(event);editor.instance.listen();editor.TEXTAREA.focus();}}};HandsontableEditor.prototype.open=function(){this.instance.addHook('beforeKeyDown',onBeforeKeyDown);for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3];}
_textEditor.default.prototype.open.apply(this,args);if(this.htEditor){this.htEditor.destroy();}
if(this.htContainer.style.display==='none'){this.htContainer.style.display='';}
this.htEditor=new this.instance.constructor(this.htContainer,this.htOptions);this.htEditor.init();this.htEditor.rootElement.style.display='';if(this.cellProperties.strict){this.htEditor.selectCell(0,0);}else{this.htEditor.deselectCell();}
(0,_element.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length);};HandsontableEditor.prototype.close=function(){this.htEditor.rootElement.style.display='none';this.instance.removeHook('beforeKeyDown',onBeforeKeyDown);for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4];}
_textEditor.default.prototype.close.apply(this,args);};HandsontableEditor.prototype.focus=function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5];}
_textEditor.default.prototype.focus.apply(this,args);};HandsontableEditor.prototype.beginEditing=function(){var onBeginEditing=this.instance.getSettings().onBeginEditing;if(onBeginEditing&&onBeginEditing()===false){return;}
for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++){args[_key6]=arguments[_key6];}
_textEditor.default.prototype.beginEditing.apply(this,args);};HandsontableEditor.prototype.finishEditing=function(){if(this.htEditor&&this.htEditor.isListening()){this.instance.listen();}
if(this.htEditor&&this.htEditor.getSelectedLast()){var value=this.htEditor.getInstance().getValue();if(value!==void 0){this.setValue(value);}}
for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++){args[_key7]=arguments[_key7];}
return _textEditor.default.prototype.finishEditing.apply(this,args);};HandsontableEditor.prototype.assignHooks=function(){var _this=this;this.instance.addHook('afterDestroy',function(){if(_this.htEditor){_this.htEditor.destroy();}});};var _default=HandsontableEditor;exports.default=_default;}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports,__webpack_require__){var require;var require;!function(e){if(true)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).numbro=e()}}(function(){return function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var s="function"==typeof require&&require;if(!u&&s)return require(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return i(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){!function(e){"use strict";function n(e){function t(e,n){var r,i,a,o,u,s,c=this;if(!(c instanceof t))return q&&_(26,"constructor call without new",e),new t(e,n);if(null!=n&&Z(n,2,64,T,"base")){if(n|=0,s=e+"",10==n)return c=new t(e instanceof t?e:s),A(c,C+c.e+1,R);if((o="number"==typeof e)&&0*e!=0||!new RegExp("^-?"+(r="["+b.slice(0,n)+"]+")+"(?:\\."+r+")?$",n<37?"i":"").test(s))return E(c,s,o,n);o?(c.s=1/e<0?(s=s.slice(1),-1):1,q&&s.replace(/^0\.0*|\./,"").length>15&&_(T,y,e),o=!1):c.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1,s=g(s,10,n,c.s)}else{if(e instanceof t)return c.s=e.s,c.e=e.e,c.c=(e=e.c)?e.slice():e,void(T=0);if((o="number"==typeof e)&&0*e==0){if(c.s=1/e<0?(e=-e,-1):1,e===~~e){for(i=0,a=e;a>=10;a/=10,i++);return c.e=i,c.c=[e],void(T=0)}s=e+""}else{if(!p.test(s=e+""))return E(c,s,o);c.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1}}for((i=s.indexOf("."))>-1&&(s=s.replace(".","")),(a=s.search(/e/i))>0?(i<0&&(i=a),i+=+s.slice(a+1),s=s.substring(0,a)):i<0&&(i=s.length),a=0;48===s.charCodeAt(a);a++);for(u=s.length;48===s.charCodeAt(--u););if(s=s.slice(a,u+1))if(u=s.length,o&&q&&u>15&&(e>S||e!==h(e))&&_(T,y,c.s*e),(i=i-a-1)>V)c.c=c.e=null;else if(i<I)c.c=[c.e=0];else{if(c.e=i,c.c=[],a=(i+1)%x,i<0&&(a+=x),a<u){for(a&&c.c.push(+s.slice(0,a)),u-=x;a<u;)c.c.push(+s.slice(a,a+=x));s=s.slice(a),a=x-s.length}else a-=u;for(;a--;s+="0");c.c.push(+s)}else c.c=[c.e=0];T=0}function g(e,n,r,a){var o,u,c,f,g,p,d,h=e.indexOf("."),v=C,m=R;for(r<37&&(e=e.toLowerCase()),h>=0&&(c=W,W=0,e=e.replace(".",""),g=(d=new t(r)).pow(e.length-h),W=c,d.c=s(l(i(g.c),g.e),10,n),d.e=d.c.length),u=c=(p=s(e,r,n)).length;0==p[--c];p.pop());if(!p[0])return"0";if(h<0?--u:(g.c=p,g.e=u,g.s=a,p=(g=L(g,d,v,m,n)).c,f=g.r,u=g.e),o=u+v+1,h=p[o],c=n/2,f=f||o<0||null!=p[o+1],f=m<4?(null!=h||f)&&(0==m||m==(g.s<0?3:2)):h>c||h==c&&(4==m||f||6==m&&1&p[o-1]||m==(g.s<0?8:7)),o<1||!p[0])e=f?l("1",-v):"0";else{if(p.length=o,f)for(--n;++p[--o]>n;)p[o]=0,o||(++u,p=[1].concat(p));for(c=p.length;!p[--c];);for(h=0,e="";h<=c;e+=b.charAt(p[h++]));e=l(e,u)}return e}function F(e,n,r,a){var o,u,s,f,g;if(r=null!=r&&Z(r,0,8,a,m)?0|r:R,!e.c)return e.toString();if(o=e.c[0],s=e.e,null==n)g=i(e.c),g=19==a||24==a&&s<=$?c(g,s):l(g,s);else if(e=A(new t(e),n,r),u=e.e,g=i(e.c),f=g.length,19==a||24==a&&(n<=u||u<=$)){for(;f<n;g+="0",f++);g=c(g,u)}else if(n-=s,g=l(g,u),u+1>f){if(--n>0)for(g+=".";n--;g+="0");}else if((n+=u-f)>0)for(u+1==f&&(g+=".");n--;g+="0");return e.s<0&&o?"-"+g:g}function D(e,n){var r,i,a=0;for(u(e[0])&&(e=e[0]),r=new t(e[0]);++a<e.length;){if(!(i=new t(e[a])).s){r=i;break}n.call(r,i)&&(r=i)}return r}function B(e,t,n,r,i){return(e<t||e>n||e!=f(e))&&_(r,(i||"decimal places")+(e<t||e>n?" out of range":" not an integer"),e),!0}function k(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*x-1)>V?e.c=e.e=null:n<I?e.c=[e.e=0]:(e.e=n,e.c=t),e}function _(e,t,n){var r=new Error(["new BigNumber","cmp","config","div","divToInt","eq","gt","gte","lt","lte","minus","mod","plus","precision","random","round","shift","times","toDigits","toExponential","toFixed","toFormat","toFraction","pow","toPrecision","toString","BigNumber"][e]+"() "+t+": "+n);throw r.name="BigNumber Error",T=0,r}function A(e,t,n,r){var i,a,o,u,s,c,l,f=e.c,g=N;if(f){e:{for(i=1,u=f[0];u>=10;u/=10,i++);if((a=t-i)<0)a+=x,o=t,l=(s=f[c=0])/g[i-o-1]%10|0;else if((c=d((a+1)/x))>=f.length){if(!r)break e;for(;f.length<=c;f.push(0));s=l=0,i=1,o=(a%=x)-x+1}else{for(s=u=f[c],i=1;u>=10;u/=10,i++);l=(o=(a%=x)-x+i)<0?0:s/g[i-o-1]%10|0}if(r=r||t<0||null!=f[c+1]||(o<0?s:s%g[i-o-1]),r=n<4?(l||r)&&(0==n||n==(e.s<0?3:2)):l>5||5==l&&(4==n||r||6==n&&(a>0?o>0?s/g[i-o]:0:f[c-1])%10&1||n==(e.s<0?8:7)),t<1||!f[0])return f.length=0,r?(t-=e.e+1,f[0]=g[(x-t%x)%x],e.e=-t||0):f[0]=e.e=0,e;if(0==a?(f.length=c,u=1,c--):(f.length=c+1,u=g[x-a],f[c]=o>0?h(s/g[i-o]%g[o])*u:0),r)for(;;){if(0==c){for(a=1,o=f[0];o>=10;o/=10,a++);for(o=f[0]+=u,u=1;o>=10;o/=10,u++);a!=u&&(e.e++,f[0]==w&&(f[0]=1));break}if(f[c]+=u,f[c]!=w)break;f[c--]=0,u=1}for(a=f.length;0===f[--a];f.pop());}e.e>V?e.c=e.e=null:e.e<I&&(e.c=[e.e=0])}return e}var L,E,T=0,U=t.prototype,j=new t(1),C=20,R=4,$=-7,P=21,I=-1e7,V=1e7,q=!0,Z=B,z=!1,G=1,W=0,H={decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:" ",fractionGroupSize:0};return t.another=n,t.ROUND_UP=0,t.ROUND_DOWN=1,t.ROUND_CEIL=2,t.ROUND_FLOOR=3,t.ROUND_HALF_UP=4,t.ROUND_HALF_DOWN=5,t.ROUND_HALF_EVEN=6,t.ROUND_HALF_CEIL=7,t.ROUND_HALF_FLOOR=8,t.EUCLID=9,t.config=t.set=function(){var e,t,n=0,r={},i=arguments,a=i[0],s=a&&"object"==typeof a?function(){if(a.hasOwnProperty(t))return null!=(e=a[t])}:function(){if(i.length>n)return null!=(e=i[n++])};return s(t="DECIMAL_PLACES")&&Z(e,0,M,2,t)&&(C=0|e),r[t]=C,s(t="ROUNDING_MODE")&&Z(e,0,8,2,t)&&(R=0|e),r[t]=R,s(t="EXPONENTIAL_AT")&&(u(e)?Z(e[0],-M,0,2,t)&&Z(e[1],0,M,2,t)&&($=0|e[0],P=0|e[1]):Z(e,-M,M,2,t)&&($=-(P=0|(e<0?-e:e)))),r[t]=[$,P],s(t="RANGE")&&(u(e)?Z(e[0],-M,-1,2,t)&&Z(e[1],1,M,2,t)&&(I=0|e[0],V=0|e[1]):Z(e,-M,M,2,t)&&(0|e?I=-(V=0|(e<0?-e:e)):q&&_(2,t+" cannot be zero",e))),r[t]=[I,V],s(t="ERRORS")&&(e===!!e||1===e||0===e?(T=0,Z=(q=!!e)?B:o):q&&_(2,t+v,e)),r[t]=q,s(t="CRYPTO")&&(!0===e||!1===e||1===e||0===e?e?!(e="undefined"==typeof crypto)&&crypto&&(crypto.getRandomValues||crypto.randomBytes)?z=!0:q?_(2,"crypto unavailable",e?void 0:crypto):z=!1:z=!1:q&&_(2,t+v,e)),r[t]=z,s(t="MODULO_MODE")&&Z(e,0,9,2,t)&&(G=0|e),r[t]=G,s(t="POW_PRECISION")&&Z(e,0,M,2,t)&&(W=0|e),r[t]=W,s(t="FORMAT")&&("object"==typeof e?H=e:q&&_(2,t+" not an object",e)),r[t]=H,r},t.max=function(){return D(arguments,U.lt)},t.min=function(){return D(arguments,U.gt)},t.random=function(){var e=9007199254740992*Math.random()&2097151?function(){return h(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(n){var r,i,a,o,u,s=0,c=[],l=new t(j);if(n=null!=n&&Z(n,0,M,14)?0|n:C,o=d(n/x),z)if(crypto.getRandomValues){for(r=crypto.getRandomValues(new Uint32Array(o*=2));s<o;)(u=131072*r[s]+(r[s+1]>>>11))>=9e15?(i=crypto.getRandomValues(new Uint32Array(2)),r[s]=i[0],r[s+1]=i[1]):(c.push(u%1e14),s+=2);s=o/2}else if(crypto.randomBytes){for(r=crypto.randomBytes(o*=7);s<o;)(u=281474976710656*(31&r[s])+1099511627776*r[s+1]+4294967296*r[s+2]+16777216*r[s+3]+(r[s+4]<<16)+(r[s+5]<<8)+r[s+6])>=9e15?crypto.randomBytes(7).copy(r,s):(c.push(u%1e14),s+=7);s=o/7}else z=!1,q&&_(14,"crypto unavailable",crypto);if(!z)for(;s<o;)(u=e())<9e15&&(c[s++]=u%1e14);for(o=c[--s],n%=x,o&&n&&(u=N[x-n],c[s]=h(o/u)*u);0===c[s];c.pop(),s--);if(s<0)c=[a=0];else{for(a=-1;0===c[0];c.splice(0,1),a-=x);for(s=1,u=c[0];u>=10;u/=10,s++);s<x&&(a-=x-s)}return l.e=a,l.c=c,l}}(),L=function(){function e(e,t,n){var r,i,a,o,u=0,s=e.length,c=t%O,l=t/O|0;for(e=e.slice();s--;)u=((i=c*(a=e[s]%O)+(r=l*a+(o=e[s]/O|0)*c)%O*O+u)/n|0)+(r/O|0)+l*o,e[s]=i%n;return u&&(e=[u].concat(e)),e}function n(e,t,n,r){var i,a;if(n!=r)a=n>r?1:-1;else for(i=a=0;i<n;i++)if(e[i]!=t[i]){a=e[i]>t[i]?1:-1;break}return a}function i(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(a,o,u,s,c){var l,f,g,p,d,v,m,y,b,S,N,O,M,F,D,B,k,_=a.s==o.s?1:-1,L=a.c,E=o.c;if(!(L&&L[0]&&E&&E[0]))return new t(a.s&&o.s&&(L?!E||L[0]!=E[0]:E)?L&&0==L[0]||!E?0*_:_/0:NaN);for(b=(y=new t(_)).c=[],_=u+(f=a.e-o.e)+1,c||(c=w,f=r(a.e/x)-r(o.e/x),_=_/x|0),g=0;E[g]==(L[g]||0);g++);if(E[g]>(L[g]||0)&&f--,_<0)b.push(1),p=!0;else{for(F=L.length,B=E.length,g=0,_+=2,(d=h(c/(E[0]+1)))>1&&(E=e(E,d,c),L=e(L,d,c),B=E.length,F=L.length),M=B,N=(S=L.slice(0,B)).length;N<B;S[N++]=0);k=E.slice(),k=[0].concat(k),D=E[0],E[1]>=c/2&&D++;do{if(d=0,(l=n(E,S,B,N))<0){if(O=S[0],B!=N&&(O=O*c+(S[1]||0)),(d=h(O/D))>1)for(d>=c&&(d=c-1),m=(v=e(E,d,c)).length,N=S.length;1==n(v,S,m,N);)d--,i(v,B<m?k:E,m,c),m=v.length,l=1;else 0==d&&(l=d=1),m=(v=E.slice()).length;if(m<N&&(v=[0].concat(v)),i(S,v,N,c),N=S.length,-1==l)for(;n(E,S,B,N)<1;)d++,i(S,B<N?k:E,N,c),N=S.length}else 0===l&&(d++,S=[0]);b[g++]=d,S[0]?S[N++]=L[M]||0:(S=[L[M]],N=1)}while((M++<F||null!=S[0])&&_--);p=null!=S[0],b[0]||b.splice(0,1)}if(c==w){for(g=1,_=b[0];_>=10;_/=10,g++);A(y,u+(y.e=g+f*x-1)+1,s,p)}else y.e=f,y.r=+p;return y}}(),E=function(){var e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,n=/^([^.]+)\.$/,r=/^\.([^.]+)$/,i=/^-?(Infinity|NaN)$/,a=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(o,u,s,c){var l,f=s?u:u.replace(a,"");if(i.test(f))o.s=isNaN(f)?null:f<0?-1:1;else{if(!s&&(f=f.replace(e,function(e,t,n){return l="x"==(n=n.toLowerCase())?16:"b"==n?2:8,c&&c!=l?e:t}),c&&(l=c,f=f.replace(n,"$1").replace(r,"0.$1")),u!=f))return new t(f,l);q&&_(T,"not a"+(c?" base "+c:"")+" number",u),o.s=null}o.c=o.e=null,T=0}}(),U.absoluteValue=U.abs=function(){var e=new t(this);return e.s<0&&(e.s=1),e},U.ceil=function(){return A(new t(this),this.e+1,2)},U.comparedTo=U.cmp=function(e,n){return T=1,a(this,new t(e,n))},U.decimalPlaces=U.dp=function(){var e,t,n=this.c;if(!n)return null;if(e=((t=n.length-1)-r(this.e/x))*x,t=n[t])for(;t%10==0;t/=10,e--);return e<0&&(e=0),e},U.dividedBy=U.div=function(e,n){return T=3,L(this,new t(e,n),C,R)},U.dividedToIntegerBy=U.divToInt=function(e,n){return T=4,L(this,new t(e,n),0,1)},U.equals=U.eq=function(e,n){return T=5,0===a(this,new t(e,n))},U.floor=function(){return A(new t(this),this.e+1,3)},U.greaterThan=U.gt=function(e,n){return T=6,a(this,new t(e,n))>0},U.greaterThanOrEqualTo=U.gte=function(e,n){return T=7,1===(n=a(this,new t(e,n)))||0===n},U.isFinite=function(){return!!this.c},U.isInteger=U.isInt=function(){return!!this.c&&r(this.e/x)>this.c.length-2},U.isNaN=function(){return!this.s},U.isNegative=U.isNeg=function(){return this.s<0},U.isZero=function(){return!!this.c&&0==this.c[0]},U.lessThan=U.lt=function(e,n){return T=8,a(this,new t(e,n))<0},U.lessThanOrEqualTo=U.lte=function(e,n){return T=9,-1===(n=a(this,new t(e,n)))||0===n},U.minus=U.sub=function(e,n){var i,a,o,u,s=this,c=s.s;if(T=10,e=new t(e,n),n=e.s,!c||!n)return new t(NaN);if(c!=n)return e.s=-n,s.plus(e);var l=s.e/x,f=e.e/x,g=s.c,p=e.c;if(!l||!f){if(!g||!p)return g?(e.s=-n,e):new t(p?s:NaN);if(!g[0]||!p[0])return p[0]?(e.s=-n,e):new t(g[0]?s:3==R?-0:0)}if(l=r(l),f=r(f),g=g.slice(),c=l-f){for((u=c<0)?(c=-c,o=g):(f=l,o=p),o.reverse(),n=c;n--;o.push(0));o.reverse()}else for(a=(u=(c=g.length)<(n=p.length))?c:n,c=n=0;n<a;n++)if(g[n]!=p[n]){u=g[n]<p[n];break}if(u&&(o=g,g=p,p=o,e.s=-e.s),(n=(a=p.length)-(i=g.length))>0)for(;n--;g[i++]=0);for(n=w-1;a>c;){if(g[--a]<p[a]){for(i=a;i&&!g[--i];g[i]=n);--g[i],g[a]+=w}g[a]-=p[a]}for(;0==g[0];g.splice(0,1),--f);return g[0]?k(e,g,f):(e.s=3==R?-1:1,e.c=[e.e=0],e)},U.modulo=U.mod=function(e,n){var r,i,a=this;return T=11,e=new t(e,n),!a.c||!e.s||e.c&&!e.c[0]?new t(NaN):!e.c||a.c&&!a.c[0]?new t(a):(9==G?(i=e.s,e.s=1,r=L(a,e,0,3),e.s=i,r.s*=i):r=L(a,e,0,G),a.minus(r.times(e)))},U.negated=U.neg=function(){var e=new t(this);return e.s=-e.s||null,e},U.plus=U.add=function(e,n){var i,a=this,o=a.s;if(T=12,e=new t(e,n),n=e.s,!o||!n)return new t(NaN);if(o!=n)return e.s=-n,a.minus(e);var u=a.e/x,s=e.e/x,c=a.c,l=e.c;if(!u||!s){if(!c||!l)return new t(o/0);if(!c[0]||!l[0])return l[0]?e:new t(c[0]?a:0*o)}if(u=r(u),s=r(s),c=c.slice(),o=u-s){for(o>0?(s=u,i=l):(o=-o,i=c),i.reverse();o--;i.push(0));i.reverse()}for((o=c.length)-(n=l.length)<0&&(i=l,l=c,c=i,n=o),o=0;n;)o=(c[--n]=c[n]+l[n]+o)/w|0,c[n]=w===c[n]?0:c[n]%w;return o&&(c=[o].concat(c),++s),k(e,c,s)},U.precision=U.sd=function(e){var t,n,r=this,i=r.c;if(null!=e&&e!==!!e&&1!==e&&0!==e&&(q&&_(13,"argument"+v,e),e!=!!e&&(e=null)),!i)return null;if(n=i.length-1,t=n*x+1,n=i[n]){for(;n%10==0;n/=10,t--);for(n=i[0];n>=10;n/=10,t++);}return e&&r.e+1>t&&(t=r.e+1),t},U.round=function(e,n){var r=new t(this);return(null==e||Z(e,0,M,15))&&A(r,~~e+this.e+1,null!=n&&Z(n,0,8,15,m)?0|n:R),r},U.shift=function(e){var n=this;return Z(e,-S,S,16,"argument")?n.times("1e"+f(e)):new t(n.c&&n.c[0]&&(e<-S||e>S)?n.s*(e<0?0:1/0):n)},U.squareRoot=U.sqrt=function(){var e,n,a,o,u,s=this,c=s.c,l=s.s,f=s.e,g=C+4,p=new t("0.5");if(1!==l||!c||!c[0])return new t(!l||l<0&&(!c||c[0])?NaN:c?s:1/0);if(0==(l=Math.sqrt(+s))||l==1/0?(((n=i(c)).length+f)%2==0&&(n+="0"),l=Math.sqrt(n),f=r((f+1)/2)-(f<0||f%2),a=new t(n=l==1/0?"1e"+f:(n=l.toExponential()).slice(0,n.indexOf("e")+1)+f)):a=new t(l+""),a.c[0])for((l=(f=a.e)+g)<3&&(l=0);;)if(u=a,a=p.times(u.plus(L(s,u,g,1))),i(u.c).slice(0,l)===(n=i(a.c)).slice(0,l)){if(a.e<f&&--l,"9999"!=(n=n.slice(l-3,l+1))&&(o||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(A(a,a.e+C+2,1),e=!a.times(a).eq(s));break}if(!o&&(A(u,u.e+C+2,0),u.times(u).eq(s))){a=u;break}g+=4,l+=4,o=1}return A(a,a.e+C+1,R,e)},U.times=U.mul=function(e,n){var i,a,o,u,s,c,l,f,g,p,d,h,v,m,y,b=this,S=b.c,N=(T=17,e=new t(e,n)).c;if(!(S&&N&&S[0]&&N[0]))return!b.s||!e.s||S&&!S[0]&&!N||N&&!N[0]&&!S?e.c=e.e=e.s=null:(e.s*=b.s,S&&N?(e.c=[0],e.e=0):e.c=e.e=null),e;for(a=r(b.e/x)+r(e.e/x),e.s*=b.s,(l=S.length)<(p=N.length)&&(v=S,S=N,N=v,o=l,l=p,p=o),o=l+p,v=[];o--;v.push(0));for(m=w,y=O,o=p;--o>=0;){for(i=0,d=N[o]%y,h=N[o]/y|0,u=o+(s=l);u>o;)i=((f=d*(f=S[--s]%y)+(c=h*f+(g=S[s]/y|0)*d)%y*y+v[u]+i)/m|0)+(c/y|0)+h*g,v[u--]=f%m;v[u]=i}return i?++a:v.splice(0,1),k(e,v,a)},U.toDigits=function(e,n){var r=new t(this);return e=null!=e&&Z(e,1,M,18,"precision")?0|e:null,n=null!=n&&Z(n,0,8,18,m)?0|n:R,e?A(r,e,n):r},U.toExponential=function(e,t){return F(this,null!=e&&Z(e,0,M,19)?1+~~e:null,t,19)},U.toFixed=function(e,t){return F(this,null!=e&&Z(e,0,M,20)?~~e+this.e+1:null,t,20)},U.toFormat=function(e,t){var n=F(this,null!=e&&Z(e,0,M,21)?~~e+this.e+1:null,t,21);if(this.c){var r,i=n.split("."),a=+H.groupSize,o=+H.secondaryGroupSize,u=H.groupSeparator,s=i[0],c=i[1],l=this.s<0,f=l?s.slice(1):s,g=f.length;if(o&&(r=a,a=o,o=r,g-=r),a>0&&g>0){for(r=g%a||a,s=f.substr(0,r);r<g;r+=a)s+=u+f.substr(r,a);o>0&&(s+=u+f.slice(r)),l&&(s="-"+s)}n=c?s+H.decimalSeparator+((o=+H.fractionGroupSize)?c.replace(new RegExp("\\d{"+o+"}\\B","g"),"$&"+H.fractionGroupSeparator):c):s}return n},U.toFraction=function(e){var n,r,a,o,u,s,c,l,f,g=q,p=this,d=p.c,h=new t(j),v=r=new t(j),m=c=new t(j);if(null!=e&&(q=!1,s=new t(e),q=g,(g=s.isInt())&&!s.lt(j)||(q&&_(22,"max denominator "+(g?"out of range":"not an integer"),e),e=!g&&s.c&&A(s,s.e+1,1).gte(j)?s:null)),!d)return p.toString();for(f=i(d),o=h.e=f.length-p.e-1,h.c[0]=N[(u=o%x)<0?x+u:u],e=!e||s.cmp(h)>0?o>0?h:v:s,u=V,V=1/0,s=new t(f),c.c[0]=0;l=L(s,h,0,1),1!=(a=r.plus(l.times(m))).cmp(e);)r=m,m=a,v=c.plus(l.times(a=v)),c=a,h=s.minus(l.times(a=h)),s=a;return a=L(e.minus(r),m,0,1),c=c.plus(a.times(v)),r=r.plus(a.times(m)),c.s=v.s=p.s,o*=2,n=L(v,m,o,R).minus(p).abs().cmp(L(c,r,o,R).minus(p).abs())<1?[v.toString(),m.toString()]:[c.toString(),r.toString()],V=u,n},U.toNumber=function(){return+this},U.toPower=U.pow=function(e,n){var r,i,a,o=h(e<0?-e:+e),u=this;if(null!=n&&(T=23,n=new t(n)),!Z(e,-S,S,23,"exponent")&&(!isFinite(e)||o>S&&(e/=0)||parseFloat(e)!=e&&!(e=NaN))||0==e)return r=Math.pow(+u,e),new t(n?r%n:r);for(n?e>1&&u.gt(j)&&u.isInt()&&n.gt(j)&&n.isInt()?u=u.mod(n):(a=n,n=null):W&&(r=d(W/x+2)),i=new t(j);;){if(o%2){if(!(i=i.times(u)).c)break;r?i.c.length>r&&(i.c.length=r):n&&(i=i.mod(n))}if(!(o=h(o/2)))break;u=u.times(u),r?u.c&&u.c.length>r&&(u.c.length=r):n&&(u=u.mod(n))}return n?i:(e<0&&(i=j.div(i)),a?i.mod(a):r?A(i,W,R):i)},U.toPrecision=function(e,t){return F(this,null!=e&&Z(e,1,M,24,"precision")?0|e:null,t,24)},U.toString=function(e){var t,n=this,r=n.s,a=n.e;return null===a?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(t=i(n.c),t=null!=e&&Z(e,2,64,25,"base")?g(l(t,a),0|e,10,r):a<=$||a>=P?c(t,a):l(t,a),r<0&&n.c[0]&&(t="-"+t)),t},U.truncated=U.trunc=function(){return A(new t(this),this.e+1,1)},U.valueOf=U.toJSON=function(){var e,t=this,n=t.e;return null===n?t.toString():(e=i(t.c),e=n<=$||n>=P?c(e,n):l(e,n),t.s<0?"-"+e:e)},U.isBigNumber=!0,null!=e&&t.config(e),t}function r(e){var t=0|e;return e>0||e===t?t:t-1}function i(e){for(var t,n,r=1,i=e.length,a=e[0]+"";r<i;){for(t=e[r++]+"",n=x-t.length;n--;t="0"+t);a+=t}for(i=a.length;48===a.charCodeAt(--i););return a.slice(0,i+1||1)}function a(e,t){var n,r,i=e.c,a=t.c,o=e.s,u=t.s,s=e.e,c=t.e;if(!o||!u)return null;if(n=i&&!i[0],r=a&&!a[0],n||r)return n?r?0:-u:o;if(o!=u)return o;if(n=o<0,r=s==c,!i||!a)return r?0:!i^n?1:-1;if(!r)return s>c^n?1:-1;for(u=(s=i.length)<(c=a.length)?s:c,o=0;o<u;o++)if(i[o]!=a[o])return i[o]>a[o]^n?1:-1;return s==c?0:s>c^n?1:-1}function o(e,t,n){return(e=f(e))>=t&&e<=n}function u(e){return"[object Array]"==Object.prototype.toString.call(e)}function s(e,t,n){for(var r,i,a=[0],o=0,u=e.length;o<u;){for(i=a.length;i--;a[i]*=t);for(a[r=0]+=b.indexOf(e.charAt(o++));r<a.length;r++)a[r]>n-1&&(null==a[r+1]&&(a[r+1]=0),a[r+1]+=a[r]/n|0,a[r]%=n)}return a.reverse()}function c(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function l(e,t){var n,r;if(t<0){for(r="0.";++t;r+="0");e=r+e}else if(n=e.length,++t>n){for(r="0",t-=n;--t;r+="0");e+=r}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}function f(e){return(e=parseFloat(e))<0?d(e):h(e)}var g,p=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,d=Math.ceil,h=Math.floor,v=" not a boolean or binary digit",m="rounding mode",y="number type has more than 15 significant digits",b="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",w=1e14,x=14,S=9007199254740991,N=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],O=1e7,M=1e9;(g=n()).default=g.BigNumber=g,void 0!==t&&t.exports?t.exports=g:(e||(e="undefined"!=typeof self?self:Function("return this")()),e.BigNumber=g)}(this)},{}],2:[function(e,t,n){"use strict";t.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];if("string"==typeof t&&(t=L.parseFormat(t)),!A.validateFormat(t))return"ERROR: invalid format";var r=t.prefix||"",a=t.postfix||"",o=i(e,t,n);return o=M(o,r),o=F(o,a)}function i(e,t,n){switch(t.output){case"currency":return t=B(t,_.currentCurrencyDefaultFormat()),p(e,t,_);case"percent":return t=B(t,_.currentPercentageDefaultFormat()),g(e,t,_,n);case"byte":return t=B(t,_.currentByteDefaultFormat()),c(e,t,_,n);case"time":return t=B(t,_.currentTimeDefaultFormat()),f(e);case"ordinal":return t=B(t,_.currentOrdinalDefaultFormat()),l(e,t,_);case"number":default:return D({instance:e,providedFormat:t,numbro:n})}}function a(e){var t=T.decimal;return s(e._value,t.suffixes,t.scale).suffix}function o(e){var t=T.binary;return s(e._value,t.suffixes,t.scale).suffix}function u(e){var t=T.general;return s(e._value,t.suffixes,t.scale).suffix}function s(e,t,n){var r=t[0],i=Math.abs(e);if(i>=n){for(var a=1;a<t.length;++a){var o=Math.pow(n,a),u=Math.pow(n,a+1);if(i>=o&&i<u){r=t[a],e/=o;break}}r===t[0]&&(e/=Math.pow(n,t.length-1),r=t[t.length-1])}return{value:e,suffix:r}}function c(e,t,n,r){var i=t.base||"binary",a=T[i],o=s(e._value,a.suffixes,a.scale),u=o.value,c=o.suffix;return D({instance:r(u),providedFormat:t,state:n,defaults:n.currentByteDefaultFormat()})+(n.currentAbbreviations().spaced?" ":"")+c}function l(e,t,n){var r=n.currentOrdinal(),i=Object.assign({},U,t),a=D({instance:e,providedFormat:t,state:n}),o=r(e._value);return a+(i.spaceSeparated?" ":"")+o}function f(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*n);return t+":"+(n<10?"0":"")+n+":"+(r<10?"0":"")+r}function g(e,t,n,r){var i=t.prefixSymbol,a=D({instance:r(100*e._value),providedFormat:t,state:n}),o=Object.assign({},U,t);return i?"%"+(o.spaceSeparated?" ":"")+a:a+(o.spaceSeparated?" ":"")+"%"}function p(e,t,n){var r=n.currentCurrency(),i=Object.assign({},U,t),a=void 0,o="",u=!!i.totalLength||!!i.forceAverage||i.average,s=t.currencyPosition||r.position,c=t.currencySymbol||r.symbol;i.spaceSeparated&&(o=" "),"infix"===s&&(a=o+c+o);var l=D({instance:e,providedFormat:t,state:n,decimalSeparator:a});return"prefix"===s&&(l=e._value<0&&"sign"===i.negative?"-"+o+c+l.slice(1):c+o+l),s&&"postfix"!==s||(l=l+(o=u?"":o)+c),l}function d(e){var t=e.value,n=e.forceAverage,r=e.abbreviations,i=e.spaceSeparated,a=void 0!==i&&i,o=e.totalLength,u=void 0===o?0:o,s="",c=Math.abs(t),l=-1;c>=Math.pow(10,12)&&!n||"trillion"===n?(s=r.trillion,t/=Math.pow(10,12)):c<Math.pow(10,12)&&c>=Math.pow(10,9)&&!n||"billion"===n?(s=r.billion,t/=Math.pow(10,9)):c<Math.pow(10,9)&&c>=Math.pow(10,6)&&!n||"million"===n?(s=r.million,t/=Math.pow(10,6)):(c<Math.pow(10,6)&&c>=Math.pow(10,3)&&!n||"thousand"===n)&&(s=r.thousand,t/=Math.pow(10,3));var f=a?" ":"";if(s&&(s=f+s),u){var g=t.toString().split(".")[0];l=Math.max(u-g.length,0)}return{value:t,abbreviation:s,mantissaPrecision:l}}function h(e){var t=e.value,n=e.characteristicPrecision,r=void 0===n?0:n,i=t.toExponential().split("e"),a=k(i,2),o=a[0],u=a[1],s=+o;if(!r)return{value:s,abbreviation:"e"+u};return 1<r&&(s*=Math.pow(10,r-1),u=(u=+u-(r-1))>=0?"+"+u:u),{value:s,abbreviation:"e"+u}}function v(e){for(var t="",n=0;n<e;n++)t+="0";return t}function m(e,t){var n=e.toString(),r=n.split("e"),i=k(r,2),a=i[0],o=i[1],u=a.split("."),s=k(u,2),c=s[0],l=s[1],f=void 0===l?"":l;if(+o>0)n=c+f+v(o-f.length);else{var g=".";g=+c<0?"-0"+g:"0"+g;var p=(v(-o-1)+Math.abs(c)+f).substr(0,t);p.length<t&&(p+=v(t-p.length)),n=g+p}return+o>0&&t>0&&(n+="."+v(t)),n}function y(e,t){return-1!==e.toString().indexOf("e")?m(e,t):(Math.round(+(e+"e+"+t))/Math.pow(10,t)).toFixed(t)}function b(e,t,n,r,i){if(-1===r)return e;var a=y(t,r),o=a.toString().split("."),u=k(o,2),s=u[0],c=u[1],l=void 0===c?"":c;if(l.match(/^0+$/)&&(n||i))return s;var f=l.match(/0+$/);return i&&f?s+"."+l.toString().slice(0,f.index):a.toString()}function w(e,t,n,r){var i=e,a=i.toString().split("."),o=k(a,2),u=o[0],s=o[1];if(u.match(/^-?0$/)&&n)return s?u.replace("0","")+"."+s:u.replace("0","");if(u.length<r)for(var c=r-u.length,l=0;l<c;l++)i="0"+i;return i.toString()}function x(e,t){for(var n=[],r=0,i=e;i>0;i--)r===t&&(n.unshift(i),r=0),r++;return n}function S(e,t,n,r,i){var a=r.currentDelimiters(),o=a.thousands;i=i||a.decimal;var u=a.thousandsSize||3,s=e.toString(),c=s.split(".")[0],l=s.split(".")[1];return n&&(t<0&&(c=c.slice(1)),x(c.length,u).forEach(function(e,t){c=c.slice(0,e+t)+o+c.slice(e+t)}),t<0&&(c="-"+c)),s=l?c+i+l:c}function N(e,t){return e+t}function O(e,t,n){return 0===t?e:0==+e?e.replace("-",""):t>0?"+"+e:"sign"===n?e:"("+e.replace("-","")+")"}function M(e,t){return t+e}function F(e,t){return e+t}function D(e){var t=e.instance,n=e.providedFormat,r=e.state,i=void 0===r?_:r,a=e.decimalSeparator,o=e.defaults,u=void 0===o?i.currentDefaults():o,s=t._value;if(0===s&&i.hasZeroFormat())return i.getZeroFormat();if(!isFinite(s))return s.toString();var c=Object.assign({},U,u,n),l=c.totalLength,f=l?0:c.characteristic,g=c.optionalCharacteristic,p=c.forceAverage,v=!!l||!!p||c.average,m=l?-1:v&&void 0===n.mantissa?0:c.mantissa,y=!l&&(void 0===n.optionalMantissa?-1===m:c.optionalMantissa),x=c.trimMantissa,M=c.thousandSeparated,F=c.spaceSeparated,D=c.negative,B=c.forceSign,k=c.exponential,A="";if(v){var L=d({value:s,forceAverage:p,abbreviations:i.currentAbbreviations(),spaceSeparated:F,totalLength:l});s=L.value,A+=L.abbreviation,l&&(m=L.mantissaPrecision)}if(k){var E=h({value:s,characteristicPrecision:f});s=E.value,A=E.abbreviation+A}var T=b(s.toString(),s,y,m,x);return T=w(T,s,g,f),T=S(T,s,M,i,a),(v||k)&&(T=N(T,A)),(B||s<0)&&(T=O(T,s,D)),T}function B(e,t){if(!e)return t;var n=Object.keys(e);return 1===n.length&&"output"===n[0]?t:e}var k=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_=e("./globalState"),A=e("./validating"),L=e("./parsing"),E=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],T={general:{scale:1024,suffixes:E,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:E,marker:"d"}},U={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};t.exports=function(e){return{format:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.apply(void 0,n.concat([e]))},getByteUnit:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return u.apply(void 0,n.concat([e]))},getBinaryByteUnit:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.apply(void 0,n.concat([e]))},getDecimalByteUnit:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return a.apply(void 0,n.concat([e]))},formatOrDefault:B}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,t,n){"use strict";function r(e){c=e}function i(){return l[c]}var a=e("./en-US"),o=e("./validating"),u=e("./parsing"),s={},c=void 0,l={},f=null,g={};s.languages=function(){return Object.assign({},l)},s.currentLanguage=function(){return c},s.currentCurrency=function(){return i().currency},s.currentAbbreviations=function(){return i().abbreviations},s.currentDelimiters=function(){return i().delimiters},s.currentOrdinal=function(){return i().ordinal},s.currentDefaults=function(){return Object.assign({},i().defaults,g)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),i().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),i().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),i().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),i().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),i().timeFormat)},s.setDefaults=function(e){e=u.parseFormat(e),o.validateFormat(e)&&(g=e)},s.getZeroFormat=function(){return f},s.setZeroFormat=function(e){return f="string"==typeof e?e:null},s.hasZeroFormat=function(){return null!==f},s.languageData=function(e){if(e){if(l[e])return l[e];throw new Error('Unknown tag "'+e+'"')}return i()},s.registerLanguage=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!o.validateLanguage(e))throw new Error("Invalid language data");l[e.languageTag]=e,t&&r(e.languageTag)},s.setLanguage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.languageTag;if(!l[e]){var n=e.split("-")[0],i=Object.keys(l).find(function(e){return e.split("-")[0]===n});return l[i]?void r(i):void r(t)}r(e)},s.registerLanguage(a),c=a.languageTag,t.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(e,t,n){"use strict";function r(t,n){t.forEach(function(t){var r=void 0;try{r=e("../languages/"+t)}catch(e){console.error('Unable to load "'+t+'". No matching language file found.')}r&&n.registerLanguage(r)})}t.exports=function(e){return{loadLanguagesInNode:function(t){return r(t,e)}}}},{}],6:[function(e,t,n){"use strict";function r(e,t,n){var r=new c(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new c(i),e._value=r.add(i).toNumber(),e}function i(e,t,n){var r=new c(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new c(i),e._value=r.minus(i).toNumber(),e}function a(e,t,n){var r=new c(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new c(i),e._value=r.times(i).toNumber(),e}function o(e,t,n){var r=new c(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new c(i),e._value=r.dividedBy(i).toNumber(),e}function u(e,t,n){var r=t;return n.isNumbro(t)&&(r=t._value),e._value=r,e}function s(e,t,n){var r=n(e._value);return i(r,t,n),Math.abs(r._value)}var c=e("bignumber.js");t.exports=function(e){return{add:function(t,n){return r(t,n,e)},subtract:function(t,n){return i(t,n,e)},multiply:function(t,n){return a(t,n,e)},divide:function(t,n){return o(t,n,e)},set:function(t,n){return u(t,n,e)},difference:function(t,n){return s(t,n,e)}}}},{"bignumber.js":1}],7:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t=e;return a.isNumbro(e)?t=e._value:"string"==typeof e?t=a.unformat(e):isNaN(e)&&(t=NaN),t}function a(e){return new d(i(e))}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./globalState"),s=e("./validating"),c=e("./loading")(a),l=e("./unformatting"),f=e("./formatting")(a),g=e("./manipulating")(a),p=e("./parsing"),d=function(){function e(t){r(this,e),this._value=t}return o(e,[{key:"clone",value:function(){return a(this._value)}},{key:"format",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f.format(this,e)}},{key:"formatCurrency",value:function(e){return"string"==typeof e&&(e=p.parseFormat(e)),e=f.formatOrDefault(e,u.currentCurrencyDefaultFormat()),e.output="currency",f.format(this,e)}},{key:"formatTime",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",f.format(this,e)}},{key:"binaryByteUnits",value:function(){return f.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return f.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return f.getByteUnit(this)}},{key:"difference",value:function(e){return g.difference(this,e)}},{key:"add",value:function(e){return g.add(this,e)}},{key:"subtract",value:function(e){return g.subtract(this,e)}},{key:"multiply",value:function(e){return g.multiply(this,e)}},{key:"divide",value:function(e){return g.divide(this,e)}},{key:"set",value:function(e){return g.set(this,i(e))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}]),e}();a.version="2.1.1",a.isNumbro=function(e){return e instanceof d},a.language=u.currentLanguage,a.registerLanguage=u.registerLanguage,a.setLanguage=u.setLanguage,a.languages=u.languages,a.languageData=u.languageData,a.zeroFormat=u.setZeroFormat,a.defaultFormat=u.currentDefaults,a.setDefaults=u.setDefaults,a.defaultCurrencyFormat=u.currentCurrencyDefaultFormat,a.validate=s.validate,a.loadLanguagesInNode=c.loadLanguagesInNode,a.unformat=l.unformat,t.exports=a},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,t,n){"use strict";function r(e,t){var n=e.match(/^{([^}]*)}/);return n?(t.prefix=n[1],e.slice(n[0].length)):e}function i(e,t){var n=e.match(/{([^}]*)}$/);return n?(t.postfix=n[1],e.slice(0,-n[0].length)):e}function a(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",void(t.base="general")):-1!==e.indexOf("b")?(t.output="byte",void(t.base="binary")):-1!==e.indexOf("d")?(t.output="byte",void(t.base="decimal")):void(-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time");t.output="percent"}else t.output="currency"}function o(e,t){-1!==e.indexOf(",")&&(t.thousandSeparated=!0)}function u(e,t){-1!==e.indexOf(" ")&&(t.spaceSeparated=!0)}function s(e,t){var n=e.match(/[1-9]+[0-9]*/);n&&(t.totalLength=+n[0])}function c(e,t){var n=e.split(".")[0].match(/0+/);n&&(t.characteristic=n[0].length)}function l(e,t){var n=e.split(".")[1];if(n){var r=n.match(/0+/);r&&(t.mantissa=r[0].length)}}function f(e,t){-1!==e.indexOf("a")&&(t.average=!0)}function g(e,t){-1!==e.indexOf("K")?t.forceAverage="thousand":-1!==e.indexOf("M")?t.forceAverage="million":-1!==e.indexOf("B")?t.forceAverage="billion":-1!==e.indexOf("T")&&(t.forceAverage="trillion")}function p(e,t){e.match(/\[\.]/)?t.optionalMantissa=!0:e.match(/\./)&&(t.optionalMantissa=!1)}function d(e,t){if(-1!==e.indexOf(".")){var n=e.split(".")[0];t.optionalCharacteristic=-1===n.indexOf("0")}}function h(e,t){e.match(/^\+?\([^)]*\)$/)&&(t.negative="parenthesis"),e.match(/^\+?-/)&&(t.negative="sign")}function v(e,t){e.match(/^\+/)&&(t.forceSign=!0)}t.exports={parseFormat:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?e:(e=r(e,t),e=i(e,t),a(e,t),s(e,t),c(e,t),d(e,t),f(e,t),g(e,t),l(e,t),p(e,t),o(e,t),u(e,t),h(e,t),v(e,t),t)}}},{}],9:[function(e,t,n){"use strict";function r(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments[3],o=arguments[4],u=arguments[5],s=arguments[6];if(!isNaN(+e))return+e;var l="",f=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(f!==e)return-1*i(f,t,n,a,o,u,s);for(var g=0;g<c.length;g++){var p=c[g];if((l=e.replace(p.key,""))!==e)return i(l,t,n,a,o,u,s)*p.factor}if((l=e.replace("%",""))!==e)return i(l,t,n,a,o,u,s)/100;var d=parseFloat(e);if(!isNaN(d)){var h=a(d);if(h&&"."!==h&&(l=e.replace(new RegExp(r(h)+"$"),""))!==e)return i(l,t,n,a,o,u,s);var v={};Object.keys(u).forEach(function(e){v[u[e]]=e});for(var m=Object.keys(v).sort().reverse(),y=m.length,b=0;b<y;b++){var w=m[b],x=v[w];if((l=e.replace(w,""))!==e){var S=void 0;switch(x){case"thousand":S=Math.pow(10,3);break;case"million":S=Math.pow(10,6);break;case"billion":S=Math.pow(10,9);break;case"trillion":S=Math.pow(10,12)}return i(l,t,n,a,o,u,s)*S}}}}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=e.replace(n,"");return i=i.replace(new RegExp("([0-9])"+r(t.thousands)+"([0-9])","g"),"$1$2"),i=i.replace(t.decimal,".")}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments[3],o=arguments[4],u=arguments[5],s=arguments[6];if(""!==e)return isNaN(+e)?e===o?0:i(a(e,t,n),t,n,r,o,u,s):+e}function u(e,t){if(!(e.indexOf(":")&&":"!==t.thousands))return!1;var n=e.split(":");if(3!==n.length)return!1;var r=+n[0],i=+n[1],a=+n[2];return!isNaN(r)&&!isNaN(i)&&!isNaN(a)}function s(e){var t=e.split(":"),n=+t[0],r=+t[1];return+t[2]+60*r+3600*n}var c=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];t.exports={unformat:function(t,n){var r=e("./globalState"),i=r.currentDelimiters(),a=r.currentCurrency().symbol,c=r.currentOrdinal(),l=r.getZeroFormat(),f=r.currentAbbreviations(),g=void 0;if("string"==typeof t)g=u(t,i)?s(t):o(t,i,a,c,l,f,n);else{if("number"!=typeof t)return;g=t}if(void 0!==g)return g}}},{"./globalState":4}],10:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){return!!s.unformat(e)}function a(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=Object.keys(e).map(function(r){if(!t[r])return console.error(n+" Invalid key: "+r),!1;var i=e[r],o=t[r];if("string"==typeof o&&(o={type:o}),"format"===o.type){if(!a(i,l,"[Validate "+r+"]",!0))return!1}else if((void 0===i?"undefined":u(i))!==o.type)return console.error(n+" "+r+' type mismatched: "'+o.type+'" expected, "'+(void 0===i?"undefined":u(i))+'" provided'),!1;if(o.restrictions&&o.restrictions.length)for(var s=o.restrictions.length,c=0;c<s;c++){var f=o.restrictions[c],g=f.restriction,p=f.message;if(!g(i,e))return console.error(n+" "+r+" invalid value: "+p),!1}return o.restriction&&!o.restriction(i,e)?(console.error(n+" "+r+" invalid value: "+o.message),!1):o.validValues&&-1===o.validValues.indexOf(i)?(console.error(n+" "+r+" invalid value: must be among "+JSON.stringify(o.validValues)+', "'+i+'" provided'),!1):!(o.children&&!a(i,o.children,"[Validate "+r+"]"))});return i||o.push.apply(o,r(Object.keys(t).map(function(r){var i=t[r];if("string"==typeof i&&(i={type:i}),i.mandatory){var a=i.mandatory;if("function"==typeof a&&(a=a(e)),a&&void 0===e[r])return console.error(n+' Missing mandatory key "'+r+'"'),!1}return!0}))),o.reduce(function(e,t){return e&&t},!0)}function o(e){return a(e,l,"[Validate format]")}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("./unformatting"),c=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,l={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(e,t){return"byte"===t.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(e){return"byte"===e.output}},characteristic:{type:"number",restriction:function(e){return e>=0},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(e){return e>=0},message:"value must be positive"},{restriction:function(e,t){return!t.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(e){return e>=0},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(e,t){return"percent"===t.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:function(e){return e.match(c)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};t.exports={validate:function(e,t){var n=i(e),r=o(t);return n&&r},validateFormat:o,validateInput:i,validateLanguage:function(e){return a(e,f,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)});window['numbro']=__webpack_require__(420);}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.getNormalizedDate=getNormalizedDate;function getNormalizedDate(dateString){var nativeDate=new Date(dateString);if(!isNaN(new Date("".concat(dateString,"T00:00")).getDate())){return new Date(nativeDate.getTime()+nativeDate.getTimezoneOffset()*60000);}
return nativeDate;}}),(function(module,exports,__webpack_require__){"use strict";(function(global){"use strict";function countQuotes(str){return str.split('"').length-1;}
var SheetClip={parse:function parse(str){var r,rLen,rows,arr=[],a=0,c,cLen,multiline,last;rows=str.replace(/\r\n|\r/g,'\n').split('\n');if(rows.length>1&&rows[rows.length-1]===''){rows.pop();}
for(r=0,rLen=rows.length;r<rLen;r+=1){rows[r]=rows[r].split('\t');for(c=0,cLen=rows[r].length;c<cLen;c+=1){if(!arr[a]){arr[a]=[];}
if(multiline&&c===0){last=arr[a].length-1;arr[a][last]=arr[a][last]+'\n'+rows[r][0];if(multiline&&countQuotes(rows[r][0])&1){multiline=false;arr[a][last]=arr[a][last].substring(0,arr[a][last].length-1).replace(/""/g,'"');}}else{if(c===cLen-1&&rows[r][c].indexOf('"')===0&&countQuotes(rows[r][c])&1){arr[a].push(rows[r][c].substring(1).replace(/""/g,'"'));multiline=true;}else{arr[a].push(rows[r][c].replace(/""/g,'"'));multiline=false;}}}
if(!multiline){a+=1;}}
return arr;},stringify:function stringify(arr){var r,rLen,c,cLen,str='',val;for(r=0,rLen=arr.length;r<rLen;r+=1){cLen=arr[r].length;for(c=0;c<cLen;c+=1){if(c>0){str+='\t';}
val=arr[r][c];if(typeof val==='string'){if(val.indexOf('\n')>-1){str+='"'+val.replace(/"/g,'""')+'"';}else{str+=val;}}else if(val===null||val===void 0){str+='';}else{str+=val;}}
if(r!==rLen-1){str+='\n';}}
return str;}};if(true){exports.parse=SheetClip.parse;exports.stringify=SheetClip.stringify;}else{global.SheetClip=SheetClip;}})(window);}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.mouseDown=mouseDown;exports.mouseOver=mouseOver;exports.handleMouseEvent=handleMouseEvent;var _event=__webpack_require__(18);var _src=__webpack_require__(8);function mouseDown(_ref){var isShiftKey=_ref.isShiftKey,isLeftClick=_ref.isLeftClick,isRightClick=_ref.isRightClick,coords=_ref.coords,selection=_ref.selection,controller=_ref.controller;var currentSelection=selection.isSelected()?selection.getSelectedRange().current():null;var selectedCorner=selection.isSelectedByCorner();var selectedRow=selection.isSelectedByRowHeader();if(isShiftKey&&currentSelection){if(coords.row>=0&&coords.col>=0&&!controller.cells){selection.setRangeEnd(coords);}else if((selectedCorner||selectedRow)&&coords.row>=0&&coords.col>=0&&!controller.cells){selection.setRangeEnd(new _src.CellCoords(coords.row,coords.col));}else if(selectedCorner&&coords.row<0&&!controller.column){selection.setRangeEnd(new _src.CellCoords(currentSelection.to.row,coords.col));}else if(selectedRow&&coords.col<0&&!controller.row){selection.setRangeEnd(new _src.CellCoords(coords.row,currentSelection.to.col));}else if((!selectedCorner&&!selectedRow&&coords.col<0||selectedCorner&&coords.col<0)&&!controller.row){selection.selectRows(currentSelection.from.row,coords.row);}else if((!selectedCorner&&!selectedRow&&coords.row<0||selectedRow&&coords.row<0)&&!controller.column){selection.selectColumns(currentSelection.from.col,coords.col);}}else{var newCoord=new _src.CellCoords(coords.row,coords.col);if(newCoord.row<0){newCoord.row=0;}
if(newCoord.col<0){newCoord.col=0;}
var allowRightClickSelection=!selection.inInSelection(newCoord);var performSelection=isLeftClick||isRightClick&&allowRightClickSelection;if(coords.row<0&&coords.col>=0&&!controller.column){if(performSelection){selection.selectColumns(coords.col);}}else if(coords.col<0&&coords.row>=0&&!controller.row){if(performSelection){selection.selectRows(coords.row);}}else if(coords.col>=0&&coords.row>=0&&!controller.cells){if(performSelection){selection.setRangeStart(coords);}}else if(coords.col<0&&coords.row<0){selection.setRangeStart(coords);}}}
function mouseOver(_ref2){var isLeftClick=_ref2.isLeftClick,coords=_ref2.coords,selection=_ref2.selection,controller=_ref2.controller;if(!isLeftClick){return;}
var selectedRow=selection.isSelectedByRowHeader();var selectedColumn=selection.isSelectedByColumnHeader();var countCols=selection.tableProps.countCols();var countRows=selection.tableProps.countRows();if(selectedColumn&&!controller.column){selection.setRangeEnd(new _src.CellCoords(countRows-1,coords.col));}else if(selectedRow&&!controller.row){selection.setRangeEnd(new _src.CellCoords(coords.row,countCols-1));}else if(!controller.cell){selection.setRangeEnd(coords);}}
var handlers=new Map([['mousedown',mouseDown],['mouseover',mouseOver],['touchstart',mouseDown]]);function handleMouseEvent(event,_ref3){var coords=_ref3.coords,selection=_ref3.selection,controller=_ref3.controller;handlers.get(event.type)({coords:coords,selection:selection,controller:controller,isShiftKey:event.shiftKey,isLeftClick:(0,_event.isLeftClick)(event)||event.type==='touchstart',isRightClick:(0,_event.isRightClick)(event)});}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.registerIdentity=registerIdentity;exports.getTranslator=getTranslator;exports.getIdentity=getIdentity;exports.RecordTranslator=void 0;var _core=_interopRequireDefault(__webpack_require__(120));var _object=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var RecordTranslator=function(){function RecordTranslator(hot){_classCallCheck(this,RecordTranslator);this.hot=hot;}
_createClass(RecordTranslator,[{key:"toVisualRow",value:function toVisualRow(row){return this.hot.runHooks('unmodifyRow',row);}},{key:"toVisualColumn",value:function toVisualColumn(column){return this.hot.runHooks('unmodifyCol',column);}},{key:"toVisual",value:function toVisual(row,column){var result;if((0,_object.isObject)(row)){result={row:this.toVisualRow(row.row),column:this.toVisualColumn(row.column)};}else{result=[this.toVisualRow(row),this.toVisualColumn(column)];}
return result;}},{key:"toPhysicalRow",value:function toPhysicalRow(row){return this.hot.runHooks('modifyRow',row);}},{key:"toPhysicalColumn",value:function toPhysicalColumn(column){return this.hot.runHooks('modifyCol',column);}},{key:"toPhysical",value:function toPhysical(row,column){var result;if((0,_object.isObject)(row)){result={row:this.toPhysicalRow(row.row),column:this.toPhysicalColumn(row.column)};}else{result=[this.toPhysicalRow(row),this.toPhysicalColumn(column)];}
return result;}}]);return RecordTranslator;}();exports.RecordTranslator=RecordTranslator;var identities=new WeakMap();var translatorSingletons=new WeakMap();function registerIdentity(identity,hot){identities.set(identity,hot);}
function getTranslator(identity){var instance=identity instanceof _core.default?identity:getIdentity(identity);var singleton;if(translatorSingletons.has(instance)){singleton=translatorSingletons.get(instance);}else{singleton=new RecordTranslator(instance);translatorSingletons.set(instance,singleton);}
return singleton;}
function getIdentity(identity){if(!identities.has(identity)){throw Error('Record translator was not registered for this object identity');}
return identities.get(identity);}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.registerAsRootInstance=registerAsRootInstance;exports.hasValidParameter=hasValidParameter;exports.isRootInstance=isRootInstance;exports.rootInstanceSymbol=exports.holder=void 0;var holder=new WeakMap();exports.holder=holder;var rootInstanceSymbol=Symbol('rootInstance');exports.rootInstanceSymbol=rootInstanceSymbol;function registerAsRootInstance(object){holder.set(object,true);}
function hasValidParameter(rootSymbol){return rootSymbol===rootInstanceSymbol;}
function isRootInstance(object){return holder.has(object);}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _mixed=__webpack_require__(14);var _object=__webpack_require__(2);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function DefaultSettings(){}
DefaultSettings.prototype={licenseKey:'trial',data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:false,customBorders:false,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,allowInsertRow:true,allowInsertColumn:true,allowRemoveRow:true,allowRemoveColumn:true,selectionMode:'multiple',fillHandle:{autoInsertRow:false},fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:true,autoWrapCol:true,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:'ht__highlight',activeHeaderClassName:'ht__active_highlight',className:void 0,tableClassName:void 0,stretchH:'none',isEmptyRow:function isEmptyRow(row){var col;var colLen;var value;var meta;for(col=0,colLen=this.countCols();col<colLen;col++){value=this.getDataAtCell(row,col);if(value!==''&&value!==null&&(0,_mixed.isDefined)(value)){if(_typeof(value)==='object'){meta=this.getCellMeta(row,col);return(0,_object.isObjectEqual)(this.getSchema()[meta.prop],value);}
return false;}}
return true;},isEmptyCol:function isEmptyCol(col){var row;var rowLen;var value;for(row=0,rowLen=this.countRows();row<rowLen;row++){value=this.getDataAtCell(row,col);if(value!==''&&value!==null&&(0,_mixed.isDefined)(value)){return false;}}
return true;},observeDOMVisibility:true,allowInvalid:true,allowEmpty:true,invalidCellClassName:'htInvalid',placeholder:void 0,placeholderCellClassName:'htPlaceholder',readOnlyCellClassName:'htDimmed',renderer:void 0,commentedCellClassName:'htCommentCell',fragmentSelection:false,readOnly:false,skipColumnOnPaste:false,search:false,type:'text',copyable:true,editor:void 0,visibleRows:10,trimDropdown:true,debug:false,wordWrap:true,noWordWrapClassName:'htNoWrap',contextMenu:void 0,copyPaste:true,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:false,multiColumnSorting:void 0,viewportRowRenderingOffset:'auto',viewportColumnRenderingOffset:'auto',validator:void 0,disableVisualSelection:false,manualColumnFreeze:void 0,trimWhitespace:true,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,numericFormat:void 0,language:'en-US',selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:'DD/MM/YYYY',correctFormat:false,defaultDate:void 0,strict:void 0,allowHtml:false,renderAllRows:void 0,preventOverflow:false,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortByRelevance:true,filter:true,filteringCaseSensitive:false,dragToScroll:true,nestedRows:void 0};var _default=DefaultSettings;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.getTranslatedPhrase=getTranslatedPhrase;var _array=__webpack_require__(3);var _dictionariesManager=__webpack_require__(90);var _phraseFormatters=__webpack_require__(651);var _mixed=__webpack_require__(14);function getTranslatedPhrase(languageCode,dictionaryKey,argumentsForFormatters){var languageDictionary=(0,_dictionariesManager.getLanguageDictionary)(languageCode);if(languageDictionary===null){return null;}
var phrasePropositions=languageDictionary[dictionaryKey];if((0,_mixed.isUndefined)(phrasePropositions)){return null;}
var formattedPhrase=getFormattedPhrase(phrasePropositions,argumentsForFormatters);if(Array.isArray(formattedPhrase)){return formattedPhrase[0];}
return formattedPhrase;}
function getFormattedPhrase(phrasePropositions,argumentsForFormatters){var formattedPhrasePropositions=phrasePropositions;(0,_array.arrayEach)((0,_phraseFormatters.getPhraseFormatters)(),function(formatter){formattedPhrasePropositions=formatter(phrasePropositions,argumentsForFormatters);});return formattedPhrasePropositions;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.extendNotExistingKeys=extendNotExistingKeys;exports.createCellHeadersRange=createCellHeadersRange;exports.normalizeLanguageCode=normalizeLanguageCode;exports.applyLanguageSetting=applyLanguageSetting;exports.warnUserAboutLanguageRegistration=warnUserAboutLanguageRegistration;var _mixed=__webpack_require__(14);var _object=__webpack_require__(2);var _console=__webpack_require__(76);var _templateLiteralTag=__webpack_require__(58);var _dictionariesManager=__webpack_require__(90);function _templateObject(){var data=_taggedTemplateLiteral(["Language with code \"","\" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code."]);_templateObject=function _templateObject(){return data;};return data;}
function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0);}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}
function extendNotExistingKeys(target,extension){(0,_object.objectEach)(extension,function(value,key){if((0,_mixed.isUndefined)(target[key])){target[key]=value;}});return target;}
function createCellHeadersRange(firstRowIndex,nextRowIndex){var fromValue=arguments.length>2&&arguments[2]!==undefined?arguments[2]:firstRowIndex;var toValue=arguments.length>3&&arguments[3]!==undefined?arguments[3]:nextRowIndex;var from=fromValue,to=toValue;if(firstRowIndex>nextRowIndex){var _ref=[to,from];from=_ref[0];to=_ref[1];}
return"".concat(from,"-").concat(to);}
function normalizeLanguageCode(languageCode){var languageCodePattern=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/;var partsOfLanguageCode=languageCodePattern.exec(languageCode);if(partsOfLanguageCode){return"".concat(partsOfLanguageCode[1].toLowerCase(),"-").concat(partsOfLanguageCode[2].toUpperCase());}
return languageCode;}
function applyLanguageSetting(settings,languageCode){var normalizedLanguageCode=normalizeLanguageCode(languageCode);if((0,_dictionariesManager.hasLanguageDictionary)(normalizedLanguageCode)){settings.language=normalizedLanguageCode;}else{settings.language=_dictionariesManager.DEFAULT_LANGUAGE_CODE;warnUserAboutLanguageRegistration(languageCode);}}
function warnUserAboutLanguageRegistration(languageCode){if((0,_mixed.isDefined)(languageCode)){(0,_console.error)((0,_templateLiteralTag.toSingleLine)(_templateObject(),languageCode));}}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;var _highlight=_interopRequireDefault(__webpack_require__(430));exports.Highlight=_highlight.default;var _selection=_interopRequireDefault(__webpack_require__(660));exports.Selection=_selection.default;var _mouseEventHandler=__webpack_require__(423);exports.handleMouseEvent=_mouseEventHandler.handleMouseEvent;var _utils=__webpack_require__(91);exports.detectSelectionType=_utils.detectSelectionType;exports.normalizeSelectionFactory=_utils.normalizeSelectionFactory;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=exports.CUSTOM_SELECTION=exports.HEADER_TYPE=exports.FILL_TYPE=exports.CELL_TYPE=exports.AREA_TYPE=exports.ACTIVE_HEADER_TYPE=void 0;var _types=__webpack_require__(653);var _array=__webpack_require__(3);function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==='function'){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable;}));}ownKeys.forEach(function(key){_defineProperty(target,key,source[key]);});}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var ACTIVE_HEADER_TYPE='active-header';exports.ACTIVE_HEADER_TYPE=ACTIVE_HEADER_TYPE;var AREA_TYPE='area';exports.AREA_TYPE=AREA_TYPE;var CELL_TYPE='cell';exports.CELL_TYPE=CELL_TYPE;var FILL_TYPE='fill';exports.FILL_TYPE=FILL_TYPE;var HEADER_TYPE='header';exports.HEADER_TYPE=HEADER_TYPE;var CUSTOM_SELECTION='custom-selection';exports.CUSTOM_SELECTION=CUSTOM_SELECTION;var Highlight=function(){function Highlight(options){_classCallCheck(this,Highlight);this.options=options;this.layerLevel=0;this.cell=(0,_types.createHighlight)(CELL_TYPE,options);this.fill=(0,_types.createHighlight)(FILL_TYPE,options);this.areas=new Map();this.headers=new Map();this.activeHeaders=new Map();this.customSelections=[];}
_createClass(Highlight,[{key:"isEnabledFor",value:function isEnabledFor(highlightType){var type=highlightType==='current'?CELL_TYPE:highlightType;var disableHighlight=this.options.disableHighlight;if(typeof disableHighlight==='string'){disableHighlight=[disableHighlight];}
return disableHighlight===false||Array.isArray(disableHighlight)&&!disableHighlight.includes(type);}},{key:"useLayerLevel",value:function useLayerLevel(){var level=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;this.layerLevel=level;return this;}},{key:"getCell",value:function getCell(){return this.cell;}},{key:"getFill",value:function getFill(){return this.fill;}},{key:"createOrGetArea",value:function createOrGetArea(){var layerLevel=this.layerLevel;var area;if(this.areas.has(layerLevel)){area=this.areas.get(layerLevel);}else{area=(0,_types.createHighlight)(AREA_TYPE,_objectSpread({layerLevel:layerLevel},this.options));this.areas.set(layerLevel,area);}
return area;}},{key:"getAreas",value:function getAreas(){return _toConsumableArray(this.areas.values());}},{key:"createOrGetHeader",value:function createOrGetHeader(){var layerLevel=this.layerLevel;var header;if(this.headers.has(layerLevel)){header=this.headers.get(layerLevel);}else{header=(0,_types.createHighlight)(HEADER_TYPE,_objectSpread({},this.options));this.headers.set(layerLevel,header);}
return header;}},{key:"getHeaders",value:function getHeaders(){return _toConsumableArray(this.headers.values());}},{key:"createOrGetActiveHeader",value:function createOrGetActiveHeader(){var layerLevel=this.layerLevel;var header;if(this.activeHeaders.has(layerLevel)){header=this.activeHeaders.get(layerLevel);}else{header=(0,_types.createHighlight)(ACTIVE_HEADER_TYPE,_objectSpread({},this.options));this.activeHeaders.set(layerLevel,header);}
return header;}},{key:"getActiveHeaders",value:function getActiveHeaders(){return _toConsumableArray(this.activeHeaders.values());}},{key:"getCustomSelections",value:function getCustomSelections(){return _toConsumableArray(this.customSelections.values());}},{key:"addCustomSelection",value:function addCustomSelection(options){this.customSelections.push((0,_types.createHighlight)(CUSTOM_SELECTION,_objectSpread({},options)));}},{key:"clear",value:function clear(){this.cell.clear();this.fill.clear();(0,_array.arrayEach)(this.areas.values(),function(highlight){return void highlight.clear();});(0,_array.arrayEach)(this.headers.values(),function(highlight){return void highlight.clear();});(0,_array.arrayEach)(this.activeHeaders.values(),function(highlight){return void highlight.clear();});}},{key:Symbol.iterator,value:function value(){return[this.cell,this.fill].concat(_toConsumableArray(this.areas.values()),_toConsumableArray(this.headers.values()),_toConsumableArray(this.activeHeaders.values()),_toConsumableArray(this.customSelections))[Symbol.iterator]();}}]);return Highlight;}();var _default=Highlight;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _object=__webpack_require__(2);var _number=__webpack_require__(9);var _mixed=__webpack_require__(14);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var SamplesGenerator=function(){_createClass(SamplesGenerator,null,[{key:"SAMPLE_COUNT",get:function get(){return 3;}}]);function SamplesGenerator(dataFactory){_classCallCheck(this,SamplesGenerator);this.samples=null;this.dataFactory=dataFactory;this.customSampleCount=null;this.allowDuplicates=false;}
_createClass(SamplesGenerator,[{key:"getSampleCount",value:function getSampleCount(){if(this.customSampleCount){return this.customSampleCount;}
return SamplesGenerator.SAMPLE_COUNT;}},{key:"setSampleCount",value:function setSampleCount(sampleCount){this.customSampleCount=sampleCount;}},{key:"setAllowDuplicates",value:function setAllowDuplicates(allowDuplicates){this.allowDuplicates=allowDuplicates;}},{key:"generateRowSamples",value:function generateRowSamples(rowRange,colRange){return this.generateSamples('row',colRange,rowRange);}},{key:"generateColumnSamples",value:function generateColumnSamples(colRange,rowRange){return this.generateSamples('col',rowRange,colRange);}},{key:"generateSamples",value:function generateSamples(type,range,specifierRange){var _this=this;var samples=new Map();var _ref=typeof specifierRange==='number'?{from:specifierRange,to:specifierRange}:specifierRange,from=_ref.from,to=_ref.to;(0,_number.rangeEach)(from,to,function(index){var sample=_this.generateSample(type,range,index);samples.set(index,sample);});return samples;}},{key:"generateSample",value:function generateSample(type,range,specifierValue){var _this2=this;if(type!=='row'&&type!=='col'){throw new Error('Unsupported sample type');}
var samples=new Map();var computedKey=type==='row'?'col':'row';var sampledValues=[];(0,_number.rangeEach)(range.from,range.to,function(index){var _ref2=type==='row'?_this2.dataFactory(specifierValue,index):_this2.dataFactory(index,specifierValue),value=_ref2.value,bundleCountSeed=_ref2.bundleCountSeed;var hasCustomBundleSeed=bundleCountSeed>0;var length;if((0,_object.isObject)(value)){length=Object.keys(value).length;}else if(Array.isArray(value)){length=value.length;}else{length=(0,_mixed.stringify)(value).length;}
if(hasCustomBundleSeed){length+=bundleCountSeed;}
if(!samples.has(length)){samples.set(length,{needed:_this2.getSampleCount(),strings:[]});}
var sample=samples.get(length);if(sample.needed){var duplicate=sampledValues.indexOf(value)>-1;if(!duplicate||_this2.allowDuplicates||hasCustomBundleSeed){sample.strings.push(_defineProperty({value:value},computedKey,index));sampledValues.push(value);sample.needed-=1;}}});return samples;}}]);return SamplesGenerator;}();var _default=SamplesGenerator;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.areValidSortStates=areValidSortStates;exports.getNextSortOrder=getNextSortOrder;exports.getHeaderSpanElement=getHeaderSpanElement;exports.isFirstLevelColumnHeader=isFirstLevelColumnHeader;exports.wasHeaderClickedProperly=wasHeaderClickedProperly;exports.HEADER_SPAN_CLASS=exports.DESC_SORT_STATE=exports.ASC_SORT_STATE=void 0;var _mixed=__webpack_require__(14);var _object=__webpack_require__(2);var _event=__webpack_require__(18);var ASC_SORT_STATE='asc';exports.ASC_SORT_STATE=ASC_SORT_STATE;var DESC_SORT_STATE='desc';exports.DESC_SORT_STATE=DESC_SORT_STATE;var HEADER_SPAN_CLASS='colHeader';exports.HEADER_SPAN_CLASS=HEADER_SPAN_CLASS;function isValidColumnState(columnState){if((0,_mixed.isUndefined)(columnState)){return false;}
var column=columnState.column,sortOrder=columnState.sortOrder;return Number.isInteger(column)&&[ASC_SORT_STATE,DESC_SORT_STATE].includes(sortOrder);}
function areValidSortStates(sortStates){if(Array.isArray(sortStates)===false||sortStates.every(function(columnState){return(0,_object.isObject)(columnState);})===false){return false;}
var sortedColumns=sortStates.map(function(_ref){var column=_ref.column;return column;});var indexOccursOnlyOnce=new Set(sortedColumns).size===sortedColumns.length;return indexOccursOnlyOnce&&sortStates.every(isValidColumnState);}
function getNextSortOrder(sortOrder){if(sortOrder===DESC_SORT_STATE){return;}else if(sortOrder===ASC_SORT_STATE){return DESC_SORT_STATE;}
return ASC_SORT_STATE;}
function getHeaderSpanElement(TH){var headerSpanElement=TH.querySelector(".".concat(HEADER_SPAN_CLASS));return headerSpanElement;}
function isFirstLevelColumnHeader(column,TH){if(column<0||!TH.parentNode){return false;}
var TRs=TH.parentNode.parentNode.childNodes;var headerLevel=Array.from(TRs).indexOf(TH.parentNode)-TRs.length;if(headerLevel!==-1){return false;}
return true;}
function wasHeaderClickedProperly(row,column,clickEvent){return row===-1&&column>=0&&(0,_event.isRightClick)(clickEvent)===false;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.getCompareFunctionFactory=getCompareFunctionFactory;exports.getRootComparator=exports.registerRootComparator=void 0;var _default=__webpack_require__(676);var _numeric=__webpack_require__(677);var _date=__webpack_require__(678);var _staticRegister3=_interopRequireDefault(__webpack_require__(46));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var _staticRegister=(0,_staticRegister3.default)('sorting.compareFunctionFactory'),registerCompareFunctionFactory=_staticRegister.register,getGloballyCompareFunctionFactory=_staticRegister.getItem,hasGloballyCompareFunctionFactory=_staticRegister.hasItem;var _staticRegister2=(0,_staticRegister3.default)('sorting.mainSortComparator'),registerRootComparator=_staticRegister2.register,getRootComparator=_staticRegister2.getItem;exports.getRootComparator=getRootComparator;exports.registerRootComparator=registerRootComparator;function getCompareFunctionFactory(type){if(hasGloballyCompareFunctionFactory(type)){return getGloballyCompareFunctionFactory(type);}
return getGloballyCompareFunctionFactory(_default.COLUMN_DATA_TYPE);}
registerCompareFunctionFactory(_numeric.COLUMN_DATA_TYPE,_numeric.compareFunctionFactory);registerCompareFunctionFactory(_date.COLUMN_DATA_TYPE,_date.compareFunctionFactory);registerCompareFunctionFactory(_default.COLUMN_DATA_TYPE,_default.compareFunctionFactory);}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _number=__webpack_require__(9);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var STATE_INITIALIZED=0;var STATE_BUILT=1;var STATE_APPENDED=2;var UNIT='px';var BaseUI=function(){function BaseUI(hotInstance){_classCallCheck(this,BaseUI);this.hot=hotInstance;this._element=null;this.state=STATE_INITIALIZED;}
_createClass(BaseUI,[{key:"appendTo",value:function appendTo(wrapper){wrapper.appendChild(this._element);this.state=STATE_APPENDED;}},{key:"build",value:function build(){this._element=document.createElement('div');this.state=STATE_BUILT;}},{key:"destroy",value:function destroy(){if(this.isAppended()){this._element.parentElement.removeChild(this._element);}
this._element=null;this.state=STATE_INITIALIZED;}},{key:"isAppended",value:function isAppended(){return this.state===STATE_APPENDED;}},{key:"isBuilt",value:function isBuilt(){return this.state>=STATE_BUILT;}},{key:"setPosition",value:function setPosition(top,left){if((0,_number.isNumeric)(top)){this._element.style.top=top+UNIT;}
if((0,_number.isNumeric)(left)){this._element.style.left=left+UNIT;}}},{key:"getPosition",value:function getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0};}},{key:"setSize",value:function setSize(width,height){if((0,_number.isNumeric)(width)){this._element.style.width=width+UNIT;}
if((0,_number.isNumeric)(height)){this._element.style.height=height+UNIT;}}},{key:"getSize",value:function getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0};}},{key:"setOffset",value:function setOffset(top,left){if((0,_number.isNumeric)(top)){this._element.style.marginTop=top+UNIT;}
if((0,_number.isNumeric)(left)){this._element.style.marginLeft=left+UNIT;}}},{key:"getOffset",value:function getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0};}}]);return BaseUI;}();var _default=BaseUI;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var STATE_INITIALIZED=0;var STATE_BUILT=1;var STATE_APPENDED=2;var UNIT='px';var BaseUI=function(){function BaseUI(hotInstance){_classCallCheck(this,BaseUI);this.hot=hotInstance;this._element=null;this.state=STATE_INITIALIZED;}
_createClass(BaseUI,[{key:"appendTo",value:function appendTo(wrapper){wrapper.appendChild(this._element);this.state=STATE_APPENDED;}},{key:"build",value:function build(){this._element=document.createElement('div');this.state=STATE_BUILT;}},{key:"destroy",value:function destroy(){if(this.isAppended()){this._element.parentElement.removeChild(this._element);}
this._element=null;this.state=STATE_INITIALIZED;}},{key:"isAppended",value:function isAppended(){return this.state===STATE_APPENDED;}},{key:"isBuilt",value:function isBuilt(){return this.state>=STATE_BUILT;}},{key:"setPosition",value:function setPosition(top,left){if(top!==void 0){this._element.style.top=top+UNIT;}
if(left!==void 0){this._element.style.left=left+UNIT;}}},{key:"getPosition",value:function getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0};}},{key:"setSize",value:function setSize(width,height){if(width){this._element.style.width=width+UNIT;}
if(height){this._element.style.height=height+UNIT;}}},{key:"getSize",value:function getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0};}},{key:"setOffset",value:function setOffset(top,left){if(top){this._element.style.marginTop=top+UNIT;}
if(left){this._element.style.marginLeft=left+UNIT;}}},{key:"getOffset",value:function getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0};}}]);return BaseUI;}();var _default=BaseUI;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.applySpanProperties=applySpanProperties;function applySpanProperties(TD,mergedCellInfo,row,col){if(mergedCellInfo){if(mergedCellInfo.row===row&&mergedCellInfo.col===col){TD.setAttribute('rowspan',mergedCellInfo.rowspan.toString());TD.setAttribute('colspan',mergedCellInfo.colspan.toString());}else{TD.removeAttribute('rowspan');TD.removeAttribute('colspan');TD.style.display='none';}}else{TD.removeAttribute('rowspan');TD.removeAttribute('colspan');TD.style.display='';}}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;__webpack_require__(129);__webpack_require__(602);__webpack_require__(603);__webpack_require__(604);var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var _validators=__webpack_require__(49);var _cellTypes=__webpack_require__(119);var _core=_interopRequireDefault(__webpack_require__(120));var _jquery=_interopRequireDefault(__webpack_require__(663));var _eventManager=_interopRequireWildcard(__webpack_require__(10));var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _ghostTable=_interopRequireDefault(__webpack_require__(124));var arrayHelpers=_interopRequireWildcard(__webpack_require__(3));var browserHelpers=_interopRequireWildcard(__webpack_require__(42));var dataHelpers=_interopRequireWildcard(__webpack_require__(122));var dateHelpers=_interopRequireWildcard(__webpack_require__(421));var featureHelpers=_interopRequireWildcard(__webpack_require__(47));var functionHelpers=_interopRequireWildcard(__webpack_require__(59));var mixedHelpers=_interopRequireWildcard(__webpack_require__(14));var numberHelpers=_interopRequireWildcard(__webpack_require__(9));var objectHelpers=_interopRequireWildcard(__webpack_require__(2));var settingHelpers=_interopRequireWildcard(__webpack_require__(121));var stringHelpers=_interopRequireWildcard(__webpack_require__(48));var unicodeHelpers=_interopRequireWildcard(__webpack_require__(32));var domHelpers=_interopRequireWildcard(__webpack_require__(1));var domEventHelpers=_interopRequireWildcard(__webpack_require__(18));var plugins=_interopRequireWildcard(__webpack_require__(664));var _plugins=__webpack_require__(13);var _defaultSettings=_interopRequireDefault(__webpack_require__(426));var _rootInstance=__webpack_require__(425);var _i18n=__webpack_require__(427);var constants=_interopRequireWildcard(__webpack_require__(11));var _dictionariesManager=__webpack_require__(90);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function Handsontable(rootElement,userSettings){var instance=new _core.default(rootElement,userSettings||{},_rootInstance.rootInstanceSymbol);instance.init();return instance;}
(0,_jquery.default)(Handsontable);Handsontable.Core=_core.default;Handsontable.DefaultSettings=_defaultSettings.default;Handsontable.EventManager=_eventManager.default;Handsontable._getListenersCounter=_eventManager.getListenersCounter;Handsontable.buildDate="18/12/2018 14:40:17";Handsontable.packageName="handsontable";Handsontable.version="6.2.2";var baseVersion="";if(baseVersion){Handsontable.baseVersion=baseVersion;}
Handsontable.hooks=_pluginHooks.default.getSingleton();Handsontable.__GhostTable=_ghostTable.default;var HELPERS=[arrayHelpers,browserHelpers,dataHelpers,dateHelpers,featureHelpers,functionHelpers,mixedHelpers,numberHelpers,objectHelpers,settingHelpers,stringHelpers,unicodeHelpers];var DOM=[domHelpers,domEventHelpers];Handsontable.helper={};Handsontable.dom={};arrayHelpers.arrayEach(HELPERS,function(helper){arrayHelpers.arrayEach(Object.getOwnPropertyNames(helper),function(key){if(key.charAt(0)!=='_'){Handsontable.helper[key]=helper[key];}});});arrayHelpers.arrayEach(DOM,function(helper){arrayHelpers.arrayEach(Object.getOwnPropertyNames(helper),function(key){if(key.charAt(0)!=='_'){Handsontable.dom[key]=helper[key];}});});Handsontable.cellTypes={};arrayHelpers.arrayEach((0,_cellTypes.getRegisteredCellTypeNames)(),function(cellTypeName){Handsontable.cellTypes[cellTypeName]=(0,_cellTypes.getCellType)(cellTypeName);});Handsontable.cellTypes.registerCellType=_cellTypes.registerCellType;Handsontable.cellTypes.getCellType=_cellTypes.getCellType;Handsontable.editors={};arrayHelpers.arrayEach((0,_editors.getRegisteredEditorNames)(),function(editorName){Handsontable.editors["".concat(stringHelpers.toUpperCaseFirst(editorName),"Editor")]=(0,_editors.getEditor)(editorName);});Handsontable.editors.registerEditor=_editors.registerEditor;Handsontable.editors.getEditor=_editors.getEditor;Handsontable.renderers={};arrayHelpers.arrayEach((0,_renderers.getRegisteredRendererNames)(),function(rendererName){var renderer=(0,_renderers.getRenderer)(rendererName);if(rendererName==='base'){Handsontable.renderers.cellDecorator=renderer;}
Handsontable.renderers["".concat(stringHelpers.toUpperCaseFirst(rendererName),"Renderer")]=renderer;});Handsontable.renderers.registerRenderer=_renderers.registerRenderer;Handsontable.renderers.getRenderer=_renderers.getRenderer;Handsontable.validators={};arrayHelpers.arrayEach((0,_validators.getRegisteredValidatorNames)(),function(validatorName){Handsontable.validators["".concat(stringHelpers.toUpperCaseFirst(validatorName),"Validator")]=(0,_validators.getValidator)(validatorName);});Handsontable.validators.registerValidator=_validators.registerValidator;Handsontable.validators.getValidator=_validators.getValidator;Handsontable.plugins={};arrayHelpers.arrayEach(Object.getOwnPropertyNames(plugins),function(pluginName){var plugin=plugins[pluginName];if(pluginName==='Base'){Handsontable.plugins["".concat(pluginName,"Plugin")]=plugin;}else{Handsontable.plugins[pluginName]=plugin;}});Handsontable.plugins.registerPlugin=_plugins.registerPlugin;Handsontable.languages={};Handsontable.languages.dictionaryKeys=constants;Handsontable.languages.getLanguageDictionary=_dictionariesManager.getLanguageDictionary;Handsontable.languages.getLanguagesDictionaries=_dictionariesManager.getLanguagesDictionaries;Handsontable.languages.registerLanguageDictionary=_dictionariesManager.registerLanguageDictionary;Handsontable.languages.getTranslatedPhrase=function(){return _i18n.getTranslatedPhrase.apply(void 0,arguments);};var _default=Handsontable;exports.default=_default;}),(function(module,exports,__webpack_require__){__webpack_require__(439);__webpack_require__(441);__webpack_require__(442);__webpack_require__(443);__webpack_require__(444);__webpack_require__(445);__webpack_require__(446);__webpack_require__(447);__webpack_require__(448);__webpack_require__(449);__webpack_require__(450);__webpack_require__(451);__webpack_require__(452);__webpack_require__(453);__webpack_require__(454);__webpack_require__(455);__webpack_require__(456);__webpack_require__(457);__webpack_require__(458);__webpack_require__(459);__webpack_require__(460);__webpack_require__(461);__webpack_require__(462);__webpack_require__(463);__webpack_require__(464);__webpack_require__(465);__webpack_require__(466);__webpack_require__(467);__webpack_require__(468);__webpack_require__(469);__webpack_require__(470);__webpack_require__(471);__webpack_require__(472);__webpack_require__(473);__webpack_require__(474);__webpack_require__(475);__webpack_require__(476);__webpack_require__(477);__webpack_require__(478);__webpack_require__(479);__webpack_require__(480);__webpack_require__(481);__webpack_require__(482);__webpack_require__(484);__webpack_require__(485);__webpack_require__(486);__webpack_require__(487);__webpack_require__(488);__webpack_require__(489);__webpack_require__(490);__webpack_require__(491);__webpack_require__(492);__webpack_require__(493);__webpack_require__(494);__webpack_require__(495);__webpack_require__(496);__webpack_require__(497);__webpack_require__(498);__webpack_require__(499);__webpack_require__(500);__webpack_require__(501);__webpack_require__(502);__webpack_require__(503);__webpack_require__(504);__webpack_require__(505);__webpack_require__(506);__webpack_require__(507);__webpack_require__(508);__webpack_require__(509);__webpack_require__(510);__webpack_require__(511);__webpack_require__(512);__webpack_require__(513);__webpack_require__(514);__webpack_require__(515);__webpack_require__(516);__webpack_require__(517);__webpack_require__(519);__webpack_require__(520);__webpack_require__(522);__webpack_require__(523);__webpack_require__(524);__webpack_require__(525);__webpack_require__(526);__webpack_require__(527);__webpack_require__(528);__webpack_require__(531);__webpack_require__(532);__webpack_require__(533);__webpack_require__(534);__webpack_require__(535);__webpack_require__(536);__webpack_require__(537);__webpack_require__(538);__webpack_require__(539);__webpack_require__(540);__webpack_require__(541);__webpack_require__(542);__webpack_require__(543);__webpack_require__(114);__webpack_require__(544);__webpack_require__(149);__webpack_require__(545);__webpack_require__(150);__webpack_require__(546);__webpack_require__(547);__webpack_require__(548);__webpack_require__(549);__webpack_require__(151);__webpack_require__(552);__webpack_require__(553);__webpack_require__(554);__webpack_require__(555);__webpack_require__(556);__webpack_require__(557);__webpack_require__(558);__webpack_require__(559);__webpack_require__(560);__webpack_require__(561);__webpack_require__(562);__webpack_require__(563);__webpack_require__(564);__webpack_require__(565);__webpack_require__(566);__webpack_require__(567);__webpack_require__(568);__webpack_require__(569);__webpack_require__(570);__webpack_require__(571);__webpack_require__(572);__webpack_require__(573);__webpack_require__(574);__webpack_require__(575);__webpack_require__(576);__webpack_require__(577);__webpack_require__(578);__webpack_require__(579);__webpack_require__(580);module.exports=__webpack_require__(21);}),(function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(6);var has=__webpack_require__(27);var DESCRIPTORS=__webpack_require__(20);var $export=__webpack_require__(0);var redefine=__webpack_require__(23);var META=__webpack_require__(45).KEY;var $fails=__webpack_require__(4);var shared=__webpack_require__(93);var setToStringTag=__webpack_require__(60);var uid=__webpack_require__(51);var wks=__webpack_require__(12);var wksExt=__webpack_require__(94);var wksDefine=__webpack_require__(131);var enumKeys=__webpack_require__(440);var isArray=__webpack_require__(97);var anObject=__webpack_require__(5);var isObject=__webpack_require__(7);var toIObject=__webpack_require__(29);var toPrimitive=__webpack_require__(44);var createDesc=__webpack_require__(50);var _create=__webpack_require__(55);var gOPNExt=__webpack_require__(134);var $GOPD=__webpack_require__(34);var $DP=__webpack_require__(17);var $keys=__webpack_require__(53);var gOPD=$GOPD.f;var dP=$DP.f;var gOPN=gOPNExt.f;var $Symbol=global.Symbol;var $JSON=global.JSON;var _stringify=$JSON&&$JSON.stringify;var PROTOTYPE='prototype';var HIDDEN=wks('_hidden');var TO_PRIMITIVE=wks('toPrimitive');var isEnum={}.propertyIsEnumerable;var SymbolRegistry=shared('symbol-registry');var AllSymbols=shared('symbols');var OPSymbols=shared('op-symbols');var ObjectProto=Object[PROTOTYPE];var USE_NATIVE=typeof $Symbol=='function';var QObject=global.QObject;var setter=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild;var setSymbolDesc=DESCRIPTORS&&$fails(function(){return _create(dP({},'a',{get:function(){return dP(this,'a',{value:7}).a;}})).a!=7;})?function(it,key,D){var protoDesc=gOPD(ObjectProto,key);if(protoDesc)delete ObjectProto[key];dP(it,key,D);if(protoDesc&&it!==ObjectProto)dP(ObjectProto,key,protoDesc);}:dP;var wrap=function(tag){var sym=AllSymbols[tag]=_create($Symbol[PROTOTYPE]);sym._k=tag;return sym;};var isSymbol=USE_NATIVE&&typeof $Symbol.iterator=='symbol'?function(it){return typeof it=='symbol';}:function(it){return it instanceof $Symbol;};var $defineProperty=function defineProperty(it,key,D){if(it===ObjectProto)$defineProperty(OPSymbols,key,D);anObject(it);key=toPrimitive(key,true);anObject(D);if(has(AllSymbols,key)){if(!D.enumerable){if(!has(it,HIDDEN))dP(it,HIDDEN,createDesc(1,{}));it[HIDDEN][key]=true;}else{if(has(it,HIDDEN)&&it[HIDDEN][key])it[HIDDEN][key]=false;D=_create(D,{enumerable:createDesc(0,false)});}return setSymbolDesc(it,key,D);}return dP(it,key,D);};var $defineProperties=function defineProperties(it,P){anObject(it);var keys=enumKeys(P=toIObject(P));var i=0;var l=keys.length;var key;while(l>i)$defineProperty(it,key=keys[i++],P[key]);return it;};var $create=function create(it,P){return P===undefined?_create(it):$defineProperties(_create(it),P);};var $propertyIsEnumerable=function propertyIsEnumerable(key){var E=isEnum.call(this,key=toPrimitive(key,true));if(this===ObjectProto&&has(AllSymbols,key)&&!has(OPSymbols,key))return false;return E||!has(this,key)||!has(AllSymbols,key)||has(this,HIDDEN)&&this[HIDDEN][key]?E:true;};var $getOwnPropertyDescriptor=function getOwnPropertyDescriptor(it,key){it=toIObject(it);key=toPrimitive(key,true);if(it===ObjectProto&&has(AllSymbols,key)&&!has(OPSymbols,key))return;var D=gOPD(it,key);if(D&&has(AllSymbols,key)&&!(has(it,HIDDEN)&&it[HIDDEN][key]))D.enumerable=true;return D;};var $getOwnPropertyNames=function getOwnPropertyNames(it){var names=gOPN(toIObject(it));var result=[];var i=0;var key;while(names.length>i){if(!has(AllSymbols,key=names[i++])&&key!=HIDDEN&&key!=META)result.push(key);}return result;};var $getOwnPropertySymbols=function getOwnPropertySymbols(it){var IS_OP=it===ObjectProto;var names=gOPN(IS_OP?OPSymbols:toIObject(it));var result=[];var i=0;var key;while(names.length>i){if(has(AllSymbols,key=names[i++])&&(IS_OP?has(ObjectProto,key):true))result.push(AllSymbols[key]);}return result;};if(!USE_NATIVE){$Symbol=function Symbol(){if(this instanceof $Symbol)throw TypeError('Symbol is not a constructor!');var tag=uid(arguments.length>0?arguments[0]:undefined);var $set=function(value){if(this===ObjectProto)$set.call(OPSymbols,value);if(has(this,HIDDEN)&&has(this[HIDDEN],tag))this[HIDDEN][tag]=false;setSymbolDesc(this,tag,createDesc(1,value));};if(DESCRIPTORS&&setter)setSymbolDesc(ObjectProto,tag,{configurable:true,set:$set});return wrap(tag);};redefine($Symbol[PROTOTYPE],'toString',function toString(){return this._k;});$GOPD.f=$getOwnPropertyDescriptor;$DP.f=$defineProperty;__webpack_require__(56).f=gOPNExt.f=$getOwnPropertyNames;__webpack_require__(71).f=$propertyIsEnumerable;__webpack_require__(80).f=$getOwnPropertySymbols;if(DESCRIPTORS&&!__webpack_require__(52)){redefine(ObjectProto,'propertyIsEnumerable',$propertyIsEnumerable,true);}
wksExt.f=function(name){return wrap(wks(name));};}
$export($export.G+$export.W+$export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols=('hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables').split(','),j=0;es6Symbols.length>j;)wks(es6Symbols[j++]);for(var wellKnownSymbols=$keys(wks.store),k=0;wellKnownSymbols.length>k;)wksDefine(wellKnownSymbols[k++]);$export($export.S+$export.F*!USE_NATIVE,'Symbol',{'for':function(key){return has(SymbolRegistry,key+='')?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key);},keyFor:function keyFor(sym){if(!isSymbol(sym))throw TypeError(sym+' is not a symbol!');for(var key in SymbolRegistry)if(SymbolRegistry[key]===sym)return key;},useSetter:function(){setter=true;},useSimple:function(){setter=false;}});$export($export.S+$export.F*!USE_NATIVE,'Object',{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});$JSON&&$export($export.S+$export.F*(!USE_NATIVE||$fails(function(){var S=$Symbol();return _stringify([S])!='[null]'||_stringify({a:S})!='{}'||_stringify(Object(S))!='{}';})),'JSON',{stringify:function stringify(it){var args=[it];var i=1;var replacer,$replacer;while(arguments.length>i)args.push(arguments[i++]);$replacer=replacer=args[1];if(!isObject(replacer)&&it===undefined||isSymbol(it))return;if(!isArray(replacer))replacer=function(key,value){if(typeof $replacer=='function')value=$replacer.call(this,key,value);if(!isSymbol(value))return value;};args[1]=replacer;return _stringify.apply($JSON,args);}});$Symbol[PROTOTYPE][TO_PRIMITIVE]||__webpack_require__(28)($Symbol[PROTOTYPE],TO_PRIMITIVE,$Symbol[PROTOTYPE].valueOf);setToStringTag($Symbol,'Symbol');setToStringTag(Math,'Math',true);setToStringTag(global.JSON,'JSON',true);}),(function(module,exports,__webpack_require__){var getKeys=__webpack_require__(53);var gOPS=__webpack_require__(80);var pIE=__webpack_require__(71);module.exports=function(it){var result=getKeys(it);var getSymbols=gOPS.f;if(getSymbols){var symbols=getSymbols(it);var isEnum=pIE.f;var i=0;var key;while(symbols.length>i)if(isEnum.call(it,key=symbols[i++]))result.push(key);}return result;};}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Object',{create:__webpack_require__(55)});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S+$export.F*!__webpack_require__(20),'Object',{defineProperty:__webpack_require__(17).f});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S+$export.F*!__webpack_require__(20),'Object',{defineProperties:__webpack_require__(133)});}),(function(module,exports,__webpack_require__){var toIObject=__webpack_require__(29);var $getOwnPropertyDescriptor=__webpack_require__(34).f;__webpack_require__(35)('getOwnPropertyDescriptor',function(){return function getOwnPropertyDescriptor(it,key){return $getOwnPropertyDescriptor(toIObject(it),key);};});}),(function(module,exports,__webpack_require__){var toObject=__webpack_require__(24);var $getPrototypeOf=__webpack_require__(57);__webpack_require__(35)('getPrototypeOf',function(){return function getPrototypeOf(it){return $getPrototypeOf(toObject(it));};});}),(function(module,exports,__webpack_require__){var toObject=__webpack_require__(24);var $keys=__webpack_require__(53);__webpack_require__(35)('keys',function(){return function keys(it){return $keys(toObject(it));};});}),(function(module,exports,__webpack_require__){__webpack_require__(35)('getOwnPropertyNames',function(){return __webpack_require__(134).f;});}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);var meta=__webpack_require__(45).onFreeze;__webpack_require__(35)('freeze',function($freeze){return function freeze(it){return $freeze&&isObject(it)?$freeze(meta(it)):it;};});}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);var meta=__webpack_require__(45).onFreeze;__webpack_require__(35)('seal',function($seal){return function seal(it){return $seal&&isObject(it)?$seal(meta(it)):it;};});}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);var meta=__webpack_require__(45).onFreeze;__webpack_require__(35)('preventExtensions',function($preventExtensions){return function preventExtensions(it){return $preventExtensions&&isObject(it)?$preventExtensions(meta(it)):it;};});}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);__webpack_require__(35)('isFrozen',function($isFrozen){return function isFrozen(it){return isObject(it)?$isFrozen?$isFrozen(it):false:true;};});}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);__webpack_require__(35)('isSealed',function($isSealed){return function isSealed(it){return isObject(it)?$isSealed?$isSealed(it):false:true;};});}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);__webpack_require__(35)('isExtensible',function($isExtensible){return function isExtensible(it){return isObject(it)?$isExtensible?$isExtensible(it):true:false;};});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S+$export.F,'Object',{assign:__webpack_require__(135)});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Object',{is:__webpack_require__(136)});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Object',{setPrototypeOf:__webpack_require__(99).set});}),(function(module,exports,__webpack_require__){"use strict";var classof=__webpack_require__(72);var test={};test[__webpack_require__(12)('toStringTag')]='z';if(test+''!='[object z]'){__webpack_require__(23)(Object.prototype,'toString',function toString(){return'[object '+classof(this)+']';},true);}}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.P,'Function',{bind:__webpack_require__(137)});}),(function(module,exports,__webpack_require__){var dP=__webpack_require__(17).f;var FProto=Function.prototype;var nameRE=/^\s*function ([^ (]*)/;var NAME='name';NAME in FProto||__webpack_require__(20)&&dP(FProto,NAME,{configurable:true,get:function(){try{return(''+this).match(nameRE)[1];}catch(e){return'';}}});}),(function(module,exports,__webpack_require__){"use strict";var isObject=__webpack_require__(7);var getPrototypeOf=__webpack_require__(57);var HAS_INSTANCE=__webpack_require__(12)('hasInstance');var FunctionProto=Function.prototype;if(!(HAS_INSTANCE in FunctionProto))__webpack_require__(17).f(FunctionProto,HAS_INSTANCE,{value:function(O){if(typeof this!='function'||!isObject(O))return false;if(!isObject(this.prototype))return O instanceof this;while(O=getPrototypeOf(O))if(this.prototype===O)return true;return false;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $parseInt=__webpack_require__(139);$export($export.G+$export.F*(parseInt!=$parseInt),{parseInt:$parseInt});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $parseFloat=__webpack_require__(140);$export($export.G+$export.F*(parseFloat!=$parseFloat),{parseFloat:$parseFloat});}),(function(module,exports,__webpack_require__){"use strict";var global=__webpack_require__(6);var has=__webpack_require__(27);var cof=__webpack_require__(39);var inheritIfRequired=__webpack_require__(101);var toPrimitive=__webpack_require__(44);var fails=__webpack_require__(4);var gOPN=__webpack_require__(56).f;var gOPD=__webpack_require__(34).f;var dP=__webpack_require__(17).f;var $trim=__webpack_require__(81).trim;var NUMBER='Number';var $Number=global[NUMBER];var Base=$Number;var proto=$Number.prototype;var BROKEN_COF=cof(__webpack_require__(55)(proto))==NUMBER;var TRIM='trim'in String.prototype;var toNumber=function(argument){var it=toPrimitive(argument,false);if(typeof it=='string'&&it.length>2){it=TRIM?it.trim():$trim(it,3);var first=it.charCodeAt(0);var third,radix,maxCode;if(first===43||first===45){third=it.charCodeAt(2);if(third===88||third===120)return NaN;}else if(first===48){switch(it.charCodeAt(1)){case 66:case 98:radix=2;maxCode=49;break;case 79:case 111:radix=8;maxCode=55;break;default:return+it;}
for(var digits=it.slice(2),i=0,l=digits.length,code;i<l;i++){code=digits.charCodeAt(i);if(code<48||code>maxCode)return NaN;}return parseInt(digits,radix);}}return+it;};if(!$Number(' 0o1')||!$Number('0b1')||$Number('+0x1')){$Number=function Number(value){var it=arguments.length<1?0:value;var that=this;return that instanceof $Number&&(BROKEN_COF?fails(function(){proto.valueOf.call(that);}):cof(that)!=NUMBER)?inheritIfRequired(new Base(toNumber(it)),that,$Number):toNumber(it);};for(var keys=__webpack_require__(20)?gOPN(Base):('MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,'+'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,'+'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger').split(','),j=0,key;keys.length>j;j++){if(has(Base,key=keys[j])&&!has($Number,key)){dP($Number,key,gOPD(Base,key));}}
$Number.prototype=proto;proto.constructor=$Number;__webpack_require__(23)(global,NUMBER,$Number);}}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toInteger=__webpack_require__(33);var aNumberValue=__webpack_require__(141);var repeat=__webpack_require__(102);var $toFixed=1.0.toFixed;var floor=Math.floor;var data=[0,0,0,0,0,0];var ERROR='Number.toFixed: incorrect invocation!';var ZERO='0';var multiply=function(n,c){var i=-1;var c2=c;while(++i<6){c2+=n*data[i];data[i]=c2%1e7;c2=floor(c2/1e7);}};var divide=function(n){var i=6;var c=0;while(--i>=0){c+=data[i];data[i]=floor(c/n);c=(c%n)*1e7;}};var numToString=function(){var i=6;var s='';while(--i>=0){if(s!==''||i===0||data[i]!==0){var t=String(data[i]);s=s===''?t:s+repeat.call(ZERO,7-t.length)+t;}}return s;};var pow=function(x,n,acc){return n===0?acc:n%2===1?pow(x,n-1,acc*x):pow(x*x,n/2,acc);};var log=function(x){var n=0;var x2=x;while(x2>=4096){n+=12;x2/=4096;}
while(x2>=2){n+=1;x2/=2;}return n;};$export($export.P+$export.F*(!!$toFixed&&(0.00008.toFixed(3)!=='0.000'||0.9.toFixed(0)!=='1'||1.255.toFixed(2)!=='1.25'||1000000000000000128.0.toFixed(0)!=='1000000000000000128')||!__webpack_require__(4)(function(){$toFixed.call({});})),'Number',{toFixed:function toFixed(fractionDigits){var x=aNumberValue(this,ERROR);var f=toInteger(fractionDigits);var s='';var m=ZERO;var e,z,j,k;if(f<0||f>20)throw RangeError(ERROR);if(x!=x)return'NaN';if(x<=-1e21||x>=1e21)return String(x);if(x<0){s='-';x=-x;}
if(x>1e-21){e=log(x*pow(2,69,1))-69;z=e<0?x*pow(2,-e,1):x/pow(2,e,1);z*=0x10000000000000;e=52-e;if(e>0){multiply(0,z);j=f;while(j>=7){multiply(1e7,0);j-=7;}
multiply(pow(10,j,1),0);j=e-1;while(j>=23){divide(1<<23);j-=23;}
divide(1<<j);multiply(1,1);divide(2);m=numToString();}else{multiply(0,z);multiply(1<<-e,0);m=numToString()+repeat.call(ZERO,f);}}
if(f>0){k=m.length;m=s+(k<=f?'0.'+repeat.call(ZERO,f-k)+m:m.slice(0,k-f)+'.'+m.slice(k-f));}else{m=s+m;}return m;}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $fails=__webpack_require__(4);var aNumberValue=__webpack_require__(141);var $toPrecision=1.0.toPrecision;$export($export.P+$export.F*($fails(function(){return $toPrecision.call(1,undefined)!=='1';})||!$fails(function(){$toPrecision.call({});})),'Number',{toPrecision:function toPrecision(precision){var that=aNumberValue(this,'Number#toPrecision: incorrect invocation!');return precision===undefined?$toPrecision.call(that):$toPrecision.call(that,precision);}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Number',{EPSILON:Math.pow(2,-52)});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var _isFinite=__webpack_require__(6).isFinite;$export($export.S,'Number',{isFinite:function isFinite(it){return typeof it=='number'&&_isFinite(it);}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Number',{isInteger:__webpack_require__(142)});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Number',{isNaN:function isNaN(number){return number!=number;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var isInteger=__webpack_require__(142);var abs=Math.abs;$export($export.S,'Number',{isSafeInteger:function isSafeInteger(number){return isInteger(number)&&abs(number)<=0x1fffffffffffff;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Number',{MAX_SAFE_INTEGER:0x1fffffffffffff});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Number',{MIN_SAFE_INTEGER:-0x1fffffffffffff});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $parseFloat=__webpack_require__(140);$export($export.S+$export.F*(Number.parseFloat!=$parseFloat),'Number',{parseFloat:$parseFloat});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $parseInt=__webpack_require__(139);$export($export.S+$export.F*(Number.parseInt!=$parseInt),'Number',{parseInt:$parseInt});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var log1p=__webpack_require__(143);var sqrt=Math.sqrt;var $acosh=Math.acosh;$export($export.S+$export.F*!($acosh&&Math.floor($acosh(Number.MAX_VALUE))==710&&$acosh(Infinity)==Infinity),'Math',{acosh:function acosh(x){return(x=+x)<1?NaN:x>94906265.62425156?Math.log(x)+Math.LN2:log1p(x-1+sqrt(x-1)*sqrt(x+1));}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $asinh=Math.asinh;function asinh(x){return!isFinite(x=+x)||x==0?x:x<0?-asinh(-x):Math.log(x+Math.sqrt(x*x+1));}
$export($export.S+$export.F*!($asinh&&1/$asinh(0)>0),'Math',{asinh:asinh});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $atanh=Math.atanh;$export($export.S+$export.F*!($atanh&&1/$atanh(-0)<0),'Math',{atanh:function atanh(x){return(x=+x)==0?x:Math.log((1+x)/(1-x))/2;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var sign=__webpack_require__(103);$export($export.S,'Math',{cbrt:function cbrt(x){return sign(x=+x)*Math.pow(Math.abs(x),1/3);}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Math',{clz32:function clz32(x){return(x>>>=0)?31-Math.floor(Math.log(x+0.5)*Math.LOG2E):32;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var exp=Math.exp;$export($export.S,'Math',{cosh:function cosh(x){return(exp(x=+x)+exp(-x))/2;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $expm1=__webpack_require__(104);$export($export.S+$export.F*($expm1!=Math.expm1),'Math',{expm1:$expm1});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Math',{fround:__webpack_require__(483)});}),(function(module,exports,__webpack_require__){var sign=__webpack_require__(103);var pow=Math.pow;var EPSILON=pow(2,-52);var EPSILON32=pow(2,-23);var MAX32=pow(2,127)*(2-EPSILON32);var MIN32=pow(2,-126);var roundTiesToEven=function(n){return n+1/EPSILON-1/EPSILON;};module.exports=Math.fround||function fround(x){var $abs=Math.abs(x);var $sign=sign(x);var a,result;if($abs<MIN32)return $sign*roundTiesToEven($abs/MIN32/EPSILON32)*MIN32*EPSILON32;a=(1+EPSILON32/EPSILON)*$abs;result=a-(a-$abs);if(result>MAX32||result!=result)return $sign*Infinity;return $sign*result;};}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var abs=Math.abs;$export($export.S,'Math',{hypot:function hypot(value1,value2){var sum=0;var i=0;var aLen=arguments.length;var larg=0;var arg,div;while(i<aLen){arg=abs(arguments[i++]);if(larg<arg){div=larg/arg;sum=sum*div*div+1;larg=arg;}else if(arg>0){div=arg/larg;sum+=div*div;}else sum+=arg;}
return larg===Infinity?Infinity:larg*Math.sqrt(sum);}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $imul=Math.imul;$export($export.S+$export.F*__webpack_require__(4)(function(){return $imul(0xffffffff,5)!=-5||$imul.length!=2;}),'Math',{imul:function imul(x,y){var UINT16=0xffff;var xn=+x;var yn=+y;var xl=UINT16&xn;var yl=UINT16&yn;return 0|xl*yl+((UINT16&xn>>>16)*yl+xl*(UINT16&yn>>>16)<<16>>>0);}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Math',{log10:function log10(x){return Math.log(x)*Math.LOG10E;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Math',{log1p:__webpack_require__(143)});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Math',{log2:function log2(x){return Math.log(x)/Math.LN2;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Math',{sign:__webpack_require__(103)});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var expm1=__webpack_require__(104);var exp=Math.exp;$export($export.S+$export.F*__webpack_require__(4)(function(){return!Math.sinh(-2e-17)!=-2e-17;}),'Math',{sinh:function sinh(x){return Math.abs(x=+x)<1?(expm1(x)-expm1(-x))/2:(exp(x-1)-exp(-x-1))*(Math.E/2);}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var expm1=__webpack_require__(104);var exp=Math.exp;$export($export.S,'Math',{tanh:function tanh(x){var a=expm1(x=+x);var b=expm1(-x);return a==Infinity?1:b==Infinity?-1:(a-b)/(exp(x)+exp(-x));}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Math',{trunc:function trunc(it){return(it>0?Math.floor:Math.ceil)(it);}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var toAbsoluteIndex=__webpack_require__(54);var fromCharCode=String.fromCharCode;var $fromCodePoint=String.fromCodePoint;$export($export.S+$export.F*(!!$fromCodePoint&&$fromCodePoint.length!=1),'String',{fromCodePoint:function fromCodePoint(x){var res=[];var aLen=arguments.length;var i=0;var code;while(aLen>i){code=+arguments[i++];if(toAbsoluteIndex(code,0x10ffff)!==code)throw RangeError(code+' is not a valid code point');res.push(code<0x10000?fromCharCode(code):fromCharCode(((code-=0x10000)>>10)+0xd800,code%0x400+0xdc00));}return res.join('');}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var toIObject=__webpack_require__(29);var toLength=__webpack_require__(16);$export($export.S,'String',{raw:function raw(callSite){var tpl=toIObject(callSite.raw);var len=toLength(tpl.length);var aLen=arguments.length;var res=[];var i=0;while(len>i){res.push(String(tpl[i++]));if(i<aLen)res.push(String(arguments[i]));}return res.join('');}});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(81)('trim',function($trim){return function trim(){return $trim(this,3);};});}),(function(module,exports,__webpack_require__){"use strict";var $at=__webpack_require__(105)(true);__webpack_require__(106)(String,'String',function(iterated){this._t=String(iterated);this._i=0;},function(){var O=this._t;var index=this._i;var point;if(index>=O.length)return{value:undefined,done:true};point=$at(O,index);this._i+=point.length;return{value:point,done:false};});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $at=__webpack_require__(105)(false);$export($export.P,'String',{codePointAt:function codePointAt(pos){return $at(this,pos);}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toLength=__webpack_require__(16);var context=__webpack_require__(107);var ENDS_WITH='endsWith';var $endsWith=''[ENDS_WITH];$export($export.P+$export.F*__webpack_require__(109)(ENDS_WITH),'String',{endsWith:function endsWith(searchString){var that=context(this,searchString,ENDS_WITH);var endPosition=arguments.length>1?arguments[1]:undefined;var len=toLength(that.length);var end=endPosition===undefined?len:Math.min(toLength(endPosition),len);var search=String(searchString);return $endsWith?$endsWith.call(that,search,end):that.slice(end-search.length,end)===search;}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var context=__webpack_require__(107);var INCLUDES='includes';$export($export.P+$export.F*__webpack_require__(109)(INCLUDES),'String',{includes:function includes(searchString){return!!~context(this,searchString,INCLUDES).indexOf(searchString,arguments.length>1?arguments[1]:undefined);}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.P,'String',{repeat:__webpack_require__(102)});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toLength=__webpack_require__(16);var context=__webpack_require__(107);var STARTS_WITH='startsWith';var $startsWith=''[STARTS_WITH];$export($export.P+$export.F*__webpack_require__(109)(STARTS_WITH),'String',{startsWith:function startsWith(searchString){var that=context(this,searchString,STARTS_WITH);var index=toLength(Math.min(arguments.length>1?arguments[1]:undefined,that.length));var search=String(searchString);return $startsWith?$startsWith.call(that,search,index):that.slice(index,index+search.length)===search;}});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('anchor',function(createHTML){return function anchor(name){return createHTML(this,'a','name',name);};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('big',function(createHTML){return function big(){return createHTML(this,'big','','');};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('blink',function(createHTML){return function blink(){return createHTML(this,'blink','','');};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('bold',function(createHTML){return function bold(){return createHTML(this,'b','','');};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('fixed',function(createHTML){return function fixed(){return createHTML(this,'tt','','');};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('fontcolor',function(createHTML){return function fontcolor(color){return createHTML(this,'font','color',color);};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('fontsize',function(createHTML){return function fontsize(size){return createHTML(this,'font','size',size);};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('italics',function(createHTML){return function italics(){return createHTML(this,'i','','');};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('link',function(createHTML){return function link(url){return createHTML(this,'a','href',url);};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('small',function(createHTML){return function small(){return createHTML(this,'small','','');};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('strike',function(createHTML){return function strike(){return createHTML(this,'strike','','');};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('sub',function(createHTML){return function sub(){return createHTML(this,'sub','','');};});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(25)('sup',function(createHTML){return function sup(){return createHTML(this,'sup','','');};});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Date',{now:function(){return new Date().getTime();}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toObject=__webpack_require__(24);var toPrimitive=__webpack_require__(44);$export($export.P+$export.F*__webpack_require__(4)(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1;}})!==1;}),'Date',{toJSON:function toJSON(key){var O=toObject(this);var pv=toPrimitive(O);return typeof pv=='number'&&!isFinite(pv)?null:O.toISOString();}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var toISOString=__webpack_require__(518);$export($export.P+$export.F*(Date.prototype.toISOString!==toISOString),'Date',{toISOString:toISOString});}),(function(module,exports,__webpack_require__){"use strict";var fails=__webpack_require__(4);var getTime=Date.prototype.getTime;var $toISOString=Date.prototype.toISOString;var lz=function(num){return num>9?num:'0'+num;};module.exports=(fails(function(){return $toISOString.call(new Date(-5e13-1))!='0385-07-25T07:06:39.999Z';})||!fails(function(){$toISOString.call(new Date(NaN));}))?function toISOString(){if(!isFinite(getTime.call(this)))throw RangeError('Invalid time value');var d=this;var y=d.getUTCFullYear();var m=d.getUTCMilliseconds();var s=y<0?'-':y>9999?'+':'';return s+('00000'+Math.abs(y)).slice(s?-6:-4)+'-'+lz(d.getUTCMonth()+1)+'-'+lz(d.getUTCDate())+'T'+lz(d.getUTCHours())+':'+lz(d.getUTCMinutes())+':'+lz(d.getUTCSeconds())+'.'+(m>99?m:'0'+lz(m))+'Z';}:$toISOString;}),(function(module,exports,__webpack_require__){var DateProto=Date.prototype;var INVALID_DATE='Invalid Date';var TO_STRING='toString';var $toString=DateProto[TO_STRING];var getTime=DateProto.getTime;if(new Date(NaN)+''!=INVALID_DATE){__webpack_require__(23)(DateProto,TO_STRING,function toString(){var value=getTime.call(this);return value===value?$toString.call(this):INVALID_DATE;});}}),(function(module,exports,__webpack_require__){var TO_PRIMITIVE=__webpack_require__(12)('toPrimitive');var proto=Date.prototype;if(!(TO_PRIMITIVE in proto))__webpack_require__(28)(proto,TO_PRIMITIVE,__webpack_require__(521));}),(function(module,exports,__webpack_require__){"use strict";var anObject=__webpack_require__(5);var toPrimitive=__webpack_require__(44);var NUMBER='number';module.exports=function(hint){if(hint!=='string'&&hint!==NUMBER&&hint!=='default')throw TypeError('Incorrect hint');return toPrimitive(anObject(this),hint!=NUMBER);};}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Array',{isArray:__webpack_require__(97)});}),(function(module,exports,__webpack_require__){"use strict";var ctx=__webpack_require__(37);var $export=__webpack_require__(0);var toObject=__webpack_require__(24);var call=__webpack_require__(145);var isArrayIter=__webpack_require__(110);var toLength=__webpack_require__(16);var createProperty=__webpack_require__(111);var getIterFn=__webpack_require__(112);$export($export.S+$export.F*!__webpack_require__(82)(function(iter){Array.from(iter);}),'Array',{from:function from(arrayLike){var O=toObject(arrayLike);var C=typeof this=='function'?this:Array;var aLen=arguments.length;var mapfn=aLen>1?arguments[1]:undefined;var mapping=mapfn!==undefined;var index=0;var iterFn=getIterFn(O);var length,result,step,iterator;if(mapping)mapfn=ctx(mapfn,aLen>2?arguments[2]:undefined,2);if(iterFn!=undefined&&!(C==Array&&isArrayIter(iterFn))){for(iterator=iterFn.call(O),result=new C();!(step=iterator.next()).done;index++){createProperty(result,index,mapping?call(iterator,mapfn,[step.value,index],true):step.value);}}else{length=toLength(O.length);for(result=new C(length);length>index;index++){createProperty(result,index,mapping?mapfn(O[index],index):O[index]);}}
result.length=index;return result;}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var createProperty=__webpack_require__(111);$export($export.S+$export.F*__webpack_require__(4)(function(){function F(){}
return!(Array.of.call(F)instanceof F);}),'Array',{of:function of(){var index=0;var aLen=arguments.length;var result=new(typeof this=='function'?this:Array)(aLen);while(aLen>index)createProperty(result,index,arguments[index++]);result.length=aLen;return result;}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toIObject=__webpack_require__(29);var arrayJoin=[].join;$export($export.P+$export.F*(__webpack_require__(70)!=Object||!__webpack_require__(31)(arrayJoin)),'Array',{join:function join(separator){return arrayJoin.call(toIObject(this),separator===undefined?',':separator);}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var html=__webpack_require__(98);var cof=__webpack_require__(39);var toAbsoluteIndex=__webpack_require__(54);var toLength=__webpack_require__(16);var arraySlice=[].slice;$export($export.P+$export.F*__webpack_require__(4)(function(){if(html)arraySlice.call(html);}),'Array',{slice:function slice(begin,end){var len=toLength(this.length);var klass=cof(this);end=end===undefined?len:end;if(klass=='Array')return arraySlice.call(this,begin,end);var start=toAbsoluteIndex(begin,len);var upTo=toAbsoluteIndex(end,len);var size=toLength(upTo-start);var cloned=new Array(size);var i=0;for(;i<size;i++)cloned[i]=klass=='String'?this.charAt(start+i):this[start+i];return cloned;}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var aFunction=__webpack_require__(38);var toObject=__webpack_require__(24);var fails=__webpack_require__(4);var $sort=[].sort;var test=[1,2,3];$export($export.P+$export.F*(fails(function(){test.sort(undefined);})||!fails(function(){test.sort(null);})||!__webpack_require__(31)($sort)),'Array',{sort:function sort(comparefn){return comparefn===undefined?$sort.call(toObject(this)):$sort.call(toObject(this),aFunction(comparefn));}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $forEach=__webpack_require__(36)(0);var STRICT=__webpack_require__(31)([].forEach,true);$export($export.P+$export.F*!STRICT,'Array',{forEach:function forEach(callbackfn){return $forEach(this,callbackfn,arguments[1]);}});}),(function(module,exports,__webpack_require__){var speciesConstructor=__webpack_require__(530);module.exports=function(original,length){return new(speciesConstructor(original))(length);};}),(function(module,exports,__webpack_require__){var isObject=__webpack_require__(7);var isArray=__webpack_require__(97);var SPECIES=__webpack_require__(12)('species');module.exports=function(original){var C;if(isArray(original)){C=original.constructor;if(typeof C=='function'&&(C===Array||isArray(C.prototype)))C=undefined;if(isObject(C)){C=C[SPECIES];if(C===null)C=undefined;}}return C===undefined?Array:C;};}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $map=__webpack_require__(36)(1);$export($export.P+$export.F*!__webpack_require__(31)([].map,true),'Array',{map:function map(callbackfn){return $map(this,callbackfn,arguments[1]);}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $filter=__webpack_require__(36)(2);$export($export.P+$export.F*!__webpack_require__(31)([].filter,true),'Array',{filter:function filter(callbackfn){return $filter(this,callbackfn,arguments[1]);}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $some=__webpack_require__(36)(3);$export($export.P+$export.F*!__webpack_require__(31)([].some,true),'Array',{some:function some(callbackfn){return $some(this,callbackfn,arguments[1]);}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $every=__webpack_require__(36)(4);$export($export.P+$export.F*!__webpack_require__(31)([].every,true),'Array',{every:function every(callbackfn){return $every(this,callbackfn,arguments[1]);}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $reduce=__webpack_require__(146);$export($export.P+$export.F*!__webpack_require__(31)([].reduce,true),'Array',{reduce:function reduce(callbackfn){return $reduce(this,callbackfn,arguments.length,arguments[1],false);}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $reduce=__webpack_require__(146);$export($export.P+$export.F*!__webpack_require__(31)([].reduceRight,true),'Array',{reduceRight:function reduceRight(callbackfn){return $reduce(this,callbackfn,arguments.length,arguments[1],true);}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $indexOf=__webpack_require__(79)(false);var $native=[].indexOf;var NEGATIVE_ZERO=!!$native&&1/[1].indexOf(1,-0)<0;$export($export.P+$export.F*(NEGATIVE_ZERO||!__webpack_require__(31)($native)),'Array',{indexOf:function indexOf(searchElement){return NEGATIVE_ZERO?$native.apply(this,arguments)||0:$indexOf(this,searchElement,arguments[1]);}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var toIObject=__webpack_require__(29);var toInteger=__webpack_require__(33);var toLength=__webpack_require__(16);var $native=[].lastIndexOf;var NEGATIVE_ZERO=!!$native&&1/[1].lastIndexOf(1,-0)<0;$export($export.P+$export.F*(NEGATIVE_ZERO||!__webpack_require__(31)($native)),'Array',{lastIndexOf:function lastIndexOf(searchElement){if(NEGATIVE_ZERO)return $native.apply(this,arguments)||0;var O=toIObject(this);var length=toLength(O.length);var index=length-1;if(arguments.length>1)index=Math.min(index,toInteger(arguments[1]));if(index<0)index=length+index;for(;index>=0;index--)if(index in O)if(O[index]===searchElement)return index||0;return-1;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.P,'Array',{copyWithin:__webpack_require__(147)});__webpack_require__(62)('copyWithin');}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.P,'Array',{fill:__webpack_require__(113)});__webpack_require__(62)('fill');}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $find=__webpack_require__(36)(5);var KEY='find';var forced=true;if(KEY in[])Array(1)[KEY](function(){forced=false;});$export($export.P+$export.F*forced,'Array',{find:function find(callbackfn){return $find(this,callbackfn,arguments.length>1?arguments[1]:undefined);}});__webpack_require__(62)(KEY);}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $find=__webpack_require__(36)(6);var KEY='findIndex';var forced=true;if(KEY in[])Array(1)[KEY](function(){forced=false;});$export($export.P+$export.F*forced,'Array',{findIndex:function findIndex(callbackfn){return $find(this,callbackfn,arguments.length>1?arguments[1]:undefined);}});__webpack_require__(62)(KEY);}),(function(module,exports,__webpack_require__){__webpack_require__(63)('Array');}),(function(module,exports,__webpack_require__){var global=__webpack_require__(6);var inheritIfRequired=__webpack_require__(101);var dP=__webpack_require__(17).f;var gOPN=__webpack_require__(56).f;var isRegExp=__webpack_require__(108);var $flags=__webpack_require__(83);var $RegExp=global.RegExp;var Base=$RegExp;var proto=$RegExp.prototype;var re1=/a/g;var re2=/a/g;var CORRECT_NEW=new $RegExp(re1)!==re1;if(__webpack_require__(20)&&(!CORRECT_NEW||__webpack_require__(4)(function(){re2[__webpack_require__(12)('match')]=false;return $RegExp(re1)!=re1||$RegExp(re2)==re2||$RegExp(re1,'i')!='/a/i';}))){$RegExp=function RegExp(p,f){var tiRE=this instanceof $RegExp;var piRE=isRegExp(p);var fiU=f===undefined;return!tiRE&&piRE&&p.constructor===$RegExp&&fiU?p:inheritIfRequired(CORRECT_NEW?new Base(piRE&&!fiU?p.source:p,f):Base((piRE=p instanceof $RegExp)?p.source:p,piRE&&fiU?$flags.call(p):f),tiRE?this:proto,$RegExp);};var proxy=function(key){key in $RegExp||dP($RegExp,key,{configurable:true,get:function(){return Base[key];},set:function(it){Base[key]=it;}});};for(var keys=gOPN(Base),i=0;keys.length>i;)proxy(keys[i++]);proto.constructor=$RegExp;$RegExp.prototype=proto;__webpack_require__(23)(global,'RegExp',$RegExp);}
__webpack_require__(63)('RegExp');}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(150);var anObject=__webpack_require__(5);var $flags=__webpack_require__(83);var DESCRIPTORS=__webpack_require__(20);var TO_STRING='toString';var $toString=/./[TO_STRING];var define=function(fn){__webpack_require__(23)(RegExp.prototype,TO_STRING,fn,true);};if(__webpack_require__(4)(function(){return $toString.call({source:'a',flags:'b'})!='/a/b';})){define(function toString(){var R=anObject(this);return'/'.concat(R.source,'/','flags'in R?R.flags:!DESCRIPTORS&&R instanceof RegExp?$flags.call(R):undefined);});}else if($toString.name!=TO_STRING){define(function toString(){return $toString.call(this);});}}),(function(module,exports,__webpack_require__){"use strict";var anObject=__webpack_require__(5);var toLength=__webpack_require__(16);var advanceStringIndex=__webpack_require__(116);var regExpExec=__webpack_require__(84);__webpack_require__(85)('match',1,function(defined,MATCH,$match,maybeCallNative){return[function match(regexp){var O=defined(this);var fn=regexp==undefined?undefined:regexp[MATCH];return fn!==undefined?fn.call(regexp,O):new RegExp(regexp)[MATCH](String(O));},function(regexp){var res=maybeCallNative($match,regexp,this);if(res.done)return res.value;var rx=anObject(regexp);var S=String(this);if(!rx.global)return regExpExec(rx,S);var fullUnicode=rx.unicode;rx.lastIndex=0;var A=[];var n=0;var result;while((result=regExpExec(rx,S))!==null){var matchStr=String(result[0]);A[n]=matchStr;if(matchStr==='')rx.lastIndex=advanceStringIndex(S,toLength(rx.lastIndex),fullUnicode);n++;}
return n===0?null:A;}];});}),(function(module,exports,__webpack_require__){"use strict";var anObject=__webpack_require__(5);var toObject=__webpack_require__(24);var toLength=__webpack_require__(16);var toInteger=__webpack_require__(33);var advanceStringIndex=__webpack_require__(116);var regExpExec=__webpack_require__(84);var max=Math.max;var min=Math.min;var floor=Math.floor;var SUBSTITUTION_SYMBOLS=/\$([$&`']|\d\d?|<[^>]*>)/g;var SUBSTITUTION_SYMBOLS_NO_NAMED=/\$([$&`']|\d\d?)/g;var maybeToString=function(it){return it===undefined?it:String(it);};__webpack_require__(85)('replace',2,function(defined,REPLACE,$replace,maybeCallNative){return[function replace(searchValue,replaceValue){var O=defined(this);var fn=searchValue==undefined?undefined:searchValue[REPLACE];return fn!==undefined?fn.call(searchValue,O,replaceValue):$replace.call(String(O),searchValue,replaceValue);},function(regexp,replaceValue){var res=maybeCallNative($replace,regexp,this,replaceValue);if(res.done)return res.value;var rx=anObject(regexp);var S=String(this);var functionalReplace=typeof replaceValue==='function';if(!functionalReplace)replaceValue=String(replaceValue);var global=rx.global;if(global){var fullUnicode=rx.unicode;rx.lastIndex=0;}
var results=[];while(true){var result=regExpExec(rx,S);if(result===null)break;results.push(result);if(!global)break;var matchStr=String(result[0]);if(matchStr==='')rx.lastIndex=advanceStringIndex(S,toLength(rx.lastIndex),fullUnicode);}
var accumulatedResult='';var nextSourcePosition=0;for(var i=0;i<results.length;i++){result=results[i];var matched=String(result[0]);var position=max(min(toInteger(result.index),S.length),0);var captures=[];for(var j=1;j<result.length;j++)captures.push(maybeToString(result[j]));var namedCaptures=result.groups;if(functionalReplace){var replacerArgs=[matched].concat(captures,position,S);if(namedCaptures!==undefined)replacerArgs.push(namedCaptures);var replacement=String(replaceValue.apply(undefined,replacerArgs));}else{replacement=getSubstitution(matched,S,position,captures,namedCaptures,replaceValue);}
if(position>=nextSourcePosition){accumulatedResult+=S.slice(nextSourcePosition,position)+replacement;nextSourcePosition=position+matched.length;}}
return accumulatedResult+S.slice(nextSourcePosition);}];function getSubstitution(matched,str,position,captures,namedCaptures,replacement){var tailPos=position+matched.length;var m=captures.length;var symbols=SUBSTITUTION_SYMBOLS_NO_NAMED;if(namedCaptures!==undefined){namedCaptures=toObject(namedCaptures);symbols=SUBSTITUTION_SYMBOLS;}
return $replace.call(replacement,symbols,function(match,ch){var capture;switch(ch.charAt(0)){case'$':return'$';case'&':return matched;case'`':return str.slice(0,position);case"'":return str.slice(tailPos);case'<':capture=namedCaptures[ch.slice(1,-1)];break;default:var n=+ch;if(n===0)return ch;if(n>m){var f=floor(n/10);if(f===0)return ch;if(f<=m)return captures[f-1]===undefined?ch.charAt(1):captures[f-1]+ch.charAt(1);return ch;}
capture=captures[n-1];}
return capture===undefined?'':capture;});}});}),(function(module,exports,__webpack_require__){"use strict";var anObject=__webpack_require__(5);var sameValue=__webpack_require__(136);var regExpExec=__webpack_require__(84);__webpack_require__(85)('search',1,function(defined,SEARCH,$search,maybeCallNative){return[function search(regexp){var O=defined(this);var fn=regexp==undefined?undefined:regexp[SEARCH];return fn!==undefined?fn.call(regexp,O):new RegExp(regexp)[SEARCH](String(O));},function(regexp){var res=maybeCallNative($search,regexp,this);if(res.done)return res.value;var rx=anObject(regexp);var S=String(this);var previousLastIndex=rx.lastIndex;if(!sameValue(previousLastIndex,0))rx.lastIndex=0;var result=regExpExec(rx,S);if(!sameValue(rx.lastIndex,previousLastIndex))rx.lastIndex=previousLastIndex;return result===null?-1:result.index;}];});}),(function(module,exports,__webpack_require__){"use strict";var isRegExp=__webpack_require__(108);var anObject=__webpack_require__(5);var speciesConstructor=__webpack_require__(73);var advanceStringIndex=__webpack_require__(116);var toLength=__webpack_require__(16);var callRegExpExec=__webpack_require__(84);var regexpExec=__webpack_require__(115);var $min=Math.min;var $push=[].push;var $SPLIT='split';var LENGTH='length';var LAST_INDEX='lastIndex';var SUPPORTS_Y=!!(function(){try{return new RegExp('x','y');}catch(e){}})();__webpack_require__(85)('split',2,function(defined,SPLIT,$split,maybeCallNative){var internalSplit;if('abbc'[$SPLIT](/(b)*/)[1]=='c'||'test'[$SPLIT](/(?:)/,-1)[LENGTH]!=4||'ab'[$SPLIT](/(?:ab)*/)[LENGTH]!=2||'.'[$SPLIT](/(.?)(.?)/)[LENGTH]!=4||'.'[$SPLIT](/()()/)[LENGTH]>1||''[$SPLIT](/.?/)[LENGTH]){internalSplit=function(separator,limit){var string=String(this);if(separator===undefined&&limit===0)return[];if(!isRegExp(separator))return $split.call(string,separator,limit);var output=[];var flags=(separator.ignoreCase?'i':'')+
(separator.multiline?'m':'')+
(separator.unicode?'u':'')+
(separator.sticky?'y':'');var lastLastIndex=0;var splitLimit=limit===undefined?4294967295:limit>>>0;var separatorCopy=new RegExp(separator.source,flags+'g');var match,lastIndex,lastLength;while(match=regexpExec.call(separatorCopy,string)){lastIndex=separatorCopy[LAST_INDEX];if(lastIndex>lastLastIndex){output.push(string.slice(lastLastIndex,match.index));if(match[LENGTH]>1&&match.index<string[LENGTH])$push.apply(output,match.slice(1));lastLength=match[0][LENGTH];lastLastIndex=lastIndex;if(output[LENGTH]>=splitLimit)break;}
if(separatorCopy[LAST_INDEX]===match.index)separatorCopy[LAST_INDEX]++;}
if(lastLastIndex===string[LENGTH]){if(lastLength||!separatorCopy.test(''))output.push('');}else output.push(string.slice(lastLastIndex));return output[LENGTH]>splitLimit?output.slice(0,splitLimit):output;};}else if('0'[$SPLIT](undefined,0)[LENGTH]){internalSplit=function(separator,limit){return separator===undefined&&limit===0?[]:$split.call(this,separator,limit);};}else{internalSplit=$split;}
return[function split(separator,limit){var O=defined(this);var splitter=separator==undefined?undefined:separator[SPLIT];return splitter!==undefined?splitter.call(separator,O,limit):internalSplit.call(String(O),separator,limit);},function(regexp,limit){var res=maybeCallNative(internalSplit,regexp,this,limit,internalSplit!==$split);if(res.done)return res.value;var rx=anObject(regexp);var S=String(this);var C=speciesConstructor(rx,RegExp);var unicodeMatching=rx.unicode;var flags=(rx.ignoreCase?'i':'')+
(rx.multiline?'m':'')+
(rx.unicode?'u':'')+
(SUPPORTS_Y?'y':'g');var splitter=new C(SUPPORTS_Y?rx:'^(?:'+rx.source+')',flags);var lim=limit===undefined?0xffffffff:limit>>>0;if(lim===0)return[];if(S.length===0)return callRegExpExec(splitter,S)===null?[S]:[];var p=0;var q=0;var A=[];while(q<S.length){splitter.lastIndex=SUPPORTS_Y?q:0;var z=callRegExpExec(splitter,SUPPORTS_Y?S:S.slice(q));var e;if(z===null||(e=$min(toLength(splitter.lastIndex+(SUPPORTS_Y?0:q)),S.length))===p){q=advanceStringIndex(S,q,unicodeMatching);}else{A.push(S.slice(p,q));if(A.length===lim)return A;for(var i=1;i<=z.length-1;i++){A.push(z[i]);if(A.length===lim)return A;}
q=p=e;}}
A.push(S.slice(p));return A;}];});}),(function(module,exports,__webpack_require__){var global=__webpack_require__(6);var macrotask=__webpack_require__(117).set;var Observer=global.MutationObserver||global.WebKitMutationObserver;var process=global.process;var Promise=global.Promise;var isNode=__webpack_require__(39)(process)=='process';module.exports=function(){var head,last,notify;var flush=function(){var parent,fn;if(isNode&&(parent=process.domain))parent.exit();while(head){fn=head.fn;head=head.next;try{fn();}catch(e){if(head)notify();else last=undefined;throw e;}}last=undefined;if(parent)parent.enter();};if(isNode){notify=function(){process.nextTick(flush);};}else if(Observer&&!(global.navigator&&global.navigator.standalone)){var toggle=true;var node=document.createTextNode('');new Observer(flush).observe(node,{characterData:true});notify=function(){node.data=toggle=!toggle;};}else if(Promise&&Promise.resolve){var promise=Promise.resolve(undefined);notify=function(){promise.then(flush);};}else{notify=function(){macrotask.call(global,flush);};}
return function(fn){var task={fn:fn,next:undefined};if(last)last.next=task;if(!head){head=task;notify();}last=task;};};}),(function(module,exports){module.exports=function(exec){try{return{e:false,v:exec()};}catch(e){return{e:true,v:e};}};}),(function(module,exports,__webpack_require__){"use strict";var strong=__webpack_require__(154);var validate=__webpack_require__(66);var MAP='Map';module.exports=__webpack_require__(88)(MAP,function(get){return function Map(){return get(this,arguments.length>0?arguments[0]:undefined);};},{get:function get(key){var entry=strong.getEntry(validate(this,MAP),key);return entry&&entry.v;},set:function set(key,value){return strong.def(validate(this,MAP),key===0?0:key,value);}},strong,true);}),(function(module,exports,__webpack_require__){"use strict";var strong=__webpack_require__(154);var validate=__webpack_require__(66);var SET='Set';module.exports=__webpack_require__(88)(SET,function(get){return function Set(){return get(this,arguments.length>0?arguments[0]:undefined);};},{add:function add(value){return strong.def(validate(this,SET),value=value===0?0:value,value);}},strong);}),(function(module,exports,__webpack_require__){"use strict";var each=__webpack_require__(36)(0);var redefine=__webpack_require__(23);var meta=__webpack_require__(45);var assign=__webpack_require__(135);var weak=__webpack_require__(155);var isObject=__webpack_require__(7);var fails=__webpack_require__(4);var validate=__webpack_require__(66);var WEAK_MAP='WeakMap';var getWeak=meta.getWeak;var isExtensible=Object.isExtensible;var uncaughtFrozenStore=weak.ufstore;var tmp={};var InternalMap;var wrapper=function(get){return function WeakMap(){return get(this,arguments.length>0?arguments[0]:undefined);};};var methods={get:function get(key){if(isObject(key)){var data=getWeak(key);if(data===true)return uncaughtFrozenStore(validate(this,WEAK_MAP)).get(key);return data?data[this._i]:undefined;}},set:function set(key,value){return weak.def(validate(this,WEAK_MAP),key,value);}};var $WeakMap=module.exports=__webpack_require__(88)(WEAK_MAP,wrapper,methods,weak,true,true);if(fails(function(){return new $WeakMap().set((Object.freeze||Object)(tmp),7).get(tmp)!=7;})){InternalMap=weak.getConstructor(wrapper,WEAK_MAP);assign(InternalMap.prototype,methods);meta.NEED=true;each(['delete','has','get','set'],function(key){var proto=$WeakMap.prototype;var method=proto[key];redefine(proto,key,function(a,b){if(isObject(a)&&!isExtensible(a)){if(!this._f)this._f=new InternalMap();var result=this._f[key](a,b);return key=='set'?this:result;}return method.call(this,a,b);});});}}),(function(module,exports,__webpack_require__){"use strict";var weak=__webpack_require__(155);var validate=__webpack_require__(66);var WEAK_SET='WeakSet';__webpack_require__(88)(WEAK_SET,function(get){return function WeakSet(){return get(this,arguments.length>0?arguments[0]:undefined);};},{add:function add(value){return weak.def(validate(this,WEAK_SET),value,true);}},weak,false,true);}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $typed=__webpack_require__(89);var buffer=__webpack_require__(118);var anObject=__webpack_require__(5);var toAbsoluteIndex=__webpack_require__(54);var toLength=__webpack_require__(16);var isObject=__webpack_require__(7);var ArrayBuffer=__webpack_require__(6).ArrayBuffer;var speciesConstructor=__webpack_require__(73);var $ArrayBuffer=buffer.ArrayBuffer;var $DataView=buffer.DataView;var $isView=$typed.ABV&&ArrayBuffer.isView;var $slice=$ArrayBuffer.prototype.slice;var VIEW=$typed.VIEW;var ARRAY_BUFFER='ArrayBuffer';$export($export.G+$export.W+$export.F*(ArrayBuffer!==$ArrayBuffer),{ArrayBuffer:$ArrayBuffer});$export($export.S+$export.F*!$typed.CONSTR,ARRAY_BUFFER,{isView:function isView(it){return $isView&&$isView(it)||isObject(it)&&VIEW in it;}});$export($export.P+$export.U+$export.F*__webpack_require__(4)(function(){return!new $ArrayBuffer(2).slice(1,undefined).byteLength;}),ARRAY_BUFFER,{slice:function slice(start,end){if($slice!==undefined&&end===undefined)return $slice.call(anObject(this),start);var len=anObject(this).byteLength;var first=toAbsoluteIndex(start,len);var fin=toAbsoluteIndex(end===undefined?len:end,len);var result=new(speciesConstructor(this,$ArrayBuffer))(toLength(fin-first));var viewS=new $DataView(this);var viewT=new $DataView(result);var index=0;while(first<fin){viewT.setUint8(index++,viewS.getUint8(first++));}return result;}});__webpack_require__(63)(ARRAY_BUFFER);}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.G+$export.W+$export.F*!__webpack_require__(89).ABV,{DataView:__webpack_require__(118).DataView});}),(function(module,exports,__webpack_require__){__webpack_require__(41)('Int8',1,function(init){return function Int8Array(data,byteOffset,length){return init(this,data,byteOffset,length);};});}),(function(module,exports,__webpack_require__){__webpack_require__(41)('Uint8',1,function(init){return function Uint8Array(data,byteOffset,length){return init(this,data,byteOffset,length);};});}),(function(module,exports,__webpack_require__){__webpack_require__(41)('Uint8',1,function(init){return function Uint8ClampedArray(data,byteOffset,length){return init(this,data,byteOffset,length);};},true);}),(function(module,exports,__webpack_require__){__webpack_require__(41)('Int16',2,function(init){return function Int16Array(data,byteOffset,length){return init(this,data,byteOffset,length);};});}),(function(module,exports,__webpack_require__){__webpack_require__(41)('Uint16',2,function(init){return function Uint16Array(data,byteOffset,length){return init(this,data,byteOffset,length);};});}),(function(module,exports,__webpack_require__){__webpack_require__(41)('Int32',4,function(init){return function Int32Array(data,byteOffset,length){return init(this,data,byteOffset,length);};});}),(function(module,exports,__webpack_require__){__webpack_require__(41)('Uint32',4,function(init){return function Uint32Array(data,byteOffset,length){return init(this,data,byteOffset,length);};});}),(function(module,exports,__webpack_require__){__webpack_require__(41)('Float32',4,function(init){return function Float32Array(data,byteOffset,length){return init(this,data,byteOffset,length);};});}),(function(module,exports,__webpack_require__){__webpack_require__(41)('Float64',8,function(init){return function Float64Array(data,byteOffset,length){return init(this,data,byteOffset,length);};});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var aFunction=__webpack_require__(38);var anObject=__webpack_require__(5);var rApply=(__webpack_require__(6).Reflect||{}).apply;var fApply=Function.apply;$export($export.S+$export.F*!__webpack_require__(4)(function(){rApply(function(){});}),'Reflect',{apply:function apply(target,thisArgument,argumentsList){var T=aFunction(target);var L=anObject(argumentsList);return rApply?rApply(T,thisArgument,L):fApply.call(T,thisArgument,L);}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var create=__webpack_require__(55);var aFunction=__webpack_require__(38);var anObject=__webpack_require__(5);var isObject=__webpack_require__(7);var fails=__webpack_require__(4);var bind=__webpack_require__(137);var rConstruct=(__webpack_require__(6).Reflect||{}).construct;var NEW_TARGET_BUG=fails(function(){function F(){}
return!(rConstruct(function(){},[],F)instanceof F);});var ARGS_BUG=!fails(function(){rConstruct(function(){});});$export($export.S+$export.F*(NEW_TARGET_BUG||ARGS_BUG),'Reflect',{construct:function construct(Target,args){aFunction(Target);anObject(args);var newTarget=arguments.length<3?Target:aFunction(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return rConstruct(Target,args,newTarget);if(Target==newTarget){switch(args.length){case 0:return new Target();case 1:return new Target(args[0]);case 2:return new Target(args[0],args[1]);case 3:return new Target(args[0],args[1],args[2]);case 4:return new Target(args[0],args[1],args[2],args[3]);}
var $args=[null];$args.push.apply($args,args);return new(bind.apply(Target,$args))();}
var proto=newTarget.prototype;var instance=create(isObject(proto)?proto:Object.prototype);var result=Function.apply.call(Target,instance,args);return isObject(result)?result:instance;}});}),(function(module,exports,__webpack_require__){var dP=__webpack_require__(17);var $export=__webpack_require__(0);var anObject=__webpack_require__(5);var toPrimitive=__webpack_require__(44);$export($export.S+$export.F*__webpack_require__(4)(function(){Reflect.defineProperty(dP.f({},1,{value:1}),1,{value:2});}),'Reflect',{defineProperty:function defineProperty(target,propertyKey,attributes){anObject(target);propertyKey=toPrimitive(propertyKey,true);anObject(attributes);try{dP.f(target,propertyKey,attributes);return true;}catch(e){return false;}}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var gOPD=__webpack_require__(34).f;var anObject=__webpack_require__(5);$export($export.S,'Reflect',{deleteProperty:function deleteProperty(target,propertyKey){var desc=gOPD(anObject(target),propertyKey);return desc&&!desc.configurable?false:delete target[propertyKey];}});}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var anObject=__webpack_require__(5);var Enumerate=function(iterated){this._t=anObject(iterated);this._i=0;var keys=this._k=[];var key;for(key in iterated)keys.push(key);};__webpack_require__(144)(Enumerate,'Object',function(){var that=this;var keys=that._k;var key;do{if(that._i>=keys.length)return{value:undefined,done:true};}while(!((key=keys[that._i++])in that._t));return{value:key,done:false};});$export($export.S,'Reflect',{enumerate:function enumerate(target){return new Enumerate(target);}});}),(function(module,exports,__webpack_require__){var gOPD=__webpack_require__(34);var getPrototypeOf=__webpack_require__(57);var has=__webpack_require__(27);var $export=__webpack_require__(0);var isObject=__webpack_require__(7);var anObject=__webpack_require__(5);function get(target,propertyKey){var receiver=arguments.length<3?target:arguments[2];var desc,proto;if(anObject(target)===receiver)return target[propertyKey];if(desc=gOPD.f(target,propertyKey))return has(desc,'value')?desc.value:desc.get!==undefined?desc.get.call(receiver):undefined;if(isObject(proto=getPrototypeOf(target)))return get(proto,propertyKey,receiver);}
$export($export.S,'Reflect',{get:get});}),(function(module,exports,__webpack_require__){var gOPD=__webpack_require__(34);var $export=__webpack_require__(0);var anObject=__webpack_require__(5);$export($export.S,'Reflect',{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(target,propertyKey){return gOPD.f(anObject(target),propertyKey);}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var getProto=__webpack_require__(57);var anObject=__webpack_require__(5);$export($export.S,'Reflect',{getPrototypeOf:function getPrototypeOf(target){return getProto(anObject(target));}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Reflect',{has:function has(target,propertyKey){return propertyKey in target;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var anObject=__webpack_require__(5);var $isExtensible=Object.isExtensible;$export($export.S,'Reflect',{isExtensible:function isExtensible(target){anObject(target);return $isExtensible?$isExtensible(target):true;}});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);$export($export.S,'Reflect',{ownKeys:__webpack_require__(157)});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var anObject=__webpack_require__(5);var $preventExtensions=Object.preventExtensions;$export($export.S,'Reflect',{preventExtensions:function preventExtensions(target){anObject(target);try{if($preventExtensions)$preventExtensions(target);return true;}catch(e){return false;}}});}),(function(module,exports,__webpack_require__){var dP=__webpack_require__(17);var gOPD=__webpack_require__(34);var getPrototypeOf=__webpack_require__(57);var has=__webpack_require__(27);var $export=__webpack_require__(0);var createDesc=__webpack_require__(50);var anObject=__webpack_require__(5);var isObject=__webpack_require__(7);function set(target,propertyKey,V){var receiver=arguments.length<4?target:arguments[3];var ownDesc=gOPD.f(anObject(target),propertyKey);var existingDescriptor,proto;if(!ownDesc){if(isObject(proto=getPrototypeOf(target))){return set(proto,propertyKey,V,receiver);}
ownDesc=createDesc(0);}
if(has(ownDesc,'value')){if(ownDesc.writable===false||!isObject(receiver))return false;if(existingDescriptor=gOPD.f(receiver,propertyKey)){if(existingDescriptor.get||existingDescriptor.set||existingDescriptor.writable===false)return false;existingDescriptor.value=V;dP.f(receiver,propertyKey,existingDescriptor);}else dP.f(receiver,propertyKey,createDesc(0,V));return true;}
return ownDesc.set===undefined?false:(ownDesc.set.call(receiver,V),true);}
$export($export.S,'Reflect',{set:set});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var setProto=__webpack_require__(99);if(setProto)$export($export.S,'Reflect',{setPrototypeOf:function setPrototypeOf(target,proto){setProto.check(target,proto);try{setProto.set(target,proto);return true;}catch(e){return false;}}});}),(function(module,exports,__webpack_require__){__webpack_require__(582);module.exports=__webpack_require__(21).Array.includes;}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $includes=__webpack_require__(79)(true);$export($export.P,'Array',{includes:function includes(el){return $includes(this,el,arguments.length>1?arguments[1]:undefined);}});__webpack_require__(62)('includes');}),(function(module,exports,__webpack_require__){__webpack_require__(584);module.exports=__webpack_require__(21).String.padStart;}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $pad=__webpack_require__(158);var userAgent=__webpack_require__(87);$export($export.P+$export.F* /Version\/10\.\d+(\.\d+)? Safari\//.test(userAgent),'String',{padStart:function padStart(maxLength){return $pad(this,maxLength,arguments.length>1?arguments[1]:undefined,true);}});}),(function(module,exports,__webpack_require__){__webpack_require__(586);module.exports=__webpack_require__(21).String.padEnd;}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var $pad=__webpack_require__(158);var userAgent=__webpack_require__(87);$export($export.P+$export.F* /Version\/10\.\d+(\.\d+)? Safari\//.test(userAgent),'String',{padEnd:function padEnd(maxLength){return $pad(this,maxLength,arguments.length>1?arguments[1]:undefined,false);}});}),(function(module,exports,__webpack_require__){__webpack_require__(588);module.exports=__webpack_require__(94).f('asyncIterator');}),(function(module,exports,__webpack_require__){__webpack_require__(131)('asyncIterator');}),(function(module,exports,__webpack_require__){__webpack_require__(590);module.exports=__webpack_require__(21).Object.getOwnPropertyDescriptors;}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var ownKeys=__webpack_require__(157);var toIObject=__webpack_require__(29);var gOPD=__webpack_require__(34);var createProperty=__webpack_require__(111);$export($export.S,'Object',{getOwnPropertyDescriptors:function getOwnPropertyDescriptors(object){var O=toIObject(object);var getDesc=gOPD.f;var keys=ownKeys(O);var result={};var i=0;var key,desc;while(keys.length>i){desc=getDesc(O,key=keys[i++]);if(desc!==undefined)createProperty(result,key,desc);}
return result;}});}),(function(module,exports,__webpack_require__){__webpack_require__(592);module.exports=__webpack_require__(21).Object.values;}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $values=__webpack_require__(159)(false);$export($export.S,'Object',{values:function values(it){return $values(it);}});}),(function(module,exports,__webpack_require__){__webpack_require__(594);module.exports=__webpack_require__(21).Object.entries;}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $entries=__webpack_require__(159)(true);$export($export.S,'Object',{entries:function entries(it){return $entries(it);}});}),(function(module,exports,__webpack_require__){"use strict";__webpack_require__(151);__webpack_require__(596);module.exports=__webpack_require__(21).Promise['finally'];}),(function(module,exports,__webpack_require__){"use strict";var $export=__webpack_require__(0);var core=__webpack_require__(21);var global=__webpack_require__(6);var speciesConstructor=__webpack_require__(73);var promiseResolve=__webpack_require__(153);$export($export.P+$export.R,'Promise',{'finally':function(onFinally){var C=speciesConstructor(this,core.Promise||global.Promise);var isFunction=typeof onFinally=='function';return this.then(isFunction?function(x){return promiseResolve(C,onFinally()).then(function(){return x;});}:onFinally,isFunction?function(e){return promiseResolve(C,onFinally()).then(function(){throw e;});}:onFinally);}});}),(function(module,exports,__webpack_require__){__webpack_require__(598);__webpack_require__(599);__webpack_require__(600);module.exports=__webpack_require__(21);}),(function(module,exports,__webpack_require__){var global=__webpack_require__(6);var $export=__webpack_require__(0);var userAgent=__webpack_require__(87);var slice=[].slice;var MSIE=/MSIE .\./.test(userAgent);var wrap=function(set){return function(fn,time){var boundArgs=arguments.length>2;var args=boundArgs?slice.call(arguments,2):false;return set(boundArgs?function(){(typeof fn=='function'?fn:Function(fn)).apply(this,args);}:fn,time);};};$export($export.G+$export.B+$export.F*MSIE,{setTimeout:wrap(global.setTimeout),setInterval:wrap(global.setInterval)});}),(function(module,exports,__webpack_require__){var $export=__webpack_require__(0);var $task=__webpack_require__(117);$export($export.G+$export.B,{setImmediate:$task.set,clearImmediate:$task.clear});}),(function(module,exports,__webpack_require__){var $iterators=__webpack_require__(114);var getKeys=__webpack_require__(53);var redefine=__webpack_require__(23);var global=__webpack_require__(6);var hide=__webpack_require__(28);var Iterators=__webpack_require__(61);var wks=__webpack_require__(12);var ITERATOR=wks('iterator');var TO_STRING_TAG=wks('toStringTag');var ArrayValues=Iterators.Array;var DOMIterables={CSSRuleList:true,CSSStyleDeclaration:false,CSSValueList:false,ClientRectList:false,DOMRectList:false,DOMStringList:false,DOMTokenList:true,DataTransferItemList:false,FileList:false,HTMLAllCollection:false,HTMLCollection:false,HTMLFormElement:false,HTMLSelectElement:false,MediaList:true,MimeTypeArray:false,NamedNodeMap:false,NodeList:true,PaintRequestList:false,Plugin:false,PluginArray:false,SVGLengthList:false,SVGNumberList:false,SVGPathSegList:false,SVGPointList:false,SVGStringList:false,SVGTransformList:false,SourceBufferList:false,StyleSheetList:true,TextTrackCueList:false,TextTrackList:false,TouchList:false};for(var collections=getKeys(DOMIterables),i=0;i<collections.length;i++){var NAME=collections[i];var explicit=DOMIterables[NAME];var Collection=global[NAME];var proto=Collection&&Collection.prototype;var key;if(proto){if(!proto[ITERATOR])hide(proto,ITERATOR,ArrayValues);if(!proto[TO_STRING_TAG])hide(proto,TO_STRING_TAG,NAME);Iterators[NAME]=ArrayValues;if(explicit)for(key in $iterators)if(!proto[key])redefine(proto,key,$iterators[key],true);}}}),(function(module,exports){!(function(global){"use strict";var Op=Object.prototype;var hasOwn=Op.hasOwnProperty;var undefined;var $Symbol=typeof Symbol==="function"?Symbol:{};var iteratorSymbol=$Symbol.iterator||"@@iterator";var asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator";var toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";var inModule=typeof module==="object";var runtime=global.regeneratorRuntime;if(runtime){if(inModule){module.exports=runtime;}
return;}
runtime=global.regeneratorRuntime=inModule?module.exports:{};function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator;var generator=Object.create(protoGenerator.prototype);var context=new Context(tryLocsList||[]);generator._invoke=makeInvokeMethod(innerFn,self,context);return generator;}
runtime.wrap=wrap;function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)};}catch(err){return{type:"throw",arg:err};}}
var GenStateSuspendedStart="suspendedStart";var GenStateSuspendedYield="suspendedYield";var GenStateExecuting="executing";var GenStateCompleted="completed";var ContinueSentinel={};function Generator(){}
function GeneratorFunction(){}
function GeneratorFunctionPrototype(){}
var IteratorPrototype={};IteratorPrototype[iteratorSymbol]=function(){return this;};var getProto=Object.getPrototypeOf;var NativeIteratorPrototype=getProto&&getProto(getProto(values([])));if(NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)){IteratorPrototype=NativeIteratorPrototype;}
var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype;GeneratorFunctionPrototype.constructor=GeneratorFunction;GeneratorFunctionPrototype[toStringTagSymbol]=GeneratorFunction.displayName="GeneratorFunction";function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){prototype[method]=function(arg){return this._invoke(method,arg);};});}
runtime.isGeneratorFunction=function(genFun){var ctor=typeof genFun==="function"&&genFun.constructor;return ctor?ctor===GeneratorFunction||(ctor.displayName||ctor.name)==="GeneratorFunction":false;};runtime.mark=function(genFun){if(Object.setPrototypeOf){Object.setPrototypeOf(genFun,GeneratorFunctionPrototype);}else{genFun.__proto__=GeneratorFunctionPrototype;if(!(toStringTagSymbol in genFun)){genFun[toStringTagSymbol]="GeneratorFunction";}}
genFun.prototype=Object.create(Gp);return genFun;};runtime.awrap=function(arg){return{__await:arg};};function AsyncIterator(generator){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(record.type==="throw"){reject(record.arg);}else{var result=record.arg;var value=result.value;if(value&&typeof value==="object"&&hasOwn.call(value,"__await")){return Promise.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject);},function(err){invoke("throw",err,resolve,reject);});}
return Promise.resolve(value).then(function(unwrapped){result.value=unwrapped;resolve(result);},reject);}}
var previousPromise;function enqueue(method,arg){function callInvokeWithMethodAndArg(){return new Promise(function(resolve,reject){invoke(method,arg,resolve,reject);});}
return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();}
this._invoke=enqueue;}
defineIteratorMethods(AsyncIterator.prototype);AsyncIterator.prototype[asyncIteratorSymbol]=function(){return this;};runtime.AsyncIterator=AsyncIterator;runtime.async=function(innerFn,outerFn,self,tryLocsList){var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList));return runtime.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next();});};function makeInvokeMethod(innerFn,self,context){var state=GenStateSuspendedStart;return function invoke(method,arg){if(state===GenStateExecuting){throw new Error("Generator is already running");}
if(state===GenStateCompleted){if(method==="throw"){throw arg;}
return doneResult();}
context.method=method;context.arg=arg;while(true){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult;}}
if(context.method==="next"){context.sent=context._sent=context.arg;}else if(context.method==="throw"){if(state===GenStateSuspendedStart){state=GenStateCompleted;throw context.arg;}
context.dispatchException(context.arg);}else if(context.method==="return"){context.abrupt("return",context.arg);}
state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if(record.type==="normal"){state=context.done?GenStateCompleted:GenStateSuspendedYield;if(record.arg===ContinueSentinel){continue;}
return{value:record.arg,done:context.done};}else if(record.type==="throw"){state=GenStateCompleted;context.method="throw";context.arg=record.arg;}}};}
function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(method===undefined){context.delegate=null;if(context.method==="throw"){if(delegate.iterator.return){context.method="return";context.arg=undefined;maybeInvokeDelegate(delegate,context);if(context.method==="throw"){return ContinueSentinel;}}
context.method="throw";context.arg=new TypeError("The iterator does not provide a 'throw' method");}
return ContinueSentinel;}
var record=tryCatch(method,delegate.iterator,context.arg);if(record.type==="throw"){context.method="throw";context.arg=record.arg;context.delegate=null;return ContinueSentinel;}
var info=record.arg;if(!info){context.method="throw";context.arg=new TypeError("iterator result is not an object");context.delegate=null;return ContinueSentinel;}
if(info.done){context[delegate.resultName]=info.value;context.next=delegate.nextLoc;if(context.method!=="return"){context.method="next";context.arg=undefined;}}else{return info;}
context.delegate=null;return ContinueSentinel;}
defineIteratorMethods(Gp);Gp[toStringTagSymbol]="Generator";Gp[iteratorSymbol]=function(){return this;};Gp.toString=function(){return"[object Generator]";};function pushTryEntry(locs){var entry={tryLoc:locs[0]};if(1 in locs){entry.catchLoc=locs[1];}
if(2 in locs){entry.finallyLoc=locs[2];entry.afterLoc=locs[3];}
this.tryEntries.push(entry);}
function resetTryEntry(entry){var record=entry.completion||{};record.type="normal";delete record.arg;entry.completion=record;}
function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}];tryLocsList.forEach(pushTryEntry,this);this.reset(true);}
runtime.keys=function(object){var keys=[];for(var key in object){keys.push(key);}
keys.reverse();return function next(){while(keys.length){var key=keys.pop();if(key in object){next.value=key;next.done=false;return next;}}
next.done=true;return next;};};function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod){return iteratorMethod.call(iterable);}
if(typeof iterable.next==="function"){return iterable;}
if(!isNaN(iterable.length)){var i=-1,next=function next(){while(++i<iterable.length){if(hasOwn.call(iterable,i)){next.value=iterable[i];next.done=false;return next;}}
next.value=undefined;next.done=true;return next;};return next.next=next;}}
return{next:doneResult};}
runtime.values=values;function doneResult(){return{value:undefined,done:true};}
Context.prototype={constructor:Context,reset:function(skipTempReset){this.prev=0;this.next=0;this.sent=this._sent=undefined;this.done=false;this.delegate=null;this.method="next";this.arg=undefined;this.tryEntries.forEach(resetTryEntry);if(!skipTempReset){for(var name in this){if(name.charAt(0)==="t"&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))){this[name]=undefined;}}}},stop:function(){this.done=true;var rootEntry=this.tryEntries[0];var rootRecord=rootEntry.completion;if(rootRecord.type==="throw"){throw rootRecord.arg;}
return this.rval;},dispatchException:function(exception){if(this.done){throw exception;}
var context=this;function handle(loc,caught){record.type="throw";record.arg=exception;context.next=loc;if(caught){context.method="next";context.arg=undefined;}
return!!caught;}
for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];var record=entry.completion;if(entry.tryLoc==="root"){return handle("end");}
if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc");var hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true);}else if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc);}}else if(hasCatch){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true);}}else if(hasFinally){if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc);}}else{throw new Error("try statement without catch or finally");}}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break;}}
if(finallyEntry&&(type==="break"||type==="continue")&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc){finallyEntry=null;}
var record=finallyEntry?finallyEntry.completion:{};record.type=type;record.arg=arg;if(finallyEntry){this.method="next";this.next=finallyEntry.finallyLoc;return ContinueSentinel;}
return this.complete(record);},complete:function(record,afterLoc){if(record.type==="throw"){throw record.arg;}
if(record.type==="break"||record.type==="continue"){this.next=record.arg;}else if(record.type==="return"){this.rval=this.arg=record.arg;this.method="return";this.next="end";}else if(record.type==="normal"&&afterLoc){this.next=afterLoc;}
return ContinueSentinel;},finish:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc){this.complete(entry.completion,entry.afterLoc);resetTryEntry(entry);return ContinueSentinel;}}},"catch":function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(record.type==="throw"){var thrown=record.arg;resetTryEntry(entry);}
return thrown;}}
throw new Error("illegal catch attempt");},delegateYield:function(iterable,resultName,nextLoc){this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc};if(this.method==="next"){this.arg=undefined;}
return ContinueSentinel;}};})((function(){return this})()||Function("return this")());}),(function(module,exports){}),(function(module,exports){}),(function(module,exports){}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _base=_interopRequireDefault(__webpack_require__(43));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var DebugOverlay=function(_Overlay){_inherits(DebugOverlay,_Overlay);function DebugOverlay(wotInstance){var _this;_classCallCheck(this,DebugOverlay);_this=_possibleConstructorReturn(this,_getPrototypeOf(DebugOverlay).call(this,wotInstance));_this.clone=_this.makeClone(_base.default.CLONE_DEBUG);_this.clone.wtTable.holder.style.opacity=0.4;_this.clone.wtTable.holder.style.textShadow='0 0 2px #ff0000';(0,_element.addClass)(_this.clone.wtTable.holder.parentNode,'wtDebugVisible');return _this;}
return DebugOverlay;}(_base.default);_base.default.registerOverlay(_base.default.CLONE_DEBUG,DebugOverlay);var _default=DebugOverlay;exports.default=_default;}),(function(module,exports,__webpack_require__){var map={"./af":167,"./af.js":167,"./ar":168,"./ar-dz":169,"./ar-dz.js":169,"./ar-kw":170,"./ar-kw.js":170,"./ar-ly":171,"./ar-ly.js":171,"./ar-ma":172,"./ar-ma.js":172,"./ar-sa":173,"./ar-sa.js":173,"./ar-tn":174,"./ar-tn.js":174,"./ar.js":168,"./az":175,"./az.js":175,"./be":176,"./be.js":176,"./bg":177,"./bg.js":177,"./bm":178,"./bm.js":178,"./bn":179,"./bn.js":179,"./bo":180,"./bo.js":180,"./br":181,"./br.js":181,"./bs":182,"./bs.js":182,"./ca":183,"./ca.js":183,"./cs":184,"./cs.js":184,"./cv":185,"./cv.js":185,"./cy":186,"./cy.js":186,"./da":187,"./da.js":187,"./de":188,"./de-at":189,"./de-at.js":189,"./de-ch":190,"./de-ch.js":190,"./de.js":188,"./dv":191,"./dv.js":191,"./el":192,"./el.js":192,"./en-au":193,"./en-au.js":193,"./en-ca":194,"./en-ca.js":194,"./en-gb":195,"./en-gb.js":195,"./en-ie":196,"./en-ie.js":196,"./en-nz":197,"./en-nz.js":197,"./eo":198,"./eo.js":198,"./es":199,"./es-do":200,"./es-do.js":200,"./es-us":201,"./es-us.js":201,"./es.js":199,"./et":202,"./et.js":202,"./eu":203,"./eu.js":203,"./fa":204,"./fa.js":204,"./fi":205,"./fi.js":205,"./fo":206,"./fo.js":206,"./fr":207,"./fr-ca":208,"./fr-ca.js":208,"./fr-ch":209,"./fr-ch.js":209,"./fr.js":207,"./fy":210,"./fy.js":210,"./gd":211,"./gd.js":211,"./gl":212,"./gl.js":212,"./gom-latn":213,"./gom-latn.js":213,"./gu":214,"./gu.js":214,"./he":215,"./he.js":215,"./hi":216,"./hi.js":216,"./hr":217,"./hr.js":217,"./hu":218,"./hu.js":218,"./hy-am":219,"./hy-am.js":219,"./id":220,"./id.js":220,"./is":221,"./is.js":221,"./it":222,"./it.js":222,"./ja":223,"./ja.js":223,"./jv":224,"./jv.js":224,"./ka":225,"./ka.js":225,"./kk":226,"./kk.js":226,"./km":227,"./km.js":227,"./kn":228,"./kn.js":228,"./ko":229,"./ko.js":229,"./ky":230,"./ky.js":230,"./lb":231,"./lb.js":231,"./lo":232,"./lo.js":232,"./lt":233,"./lt.js":233,"./lv":234,"./lv.js":234,"./me":235,"./me.js":235,"./mi":236,"./mi.js":236,"./mk":237,"./mk.js":237,"./ml":238,"./ml.js":238,"./mr":239,"./mr.js":239,"./ms":240,"./ms-my":241,"./ms-my.js":241,"./ms.js":240,"./mt":242,"./mt.js":242,"./my":243,"./my.js":243,"./nb":244,"./nb.js":244,"./ne":245,"./ne.js":245,"./nl":246,"./nl-be":247,"./nl-be.js":247,"./nl.js":246,"./nn":248,"./nn.js":248,"./pa-in":249,"./pa-in.js":249,"./pl":250,"./pl.js":250,"./pt":251,"./pt-br":252,"./pt-br.js":252,"./pt.js":251,"./ro":253,"./ro.js":253,"./ru":254,"./ru.js":254,"./sd":255,"./sd.js":255,"./se":256,"./se.js":256,"./si":257,"./si.js":257,"./sk":258,"./sk.js":258,"./sl":259,"./sl.js":259,"./sq":260,"./sq.js":260,"./sr":261,"./sr-cyrl":262,"./sr-cyrl.js":262,"./sr.js":261,"./ss":263,"./ss.js":263,"./sv":264,"./sv.js":264,"./sw":265,"./sw.js":265,"./ta":266,"./ta.js":266,"./te":267,"./te.js":267,"./tet":268,"./tet.js":268,"./th":269,"./th.js":269,"./tl-ph":270,"./tl-ph.js":270,"./tlh":271,"./tlh.js":271,"./tr":272,"./tr.js":272,"./tzl":273,"./tzl.js":273,"./tzm":274,"./tzm-latn":275,"./tzm-latn.js":275,"./tzm.js":274,"./uk":276,"./uk.js":276,"./ur":277,"./ur.js":277,"./uz":278,"./uz-latn":279,"./uz-latn.js":279,"./uz.js":278,"./vi":280,"./vi.js":280,"./x-pseudo":281,"./x-pseudo.js":281,"./yo":282,"./yo.js":282,"./zh-cn":283,"./zh-cn.js":283,"./zh-hk":284,"./zh-hk.js":284,"./zh-tw":285,"./zh-tw.js":285};function webpackContext(req){return __webpack_require__(webpackContextResolve(req));};function webpackContextResolve(req){var id=map[req];if(!(id+1))
throw new Error("Cannot find module '"+req+"'.");return id;};webpackContext.keys=function webpackContextKeys(){return Object.keys(map);};webpackContext.resolve=webpackContextResolve;module.exports=webpackContext;webpackContext.id=606;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _base=_interopRequireDefault(__webpack_require__(43));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var LeftOverlay=function(_Overlay){_inherits(LeftOverlay,_Overlay);function LeftOverlay(wotInstance){var _this;_classCallCheck(this,LeftOverlay);_this=_possibleConstructorReturn(this,_getPrototypeOf(LeftOverlay).call(this,wotInstance));_this.clone=_this.makeClone(_base.default.CLONE_LEFT);return _this;}
_createClass(LeftOverlay,[{key:"shouldBeRendered",value:function shouldBeRendered(){return!!(this.wot.getSetting('fixedColumnsLeft')||this.wot.getSetting('rowHeaders').length);}},{key:"resetFixedPosition",value:function resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode){return;}
var overlayRoot=this.clone.wtTable.holder.parentNode;var headerPosition=0;var preventOverflow=this.wot.getSetting('preventOverflow');if(this.trimmingContainer===window&&(!preventOverflow||preventOverflow!=='horizontal')){var box=this.wot.wtTable.hider.getBoundingClientRect();var left=Math.ceil(box.left);var right=Math.ceil(box.right);var finalLeft;var finalTop;finalTop=this.wot.wtTable.hider.style.top;finalTop=finalTop===''?0:finalTop;if(left<0&&right-overlayRoot.offsetWidth>0){finalLeft=-left;}else{finalLeft=0;}
headerPosition=finalLeft;finalLeft+='px';(0,_element.setOverlayPosition)(overlayRoot,finalLeft,finalTop);}else{headerPosition=this.getScrollPosition();(0,_element.resetCssTransform)(overlayRoot);}
this.adjustHeaderBordersPosition(headerPosition);this.adjustElementsSize();}},{key:"setScrollPosition",value:function setScrollPosition(pos){var result=false;if(this.mainTableScrollableElement===window&&window.scrollX!==pos){window.scrollTo(pos,(0,_element.getWindowScrollTop)());result=true;}else if(this.mainTableScrollableElement.scrollLeft!==pos){this.mainTableScrollableElement.scrollLeft=pos;result=true;}
return result;}},{key:"onScroll",value:function onScroll(){this.wot.getSetting('onScrollVertically');}},{key:"sumCellSizes",value:function sumCellSizes(from,to){var defaultColumnWidth=this.wot.wtSettings.defaultColumnWidth;var column=from;var sum=0;while(column<to){sum+=this.wot.wtTable.getStretchedColumnWidth(column)||defaultColumnWidth;column+=1;}
return sum;}},{key:"adjustElementsSize",value:function adjustElementsSize(){var force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.updateTrimmingContainer();if(this.needFullRender||force){this.adjustRootElementSize();this.adjustRootChildrenSize();if(!force){this.areElementSizesAdjusted=true;}}}},{key:"adjustRootElementSize",value:function adjustRootElementSize(){var masterHolder=this.wot.wtTable.holder;var scrollbarHeight=masterHolder.clientHeight===masterHolder.offsetHeight?0:(0,_element.getScrollbarWidth)();var overlayRoot=this.clone.wtTable.holder.parentNode;var overlayRootStyle=overlayRoot.style;var preventOverflow=this.wot.getSetting('preventOverflow');if(this.trimmingContainer!==window||preventOverflow==='vertical'){var height=this.wot.wtViewport.getWorkspaceHeight()-scrollbarHeight;height=Math.min(height,(0,_element.innerHeight)(this.wot.wtTable.wtRootElement));overlayRootStyle.height="".concat(height,"px");}else{overlayRootStyle.height='';}
this.clone.wtTable.holder.style.height=overlayRootStyle.height;var tableWidth=(0,_element.outerWidth)(this.clone.wtTable.TABLE);overlayRootStyle.width="".concat(tableWidth===0?tableWidth:tableWidth+4,"px");}},{key:"adjustRootChildrenSize",value:function adjustRootChildrenSize(){var scrollbarWidth=(0,_element.getScrollbarWidth)();this.clone.wtTable.hider.style.height=this.hider.style.height;this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height;if(scrollbarWidth===0){scrollbarWidth=30;}
this.clone.wtTable.holder.style.width="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+scrollbarWidth,"px");}},{key:"applyToDOM",value:function applyToDOM(){var total=this.wot.getSetting('totalColumns');if(!this.areElementSizesAdjusted){this.adjustElementsSize();}
if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==='number'){this.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");}else if(total===0){this.spreader.style.left='0';}else{throw new Error('Incorrect value of the columnsRenderCalculator');}
this.spreader.style.right='';if(this.needFullRender){this.syncOverlayOffset();}}},{key:"syncOverlayOffset",value:function syncOverlayOffset(){if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==='number'){this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");}else{this.clone.wtTable.spreader.style.top='';}}},{key:"scrollTo",value:function scrollTo(sourceCol,beyondRendered){var newX=this.getTableParentOffset();var sourceInstance=this.wot.cloneSource?this.wot.cloneSource:this.wot;var mainHolder=sourceInstance.wtTable.holder;var scrollbarCompensation=0;if(beyondRendered&&mainHolder.offsetWidth!==mainHolder.clientWidth){scrollbarCompensation=(0,_element.getScrollbarWidth)();}
if(beyondRendered){newX+=this.sumCellSizes(0,sourceCol+1);newX-=this.wot.wtViewport.getViewportWidth();}else{newX+=this.sumCellSizes(this.wot.getSetting('fixedColumnsLeft'),sourceCol);}
newX+=scrollbarCompensation;return this.setScrollPosition(newX);}},{key:"getTableParentOffset",value:function getTableParentOffset(){var preventOverflow=this.wot.getSetting('preventOverflow');var offset=0;if(!preventOverflow&&this.trimmingContainer===window){offset=this.wot.wtTable.holderOffset.left;}
return offset;}},{key:"getScrollPosition",value:function getScrollPosition(){return(0,_element.getScrollLeft)(this.mainTableScrollableElement);}},{key:"adjustHeaderBordersPosition",value:function adjustHeaderBordersPosition(position){var masterParent=this.wot.wtTable.holder.parentNode;var rowHeaders=this.wot.getSetting('rowHeaders');var fixedColumnsLeft=this.wot.getSetting('fixedColumnsLeft');var totalRows=this.wot.getSetting('totalRows');if(totalRows){(0,_element.removeClass)(masterParent,'emptyRows');}else{(0,_element.addClass)(masterParent,'emptyRows');}
if(fixedColumnsLeft&&!rowHeaders.length){(0,_element.addClass)(masterParent,'innerBorderLeft');}else if(!fixedColumnsLeft&&rowHeaders.length){var previousState=(0,_element.hasClass)(masterParent,'innerBorderLeft');if(position){(0,_element.addClass)(masterParent,'innerBorderLeft');}else{(0,_element.removeClass)(masterParent,'innerBorderLeft');}
if(!previousState&&position||previousState&&!position){this.wot.wtOverlays.adjustElementsSize();}}}}]);return LeftOverlay;}(_base.default);_base.default.registerOverlay(_base.default.CLONE_LEFT,LeftOverlay);var _default=LeftOverlay;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _array=__webpack_require__(3);var _base=_interopRequireDefault(__webpack_require__(43));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var TopOverlay=function(_Overlay){_inherits(TopOverlay,_Overlay);function TopOverlay(wotInstance){var _this;_classCallCheck(this,TopOverlay);_this=_possibleConstructorReturn(this,_getPrototypeOf(TopOverlay).call(this,wotInstance));_this.clone=_this.makeClone(_base.default.CLONE_TOP);return _this;}
_createClass(TopOverlay,[{key:"shouldBeRendered",value:function shouldBeRendered(){return!!(this.wot.getSetting('fixedRowsTop')||this.wot.getSetting('columnHeaders').length);}},{key:"resetFixedPosition",value:function resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode){return;}
var overlayRoot=this.clone.wtTable.holder.parentNode;var headerPosition=0;var preventOverflow=this.wot.getSetting('preventOverflow');if(this.trimmingContainer===window&&(!preventOverflow||preventOverflow!=='vertical')){var box=this.wot.wtTable.hider.getBoundingClientRect();var top=Math.ceil(box.top);var bottom=Math.ceil(box.bottom);var finalLeft;var finalTop;finalLeft=this.wot.wtTable.hider.style.left;finalLeft=finalLeft===''?0:finalLeft;if(top<0&&bottom-overlayRoot.offsetHeight>0){finalTop=-top;}else{finalTop=0;}
headerPosition=finalTop;finalTop+='px';(0,_element.setOverlayPosition)(overlayRoot,finalLeft,finalTop);}else{headerPosition=this.getScrollPosition();(0,_element.resetCssTransform)(overlayRoot);}
this.adjustHeaderBordersPosition(headerPosition);this.adjustElementsSize();}},{key:"setScrollPosition",value:function setScrollPosition(pos){var result=false;if(this.mainTableScrollableElement===window&&window.scrollY!==pos){window.scrollTo((0,_element.getWindowScrollLeft)(),pos);result=true;}else if(this.mainTableScrollableElement.scrollTop!==pos){this.mainTableScrollableElement.scrollTop=pos;result=true;}
return result;}},{key:"onScroll",value:function onScroll(){this.wot.getSetting('onScrollHorizontally');}},{key:"sumCellSizes",value:function sumCellSizes(from,to){var defaultRowHeight=this.wot.wtSettings.settings.defaultRowHeight;var row=from;var sum=0;while(row<to){var height=this.wot.wtTable.getRowHeight(row);sum+=height===void 0?defaultRowHeight:height;row+=1;}
return sum;}},{key:"adjustElementsSize",value:function adjustElementsSize(){var force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.updateTrimmingContainer();if(this.needFullRender||force){this.adjustRootElementSize();this.adjustRootChildrenSize();if(!force){this.areElementSizesAdjusted=true;}}}},{key:"adjustRootElementSize",value:function adjustRootElementSize(){var masterHolder=this.wot.wtTable.holder;var scrollbarWidth=masterHolder.clientWidth===masterHolder.offsetWidth?0:(0,_element.getScrollbarWidth)();var overlayRoot=this.clone.wtTable.holder.parentNode;var overlayRootStyle=overlayRoot.style;var preventOverflow=this.wot.getSetting('preventOverflow');if(this.trimmingContainer!==window||preventOverflow==='horizontal'){var width=this.wot.wtViewport.getWorkspaceWidth()-scrollbarWidth;width=Math.min(width,(0,_element.innerWidth)(this.wot.wtTable.wtRootElement));overlayRootStyle.width="".concat(width,"px");}else{overlayRootStyle.width='';}
this.clone.wtTable.holder.style.width=overlayRootStyle.width;var tableHeight=(0,_element.outerHeight)(this.clone.wtTable.TABLE);overlayRootStyle.height="".concat(tableHeight===0?tableHeight:tableHeight+4,"px");}},{key:"adjustRootChildrenSize",value:function adjustRootChildrenSize(){var scrollbarWidth=(0,_element.getScrollbarWidth)();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;if(scrollbarWidth===0){scrollbarWidth=30;}
this.clone.wtTable.holder.style.height="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+scrollbarWidth,"px");}},{key:"applyToDOM",value:function applyToDOM(){var total=this.wot.getSetting('totalRows');if(!this.areElementSizesAdjusted){this.adjustElementsSize();}
if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==='number'){this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");}else if(total===0){this.spreader.style.top='0';}else{throw new Error('Incorrect value of the rowsRenderCalculator');}
this.spreader.style.bottom='';if(this.needFullRender){this.syncOverlayOffset();}}},{key:"syncOverlayOffset",value:function syncOverlayOffset(){if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==='number'){this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");}else{this.clone.wtTable.spreader.style.left='';}}},{key:"scrollTo",value:function scrollTo(sourceRow,bottomEdge){var newY=this.getTableParentOffset();var sourceInstance=this.wot.cloneSource?this.wot.cloneSource:this.wot;var mainHolder=sourceInstance.wtTable.holder;var scrollbarCompensation=0;if(bottomEdge&&mainHolder.offsetHeight!==mainHolder.clientHeight){scrollbarCompensation=(0,_element.getScrollbarWidth)();}
if(bottomEdge){var fixedRowsBottom=this.wot.getSetting('fixedRowsBottom');var totalRows=this.wot.getSetting('totalRows');newY+=this.sumCellSizes(0,sourceRow+1);newY-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(totalRows-fixedRowsBottom,totalRows);newY+=1;}else{newY+=this.sumCellSizes(this.wot.getSetting('fixedRowsTop'),sourceRow);}
newY+=scrollbarCompensation;return this.setScrollPosition(newY);}},{key:"getTableParentOffset",value:function getTableParentOffset(){if(this.mainTableScrollableElement===window){return this.wot.wtTable.holderOffset.top;}
return 0;}},{key:"getScrollPosition",value:function getScrollPosition(){return(0,_element.getScrollTop)(this.mainTableScrollableElement);}},{key:"redrawSelectionBorders",value:function redrawSelectionBorders(selection){if(selection&&selection.cellRange){var border=selection.getBorder(this.wot);var corners=selection.getCorners();border.disappear();border.appear(corners);}}},{key:"redrawAllSelectionsBorders",value:function redrawAllSelectionsBorders(){var _this2=this;var selections=this.wot.selections;this.redrawSelectionBorders(selections.getCell());(0,_array.arrayEach)(selections.getAreas(),function(area){_this2.redrawSelectionBorders(area);});this.redrawSelectionBorders(selections.getFill());this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh();}},{key:"adjustHeaderBordersPosition",value:function adjustHeaderBordersPosition(position){var masterParent=this.wot.wtTable.holder.parentNode;var totalColumns=this.wot.getSetting('totalColumns');if(totalColumns){(0,_element.removeClass)(masterParent,'emptyColumns');}else{(0,_element.addClass)(masterParent,'emptyColumns');}
if(this.wot.getSetting('fixedRowsTop')===0&&this.wot.getSetting('columnHeaders').length>0){var previousState=(0,_element.hasClass)(masterParent,'innerBorderTop');if(position||this.wot.getSetting('totalRows')===0){(0,_element.addClass)(masterParent,'innerBorderTop');}else{(0,_element.removeClass)(masterParent,'innerBorderTop');}
if(!previousState&&position||previousState&&!position){this.wot.wtOverlays.adjustElementsSize();this.redrawAllSelectionsBorders();}}
if(this.wot.getSetting('rowHeaders').length===0){var secondHeaderCell=this.clone.wtTable.THEAD.querySelectorAll('th:nth-of-type(2)');if(secondHeaderCell){for(var i=0;i<secondHeaderCell.length;i++){secondHeaderCell[i].style['border-left-width']=0;}}}}}]);return TopOverlay;}(_base.default);_base.default.registerOverlay(_base.default.CLONE_TOP,TopOverlay);var _default=TopOverlay;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _base=_interopRequireDefault(__webpack_require__(43));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var TopLeftCornerOverlay=function(_Overlay){_inherits(TopLeftCornerOverlay,_Overlay);function TopLeftCornerOverlay(wotInstance){var _this;_classCallCheck(this,TopLeftCornerOverlay);_this=_possibleConstructorReturn(this,_getPrototypeOf(TopLeftCornerOverlay).call(this,wotInstance));_this.clone=_this.makeClone(_base.default.CLONE_TOP_LEFT_CORNER);return _this;}
_createClass(TopLeftCornerOverlay,[{key:"shouldBeRendered",value:function shouldBeRendered(){return!!((this.wot.getSetting('fixedRowsTop')||this.wot.getSetting('columnHeaders').length)&&(this.wot.getSetting('fixedColumnsLeft')||this.wot.getSetting('rowHeaders').length));}},{key:"resetFixedPosition",value:function resetFixedPosition(){this.updateTrimmingContainer();if(!this.wot.wtTable.holder.parentNode){return;}
var overlayRoot=this.clone.wtTable.holder.parentNode;var tableHeight=(0,_element.outerHeight)(this.clone.wtTable.TABLE);var tableWidth=(0,_element.outerWidth)(this.clone.wtTable.TABLE);var preventOverflow=this.wot.getSetting('preventOverflow');if(this.trimmingContainer===window){var box=this.wot.wtTable.hider.getBoundingClientRect();var top=Math.ceil(box.top);var left=Math.ceil(box.left);var bottom=Math.ceil(box.bottom);var right=Math.ceil(box.right);var finalLeft='0';var finalTop='0';if(!preventOverflow||preventOverflow==='vertical'){if(left<0&&right-overlayRoot.offsetWidth>0){finalLeft="".concat(-left,"px");}}
if(!preventOverflow||preventOverflow==='horizontal'){if(top<0&&bottom-overlayRoot.offsetHeight>0){finalTop="".concat(-top,"px");}}
(0,_element.setOverlayPosition)(overlayRoot,finalLeft,finalTop);}else{(0,_element.resetCssTransform)(overlayRoot);}
overlayRoot.style.height="".concat(tableHeight===0?tableHeight:tableHeight+4,"px");overlayRoot.style.width="".concat(tableWidth===0?tableWidth:tableWidth+4,"px");}}]);return TopLeftCornerOverlay;}(_base.default);_base.default.registerOverlay(_base.default.CLONE_TOP_LEFT_CORNER,TopLeftCornerOverlay);var _default=TopLeftCornerOverlay;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _base=_interopRequireDefault(__webpack_require__(43));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var BottomOverlay=function(_Overlay){_inherits(BottomOverlay,_Overlay);function BottomOverlay(wotInstance){var _this;_classCallCheck(this,BottomOverlay);_this=_possibleConstructorReturn(this,_getPrototypeOf(BottomOverlay).call(this,wotInstance));_this.clone=_this.makeClone(_base.default.CLONE_BOTTOM);return _this;}
_createClass(BottomOverlay,[{key:"repositionOverlay",value:function repositionOverlay(){var scrollbarWidth=(0,_element.getScrollbarWidth)();var cloneRoot=this.clone.wtTable.holder.parentNode;if(this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight){scrollbarWidth=0;}
cloneRoot.style.top='';cloneRoot.style.bottom="".concat(scrollbarWidth,"px");}},{key:"shouldBeRendered",value:function shouldBeRendered(){return this.wot.getSetting('fixedRowsBottom')?true:false;}},{key:"resetFixedPosition",value:function resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode){return;}
var overlayRoot=this.clone.wtTable.holder.parentNode;var headerPosition=0;overlayRoot.style.top='';if(this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var box=this.wot.wtTable.hider.getBoundingClientRect();var bottom=Math.ceil(box.bottom);var finalLeft;var finalBottom;var bodyHeight=document.body.offsetHeight;finalLeft=this.wot.wtTable.hider.style.left;finalLeft=finalLeft===''?0:finalLeft;if(bottom>bodyHeight){finalBottom=bottom-bodyHeight;}else{finalBottom=0;}
headerPosition=finalBottom;finalBottom+='px';overlayRoot.style.top='';overlayRoot.style.left=finalLeft;overlayRoot.style.bottom=finalBottom;}else{headerPosition=this.getScrollPosition();(0,_element.resetCssTransform)(overlayRoot);this.repositionOverlay();}
this.adjustHeaderBordersPosition(headerPosition);}},{key:"setScrollPosition",value:function setScrollPosition(pos){if(this.mainTableScrollableElement===window){window.scrollTo((0,_element.getWindowScrollLeft)(),pos);}else{this.mainTableScrollableElement.scrollTop=pos;}}},{key:"onScroll",value:function onScroll(){this.wot.getSetting('onScrollVertically');}},{key:"sumCellSizes",value:function sumCellSizes(from,to){var row=from;var sum=0;var defaultRowHeight=this.wot.wtSettings.settings.defaultRowHeight;while(row<to){var height=this.wot.wtTable.getRowHeight(row);sum+=height===void 0?defaultRowHeight:height;row+=1;}
return sum;}},{key:"adjustElementsSize",value:function adjustElementsSize(){var force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.updateTrimmingContainer();if(this.needFullRender||force){this.adjustRootElementSize();this.adjustRootChildrenSize();if(!force){this.areElementSizesAdjusted=true;}}}},{key:"adjustRootElementSize",value:function adjustRootElementSize(){var masterHolder=this.wot.wtTable.holder;var scrollbarWidth=masterHolder.clientWidth===masterHolder.offsetWidth?0:(0,_element.getScrollbarWidth)();var overlayRoot=this.clone.wtTable.holder.parentNode;var overlayRootStyle=overlayRoot.style;if(this.trimmingContainer===window){overlayRootStyle.width='';}else{overlayRootStyle.width="".concat(this.wot.wtViewport.getWorkspaceWidth()-scrollbarWidth,"px");}
this.clone.wtTable.holder.style.width=overlayRootStyle.width;var tableHeight=(0,_element.outerHeight)(this.clone.wtTable.TABLE);overlayRootStyle.height="".concat(tableHeight===0?tableHeight:tableHeight,"px");}},{key:"adjustRootChildrenSize",value:function adjustRootChildrenSize(){var scrollbarWidth=(0,_element.getScrollbarWidth)();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;if(scrollbarWidth===0){scrollbarWidth=30;}
this.clone.wtTable.holder.style.height="".concat(parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+scrollbarWidth,"px");}},{key:"applyToDOM",value:function applyToDOM(){var total=this.wot.getSetting('totalRows');if(!this.areElementSizesAdjusted){this.adjustElementsSize();}
if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition==='number'){this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");}else if(total===0){this.spreader.style.top='0';}else{throw new Error('Incorrect value of the rowsRenderCalculator');}
this.spreader.style.bottom='';if(this.needFullRender){this.syncOverlayOffset();}}},{key:"syncOverlayOffset",value:function syncOverlayOffset(){if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition==='number'){this.clone.wtTable.spreader.style.left="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");}else{this.clone.wtTable.spreader.style.left='';}}},{key:"scrollTo",value:function scrollTo(sourceRow,bottomEdge){var newY=this.getTableParentOffset();var sourceInstance=this.wot.cloneSource?this.wot.cloneSource:this.wot;var mainHolder=sourceInstance.wtTable.holder;var scrollbarCompensation=0;if(bottomEdge&&mainHolder.offsetHeight!==mainHolder.clientHeight){scrollbarCompensation=(0,_element.getScrollbarWidth)();}
if(bottomEdge){newY+=this.sumCellSizes(0,sourceRow+1);newY-=this.wot.wtViewport.getViewportHeight();newY+=1;}else{newY+=this.sumCellSizes(this.wot.getSetting('fixedRowsBottom'),sourceRow);}
newY+=scrollbarCompensation;this.setScrollPosition(newY);}},{key:"getTableParentOffset",value:function getTableParentOffset(){if(this.mainTableScrollableElement===window){return this.wot.wtTable.holderOffset.top;}
return 0;}},{key:"getScrollPosition",value:function getScrollPosition(){return(0,_element.getScrollTop)(this.mainTableScrollableElement);}},{key:"adjustHeaderBordersPosition",value:function adjustHeaderBordersPosition(position){if(this.wot.getSetting('fixedRowsBottom')===0&&this.wot.getSetting('columnHeaders').length>0){var masterParent=this.wot.wtTable.holder.parentNode;var previousState=(0,_element.hasClass)(masterParent,'innerBorderTop');if(position){(0,_element.addClass)(masterParent,'innerBorderTop');}else{(0,_element.removeClass)(masterParent,'innerBorderTop');}
if(!previousState&&position||previousState&&!position){this.wot.wtOverlays.adjustElementsSize();}}
if(this.wot.getSetting('rowHeaders').length===0){var secondHeaderCell=this.clone.wtTable.THEAD.querySelector('th:nth-of-type(2)');if(secondHeaderCell){secondHeaderCell.style['border-left-width']=0;}}}}]);return BottomOverlay;}(_base.default);_base.default.registerOverlay(_base.default.CLONE_BOTTOM,BottomOverlay);var _default=BottomOverlay;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _base=_interopRequireDefault(__webpack_require__(43));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var BottomLeftCornerOverlay=function(_Overlay){_inherits(BottomLeftCornerOverlay,_Overlay);function BottomLeftCornerOverlay(wotInstance){var _this;_classCallCheck(this,BottomLeftCornerOverlay);_this=_possibleConstructorReturn(this,_getPrototypeOf(BottomLeftCornerOverlay).call(this,wotInstance));_this.clone=_this.makeClone(_base.default.CLONE_BOTTOM_LEFT_CORNER);return _this;}
_createClass(BottomLeftCornerOverlay,[{key:"shouldBeRendered",value:function shouldBeRendered(){return this.wot.getSetting('fixedRowsBottom')&&(this.wot.getSetting('fixedColumnsLeft')||this.wot.getSetting('rowHeaders').length)?true:false;}},{key:"repositionOverlay",value:function repositionOverlay(){var scrollbarWidth=(0,_element.getScrollbarWidth)();var cloneRoot=this.clone.wtTable.holder.parentNode;if(this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight){scrollbarWidth=0;}
cloneRoot.style.top='';cloneRoot.style.bottom="".concat(scrollbarWidth,"px");}},{key:"resetFixedPosition",value:function resetFixedPosition(){this.updateTrimmingContainer();if(!this.wot.wtTable.holder.parentNode){return;}
var overlayRoot=this.clone.wtTable.holder.parentNode;var tableHeight=(0,_element.outerHeight)(this.clone.wtTable.TABLE);var tableWidth=(0,_element.outerWidth)(this.clone.wtTable.TABLE);overlayRoot.style.top='';if(this.trimmingContainer===window){var box=this.wot.wtTable.hider.getBoundingClientRect();var bottom=Math.ceil(box.bottom);var left=Math.ceil(box.left);var finalLeft;var finalBottom;var bodyHeight=document.body.offsetHeight;if(left<0){finalLeft=-left;}else{finalLeft=0;}
if(bottom>bodyHeight){finalBottom=bottom-bodyHeight;}else{finalBottom=0;}
finalBottom+='px';finalLeft+='px';overlayRoot.style.top='';overlayRoot.style.left=finalLeft;overlayRoot.style.bottom=finalBottom;}else{(0,_element.resetCssTransform)(overlayRoot);this.repositionOverlay();}
overlayRoot.style.height="".concat(tableHeight===0?tableHeight:tableHeight,"px");overlayRoot.style.width="".concat(tableWidth===0?tableWidth:tableWidth,"px");}}]);return BottomLeftCornerOverlay;}(_base.default);_base.default.registerOverlay(_base.default.CLONE_BOTTOM_LEFT_CORNER,BottomLeftCornerOverlay);var _default=BottomLeftCornerOverlay;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _border=_interopRequireDefault(__webpack_require__(293));var _coords=_interopRequireDefault(__webpack_require__(75));var _range=_interopRequireDefault(__webpack_require__(162));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Selection=function(){function Selection(settings,cellRange){_classCallCheck(this,Selection);this.settings=settings;this.cellRange=cellRange||null;this.instanceBorders={};this.classNames=[this.settings.className];this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel);}
_createClass(Selection,[{key:"getBorder",value:function getBorder(wotInstance){if(!this.instanceBorders[wotInstance.guid]){this.instanceBorders[wotInstance.guid]=new _border.default(wotInstance,this.settings);}
return this.instanceBorders[wotInstance.guid];}},{key:"isEmpty",value:function isEmpty(){return this.cellRange===null;}},{key:"add",value:function add(coords){if(this.isEmpty()){this.cellRange=new _range.default(coords);}else{this.cellRange.expand(coords);}
return this;}},{key:"replace",value:function replace(oldCoords,newCoords){if(!this.isEmpty()){if(this.cellRange.from.isEqual(oldCoords)){this.cellRange.from=newCoords;return true;}
if(this.cellRange.to.isEqual(oldCoords)){this.cellRange.to=newCoords;return true;}}
return false;}},{key:"clear",value:function clear(){this.cellRange=null;return this;}},{key:"getCorners",value:function getCorners(){var topLeft=this.cellRange.getTopLeftCorner();var bottomRight=this.cellRange.getBottomRightCorner();return[topLeft.row,topLeft.col,bottomRight.row,bottomRight.col];}},{key:"addClassAtCoords",value:function addClassAtCoords(wotInstance,sourceRow,sourceColumn,className){var markIntersections=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;var TD=wotInstance.wtTable.getCell(new _coords.default(sourceRow,sourceColumn));if(_typeof(TD)==='object'){var cellClassName=className;if(markIntersections){cellClassName=this.classNameGenerator(TD);if(!this.classNames.includes(cellClassName)){this.classNames.push(cellClassName);}}
(0,_element.addClass)(TD,cellClassName);}
return this;}},{key:"linearClassNameGenerator",value:function linearClassNameGenerator(baseClassName,layerLevelOwner){return function calcClassName(element){var previousIndex=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;if(layerLevelOwner===0||previousIndex===0){return baseClassName;}
var index=previousIndex>=0?previousIndex:layerLevelOwner;var className=baseClassName;index-=1;var previousClassName=index===0?baseClassName:"".concat(baseClassName,"-").concat(index);if((0,_element.hasClass)(element,previousClassName)){var currentLayer=index+1;className="".concat(baseClassName,"-").concat(currentLayer);}else{className=calcClassName(element,index);}
return className;};}},{key:"draw",value:function draw(wotInstance){if(this.isEmpty()){if(this.settings.border){this.getBorder(wotInstance).disappear();}
return;}
var renderedRows=wotInstance.wtTable.getRenderedRowsCount();var renderedColumns=wotInstance.wtTable.getRenderedColumnsCount();var corners=this.getCorners();var _corners=_slicedToArray(corners,4),topRow=_corners[0],topColumn=_corners[1],bottomRow=_corners[2],bottomColumn=_corners[3];for(var column=0;column<renderedColumns;column+=1){var sourceCol=wotInstance.wtTable.columnFilter.renderedToSource(column);if(sourceCol>=topColumn&&sourceCol<=bottomColumn){var TH=wotInstance.wtTable.getColumnHeader(sourceCol);if(TH){var newClasses=[];if(this.settings.highlightHeaderClassName){newClasses.push(this.settings.highlightHeaderClassName);}
if(this.settings.highlightColumnClassName){newClasses.push(this.settings.highlightColumnClassName);}
(0,_element.addClass)(TH,newClasses);}}}
for(var row=0;row<renderedRows;row+=1){var sourceRow=wotInstance.wtTable.rowFilter.renderedToSource(row);if(sourceRow>=topRow&&sourceRow<=bottomRow){var _TH=wotInstance.wtTable.getRowHeader(sourceRow);if(_TH){var _newClasses=[];if(this.settings.highlightHeaderClassName){_newClasses.push(this.settings.highlightHeaderClassName);}
if(this.settings.highlightRowClassName){_newClasses.push(this.settings.highlightRowClassName);}
(0,_element.addClass)(_TH,_newClasses);}}
for(var _column=0;_column<renderedColumns;_column+=1){var _sourceCol=wotInstance.wtTable.columnFilter.renderedToSource(_column);if(sourceRow>=topRow&&sourceRow<=bottomRow&&_sourceCol>=topColumn&&_sourceCol<=bottomColumn){if(this.settings.className){this.addClassAtCoords(wotInstance,sourceRow,_sourceCol,this.settings.className,this.settings.markIntersections);}}else if(sourceRow>=topRow&&sourceRow<=bottomRow){if(this.settings.highlightRowClassName){this.addClassAtCoords(wotInstance,sourceRow,_sourceCol,this.settings.highlightRowClassName);}}else if(_sourceCol>=topColumn&&_sourceCol<=bottomColumn){if(this.settings.highlightColumnClassName){this.addClassAtCoords(wotInstance,sourceRow,_sourceCol,this.settings.highlightColumnClassName);}}
var additionalSelectionClass=wotInstance.getSetting('onAfterDrawSelection',sourceRow,_sourceCol,corners,this.settings.layerLevel);if(typeof additionalSelectionClass==='string'){this.addClassAtCoords(wotInstance,sourceRow,_sourceCol,additionalSelectionClass);}}}
wotInstance.getSetting('onBeforeDrawBorders',corners,this.settings.className);if(this.settings.border){this.getBorder(wotInstance).appear(corners);}}}]);return Selection;}();var _default=Selection;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";function autoResize(){var defaults={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},el,body=document.body,text=document.createTextNode(''),span=document.createElement('SPAN'),observe=function observe(element,event,handler){element.addEventListener(event,handler,false);},_unObserve=function unObserve(element,event,handler){element.removeEventListener(event,handler,false);},resize=function resize(newChar){var width,scrollHeight;if(!newChar){newChar="";}else if(!/^[a-zA-Z \.,\\\/\|0-9]$/.test(newChar)){newChar=".";}
if(text.textContent!==void 0){text.textContent=el.value+newChar;}else{text.data=el.value+newChar;}
span.style.fontSize=getComputedStyle(el).fontSize;span.style.fontFamily=getComputedStyle(el).fontFamily;span.style.whiteSpace="pre";body.appendChild(span);width=span.clientWidth+2;body.removeChild(span);el.style.height=defaults.minHeight+'px';if(defaults.minWidth>width){el.style.width=defaults.minWidth+'px';}else if(width>defaults.maxWidth){el.style.width=defaults.maxWidth+'px';}else{el.style.width=width+'px';}
scrollHeight=el.scrollHeight?el.scrollHeight-1:0;if(defaults.minHeight>scrollHeight){el.style.height=defaults.minHeight+'px';}else if(defaults.maxHeight<scrollHeight){el.style.height=defaults.maxHeight+'px';el.style.overflowY='visible';}else{el.style.height=scrollHeight+'px';}},delayedResize=function delayedResize(){window.setTimeout(resize,0);},extendDefaults=function extendDefaults(config){if(config&&config.minHeight){if(config.minHeight=='inherit'){defaults.minHeight=el.clientHeight;}else{var minHeight=parseInt(config.minHeight);if(!isNaN(minHeight)){defaults.minHeight=minHeight;}}}
if(config&&config.maxHeight){if(config.maxHeight=='inherit'){defaults.maxHeight=el.clientHeight;}else{var maxHeight=parseInt(config.maxHeight);if(!isNaN(maxHeight)){defaults.maxHeight=maxHeight;}}}
if(config&&config.minWidth){if(config.minWidth=='inherit'){defaults.minWidth=el.clientWidth;}else{var minWidth=parseInt(config.minWidth);if(!isNaN(minWidth)){defaults.minWidth=minWidth;}}}
if(config&&config.maxWidth){if(config.maxWidth=='inherit'){defaults.maxWidth=el.clientWidth;}else{var maxWidth=parseInt(config.maxWidth);if(!isNaN(maxWidth)){defaults.maxWidth=maxWidth;}}}
if(!span.firstChild){span.className="autoResize";span.style.display='inline-block';span.appendChild(text);}},_init=function init(el_,config,doObserve){el=el_;extendDefaults(config);if(el.nodeName=='TEXTAREA'){el.style.resize='none';el.style.overflowY='';el.style.height=defaults.minHeight+'px';el.style.minWidth=defaults.minWidth+'px';el.style.maxWidth=defaults.maxWidth+'px';el.style.overflowY='hidden';}
if(doObserve){observe(el,'change',resize);observe(el,'cut',delayedResize);observe(el,'paste',delayedResize);observe(el,'drop',delayedResize);observe(el,'keydown',delayedResize);observe(el,'focus',resize);observe(el,'compositionstart',delayedResize);observe(el,'compositionupdate',delayedResize);observe(el,'compositionend',delayedResize);}
resize();};function getComputedStyle(element){return element.currentStyle||document.defaultView.getComputedStyle(element);}
return{init:function init(el_,config,doObserve){_init(el_,config,doObserve);},unObserve:function unObserve(){_unObserve(el,'change',resize);_unObserve(el,'cut',delayedResize);_unObserve(el,'paste',delayedResize);_unObserve(el,'drop',delayedResize);_unObserve(el,'keydown',delayedResize);_unObserve(el,'focus',resize);_unObserve(el,'compositionstart',delayedResize);_unObserve(el,'compositionupdate',delayedResize);_unObserve(el,'compositionend',delayedResize);},resize:resize};}
if(true){module.exports=autoResize;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _baseEditor=_interopRequireDefault(__webpack_require__(74));var _element=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var CheckboxEditor=function(_BaseEditor){_inherits(CheckboxEditor,_BaseEditor);function CheckboxEditor(){_classCallCheck(this,CheckboxEditor);return _possibleConstructorReturn(this,_getPrototypeOf(CheckboxEditor).apply(this,arguments));}
_createClass(CheckboxEditor,[{key:"beginEditing",value:function beginEditing(initialValue,event){if(event&&event.type==='mouseup'){var checkbox=this.TD.querySelector('input[type="checkbox"]');if(!(0,_element.hasClass)(checkbox,'htBadValue')){checkbox.click();}}}},{key:"finishEditing",value:function finishEditing(){}},{key:"init",value:function init(){}},{key:"open",value:function open(){}},{key:"close",value:function close(){}},{key:"getValue",value:function getValue(){}},{key:"setValue",value:function setValue(){}},{key:"focus",value:function focus(){}}]);return CheckboxEditor;}(_baseEditor.default);var _default=CheckboxEditor;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _moment=_interopRequireDefault(__webpack_require__(67));var _pikaday=_interopRequireDefault(__webpack_require__(616));__webpack_require__(619);var _element=__webpack_require__(1);var _object=__webpack_require__(2);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _unicode=__webpack_require__(32);var _event=__webpack_require__(18);var _textEditor=_interopRequireDefault(__webpack_require__(77));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var DateEditor=function(_TextEditor){_inherits(DateEditor,_TextEditor);function DateEditor(hotInstance){var _this;_classCallCheck(this,DateEditor);_this=_possibleConstructorReturn(this,_getPrototypeOf(DateEditor).call(this,hotInstance));_this.defaultDateFormat='DD/MM/YYYY';_this.isCellEdited=false;_this.parentDestroyed=false;return _this;}
_createClass(DateEditor,[{key:"init",value:function init(){var _this2=this;if(typeof _moment.default!=='function'){throw new Error('You need to include moment.js to your project.');}
if(typeof _pikaday.default!=='function'){throw new Error('You need to include Pikaday to your project.');}
_get(_getPrototypeOf(DateEditor.prototype),"init",this).call(this);this.instance.addHook('afterDestroy',function(){_this2.parentDestroyed=true;_this2.destroyElements();});}},{key:"createElements",value:function createElements(){_get(_getPrototypeOf(DateEditor.prototype),"createElements",this).call(this);this.datePicker=document.createElement('DIV');this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position='absolute';this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=9999;(0,_element.addClass)(this.datePicker,'htDatepickerHolder');document.body.appendChild(this.datePicker);this.$datePicker=new _pikaday.default(this.getDatePickerConfig());var eventManager=new _eventManager.default(this);eventManager.addEventListener(this.datePicker,'mousedown',function(event){return(0,_event.stopPropagation)(event);});this.hideDatepicker();}},{key:"destroyElements",value:function destroyElements(){this.$datePicker.destroy();}},{key:"prepare",value:function prepare(row,col,prop,td,originalValue,cellProperties){_get(_getPrototypeOf(DateEditor.prototype),"prepare",this).call(this,row,col,prop,td,originalValue,cellProperties);}},{key:"open",value:function open(){var event=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;_get(_getPrototypeOf(DateEditor.prototype),"open",this).call(this);this.showDatepicker(event);}},{key:"close",value:function close(){var _this3=this;this._opened=false;this.instance._registerTimeout(function(){_this3.instance._refreshBorders();});_get(_getPrototypeOf(DateEditor.prototype),"close",this).call(this);}},{key:"finishEditing",value:function finishEditing(){var isCancelled=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var ctrlDown=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(isCancelled){var value=this.originalValue;if(value!==void 0){this.setValue(value);}}
this.hideDatepicker();_get(_getPrototypeOf(DateEditor.prototype),"finishEditing",this).call(this,isCancelled,ctrlDown);}},{key:"showDatepicker",value:function showDatepicker(event){this.$datePicker.config(this.getDatePickerConfig());var offset=this.TD.getBoundingClientRect();var dateFormat=this.cellProperties.dateFormat||this.defaultDateFormat;var datePickerConfig=this.$datePicker.config();var dateStr;var isMouseDown=this.instance.view.isMouseDown();var isMeta=event?(0,_unicode.isMetaKey)(event.keyCode):false;this.datePickerStyle.top="".concat(window.pageYOffset+offset.top+(0,_element.outerHeight)(this.TD),"px");this.datePickerStyle.left="".concat(window.pageXOffset+offset.left,"px");this.$datePicker._onInputFocus=function(){};datePickerConfig.format=dateFormat;if(this.originalValue){dateStr=this.originalValue;if((0,_moment.default)(dateStr,dateFormat,true).isValid()){this.$datePicker.setMoment((0,_moment.default)(dateStr,dateFormat),true);}
if(this.getValue()!==this.originalValue){this.setValue(this.originalValue);}
if(!isMeta&&!isMouseDown){this.setValue('');}}else if(this.cellProperties.defaultDate){dateStr=this.cellProperties.defaultDate;datePickerConfig.defaultDate=dateStr;if((0,_moment.default)(dateStr,dateFormat,true).isValid()){this.$datePicker.setMoment((0,_moment.default)(dateStr,dateFormat),true);}
if(!isMeta&&!isMouseDown){this.setValue('');}}else{this.$datePicker.gotoToday();}
this.datePickerStyle.display='block';this.$datePicker.show();}},{key:"hideDatepicker",value:function hideDatepicker(){this.datePickerStyle.display='none';this.$datePicker.hide();}},{key:"getDatePickerConfig",value:function getDatePickerConfig(){var _this4=this;var htInput=this.TEXTAREA;var options={};if(this.cellProperties&&this.cellProperties.datePickerConfig){(0,_object.deepExtend)(options,this.cellProperties.datePickerConfig);}
var origOnSelect=options.onSelect;var origOnClose=options.onClose;options.field=htInput;options.trigger=htInput;options.container=this.datePicker;options.bound=false;options.format=options.format||this.defaultDateFormat;options.reposition=options.reposition||false;options.onSelect=function(value){var dateStr=value;if(!isNaN(dateStr.getTime())){dateStr=(0,_moment.default)(dateStr).format(_this4.cellProperties.dateFormat||_this4.defaultDateFormat);}
_this4.setValue(dateStr);_this4.hideDatepicker();if(origOnSelect){origOnSelect();}};options.onClose=function(){if(!_this4.parentDestroyed){_this4.finishEditing(false);}
if(origOnClose){origOnClose();}};return options;}}]);return DateEditor;}(_textEditor.default);var _default=DateEditor;exports.default=_default;}),(function(module,exports,__webpack_require__){(function(root,factory)
{'use strict';var moment;if(true){try{moment=__webpack_require__(617);}catch(e){}
module.exports=factory(moment);}else if(typeof define==='function'&&define.amd){define(function(req)
{var id='moment';try{moment=req(id);}catch(e){}
return factory(moment);});}else{root.Pikaday=factory(root.moment);}}(this,function(moment)
{'use strict';var hasMoment=typeof moment==='function',hasEventListeners=!!window.addEventListener,document=window.document,sto=window.setTimeout,addEvent=function(el,e,callback,capture)
{if(hasEventListeners){el.addEventListener(e,callback,!!capture);}else{el.attachEvent('on'+e,callback);}},removeEvent=function(el,e,callback,capture)
{if(hasEventListeners){el.removeEventListener(e,callback,!!capture);}else{el.detachEvent('on'+e,callback);}},fireEvent=function(el,eventName,data)
{var ev;if(document.createEvent){ev=document.createEvent('HTMLEvents');ev.initEvent(eventName,true,false);ev=extend(ev,data);el.dispatchEvent(ev);}else if(document.createEventObject){ev=document.createEventObject();ev=extend(ev,data);el.fireEvent('on'+eventName,ev);}},trim=function(str)
{return str.trim?str.trim():str.replace(/^\s+|\s+$/g,'');},hasClass=function(el,cn)
{return(' '+el.className+' ').indexOf(' '+cn+' ')!==-1;},addClass=function(el,cn)
{if(!hasClass(el,cn)){el.className=(el.className==='')?cn:el.className+' '+cn;}},removeClass=function(el,cn)
{el.className=trim((' '+el.className+' ').replace(' '+cn+' ',' '));},isArray=function(obj)
{return(/Array/).test(Object.prototype.toString.call(obj));},isDate=function(obj)
{return(/Date/).test(Object.prototype.toString.call(obj))&&!isNaN(obj.getTime());},isWeekend=function(date)
{var day=date.getDay();return day===0||day===6;},isLeapYear=function(year)
{return year%4===0&&year%100!==0||year%400===0;},getDaysInMonth=function(year,month)
{return[31,isLeapYear(year)?29:28,31,30,31,30,31,31,30,31,30,31][month];},setToStartOfDay=function(date)
{if(isDate(date))date.setHours(0,0,0,0);},compareDates=function(a,b)
{return a.getTime()===b.getTime();},extend=function(to,from,overwrite)
{var prop,hasProp;for(prop in from){hasProp=to[prop]!==undefined;if(hasProp&&typeof from[prop]==='object'&&from[prop]!==null&&from[prop].nodeName===undefined){if(isDate(from[prop])){if(overwrite){to[prop]=new Date(from[prop].getTime());}}
else if(isArray(from[prop])){if(overwrite){to[prop]=from[prop].slice(0);}}else{to[prop]=extend({},from[prop],overwrite);}}else if(overwrite||!hasProp){to[prop]=from[prop];}}
return to;},adjustCalendar=function(calendar){if(calendar.month<0){calendar.year-=Math.ceil(Math.abs(calendar.month)/12);calendar.month+=12;}
if(calendar.month>11){calendar.year+=Math.floor(Math.abs(calendar.month)/12);calendar.month-=12;}
return calendar;},defaults={field:null,bound:undefined,position:'bottom left',reposition:true,format:'YYYY-MM-DD',defaultDate:null,setDefaultDate:false,firstDay:0,formatStrict:false,minDate:null,maxDate:null,yearRange:10,showWeekNumber:false,minYear:0,maxYear:9999,minMonth:undefined,maxMonth:undefined,startRange:null,endRange:null,isRTL:false,yearSuffix:'',showMonthAfterYear:false,showDaysInNextAndPreviousMonths:false,numberOfMonths:1,mainCalendar:'left',container:undefined,i18n:{previousMonth:'Previous Month',nextMonth:'Next Month',months:['January','February','March','April','May','June','July','August','September','October','November','December'],weekdays:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],weekdaysShort:['Sun','Mon','Tue','Wed','Thu','Fri','Sat']},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},renderDayName=function(opts,day,abbr)
{day+=opts.firstDay;while(day>=7){day-=7;}
return abbr?opts.i18n.weekdaysShort[day]:opts.i18n.weekdays[day];},renderDay=function(opts)
{var arr=[];var ariaSelected='false';if(opts.isEmpty){if(opts.showDaysInNextAndPreviousMonths){arr.push('is-outside-current-month');}else{return'<td class="is-empty"></td>';}}
if(opts.isDisabled){arr.push('is-disabled');}
if(opts.isToday){arr.push('is-today');}
if(opts.isSelected){arr.push('is-selected');ariaSelected='true';}
if(opts.isInRange){arr.push('is-inrange');}
if(opts.isStartRange){arr.push('is-startrange');}
if(opts.isEndRange){arr.push('is-endrange');}
return'<td data-day="'+opts.day+'" class="'+arr.join(' ')+'" aria-selected="'+ariaSelected+'">'+'<button class="pika-button pika-day" type="button" '+'data-pika-year="'+opts.year+'" data-pika-month="'+opts.month+'" data-pika-day="'+opts.day+'">'+
opts.day+'</button>'+'</td>';},renderWeek=function(d,m,y){var onejan=new Date(y,0,1),weekNum=Math.ceil((((new Date(y,m,d)-onejan)/86400000)+onejan.getDay()+1)/7);return'<td class="pika-week">'+weekNum+'</td>';},renderRow=function(days,isRTL)
{return'<tr>'+(isRTL?days.reverse():days).join('')+'</tr>';},renderBody=function(rows)
{return'<tbody>'+rows.join('')+'</tbody>';},renderHead=function(opts)
{var i,arr=[];if(opts.showWeekNumber){arr.push('<th></th>');}
for(i=0;i<7;i++){arr.push('<th scope="col"><abbr title="'+renderDayName(opts,i)+'">'+renderDayName(opts,i,true)+'</abbr></th>');}
return'<thead><tr>'+(opts.isRTL?arr.reverse():arr).join('')+'</tr></thead>';},renderTitle=function(instance,c,year,month,refYear,randId)
{var i,j,arr,opts=instance._o,isMinYear=year===opts.minYear,isMaxYear=year===opts.maxYear,html='<div id="'+randId+'" class="pika-title" role="heading" aria-live="assertive">',monthHtml,yearHtml,prev=true,next=true;for(arr=[],i=0;i<12;i++){arr.push('<option value="'+(year===refYear?i-c:12+i-c)+'"'+
(i===month?' selected="selected"':'')+
((isMinYear&&i<opts.minMonth)||(isMaxYear&&i>opts.maxMonth)?'disabled="disabled"':'')+'>'+
opts.i18n.months[i]+'</option>');}
monthHtml='<div class="pika-label">'+opts.i18n.months[month]+'<select class="pika-select pika-select-month" tabindex="-1">'+arr.join('')+'</select></div>';if(isArray(opts.yearRange)){i=opts.yearRange[0];j=opts.yearRange[1]+1;}else{i=year-opts.yearRange;j=1+year+opts.yearRange;}
for(arr=[];i<j&&i<=opts.maxYear;i++){if(i>=opts.minYear){arr.push('<option value="'+i+'"'+(i===year?' selected="selected"':'')+'>'+(i)+'</option>');}}
yearHtml='<div class="pika-label">'+year+opts.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+arr.join('')+'</select></div>';if(opts.showMonthAfterYear){html+=yearHtml+monthHtml;}else{html+=monthHtml+yearHtml;}
if(isMinYear&&(month===0||opts.minMonth>=month)){prev=false;}
if(isMaxYear&&(month===11||opts.maxMonth<=month)){next=false;}
if(c===0){html+='<button class="pika-prev'+(prev?'':' is-disabled')+'" type="button">'+opts.i18n.previousMonth+'</button>';}
if(c===(instance._o.numberOfMonths-1)){html+='<button class="pika-next'+(next?'':' is-disabled')+'" type="button">'+opts.i18n.nextMonth+'</button>';}
return html+='</div>';},renderTable=function(opts,data,randId)
{return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+randId+'">'+renderHead(opts)+renderBody(data)+'</table>';},Pikaday=function(options)
{var self=this,opts=self.config(options);self._onMouseDown=function(e)
{if(!self._v){return;}
e=e||window.event;var target=e.target||e.srcElement;if(!target){return;}
if(!hasClass(target,'is-disabled')){if(hasClass(target,'pika-button')&&!hasClass(target,'is-empty')&&!hasClass(target.parentNode,'is-disabled')){self.setDate(new Date(target.getAttribute('data-pika-year'),target.getAttribute('data-pika-month'),target.getAttribute('data-pika-day')));if(opts.bound){sto(function(){self.hide();if(opts.field){opts.field.blur();}},100);}}
else if(hasClass(target,'pika-prev')){self.prevMonth();}
else if(hasClass(target,'pika-next')){self.nextMonth();}}
if(!hasClass(target,'pika-select')){if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;return false;}}else{self._c=true;}};self._onChange=function(e)
{e=e||window.event;var target=e.target||e.srcElement;if(!target){return;}
if(hasClass(target,'pika-select-month')){self.gotoMonth(target.value);}
else if(hasClass(target,'pika-select-year')){self.gotoYear(target.value);}};self._onKeyChange=function(e)
{e=e||window.event;if(self.isVisible()){switch(e.keyCode){case 13:case 27:opts.field.blur();break;case 37:e.preventDefault();self.adjustDate('subtract',1);break;case 38:self.adjustDate('subtract',7);break;case 39:self.adjustDate('add',1);break;case 40:self.adjustDate('add',7);break;}}};self._onInputChange=function(e)
{var date;if(e.firedBy===self){return;}
if(hasMoment){date=moment(opts.field.value,opts.format,opts.formatStrict);date=(date&&date.isValid())?date.toDate():null;}
else{date=new Date(Date.parse(opts.field.value));}
if(isDate(date)){self.setDate(date);}
if(!self._v){self.show();}};self._onInputFocus=function()
{self.show();};self._onInputClick=function()
{self.show();};self._onInputBlur=function()
{var pEl=document.activeElement;do{if(hasClass(pEl,'pika-single')){return;}}
while((pEl=pEl.parentNode));if(!self._c){self._b=sto(function(){self.hide();},50);}
self._c=false;};self._onClick=function(e)
{e=e||window.event;var target=e.target||e.srcElement,pEl=target;if(!target){return;}
if(!hasEventListeners&&hasClass(target,'pika-select')){if(!target.onchange){target.setAttribute('onchange','return;');addEvent(target,'change',self._onChange);}}
do{if(hasClass(pEl,'pika-single')||pEl===opts.trigger){return;}}
while((pEl=pEl.parentNode));if(self._v&&target!==opts.trigger&&pEl!==opts.trigger){self.hide();}};self.el=document.createElement('div');self.el.className='pika-single'+(opts.isRTL?' is-rtl':'')+(opts.theme?' '+opts.theme:'');addEvent(self.el,'mousedown',self._onMouseDown,true);addEvent(self.el,'touchend',self._onMouseDown,true);addEvent(self.el,'change',self._onChange);addEvent(document,'keydown',self._onKeyChange);if(opts.field){if(opts.container){opts.container.appendChild(self.el);}else if(opts.bound){document.body.appendChild(self.el);}else{opts.field.parentNode.insertBefore(self.el,opts.field.nextSibling);}
addEvent(opts.field,'change',self._onInputChange);if(!opts.defaultDate){if(hasMoment&&opts.field.value){opts.defaultDate=moment(opts.field.value,opts.format).toDate();}else{opts.defaultDate=new Date(Date.parse(opts.field.value));}
opts.setDefaultDate=true;}}
var defDate=opts.defaultDate;if(isDate(defDate)){if(opts.setDefaultDate){self.setDate(defDate,true);}else{self.gotoDate(defDate);}}else{self.gotoDate(new Date());}
if(opts.bound){this.hide();self.el.className+=' is-bound';addEvent(opts.trigger,'click',self._onInputClick);addEvent(opts.trigger,'focus',self._onInputFocus);addEvent(opts.trigger,'blur',self._onInputBlur);}else{this.show();}};Pikaday.prototype={config:function(options)
{if(!this._o){this._o=extend({},defaults,true);}
var opts=extend(this._o,options,true);opts.isRTL=!!opts.isRTL;opts.field=(opts.field&&opts.field.nodeName)?opts.field:null;opts.theme=(typeof opts.theme)==='string'&&opts.theme?opts.theme:null;opts.bound=!!(opts.bound!==undefined?opts.field&&opts.bound:opts.field);opts.trigger=(opts.trigger&&opts.trigger.nodeName)?opts.trigger:opts.field;opts.disableWeekends=!!opts.disableWeekends;opts.disableDayFn=(typeof opts.disableDayFn)==='function'?opts.disableDayFn:null;var nom=parseInt(opts.numberOfMonths,10)||1;opts.numberOfMonths=nom>4?4:nom;if(!isDate(opts.minDate)){opts.minDate=false;}
if(!isDate(opts.maxDate)){opts.maxDate=false;}
if((opts.minDate&&opts.maxDate)&&opts.maxDate<opts.minDate){opts.maxDate=opts.minDate=false;}
if(opts.minDate){this.setMinDate(opts.minDate);}
if(opts.maxDate){this.setMaxDate(opts.maxDate);}
if(isArray(opts.yearRange)){var fallback=new Date().getFullYear()-10;opts.yearRange[0]=parseInt(opts.yearRange[0],10)||fallback;opts.yearRange[1]=parseInt(opts.yearRange[1],10)||fallback;}else{opts.yearRange=Math.abs(parseInt(opts.yearRange,10))||defaults.yearRange;if(opts.yearRange>100){opts.yearRange=100;}}
return opts;},toString:function(format)
{return!isDate(this._d)?'':hasMoment?moment(this._d).format(format||this._o.format):this._d.toDateString();},getMoment:function()
{return hasMoment?moment(this._d):null;},setMoment:function(date,preventOnSelect)
{if(hasMoment&&moment.isMoment(date)){this.setDate(date.toDate(),preventOnSelect);}},getDate:function()
{return isDate(this._d)?new Date(this._d.getTime()):new Date();},setDate:function(date,preventOnSelect)
{if(!date){this._d=null;if(this._o.field){this._o.field.value='';fireEvent(this._o.field,'change',{firedBy:this});}
return this.draw();}
if(typeof date==='string'){date=new Date(Date.parse(date));}
if(!isDate(date)){return;}
var min=this._o.minDate,max=this._o.maxDate;if(isDate(min)&&date<min){date=min;}else if(isDate(max)&&date>max){date=max;}
this._d=new Date(date.getTime());setToStartOfDay(this._d);this.gotoDate(this._d);if(this._o.field){this._o.field.value=this.toString();fireEvent(this._o.field,'change',{firedBy:this});}
if(!preventOnSelect&&typeof this._o.onSelect==='function'){this._o.onSelect.call(this,this.getDate());}},gotoDate:function(date)
{var newCalendar=true;if(!isDate(date)){return;}
if(this.calendars){var firstVisibleDate=new Date(this.calendars[0].year,this.calendars[0].month,1),lastVisibleDate=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),visibleDate=date.getTime();lastVisibleDate.setMonth(lastVisibleDate.getMonth()+1);lastVisibleDate.setDate(lastVisibleDate.getDate()-1);newCalendar=(visibleDate<firstVisibleDate.getTime()||lastVisibleDate.getTime()<visibleDate);}
if(newCalendar){this.calendars=[{month:date.getMonth(),year:date.getFullYear()}];if(this._o.mainCalendar==='right'){this.calendars[0].month+=1-this._o.numberOfMonths;}}
this.adjustCalendars();},adjustDate:function(sign,days){var day=this.getDate();var difference=parseInt(days)*24*60*60*1000;var newDay;if(sign==='add'){newDay=new Date(day.valueOf()+difference);}else if(sign==='subtract'){newDay=new Date(day.valueOf()-difference);}
if(hasMoment){if(sign==='add'){newDay=moment(day).add(days,"days").toDate();}else if(sign==='subtract'){newDay=moment(day).subtract(days,"days").toDate();}}
this.setDate(newDay);},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(var c=1;c<this._o.numberOfMonths;c++){this.calendars[c]=adjustCalendar({month:this.calendars[0].month+c,year:this.calendars[0].year});}
this.draw();},gotoToday:function()
{this.gotoDate(new Date());},gotoMonth:function(month)
{if(!isNaN(month)){this.calendars[0].month=parseInt(month,10);this.adjustCalendars();}},nextMonth:function()
{this.calendars[0].month++;this.adjustCalendars();},prevMonth:function()
{this.calendars[0].month--;this.adjustCalendars();},gotoYear:function(year)
{if(!isNaN(year)){this.calendars[0].year=parseInt(year,10);this.adjustCalendars();}},setMinDate:function(value)
{if(value instanceof Date){setToStartOfDay(value);this._o.minDate=value;this._o.minYear=value.getFullYear();this._o.minMonth=value.getMonth();}else{this._o.minDate=defaults.minDate;this._o.minYear=defaults.minYear;this._o.minMonth=defaults.minMonth;this._o.startRange=defaults.startRange;}
this.draw();},setMaxDate:function(value)
{if(value instanceof Date){setToStartOfDay(value);this._o.maxDate=value;this._o.maxYear=value.getFullYear();this._o.maxMonth=value.getMonth();}else{this._o.maxDate=defaults.maxDate;this._o.maxYear=defaults.maxYear;this._o.maxMonth=defaults.maxMonth;this._o.endRange=defaults.endRange;}
this.draw();},setStartRange:function(value)
{this._o.startRange=value;},setEndRange:function(value)
{this._o.endRange=value;},draw:function(force)
{if(!this._v&&!force){return;}
var opts=this._o,minYear=opts.minYear,maxYear=opts.maxYear,minMonth=opts.minMonth,maxMonth=opts.maxMonth,html='',randId;if(this._y<=minYear){this._y=minYear;if(!isNaN(minMonth)&&this._m<minMonth){this._m=minMonth;}}
if(this._y>=maxYear){this._y=maxYear;if(!isNaN(maxMonth)&&this._m>maxMonth){this._m=maxMonth;}}
randId='pika-title-'+Math.random().toString(36).replace(/[^a-z]+/g,'').substr(0,2);for(var c=0;c<opts.numberOfMonths;c++){html+='<div class="pika-lendar">'+renderTitle(this,c,this.calendars[c].year,this.calendars[c].month,this.calendars[0].year,randId)+this.render(this.calendars[c].year,this.calendars[c].month,randId)+'</div>';}
this.el.innerHTML=html;if(opts.bound){if(opts.field.type!=='hidden'){sto(function(){opts.trigger.focus();},1);}}
if(typeof this._o.onDraw==='function'){this._o.onDraw(this);}
if(opts.bound){opts.field.setAttribute('aria-label','Use the arrow keys to pick a date');}},adjustPosition:function()
{var field,pEl,width,height,viewportWidth,viewportHeight,scrollTop,left,top,clientRect;if(this._o.container)return;this.el.style.position='absolute';field=this._o.trigger;pEl=field;width=this.el.offsetWidth;height=this.el.offsetHeight;viewportWidth=window.innerWidth||document.documentElement.clientWidth;viewportHeight=window.innerHeight||document.documentElement.clientHeight;scrollTop=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;if(typeof field.getBoundingClientRect==='function'){clientRect=field.getBoundingClientRect();left=clientRect.left+window.pageXOffset;top=clientRect.bottom+window.pageYOffset;}else{left=pEl.offsetLeft;top=pEl.offsetTop+pEl.offsetHeight;while((pEl=pEl.offsetParent)){left+=pEl.offsetLeft;top+=pEl.offsetTop;}}
if((this._o.reposition&&left+width>viewportWidth)||(this._o.position.indexOf('right')>-1&&left-width+field.offsetWidth>0)){left=left-width+field.offsetWidth;}
if((this._o.reposition&&top+height>viewportHeight+scrollTop)||(this._o.position.indexOf('top')>-1&&top-height-field.offsetHeight>0)){top=top-height-field.offsetHeight;}
this.el.style.left=left+'px';this.el.style.top=top+'px';},render:function(year,month,randId)
{var opts=this._o,now=new Date(),days=getDaysInMonth(year,month),before=new Date(year,month,1).getDay(),data=[],row=[];setToStartOfDay(now);if(opts.firstDay>0){before-=opts.firstDay;if(before<0){before+=7;}}
var previousMonth=month===0?11:month-1,nextMonth=month===11?0:month+1,yearOfPreviousMonth=month===0?year-1:year,yearOfNextMonth=month===11?year+1:year,daysInPreviousMonth=getDaysInMonth(yearOfPreviousMonth,previousMonth);var cells=days+before,after=cells;while(after>7){after-=7;}
cells+=7-after;for(var i=0,r=0;i<cells;i++)
{var day=new Date(year,month,1+(i-before)),isSelected=isDate(this._d)?compareDates(day,this._d):false,isToday=compareDates(day,now),isEmpty=i<before||i>=(days+before),dayNumber=1+(i-before),monthNumber=month,yearNumber=year,isStartRange=opts.startRange&&compareDates(opts.startRange,day),isEndRange=opts.endRange&&compareDates(opts.endRange,day),isInRange=opts.startRange&&opts.endRange&&opts.startRange<day&&day<opts.endRange,isDisabled=(opts.minDate&&day<opts.minDate)||(opts.maxDate&&day>opts.maxDate)||(opts.disableWeekends&&isWeekend(day))||(opts.disableDayFn&&opts.disableDayFn(day));if(isEmpty){if(i<before){dayNumber=daysInPreviousMonth+dayNumber;monthNumber=previousMonth;yearNumber=yearOfPreviousMonth;}else{dayNumber=dayNumber-days;monthNumber=nextMonth;yearNumber=yearOfNextMonth;}}
var dayConfig={day:dayNumber,month:monthNumber,year:yearNumber,isSelected:isSelected,isToday:isToday,isDisabled:isDisabled,isEmpty:isEmpty,isStartRange:isStartRange,isEndRange:isEndRange,isInRange:isInRange,showDaysInNextAndPreviousMonths:opts.showDaysInNextAndPreviousMonths};row.push(renderDay(dayConfig));if(++r===7){if(opts.showWeekNumber){row.unshift(renderWeek(i-before,month,year));}
data.push(renderRow(row,opts.isRTL));row=[];r=0;}}
return renderTable(opts,data,randId);},isVisible:function()
{return this._v;},show:function()
{if(!this.isVisible()){removeClass(this.el,'is-hidden');this._v=true;this.draw();if(this._o.bound){addEvent(document,'click',this._onClick);this.adjustPosition();}
if(typeof this._o.onOpen==='function'){this._o.onOpen.call(this);}}},hide:function()
{var v=this._v;if(v!==false){if(this._o.bound){removeEvent(document,'click',this._onClick);}
this.el.style.position='static';this.el.style.left='auto';this.el.style.top='auto';addClass(this.el,'is-hidden');this._v=false;if(v!==undefined&&typeof this._o.onClose==='function'){this._o.onClose.call(this);}}},destroy:function()
{this.hide();removeEvent(this.el,'mousedown',this._onMouseDown,true);removeEvent(this.el,'touchend',this._onMouseDown,true);removeEvent(this.el,'change',this._onChange);if(this._o.field){removeEvent(this._o.field,'change',this._onInputChange);if(this._o.bound){removeEvent(this._o.trigger,'click',this._onInputClick);removeEvent(this._o.trigger,'focus',this._onInputFocus);removeEvent(this._o.trigger,'blur',this._onInputBlur);}}
if(this.el.parentNode){this.el.parentNode.removeChild(this.el);}}};return Pikaday;}));}),(function(module,exports,__webpack_require__){(function(module){var require;;(function(global,factory){true?module.exports=factory():typeof define==='function'&&define.amd?define(factory):global.moment=factory()}(this,(function(){'use strict';var hookCallback;function hooks(){return hookCallback.apply(null,arguments);}
function setHookCallback(callback){hookCallback=callback;}
function isArray(input){return input instanceof Array||Object.prototype.toString.call(input)==='[object Array]';}
function isObject(input){return input!=null&&Object.prototype.toString.call(input)==='[object Object]';}
function isObjectEmpty(obj){if(Object.getOwnPropertyNames){return(Object.getOwnPropertyNames(obj).length===0);}else{var k;for(k in obj){if(obj.hasOwnProperty(k)){return false;}}
return true;}}
function isUndefined(input){return input===void 0;}
function isNumber(input){return typeof input==='number'||Object.prototype.toString.call(input)==='[object Number]';}
function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==='[object Date]';}
function map(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i));}
return res;}
function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b);}
function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i];}}
if(hasOwnProp(b,'toString')){a.toString=b.toString;}
if(hasOwnProp(b,'valueOf')){a.valueOf=b.valueOf;}
return a;}
function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc();}
function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],meridiem:null,rfc2822:false,weekdayMismatch:false};}
function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags();}
return m._pf;}
var some;if(Array.prototype.some){some=Array.prototype.some;}else{some=function(fun){var t=Object(this);var len=t.length>>>0;for(var i=0;i<len;i++){if(i in t&&fun.call(this,t[i],i,t)){return true;}}
return false;};}
function isValid(m){if(m._isValid==null){var flags=getParsingFlags(m);var parsedParts=some.call(flags.parsedDateParts,function(i){return i!=null;});var isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||(flags.meridiem&&parsedParts));if(m._strict){isNowValid=isNowValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined;}
if(Object.isFrozen==null||!Object.isFrozen(m)){m._isValid=isNowValid;}
else{return isNowValid;}}
return m._isValid;}
function createInvalid(flags){var m=createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags);}
else{getParsingFlags(m).userInvalidated=true;}
return m;}
var momentProperties=hooks.momentProperties=[];function copyConfig(to,from){var i,prop,val;if(!isUndefined(from._isAMomentObject)){to._isAMomentObject=from._isAMomentObject;}
if(!isUndefined(from._i)){to._i=from._i;}
if(!isUndefined(from._f)){to._f=from._f;}
if(!isUndefined(from._l)){to._l=from._l;}
if(!isUndefined(from._strict)){to._strict=from._strict;}
if(!isUndefined(from._tzm)){to._tzm=from._tzm;}
if(!isUndefined(from._isUTC)){to._isUTC=from._isUTC;}
if(!isUndefined(from._offset)){to._offset=from._offset;}
if(!isUndefined(from._pf)){to._pf=getParsingFlags(from);}
if(!isUndefined(from._locale)){to._locale=from._locale;}
if(momentProperties.length>0){for(i=0;i<momentProperties.length;i++){prop=momentProperties[i];val=from[prop];if(!isUndefined(val)){to[prop]=val;}}}
return to;}
var updateInProgress=false;function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN);}
if(updateInProgress===false){updateInProgress=true;hooks.updateOffset(this);updateInProgress=false;}}
function isMoment(obj){return obj instanceof Moment||(obj!=null&&obj._isAMomentObject!=null);}
function absFloor(number){if(number<0){return Math.ceil(number)||0;}else{return Math.floor(number);}}
function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber);}
return value;}
function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if((dontConvert&&array1[i]!==array2[i])||(!dontConvert&&toInt(array1[i])!==toInt(array2[i]))){diffs++;}}
return diffs+lengthDiff;}
function warn(msg){if(hooks.suppressDeprecationWarnings===false&&(typeof console!=='undefined')&&console.warn){console.warn('Deprecation warning: '+msg);}}
function deprecate(msg,fn){var firstTime=true;return extend(function(){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(null,msg);}
if(firstTime){var args=[];var arg;for(var i=0;i<arguments.length;i++){arg='';if(typeof arguments[i]==='object'){arg+='\n['+i+'] ';for(var key in arguments[0]){arg+=key+': '+arguments[0][key]+', ';}
arg=arg.slice(0,-2);}else{arg=arguments[i];}
args.push(arg);}
warn(msg+'\nArguments: '+Array.prototype.slice.call(args).join('')+'\n'+(new Error()).stack);firstTime=false;}
return fn.apply(this,arguments);},fn);}
var deprecations={};function deprecateSimple(name,msg){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(name,msg);}
if(!deprecations[name]){warn(msg);deprecations[name]=true;}}
hooks.suppressDeprecationWarnings=false;hooks.deprecationHandler=null;function isFunction(input){return input instanceof Function||Object.prototype.toString.call(input)==='[object Function]';}
function set(config){var prop,i;for(i in config){prop=config[i];if(isFunction(prop)){this[i]=prop;}else{this['_'+i]=prop;}}
this._config=config;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+'|'+(/\d{1,2}/).source);}
function mergeConfigs(parentConfig,childConfig){var res=extend({},parentConfig),prop;for(prop in childConfig){if(hasOwnProp(childConfig,prop)){if(isObject(parentConfig[prop])&&isObject(childConfig[prop])){res[prop]={};extend(res[prop],parentConfig[prop]);extend(res[prop],childConfig[prop]);}else if(childConfig[prop]!=null){res[prop]=childConfig[prop];}else{delete res[prop];}}}
for(prop in parentConfig){if(hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])){res[prop]=extend({},res[prop]);}}
return res;}
function Locale(config){if(config!=null){this.set(config);}}
var keys;if(Object.keys){keys=Object.keys;}else{keys=function(obj){var i,res=[];for(i in obj){if(hasOwnProp(obj,i)){res.push(i);}}
return res;};}
var defaultCalendar={sameDay:'[Today at] LT',nextDay:'[Tomorrow at] LT',nextWeek:'dddd [at] LT',lastDay:'[Yesterday at] LT',lastWeek:'[Last] dddd [at] LT',sameElse:'L'};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar['sameElse'];return isFunction(output)?output.call(mom,now):output;}
var defaultLongDateFormat={LTS:'h:mm:ss A',LT:'h:mm A',L:'MM/DD/YYYY',LL:'MMMM D, YYYY',LLL:'MMMM D, YYYY h:mm A',LLLL:'dddd, MMMM D, YYYY h:mm A'};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format;}
this._longDateFormat[key]=formatUpper.replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1);});return this._longDateFormat[key];}
var defaultInvalidDate='Invalid date';function invalidDate(){return this._invalidDate;}
var defaultOrdinal='%d';var defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace('%d',number);}
var defaultRelativeTime={future:'in %s',past:'%s ago',s:'a few seconds',ss:'%d seconds',m:'a minute',mm:'%d minutes',h:'an hour',hh:'%d hours',d:'a day',dd:'%d days',M:'a month',MM:'%d months',y:'a year',yy:'%d years'};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return(isFunction(output))?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number);}
function pastFuture(diff,output){var format=this._relativeTime[diff>0?'future':'past'];return isFunction(format)?format(output):format.replace(/%s/i,output);}
var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+'s']=aliases[shorthand]=unit;}
function normalizeUnits(units){return typeof units==='string'?aliases[units]||aliases[units.toLowerCase()]:undefined;}
function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop];}}}
return normalizedInput;}
var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority;}
function getPrioritizedUnits(unitsObj){var units=[];for(var u in unitsObj){units.push({unit:u,priority:priorities[u]});}
units.sort(function(a,b){return a.priority-b.priority;});return units;}
function zeroFill(number,targetLength,forceSign){var absNumber=''+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?(forceSign?'+':''):'-')+
Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber;}
var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;var localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;var formatFunctions={};var formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==='string'){func=function(){return this[callback]();};}
if(token){formatTokenFunctions[token]=func;}
if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2]);};}
if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token);};}}
function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,'');}
return input.replace(/\\/g,'');}
function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]];}else{array[i]=removeFormattingTokens(array[i]);}}
return function(mom){var output='',i;for(i=0;i<length;i++){output+=isFunction(array[i])?array[i].call(mom,format):array[i];}
return output;};}
function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate();}
format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m);}
function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input;}
localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1;}
return format;}
var match1=/\d/;var match2=/\d\d/;var match3=/\d{3}/;var match4=/\d{4}/;var match6=/[+-]?\d{6}/;var match1to2=/\d\d?/;var match3to4=/\d\d\d\d?/;var match5to6=/\d\d\d\d\d\d?/;var match1to3=/\d{1,3}/;var match1to4=/\d{1,4}/;var match1to6=/[+-]?\d{1,6}/;var matchUnsigned=/\d+/;var matchSigned=/[+-]?\d+/;var matchOffset=/Z|[+-]\d\d:?\d\d/gi;var matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi;var matchTimestamp=/[+-]?\d+(\.\d{1,3})?/;var matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;var regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return(isStrict&&strictRegex)?strictRegex:regex;};}
function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token));}
return regexes[token](config._strict,config._locale);}
function unescapeFormat(s){return regexEscape(s.replace('\\','').replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4;}));}
function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');}
var tokens={};function addParseToken(token,callback){var i,func=callback;if(typeof token==='string'){token=[token];}
if(isNumber(callback)){func=function(input,array){array[callback]=toInt(input);};}
for(i=0;i<token.length;i++){tokens[token[i]]=func;}}
function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token);});}
function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token);}}
var YEAR=0;var MONTH=1;var DATE=2;var HOUR=3;var MINUTE=4;var SECOND=5;var MILLISECOND=6;var WEEK=7;var WEEKDAY=8;addFormatToken('Y',0,0,function(){var y=this.year();return y<=9999?''+y:'+'+y;});addFormatToken(0,['YY',2],0,function(){return this.year()%100;});addFormatToken(0,['YYYY',4],0,'year');addFormatToken(0,['YYYYY',5],0,'year');addFormatToken(0,['YYYYYY',6,true],0,'year');addUnitAlias('year','y');addUnitPriority('year',1);addRegexToken('Y',matchSigned);addRegexToken('YY',match1to2,match2);addRegexToken('YYYY',match1to4,match4);addRegexToken('YYYYY',match1to6,match6);addRegexToken('YYYYYY',match1to6,match6);addParseToken(['YYYYY','YYYYYY'],YEAR);addParseToken('YYYY',function(input,array){array[YEAR]=input.length===2?hooks.parseTwoDigitYear(input):toInt(input);});addParseToken('YY',function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input);});addParseToken('Y',function(input,array){array[YEAR]=parseInt(input,10);});function daysInYear(year){return isLeapYear(year)?366:365;}
function isLeapYear(year){return(year%4===0&&year%100!==0)||year%400===0;}
hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2000);};var getSetYear=makeGetSet('FullYear',true);function getIsLeapYear(){return isLeapYear(this.year());}
function makeGetSet(unit,keepTime){return function(value){if(value!=null){set$1(this,unit,value);hooks.updateOffset(this,keepTime);return this;}else{return get(this,unit);}};}
function get(mom,unit){return mom.isValid()?mom._d['get'+(mom._isUTC?'UTC':'')+unit]():NaN;}
function set$1(mom,unit,value){if(mom.isValid()&&!isNaN(value)){if(unit==='FullYear'&&isLeapYear(mom.year())&&mom.month()===1&&mom.date()===29){mom._d['set'+(mom._isUTC?'UTC':'')+unit](value,mom.month(),daysInMonth(value,mom.month()));}
else{mom._d['set'+(mom._isUTC?'UTC':'')+unit](value);}}}
function stringGet(units){units=normalizeUnits(units);if(isFunction(this[units])){return this[units]();}
return this;}
function stringSet(units,value){if(typeof units==='object'){units=normalizeObjectUnits(units);var prioritized=getPrioritizedUnits(units);for(var i=0;i<prioritized.length;i++){this[prioritized[i].unit](units[prioritized[i].unit]);}}else{units=normalizeUnits(units);if(isFunction(this[units])){return this[units](value);}}
return this;}
function mod(n,x){return((n%x)+x)%x;}
var indexOf;if(Array.prototype.indexOf){indexOf=Array.prototype.indexOf;}else{indexOf=function(o){var i;for(i=0;i<this.length;++i){if(this[i]===o){return i;}}
return-1;};}
function daysInMonth(year,month){if(isNaN(year)||isNaN(month)){return NaN;}
var modMonth=mod(month,12);year+=(month-modMonth)/12;return modMonth===1?(isLeapYear(year)?29:28):(31-modMonth%7%2);}
addFormatToken('M',['MM',2],'Mo',function(){return this.month()+1;});addFormatToken('MMM',0,0,function(format){return this.localeData().monthsShort(this,format);});addFormatToken('MMMM',0,0,function(format){return this.localeData().months(this,format);});addUnitAlias('month','M');addUnitPriority('month',8);addRegexToken('M',match1to2);addRegexToken('MM',match1to2,match2);addRegexToken('MMM',function(isStrict,locale){return locale.monthsShortRegex(isStrict);});addRegexToken('MMMM',function(isStrict,locale){return locale.monthsRegex(isStrict);});addParseToken(['M','MM'],function(input,array){array[MONTH]=toInt(input)-1;});addParseToken(['MMM','MMMM'],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month;}else{getParsingFlags(config).invalidMonth=input;}});var MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;var defaultLocaleMonths='January_February_March_April_May_June_July_August_September_October_November_December'.split('_');function localeMonths(m,format){if(!m){return isArray(this._months)?this._months:this._months['standalone'];}
return isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?'format':'standalone'][m.month()];}
var defaultLocaleMonthsShort='Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');function localeMonthsShort(m,format){if(!m){return isArray(this._monthsShort)?this._monthsShort:this._monthsShort['standalone'];}
return isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?'format':'standalone'][m.month()];}
function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){mom=createUTC([2000,i]);this._shortMonthsParse[i]=this.monthsShort(mom,'').toLocaleLowerCase();this._longMonthsParse[i]=this.months(mom,'').toLocaleLowerCase();}}
if(strict){if(format==='MMM'){ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null;}}else{if(format==='MMM'){ii=indexOf.call(this._shortMonthsParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._longMonthsParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null;}}}
function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact){return handleStrictParse.call(this,monthName,format,strict);}
if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];}
for(i=0;i<12;i++){mom=createUTC([2000,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp('^'+this.months(mom,'').replace('.','')+'$','i');this._shortMonthsParse[i]=new RegExp('^'+this.monthsShort(mom,'').replace('.','')+'$','i');}
if(!strict&&!this._monthsParse[i]){regex='^'+this.months(mom,'')+'|^'+this.monthsShort(mom,'');this._monthsParse[i]=new RegExp(regex.replace('.',''),'i');}
if(strict&&format==='MMMM'&&this._longMonthsParse[i].test(monthName)){return i;}else if(strict&&format==='MMM'&&this._shortMonthsParse[i].test(monthName)){return i;}else if(!strict&&this._monthsParse[i].test(monthName)){return i;}}}
function setMonth(mom,value){var dayOfMonth;if(!mom.isValid()){return mom;}
if(typeof value==='string'){if(/^\d+$/.test(value)){value=toInt(value);}else{value=mom.localeData().monthsParse(value);if(!isNumber(value)){return mom;}}}
dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d['set'+(mom._isUTC?'UTC':'')+'Month'](value,dayOfMonth);return mom;}
function getSetMonth(value){if(value!=null){setMonth(this,value);hooks.updateOffset(this,true);return this;}else{return get(this,'Month');}}
function getDaysInMonth(){return daysInMonth(this.year(),this.month());}
var defaultMonthsShortRegex=matchWord;function monthsShortRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,'_monthsRegex')){computeMonthsParse.call(this);}
if(isStrict){return this._monthsShortStrictRegex;}else{return this._monthsShortRegex;}}else{if(!hasOwnProp(this,'_monthsShortRegex')){this._monthsShortRegex=defaultMonthsShortRegex;}
return this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex;}}
var defaultMonthsRegex=matchWord;function monthsRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,'_monthsRegex')){computeMonthsParse.call(this);}
if(isStrict){return this._monthsStrictRegex;}else{return this._monthsRegex;}}else{if(!hasOwnProp(this,'_monthsRegex')){this._monthsRegex=defaultMonthsRegex;}
return this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex;}}
function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length;}
var shortPieces=[],longPieces=[],mixedPieces=[],i,mom;for(i=0;i<12;i++){mom=createUTC([2000,i]);shortPieces.push(this.monthsShort(mom,''));longPieces.push(this.months(mom,''));mixedPieces.push(this.months(mom,''));mixedPieces.push(this.monthsShort(mom,''));}
shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<12;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i]);}
for(i=0;i<24;i++){mixedPieces[i]=regexEscape(mixedPieces[i]);}
this._monthsRegex=new RegExp('^('+mixedPieces.join('|')+')','i');this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp('^('+longPieces.join('|')+')','i');this._monthsShortStrictRegex=new RegExp('^('+shortPieces.join('|')+')','i');}
function createDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<100&&y>=0&&isFinite(date.getFullYear())){date.setFullYear(y);}
return date;}
function createUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<100&&y>=0&&isFinite(date.getUTCFullYear())){date.setUTCFullYear(y);}
return date;}
function firstWeekOffset(year,dow,doy){var
fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1;}
function dayOfYearFromWeeks(year,week,weekday,dow,doy){var localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset,resYear,resDayOfYear;if(dayOfYear<=0){resYear=year-1;resDayOfYear=daysInYear(resYear)+dayOfYear;}else if(dayOfYear>daysInYear(year)){resYear=year+1;resDayOfYear=dayOfYear-daysInYear(year);}else{resYear=year;resDayOfYear=dayOfYear;}
return{year:resYear,dayOfYear:resDayOfYear};}
function weekOfYear(mom,dow,doy){var weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1,resWeek,resYear;if(week<1){resYear=mom.year()-1;resWeek=week+weeksInYear(resYear,dow,doy);}else if(week>weeksInYear(mom.year(),dow,doy)){resWeek=week-weeksInYear(mom.year(),dow,doy);resYear=mom.year()+1;}else{resYear=mom.year();resWeek=week;}
return{week:resWeek,year:resYear};}
function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7;}
addFormatToken('w',['ww',2],'wo','week');addFormatToken('W',['WW',2],'Wo','isoWeek');addUnitAlias('week','w');addUnitAlias('isoWeek','W');addUnitPriority('week',5);addUnitPriority('isoWeek',5);addRegexToken('w',match1to2);addRegexToken('ww',match1to2,match2);addRegexToken('W',match1to2);addRegexToken('WW',match1to2,match2);addWeekParseToken(['w','ww','W','WW'],function(input,week,config,token){week[token.substr(0,1)]=toInt(input);});function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week;}
var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow;}
function localeFirstDayOfYear(){return this._week.doy;}
function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,'d');}
function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,'d');}
addFormatToken('d',0,'do','day');addFormatToken('dd',0,0,function(format){return this.localeData().weekdaysMin(this,format);});addFormatToken('ddd',0,0,function(format){return this.localeData().weekdaysShort(this,format);});addFormatToken('dddd',0,0,function(format){return this.localeData().weekdays(this,format);});addFormatToken('e',0,0,'weekday');addFormatToken('E',0,0,'isoWeekday');addUnitAlias('day','d');addUnitAlias('weekday','e');addUnitAlias('isoWeekday','E');addUnitPriority('day',11);addUnitPriority('weekday',11);addUnitPriority('isoWeekday',11);addRegexToken('d',match1to2);addRegexToken('e',match1to2);addRegexToken('E',match1to2);addRegexToken('dd',function(isStrict,locale){return locale.weekdaysMinRegex(isStrict);});addRegexToken('ddd',function(isStrict,locale){return locale.weekdaysShortRegex(isStrict);});addRegexToken('dddd',function(isStrict,locale){return locale.weekdaysRegex(isStrict);});addWeekParseToken(['dd','ddd','dddd'],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);if(weekday!=null){week.d=weekday;}else{getParsingFlags(config).invalidWeekday=input;}});addWeekParseToken(['d','e','E'],function(input,week,config,token){week[token]=toInt(input);});function parseWeekday(input,locale){if(typeof input!=='string'){return input;}
if(!isNaN(input)){return parseInt(input,10);}
input=locale.weekdaysParse(input);if(typeof input==='number'){return input;}
return null;}
function parseIsoWeekday(input,locale){if(typeof input==='string'){return locale.weekdaysParse(input)%7||7;}
return isNaN(input)?null:input;}
var defaultLocaleWeekdays='Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');function localeWeekdays(m,format){if(!m){return isArray(this._weekdays)?this._weekdays:this._weekdays['standalone'];}
return isArray(this._weekdays)?this._weekdays[m.day()]:this._weekdays[this._weekdays.isFormat.test(format)?'format':'standalone'][m.day()];}
var defaultLocaleWeekdaysShort='Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');function localeWeekdaysShort(m){return(m)?this._weekdaysShort[m.day()]:this._weekdaysShort;}
var defaultLocaleWeekdaysMin='Su_Mo_Tu_We_Th_Fr_Sa'.split('_');function localeWeekdaysMin(m){return(m)?this._weekdaysMin[m.day()]:this._weekdaysMin;}
function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){mom=createUTC([2000,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(mom,'').toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(mom,'').toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(mom,'').toLocaleLowerCase();}}
if(strict){if(format==='dddd'){ii=indexOf.call(this._weekdaysParse,llc);return ii!==-1?ii:null;}else if(format==='ddd'){ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}}else{if(format==='dddd'){ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}else if(format==='ddd'){ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null;}else{ii=indexOf.call(this._minWeekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii;}
ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null;}}}
function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact){return handleStrictParse$1.call(this,weekdayName,format,strict);}
if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[];}
for(i=0;i<7;i++){mom=createUTC([2000,1]).day(i);if(strict&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp('^'+this.weekdays(mom,'').replace('.','\\.?')+'$','i');this._shortWeekdaysParse[i]=new RegExp('^'+this.weekdaysShort(mom,'').replace('.','\\.?')+'$','i');this._minWeekdaysParse[i]=new RegExp('^'+this.weekdaysMin(mom,'').replace('.','\\.?')+'$','i');}
if(!this._weekdaysParse[i]){regex='^'+this.weekdays(mom,'')+'|^'+this.weekdaysShort(mom,'')+'|^'+this.weekdaysMin(mom,'');this._weekdaysParse[i]=new RegExp(regex.replace('.',''),'i');}
if(strict&&format==='dddd'&&this._fullWeekdaysParse[i].test(weekdayName)){return i;}else if(strict&&format==='ddd'&&this._shortWeekdaysParse[i].test(weekdayName)){return i;}else if(strict&&format==='dd'&&this._minWeekdaysParse[i].test(weekdayName)){return i;}else if(!strict&&this._weekdaysParse[i].test(weekdayName)){return i;}}}
function getSetDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,'d');}else{return day;}}
function getSetLocaleDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,'d');}
function getSetISODayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN;}
if(input!=null){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7);}else{return this.day()||7;}}
var defaultWeekdaysRegex=matchWord;function weekdaysRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysStrictRegex;}else{return this._weekdaysRegex;}}else{if(!hasOwnProp(this,'_weekdaysRegex')){this._weekdaysRegex=defaultWeekdaysRegex;}
return this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex;}}
var defaultWeekdaysShortRegex=matchWord;function weekdaysShortRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysShortStrictRegex;}else{return this._weekdaysShortRegex;}}else{if(!hasOwnProp(this,'_weekdaysShortRegex')){this._weekdaysShortRegex=defaultWeekdaysShortRegex;}
return this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;}}
var defaultWeekdaysMinRegex=matchWord;function weekdaysMinRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,'_weekdaysRegex')){computeWeekdaysParse.call(this);}
if(isStrict){return this._weekdaysMinStrictRegex;}else{return this._weekdaysMinRegex;}}else{if(!hasOwnProp(this,'_weekdaysMinRegex')){this._weekdaysMinRegex=defaultWeekdaysMinRegex;}
return this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;}}
function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length;}
var minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[],i,mom,minp,shortp,longp;for(i=0;i<7;i++){mom=createUTC([2000,1]).day(i);minp=this.weekdaysMin(mom,'');shortp=this.weekdaysShort(mom,'');longp=this.weekdays(mom,'');minPieces.push(minp);shortPieces.push(shortp);longPieces.push(longp);mixedPieces.push(minp);mixedPieces.push(shortp);mixedPieces.push(longp);}
minPieces.sort(cmpLenRev);shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<7;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i]);mixedPieces[i]=regexEscape(mixedPieces[i]);}
this._weekdaysRegex=new RegExp('^('+mixedPieces.join('|')+')','i');this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp('^('+longPieces.join('|')+')','i');this._weekdaysShortStrictRegex=new RegExp('^('+shortPieces.join('|')+')','i');this._weekdaysMinStrictRegex=new RegExp('^('+minPieces.join('|')+')','i');}
function hFormat(){return this.hours()%12||12;}
function kFormat(){return this.hours()||24;}
addFormatToken('H',['HH',2],0,'hour');addFormatToken('h',['hh',2],0,hFormat);addFormatToken('k',['kk',2],0,kFormat);addFormatToken('hmm',0,0,function(){return''+hFormat.apply(this)+zeroFill(this.minutes(),2);});addFormatToken('hmmss',0,0,function(){return''+hFormat.apply(this)+zeroFill(this.minutes(),2)+
zeroFill(this.seconds(),2);});addFormatToken('Hmm',0,0,function(){return''+this.hours()+zeroFill(this.minutes(),2);});addFormatToken('Hmmss',0,0,function(){return''+this.hours()+zeroFill(this.minutes(),2)+
zeroFill(this.seconds(),2);});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase);});}
meridiem('a',true);meridiem('A',false);addUnitAlias('hour','h');addUnitPriority('hour',13);function matchMeridiem(isStrict,locale){return locale._meridiemParse;}
addRegexToken('a',matchMeridiem);addRegexToken('A',matchMeridiem);addRegexToken('H',match1to2);addRegexToken('h',match1to2);addRegexToken('k',match1to2);addRegexToken('HH',match1to2,match2);addRegexToken('hh',match1to2,match2);addRegexToken('kk',match1to2,match2);addRegexToken('hmm',match3to4);addRegexToken('hmmss',match5to6);addRegexToken('Hmm',match3to4);addRegexToken('Hmmss',match5to6);addParseToken(['H','HH'],HOUR);addParseToken(['k','kk'],function(input,array,config){var kInput=toInt(input);array[HOUR]=kInput===24?0:kInput;});addParseToken(['a','A'],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input;});addParseToken(['h','hh'],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true;});addParseToken('hmm',function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));getParsingFlags(config).bigHour=true;});addParseToken('hmmss',function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));getParsingFlags(config).bigHour=true;});addParseToken('Hmm',function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));});addParseToken('Hmmss',function(input,array,config){var pos1=input.length-4;var pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));});function localeIsPM(input){return((input+'').toLowerCase().charAt(0)==='p');}
var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i;function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?'pm':'PM';}else{return isLower?'am':'AM';}}
var getSetHour=makeGetSet('Hours',true);var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse};var locales={};var localeFamilies={};var globalLocale;function normalizeLocale(key){return key?key.toLowerCase().replace('_','-'):key;}
function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split('-');j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split('-'):null;while(j>0){locale=loadLocale(split.slice(0,j).join('-'));if(locale){return locale;}
if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break;}
j--;}
i++;}
return globalLocale;}
function loadLocale(name){var oldLocale=null;if(!locales[name]&&(typeof module!=='undefined')&&module&&module.exports){try{oldLocale=globalLocale._abbr;var aliasedRequire=require;__webpack_require__(618)("./"+name);getSetGlobalLocale(oldLocale);}catch(e){}}
return locales[name];}
function getSetGlobalLocale(key,values){var data;if(key){if(isUndefined(values)){data=getLocale(key);}
else{data=defineLocale(key,values);}
if(data){globalLocale=data;}
else{if((typeof console!=='undefined')&&console.warn){console.warn('Locale '+key+' not found. Did you forget to load it?');}}}
return globalLocale._abbr;}
function defineLocale(name,config){if(config!==null){var locale,parentConfig=baseConfig;config.abbr=name;if(locales[name]!=null){deprecateSimple('defineLocaleOverride','use moment.updateLocale(localeName, config) to change '+'an existing locale. moment.defineLocale(localeName, '+'config) should only be used for creating a new locale '+'See http://momentjs.com/guides/#/warnings/define-locale/ for more info.');parentConfig=locales[name]._config;}else if(config.parentLocale!=null){if(locales[config.parentLocale]!=null){parentConfig=locales[config.parentLocale]._config;}else{locale=loadLocale(config.parentLocale);if(locale!=null){parentConfig=locale._config;}else{if(!localeFamilies[config.parentLocale]){localeFamilies[config.parentLocale]=[];}
localeFamilies[config.parentLocale].push({name:name,config:config});return null;}}}
locales[name]=new Locale(mergeConfigs(parentConfig,config));if(localeFamilies[name]){localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config);});}
getSetGlobalLocale(name);return locales[name];}else{delete locales[name];return null;}}
function updateLocale(name,config){if(config!=null){var locale,tmpLocale,parentConfig=baseConfig;tmpLocale=loadLocale(name);if(tmpLocale!=null){parentConfig=tmpLocale._config;}
config=mergeConfigs(parentConfig,config);locale=new Locale(config);locale.parentLocale=locales[name];locales[name]=locale;getSetGlobalLocale(name);}else{if(locales[name]!=null){if(locales[name].parentLocale!=null){locales[name]=locales[name].parentLocale;}else if(locales[name]!=null){delete locales[name];}}}
return locales[name];}
function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr;}
if(!key){return globalLocale;}
if(!isArray(key)){locale=loadLocale(key);if(locale){return locale;}
key=[key];}
return chooseLocale(key);}
function listLocales(){return keys(locales);}
function checkOverflow(m){var overflow;var a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||(a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0))?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE;}
if(getParsingFlags(m)._overflowWeeks&&overflow===-1){overflow=WEEK;}
if(getParsingFlags(m)._overflowWeekday&&overflow===-1){overflow=WEEKDAY;}
getParsingFlags(m).overflow=overflow;}
return m;}
function defaults(a,b,c){if(a!=null){return a;}
if(b!=null){return b;}
return c;}
function currentDateArray(config){var nowValue=new Date(hooks.now());if(config._useUTC){return[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()];}
return[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()];}
function configFromArray(config){var i,date,input=[],currentDate,expectedWeekday,yearToUse;if(config._d){return;}
currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config);}
if(config._dayOfYear!=null){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)||config._dayOfYear===0){getParsingFlags(config)._overflowDayOfYear=true;}
date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate();}
for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i];}
for(;i<7;i++){config._a[i]=input[i]=(config._a[i]==null)?(i===2?1:0):config._a[i];}
if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0;}
config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay();if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);}
if(config._nextDay){config._a[HOUR]=24;}
if(config._w&&typeof config._w.d!=='undefined'&&config._w.d!==expectedWeekday){getParsingFlags(config).weekdayMismatch=true;}}
function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1);if(weekday<1||weekday>7){weekdayOverflow=true;}}else{dow=config._locale._week.dow;doy=config._locale._week.doy;var curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults(w.gg,config._a[YEAR],curWeek.year);week=defaults(w.w,curWeek.week);if(w.d!=null){weekday=w.d;if(weekday<0||weekday>6){weekdayOverflow=true;}}else if(w.e!=null){weekday=w.e+dow;if(w.e<0||w.e>6){weekdayOverflow=true;}}else{weekday=dow;}}
if(week<1||week>weeksInYear(weekYear,dow,doy)){getParsingFlags(config)._overflowWeeks=true;}else if(weekdayOverflow!=null){getParsingFlags(config)._overflowWeekday=true;}else{temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear;}}
var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/;var tzRegex=/Z|[+-]\d\d(?::?\d\d)?/;var isoDates=[['YYYYYY-MM-DD',/[+-]\d{6}-\d\d-\d\d/],['YYYY-MM-DD',/\d{4}-\d\d-\d\d/],['GGGG-[W]WW-E',/\d{4}-W\d\d-\d/],['GGGG-[W]WW',/\d{4}-W\d\d/,false],['YYYY-DDD',/\d{4}-\d{3}/],['YYYY-MM',/\d{4}-\d\d/,false],['YYYYYYMMDD',/[+-]\d{10}/],['YYYYMMDD',/\d{8}/],['GGGG[W]WWE',/\d{4}W\d{3}/],['GGGG[W]WW',/\d{4}W\d{2}/,false],['YYYYDDD',/\d{7}/]];var isoTimes=[['HH:mm:ss.SSSS',/\d\d:\d\d:\d\d\.\d+/],['HH:mm:ss,SSSS',/\d\d:\d\d:\d\d,\d+/],['HH:mm:ss',/\d\d:\d\d:\d\d/],['HH:mm',/\d\d:\d\d/],['HHmmss.SSSS',/\d\d\d\d\d\d\.\d+/],['HHmmss,SSSS',/\d\d\d\d\d\d,\d+/],['HHmmss',/\d\d\d\d\d\d/],['HHmm',/\d\d\d\d/],['HH',/\d\d/]];var aspNetJsonRegex=/^\/?Date\((\-?\d+)/i;function configFromISO(config){var i,l,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),allowTime,dateFormat,timeFormat,tzFormat;if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0];allowTime=isoDates[i][2]!==false;break;}}
if(dateFormat==null){config._isValid=false;return;}
if(match[3]){for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||' ')+isoTimes[i][0];break;}}
if(timeFormat==null){config._isValid=false;return;}}
if(!allowTime&&timeFormat!=null){config._isValid=false;return;}
if(match[4]){if(tzRegex.exec(match[4])){tzFormat='Z';}else{config._isValid=false;return;}}
config._f=dateFormat+(timeFormat||'')+(tzFormat||'');configFromStringAndFormat(config);}else{config._isValid=false;}}
var rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];if(secondStr){result.push(parseInt(secondStr,10));}
return result;}
function untruncateYear(yearStr){var year=parseInt(yearStr,10);if(year<=49){return 2000+year;}else if(year<=999){return 1900+year;}
return year;}
function preprocessRFC2822(s){return s.replace(/\([^)]*\)|[\n\t]/g,' ').replace(/(\s\s+)/g,' ').replace(/^\s\s*/,'').replace(/\s\s*$/,'');}
function checkWeekday(weekdayStr,parsedInput,config){if(weekdayStr){var weekdayProvided=defaultLocaleWeekdaysShort.indexOf(weekdayStr),weekdayActual=new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay();if(weekdayProvided!==weekdayActual){getParsingFlags(config).weekdayMismatch=true;config._isValid=false;return false;}}
return true;}
var obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function calculateOffset(obsOffset,militaryOffset,numOffset){if(obsOffset){return obsOffsets[obsOffset];}else if(militaryOffset){return 0;}else{var hm=parseInt(numOffset,10);var m=hm%100,h=(hm-m)/100;return h*60+m;}}
function configFromRFC2822(config){var match=rfc2822.exec(preprocessRFC2822(config._i));if(match){var parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]);if(!checkWeekday(match[1],parsedArray,config)){return;}
config._a=parsedArray;config._tzm=calculateOffset(match[8],match[9],match[10]);config._d=createUTCDate.apply(null,config._a);config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);getParsingFlags(config).rfc2822=true;}else{config._isValid=false;}}
function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return;}
configFromISO(config);if(config._isValid===false){delete config._isValid;}else{return;}
configFromRFC2822(config);if(config._isValid===false){delete config._isValid;}else{return;}
hooks.createFromInputFallback(config);}
hooks.createFromInputFallback=deprecate('value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), '+'which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are '+'discouraged and will be removed in an upcoming major release. Please refer to '+'http://momentjs.com/guides/#/warnings/js-date/ for more info.',function(config){config._d=new Date(config._i+(config._useUTC?' UTC':''));});hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(config){if(config._f===hooks.ISO_8601){configFromISO(config);return;}
if(config._f===hooks.RFC_2822){configFromRFC2822(config);return;}
config._a=[];getParsingFlags(config).empty=true;var string=''+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped);}
string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length;}
if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false;}
else{getParsingFlags(config).unusedTokens.push(token);}
addTimeToArrayFromToken(token,parsedInput,config);}
else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token);}}
getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string);}
if(config._a[HOUR]<=12&&getParsingFlags(config).bigHour===true&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined;}
getParsingFlags(config).parsedDateParts=config._a.slice(0);getParsingFlags(config).meridiem=config._meridiem;config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);configFromArray(config);checkOverflow(config);}
function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour;}
if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem);}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12;}
if(!isPm&&hour===12){hour=0;}
return hour;}else{return hour;}}
function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return;}
for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC;}
tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue;}
currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig;}}
extend(config,bestMoment||tempConfig);}
function configFromObject(config){if(config._d){return;}
var i=normalizeObjectUnits(config._i);config._a=map([i.year,i.month,i.day||i.date,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10);});configFromArray(config);}
function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,'d');res._nextDay=undefined;}
return res;}
function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||getLocale(config._l);if(input===null||(format===undefined&&input==='')){return createInvalid({nullInput:true});}
if(typeof input==='string'){config._i=input=config._locale.preparse(input);}
if(isMoment(input)){return new Moment(checkOverflow(input));}else if(isDate(input)){config._d=input;}else if(isArray(format)){configFromStringAndArray(config);}else if(format){configFromStringAndFormat(config);}else{configFromInput(config);}
if(!isValid(config)){config._d=null;}
return config;}
function configFromInput(config){var input=config._i;if(isUndefined(input)){config._d=new Date(hooks.now());}else if(isDate(input)){config._d=new Date(input.valueOf());}else if(typeof input==='string'){configFromString(config);}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10);});configFromArray(config);}else if(isObject(input)){configFromObject(config);}else if(isNumber(input)){config._d=new Date(input);}else{hooks.createFromInputFallback(config);}}
function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(locale===true||locale===false){strict=locale;locale=undefined;}
if((isObject(input)&&isObjectEmpty(input))||(isArray(input)&&input.length===0)){input=undefined;}
c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c);}
function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false);}
var prototypeMin=deprecate('moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/',function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other<this?this:other;}else{return createInvalid();}});var prototypeMax=deprecate('moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/',function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other>this?this:other;}else{return createInvalid();}});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0];}
if(!moments.length){return createLocal();}
res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i];}}
return res;}
function min(){var args=[].slice.call(arguments,0);return pickBy('isBefore',args);}
function max(){var args=[].slice.call(arguments,0);return pickBy('isAfter',args);}
var now=function(){return Date.now?Date.now():+(new Date());};var ordering=['year','quarter','month','week','day','hour','minute','second','millisecond'];function isDurationValid(m){for(var key in m){if(!(indexOf.call(ordering,key)!==-1&&(m[key]==null||!isNaN(m[key])))){return false;}}
var unitHasDecimal=false;for(var i=0;i<ordering.length;++i){if(m[ordering[i]]){if(unitHasDecimal){return false;}
if(parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])){unitHasDecimal=true;}}}
return true;}
function isValid$1(){return this._isValid;}
function createInvalid$1(){return createDuration(NaN);}
function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||normalizedInput.isoWeek||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=isDurationValid(normalizedInput);this._milliseconds=+milliseconds+
seconds*1e3+
minutes*6e4+
hours*1000*60*60;this._days=+days+
weeks*7;this._months=+months+
quarters*3+
years*12;this._data={};this._locale=getLocale();this._bubble();}
function isDuration(obj){return obj instanceof Duration;}
function absRound(number){if(number<0){return Math.round(-1*number)*-1;}else{return Math.round(number);}}
function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset();var sign='+';if(offset<0){offset=-offset;sign='-';}
return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~(offset)%60,2);});}
offset('Z',':');offset('ZZ','');addRegexToken('Z',matchShortOffset);addRegexToken('ZZ',matchShortOffset);addParseToken(['Z','ZZ'],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(matchShortOffset,input);});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||'').match(matcher);if(matches===null){return null;}
var chunk=matches[matches.length-1]||[];var parts=(chunk+'').match(chunkOffset)||['-',0,0];var minutes=+(parts[1]*60)+toInt(parts[2]);return minutes===0?0:parts[0]==='+'?minutes:-minutes;}
function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf();res._d.setTime(res._d.valueOf()+diff);hooks.updateOffset(res,false);return res;}else{return createLocal(input).local();}}
function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset()/15)*15;}
hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime,keepMinutes){var offset=this._offset||0,localAdjust;if(!this.isValid()){return input!=null?this:NaN;}
if(input!=null){if(typeof input==='string'){input=offsetFromString(matchShortOffset,input);if(input===null){return this;}}else if(Math.abs(input)<16&&!keepMinutes){input=input*60;}
if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this);}
this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,'m');}
if(offset!==input){if(!keepLocalTime||this._changeInProgress){addSubtract(this,createDuration(input-offset,'m'),1,false);}else if(!this._changeInProgress){this._changeInProgress=true;hooks.updateOffset(this,true);this._changeInProgress=null;}}
return this;}else{return this._isUTC?offset:getDateOffset(this);}}
function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=='string'){input=-input;}
this.utcOffset(input,keepLocalTime);return this;}else{return-this.utcOffset();}}
function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime);}
function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),'m');}}
return this;}
function setOffsetToParsedOffset(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true);}else if(typeof this._i==='string'){var tZone=offsetFromString(matchOffset,this._i);if(tZone!=null){this.utcOffset(tZone);}
else{this.utcOffset(0,true);}}
return this;}
function hasAlignedHourOffset(input){if(!this.isValid()){return false;}
input=input?createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0;}
function isDaylightSavingTime(){return(this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset());}
function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted)){return this._isDSTShifted;}
var c={};copyConfig(c,this);c=prepareConfig(c);if(c._a){var other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0;}else{this._isDSTShifted=false;}
return this._isDSTShifted;}
function isLocal(){return this.isValid()?!this._isUTC:false;}
function isUtcOffset(){return this.isValid()?this._isUTC:false;}
function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:false;}
var aspNetRegex=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/;var isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months};}else if(isNumber(input)){duration={};if(key){duration[key]=input;}else{duration.milliseconds=input;}}else if(!!(match=aspNetRegex.exec(input))){sign=(match[1]==='-')?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(match[MILLISECOND]*1000))*sign};}else if(!!(match=isoRegex.exec(input))){sign=(match[1]==='-')?-1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)};}else if(duration==null){duration={};}else if(typeof duration==='object'&&('from'in duration||'to'in duration)){diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months;}
ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,'_locale')){ret._locale=input._locale;}
return ret;}
createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(',','.'));return(isNaN(res)?0:res)*sign;}
function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};res.months=other.month()-base.month()+
(other.year()-base.year())*12;if(base.clone().add(res.months,'M').isAfter(other)){--res.months;}
res.milliseconds=+other-+(base.clone().add(res.months,'M'));return res;}
function momentsDifference(base,other){var res;if(!(base.isValid()&&other.isValid())){return{milliseconds:0,months:0};}
other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other);}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months;}
return res;}
function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,'moment().'+name+'(period, number) is deprecated. Please use moment().'+name+'(number, period). '+'See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.');tmp=val;val=period;period=tmp;}
val=typeof val==='string'?+val:val;dur=createDuration(val,period);addSubtract(this,dur,direction);return this;};}
function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);if(!mom.isValid()){return;}
updateOffset=updateOffset==null?true:updateOffset;if(months){setMonth(mom,get(mom,'Month')+months*isAdding);}
if(days){set$1(mom,'Date',get(mom,'Date')+days*isAdding);}
if(milliseconds){mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding);}
if(updateOffset){hooks.updateOffset(mom,days||months);}}
var add=createAdder(1,'add');var subtract=createAdder(-1,'subtract');function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,'days',true);return diff<-6?'sameElse':diff<-1?'lastWeek':diff<0?'lastDay':diff<1?'sameDay':diff<2?'nextDay':diff<7?'nextWeek':'sameElse';}
function calendar$1(time,formats){var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf('day'),format=hooks.calendarFormat(this,sod)||'sameElse';var output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)));}
function clone(){return new Moment(this);}
function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(units)||'millisecond';if(units==='millisecond'){return this.valueOf()>localInput.valueOf();}else{return localInput.valueOf()<this.clone().startOf(units).valueOf();}}
function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(units)||'millisecond';if(units==='millisecond'){return this.valueOf()<localInput.valueOf();}else{return this.clone().endOf(units).valueOf()<localInput.valueOf();}}
function isBetween(from,to,units,inclusivity){var localFrom=isMoment(from)?from:createLocal(from),localTo=isMoment(to)?to:createLocal(to);if(!(this.isValid()&&localFrom.isValid()&&localTo.isValid())){return false;}
inclusivity=inclusivity||'()';return(inclusivity[0]==='('?this.isAfter(localFrom,units):!this.isBefore(localFrom,units))&&(inclusivity[1]===')'?this.isBefore(localTo,units):!this.isAfter(localTo,units));}
function isSame(input,units){var localInput=isMoment(input)?input:createLocal(input),inputMs;if(!(this.isValid()&&localInput.isValid())){return false;}
units=normalizeUnits(units)||'millisecond';if(units==='millisecond'){return this.valueOf()===localInput.valueOf();}else{inputMs=localInput.valueOf();return this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf();}}
function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units);}
function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units);}
function diff(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid()){return NaN;}
that=cloneWithOffset(input,this);if(!that.isValid()){return NaN;}
zoneDelta=(that.utcOffset()-this.utcOffset())*6e4;units=normalizeUnits(units);switch(units){case'year':output=monthDiff(this,that)/12;break;case'month':output=monthDiff(this,that);break;case'quarter':output=monthDiff(this,that)/3;break;case'second':output=(this-that)/1e3;break;case'minute':output=(this-that)/6e4;break;case'hour':output=(this-that)/36e5;break;case'day':output=(this-that-zoneDelta)/864e5;break;case'week':output=(this-that-zoneDelta)/6048e5;break;default:output=this-that;}
return asFloat?output:absFloor(output);}
function monthDiff(a,b){var wholeMonthDiff=((b.year()-a.year())*12)+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,'months'),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,'months');adjust=(b-anchor)/(anchor-anchor2);}else{anchor2=a.clone().add(wholeMonthDiff+1,'months');adjust=(b-anchor)/(anchor2-anchor);}
return-(wholeMonthDiff+adjust)||0;}
hooks.defaultFormat='YYYY-MM-DDTHH:mm:ssZ';hooks.defaultFormatUtc='YYYY-MM-DDTHH:mm:ss[Z]';function toString(){return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');}
function toISOString(keepOffset){if(!this.isValid()){return null;}
var utc=keepOffset!==true;var m=utc?this.clone().utc():this;if(m.year()<0||m.year()>9999){return formatMoment(m,utc?'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]':'YYYYYY-MM-DD[T]HH:mm:ss.SSSZ');}
if(isFunction(Date.prototype.toISOString)){if(utc){return this.toDate().toISOString();}else{return new Date(this.valueOf()+this.utcOffset()*60*1000).toISOString().replace('Z',formatMoment(m,'Z'));}}
return formatMoment(m,utc?'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]':'YYYY-MM-DD[T]HH:mm:ss.SSSZ');}
function inspect(){if(!this.isValid()){return'moment.invalid(/* '+this._i+' */)';}
var func='moment';var zone='';if(!this.isLocal()){func=this.utcOffset()===0?'moment.utc':'moment.parseZone';zone='Z';}
var prefix='['+func+'("]';var year=(0<=this.year()&&this.year()<=9999)?'YYYY':'YYYYYY';var datetime='-MM-DD[T]HH:mm:ss.SSS';var suffix=zone+'[")]';return this.format(prefix+year+datetime+suffix);}
function format(inputString){if(!inputString){inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat;}
var output=formatMoment(this,inputString);return this.localeData().postformat(output);}
function from(time,withoutSuffix){if(this.isValid()&&((isMoment(time)&&time.isValid())||createLocal(time).isValid())){return createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix);}else{return this.localeData().invalidDate();}}
function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix);}
function to(time,withoutSuffix){if(this.isValid()&&((isMoment(time)&&time.isValid())||createLocal(time).isValid())){return createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix);}else{return this.localeData().invalidDate();}}
function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix);}
function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr;}else{newLocaleData=getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData;}
return this;}}
var lang=deprecate('moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',function(key){if(key===undefined){return this.localeData();}else{return this.locale(key);}});function localeData(){return this._locale;}
function startOf(units){units=normalizeUnits(units);switch(units){case'year':this.month(0);case'quarter':case'month':this.date(1);case'week':case'isoWeek':case'day':case'date':this.hours(0);case'hour':this.minutes(0);case'minute':this.seconds(0);case'second':this.milliseconds(0);}
if(units==='week'){this.weekday(0);}
if(units==='isoWeek'){this.isoWeekday(1);}
if(units==='quarter'){this.month(Math.floor(this.month()/3)*3);}
return this;}
function endOf(units){units=normalizeUnits(units);if(units===undefined||units==='millisecond'){return this;}
if(units==='date'){units='day';}
return this.startOf(units).add(1,(units==='isoWeek'?'week':units)).subtract(1,'ms');}
function valueOf(){return this._d.valueOf()-((this._offset||0)*60000);}
function unix(){return Math.floor(this.valueOf()/1000);}
function toDate(){return new Date(this.valueOf());}
function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()];}
function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()};}
function toJSON(){return this.isValid()?this.toISOString():null;}
function isValid$2(){return isValid(this);}
function parsingFlags(){return extend({},getParsingFlags(this));}
function invalidAt(){return getParsingFlags(this).overflow;}
function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict};}
addFormatToken(0,['gg',2],0,function(){return this.weekYear()%100;});addFormatToken(0,['GG',2],0,function(){return this.isoWeekYear()%100;});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter);}
addWeekYearFormatToken('gggg','weekYear');addWeekYearFormatToken('ggggg','weekYear');addWeekYearFormatToken('GGGG','isoWeekYear');addWeekYearFormatToken('GGGGG','isoWeekYear');addUnitAlias('weekYear','gg');addUnitAlias('isoWeekYear','GG');addUnitPriority('weekYear',1);addUnitPriority('isoWeekYear',1);addRegexToken('G',matchSigned);addRegexToken('g',matchSigned);addRegexToken('GG',match1to2,match2);addRegexToken('gg',match1to2,match2);addRegexToken('GGGG',match1to4,match4);addRegexToken('gggg',match1to4,match4);addRegexToken('GGGGG',match1to6,match6);addRegexToken('ggggg',match1to6,match6);addWeekParseToken(['gggg','ggggg','GGGG','GGGGG'],function(input,week,config,token){week[token.substr(0,2)]=toInt(input);});addWeekParseToken(['gg','GG'],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input);});function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy);}
function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4);}
function getISOWeeksInYear(){return weeksInYear(this.year(),1,4);}
function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy);}
function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;if(input==null){return weekOfYear(this,dow,doy).year;}else{weeksTarget=weeksInYear(input,dow,doy);if(week>weeksTarget){week=weeksTarget;}
return setWeekAll.call(this,input,week,weekday,dow,doy);}}
function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);this.year(date.getUTCFullYear());this.month(date.getUTCMonth());this.date(date.getUTCDate());return this;}
addFormatToken('Q',0,'Qo','quarter');addUnitAlias('quarter','Q');addUnitPriority('quarter',7);addRegexToken('Q',match1);addParseToken('Q',function(input,array){array[MONTH]=(toInt(input)-1)*3;});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3);}
addFormatToken('D',['DD',2],'Do','date');addUnitAlias('date','D');addUnitPriority('date',9);addRegexToken('D',match1to2);addRegexToken('DD',match1to2,match2);addRegexToken('Do',function(isStrict,locale){return isStrict?(locale._dayOfMonthOrdinalParse||locale._ordinalParse):locale._dayOfMonthOrdinalParseLenient;});addParseToken(['D','DD'],DATE);addParseToken('Do',function(input,array){array[DATE]=toInt(input.match(match1to2)[0]);});var getSetDayOfMonth=makeGetSet('Date',true);addFormatToken('DDD',['DDDD',3],'DDDo','dayOfYear');addUnitAlias('dayOfYear','DDD');addUnitPriority('dayOfYear',4);addRegexToken('DDD',match1to3);addRegexToken('DDDD',match3);addParseToken(['DDD','DDDD'],function(input,array,config){config._dayOfYear=toInt(input);});function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf('day')-this.clone().startOf('year'))/864e5)+1;return input==null?dayOfYear:this.add((input-dayOfYear),'d');}
addFormatToken('m',['mm',2],0,'minute');addUnitAlias('minute','m');addUnitPriority('minute',14);addRegexToken('m',match1to2);addRegexToken('mm',match1to2,match2);addParseToken(['m','mm'],MINUTE);var getSetMinute=makeGetSet('Minutes',false);addFormatToken('s',['ss',2],0,'second');addUnitAlias('second','s');addUnitPriority('second',15);addRegexToken('s',match1to2);addRegexToken('ss',match1to2,match2);addParseToken(['s','ss'],SECOND);var getSetSecond=makeGetSet('Seconds',false);addFormatToken('S',0,0,function(){return~~(this.millisecond()/100);});addFormatToken(0,['SS',2],0,function(){return~~(this.millisecond()/10);});addFormatToken(0,['SSS',3],0,'millisecond');addFormatToken(0,['SSSS',4],0,function(){return this.millisecond()*10;});addFormatToken(0,['SSSSS',5],0,function(){return this.millisecond()*100;});addFormatToken(0,['SSSSSS',6],0,function(){return this.millisecond()*1000;});addFormatToken(0,['SSSSSSS',7],0,function(){return this.millisecond()*10000;});addFormatToken(0,['SSSSSSSS',8],0,function(){return this.millisecond()*100000;});addFormatToken(0,['SSSSSSSSS',9],0,function(){return this.millisecond()*1000000;});addUnitAlias('millisecond','ms');addUnitPriority('millisecond',16);addRegexToken('S',match1to3,match1);addRegexToken('SS',match1to3,match2);addRegexToken('SSS',match1to3,match3);var token;for(token='SSSS';token.length<=9;token+='S'){addRegexToken(token,matchUnsigned);}
function parseMs(input,array){array[MILLISECOND]=toInt(('0.'+input)*1000);}
for(token='S';token.length<=9;token+='S'){addParseToken(token,parseMs);}
var getSetMillisecond=makeGetSet('Milliseconds',false);addFormatToken('z',0,0,'zoneAbbr');addFormatToken('zz',0,0,'zoneName');function getZoneAbbr(){return this._isUTC?'UTC':'';}
function getZoneName(){return this._isUTC?'Coordinated Universal Time':'';}
var proto=Moment.prototype;proto.add=add;proto.calendar=calendar$1;proto.clone=clone;proto.diff=diff;proto.endOf=endOf;proto.format=format;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate('dates accessor is deprecated. Use date instead.',getSetDayOfMonth);proto.months=deprecate('months accessor is deprecated. Use month instead',getSetMonth);proto.years=deprecate('years accessor is deprecated. Use year instead',getSetYear);proto.zone=deprecate('moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/',getSetZone);proto.isDSTShifted=deprecate('isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information',isDaylightSavingTimeShifted);function createUnix(input){return createLocal(input*1000);}
function createInZone(){return createLocal.apply(null,arguments).parseZone();}
function preParsePostFormat(string){return string;}
var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(format,index,field,setter){var locale=getLocale();var utc=createUTC().set(setter,index);return locale[field](utc,format);}
function listMonthsImpl(format,index,field){if(isNumber(format)){index=format;format=undefined;}
format=format||'';if(index!=null){return get$1(format,index,field,'month');}
var i;var out=[];for(i=0;i<12;i++){out[i]=get$1(format,i,field,'month');}
return out;}
function listWeekdaysImpl(localeSorted,format,index,field){if(typeof localeSorted==='boolean'){if(isNumber(format)){index=format;format=undefined;}
format=format||'';}else{format=localeSorted;index=format;localeSorted=false;if(isNumber(format)){index=format;format=undefined;}
format=format||'';}
var locale=getLocale(),shift=localeSorted?locale._week.dow:0;if(index!=null){return get$1(format,(index+shift)%7,field,'day');}
var i;var out=[];for(i=0;i<7;i++){out[i]=get$1(format,(i+shift)%7,field,'day');}
return out;}
function listMonths(format,index){return listMonthsImpl(format,index,'months');}
function listMonthsShort(format,index){return listMonthsImpl(format,index,'monthsShort');}
function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdays');}
function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdaysShort');}
function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,'weekdaysMin');}
getSetGlobalLocale('en',{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=(toInt(number%100/10)===1)?'th':(b===1)?'st':(b===2)?'nd':(b===3)?'rd':'th';return number+output;}});hooks.lang=deprecate('moment.lang is deprecated. Use moment.locale instead.',getSetGlobalLocale);hooks.langData=deprecate('moment.langData is deprecated. Use moment.localeData instead.',getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this;}
function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble();}
function add$1(input,value){return addSubtract$1(this,input,value,1);}
function subtract$1(input,value){return addSubtract$1(this,input,value,-1);}
function absCeil(number){if(number<0){return Math.floor(number);}else{return Math.ceil(number);}}
function bubble(){var milliseconds=this._milliseconds;var days=this._days;var months=this._months;var data=this._data;var seconds,minutes,hours,years,monthsFromDays;if(!((milliseconds>=0&&days>=0&&months>=0)||(milliseconds<=0&&days<=0&&months<=0))){milliseconds+=absCeil(monthsToDays(months)+days)*864e5;days=0;months=0;}
data.milliseconds=milliseconds%1000;seconds=absFloor(milliseconds/1000);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);monthsFromDays=absFloor(daysToMonths(days));months+=monthsFromDays;days-=absCeil(monthsToDays(monthsFromDays));years=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this;}
function daysToMonths(days){return days*4800/146097;}
function monthsToDays(months){return months*146097/4800;}
function as(units){if(!this.isValid()){return NaN;}
var days;var months;var milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==='month'||units==='year'){days=this._days+milliseconds/864e5;months=this._months+daysToMonths(days);return units==='month'?months:months/12;}else{days=this._days+Math.round(monthsToDays(this._months));switch(units){case'week':return days/7+milliseconds/6048e5;case'day':return days+milliseconds/864e5;case'hour':return days*24+milliseconds/36e5;case'minute':return days*1440+milliseconds/6e4;case'second':return days*86400+milliseconds/1000;case'millisecond':return Math.floor(days*864e5)+milliseconds;default:throw new Error('Unknown unit '+units);}}}
function valueOf$1(){if(!this.isValid()){return NaN;}
return(this._milliseconds+
this._days*864e5+
(this._months%12)*2592e6+
toInt(this._months/12)*31536e6);}
function makeAs(alias){return function(){return this.as(alias);};}
var asMilliseconds=makeAs('ms');var asSeconds=makeAs('s');var asMinutes=makeAs('m');var asHours=makeAs('h');var asDays=makeAs('d');var asWeeks=makeAs('w');var asMonths=makeAs('M');var asYears=makeAs('y');function clone$1(){return createDuration(this);}
function get$2(units){units=normalizeUnits(units);return this.isValid()?this[units+'s']():NaN;}
function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN;};}
var milliseconds=makeGetter('milliseconds');var seconds=makeGetter('seconds');var minutes=makeGetter('minutes');var hours=makeGetter('hours');var days=makeGetter('days');var months=makeGetter('months');var years=makeGetter('years');function weeks(){return absFloor(this.days()/7);}
var round=Math.round;var thresholds={ss:44,s:45,m:45,h:22,d:26,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture);}
function relativeTime$1(posNegDuration,withoutSuffix,locale){var duration=createDuration(posNegDuration).abs();var seconds=round(duration.as('s'));var minutes=round(duration.as('m'));var hours=round(duration.as('h'));var days=round(duration.as('d'));var months=round(duration.as('M'));var years=round(duration.as('y'));var a=seconds<=thresholds.ss&&['s',seconds]||seconds<thresholds.s&&['ss',seconds]||minutes<=1&&['m']||minutes<thresholds.m&&['mm',minutes]||hours<=1&&['h']||hours<thresholds.h&&['hh',hours]||days<=1&&['d']||days<thresholds.d&&['dd',days]||months<=1&&['M']||months<thresholds.M&&['MM',months]||years<=1&&['y']||['yy',years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a);}
function getSetRelativeTimeRounding(roundingFunction){if(roundingFunction===undefined){return round;}
if(typeof(roundingFunction)==='function'){round=roundingFunction;return true;}
return false;}
function getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false;}
if(limit===undefined){return thresholds[threshold];}
thresholds[threshold]=limit;if(threshold==='s'){thresholds.ss=limit-1;}
return true;}
function humanize(withSuffix){if(!this.isValid()){return this.localeData().invalidDate();}
var locale=this.localeData();var output=relativeTime$1(this,!withSuffix,locale);if(withSuffix){output=locale.pastFuture(+this,output);}
return locale.postformat(output);}
var abs$1=Math.abs;function sign(x){return((x>0)-(x<0))||+x;}
function toISOString$1(){if(!this.isValid()){return this.localeData().invalidDate();}
var seconds=abs$1(this._milliseconds)/1000;var days=abs$1(this._days);var months=abs$1(this._months);var minutes,hours,years;minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;var Y=years;var M=months;var D=days;var h=hours;var m=minutes;var s=seconds?seconds.toFixed(3).replace(/\.?0+$/,''):'';var total=this.asSeconds();if(!total){return'P0D';}
var totalSign=total<0?'-':'';var ymSign=sign(this._months)!==sign(total)?'-':'';var daysSign=sign(this._days)!==sign(total)?'-':'';var hmsSign=sign(this._milliseconds)!==sign(total)?'-':'';return totalSign+'P'+
(Y?ymSign+Y+'Y':'')+
(M?ymSign+M+'M':'')+
(D?daysSign+D+'D':'')+
((h||m||s)?'T':'')+
(h?hmsSign+h+'H':'')+
(m?hmsSign+m+'M':'')+
(s?hmsSign+s+'S':'');}
var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs;proto$2.add=add$1;proto$2.subtract=subtract$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)',toISOString$1);proto$2.lang=lang;addFormatToken('X',0,0,'unix');addFormatToken('x',0,0,'valueOf');addRegexToken('x',matchSigned);addRegexToken('X',matchTimestamp);addParseToken('X',function(input,array,config){config._d=new Date(parseFloat(input,10)*1000);});addParseToken('x',function(input,array,config){config._d=new Date(toInt(input));});hooks.version='2.23.0';setHookCallback(createLocal);hooks.fn=proto;hooks.min=min;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:'YYYY-MM-DDTHH:mm',DATETIME_LOCAL_SECONDS:'YYYY-MM-DDTHH:mm:ss',DATETIME_LOCAL_MS:'YYYY-MM-DDTHH:mm:ss.SSS',DATE:'YYYY-MM-DD',TIME:'HH:mm',TIME_SECONDS:'HH:mm:ss',TIME_MS:'HH:mm:ss.SSS',WEEK:'GGGG-[W]WW',MONTH:'YYYY-MM'};return hooks;})));}.call(exports,__webpack_require__(166)(module)))}),(function(module,exports,__webpack_require__){var map={"./af":296,"./af.js":296,"./ar":297,"./ar-dz":298,"./ar-dz.js":298,"./ar-kw":299,"./ar-kw.js":299,"./ar-ly":300,"./ar-ly.js":300,"./ar-ma":301,"./ar-ma.js":301,"./ar-sa":302,"./ar-sa.js":302,"./ar-tn":303,"./ar-tn.js":303,"./ar.js":297,"./az":304,"./az.js":304,"./be":305,"./be.js":305,"./bg":306,"./bg.js":306,"./bm":307,"./bm.js":307,"./bn":308,"./bn.js":308,"./bo":309,"./bo.js":309,"./br":310,"./br.js":310,"./bs":311,"./bs.js":311,"./ca":312,"./ca.js":312,"./cs":313,"./cs.js":313,"./cv":314,"./cv.js":314,"./cy":315,"./cy.js":315,"./da":316,"./da.js":316,"./de":317,"./de-at":318,"./de-at.js":318,"./de-ch":319,"./de-ch.js":319,"./de.js":317,"./dv":320,"./dv.js":320,"./el":321,"./el.js":321,"./en-au":322,"./en-au.js":322,"./en-ca":323,"./en-ca.js":323,"./en-gb":324,"./en-gb.js":324,"./en-ie":325,"./en-ie.js":325,"./en-il":326,"./en-il.js":326,"./en-nz":327,"./en-nz.js":327,"./eo":328,"./eo.js":328,"./es":329,"./es-do":330,"./es-do.js":330,"./es-us":331,"./es-us.js":331,"./es.js":329,"./et":332,"./et.js":332,"./eu":333,"./eu.js":333,"./fa":334,"./fa.js":334,"./fi":335,"./fi.js":335,"./fo":336,"./fo.js":336,"./fr":337,"./fr-ca":338,"./fr-ca.js":338,"./fr-ch":339,"./fr-ch.js":339,"./fr.js":337,"./fy":340,"./fy.js":340,"./gd":341,"./gd.js":341,"./gl":342,"./gl.js":342,"./gom-latn":343,"./gom-latn.js":343,"./gu":344,"./gu.js":344,"./he":345,"./he.js":345,"./hi":346,"./hi.js":346,"./hr":347,"./hr.js":347,"./hu":348,"./hu.js":348,"./hy-am":349,"./hy-am.js":349,"./id":350,"./id.js":350,"./is":351,"./is.js":351,"./it":352,"./it.js":352,"./ja":353,"./ja.js":353,"./jv":354,"./jv.js":354,"./ka":355,"./ka.js":355,"./kk":356,"./kk.js":356,"./km":357,"./km.js":357,"./kn":358,"./kn.js":358,"./ko":359,"./ko.js":359,"./ku":360,"./ku.js":360,"./ky":361,"./ky.js":361,"./lb":362,"./lb.js":362,"./lo":363,"./lo.js":363,"./lt":364,"./lt.js":364,"./lv":365,"./lv.js":365,"./me":366,"./me.js":366,"./mi":367,"./mi.js":367,"./mk":368,"./mk.js":368,"./ml":369,"./ml.js":369,"./mn":370,"./mn.js":370,"./mr":371,"./mr.js":371,"./ms":372,"./ms-my":373,"./ms-my.js":373,"./ms.js":372,"./mt":374,"./mt.js":374,"./my":375,"./my.js":375,"./nb":376,"./nb.js":376,"./ne":377,"./ne.js":377,"./nl":378,"./nl-be":379,"./nl-be.js":379,"./nl.js":378,"./nn":380,"./nn.js":380,"./pa-in":381,"./pa-in.js":381,"./pl":382,"./pl.js":382,"./pt":383,"./pt-br":384,"./pt-br.js":384,"./pt.js":383,"./ro":385,"./ro.js":385,"./ru":386,"./ru.js":386,"./sd":387,"./sd.js":387,"./se":388,"./se.js":388,"./si":389,"./si.js":389,"./sk":390,"./sk.js":390,"./sl":391,"./sl.js":391,"./sq":392,"./sq.js":392,"./sr":393,"./sr-cyrl":394,"./sr-cyrl.js":394,"./sr.js":393,"./ss":395,"./ss.js":395,"./sv":396,"./sv.js":396,"./sw":397,"./sw.js":397,"./ta":398,"./ta.js":398,"./te":399,"./te.js":399,"./tet":400,"./tet.js":400,"./tg":401,"./tg.js":401,"./th":402,"./th.js":402,"./tl-ph":403,"./tl-ph.js":403,"./tlh":404,"./tlh.js":404,"./tr":405,"./tr.js":405,"./tzl":406,"./tzl.js":406,"./tzm":407,"./tzm-latn":408,"./tzm-latn.js":408,"./tzm.js":407,"./ug-cn":409,"./ug-cn.js":409,"./uk":410,"./uk.js":410,"./ur":411,"./ur.js":411,"./uz":412,"./uz-latn":413,"./uz-latn.js":413,"./uz.js":412,"./vi":414,"./vi.js":414,"./x-pseudo":415,"./x-pseudo.js":415,"./yo":416,"./yo.js":416,"./zh-cn":417,"./zh-cn.js":417,"./zh-hk":418,"./zh-hk.js":418,"./zh-tw":419,"./zh-tw.js":419};function webpackContext(req){return __webpack_require__(webpackContextResolve(req));};function webpackContextResolve(req){var id=map[req];if(!(id+1))
throw new Error("Cannot find module '"+req+"'.");return id;};webpackContext.keys=function webpackContextKeys(){return Object.keys(map);};webpackContext.resolve=webpackContextResolve;module.exports=webpackContext;webpackContext.id=618;}),(function(module,exports){}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _autocompleteEditor=_interopRequireDefault(__webpack_require__(294));var _pluginHooks=_interopRequireDefault(__webpack_require__(22));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var DropdownEditor=function(_AutocompleteEditor){_inherits(DropdownEditor,_AutocompleteEditor);function DropdownEditor(){_classCallCheck(this,DropdownEditor);return _possibleConstructorReturn(this,_getPrototypeOf(DropdownEditor).apply(this,arguments));}
_createClass(DropdownEditor,[{key:"prepare",value:function prepare(row,col,prop,td,originalValue,cellProperties){_get(_getPrototypeOf(DropdownEditor.prototype),"prepare",this).call(this,row,col,prop,td,originalValue,cellProperties);this.cellProperties.filter=false;this.cellProperties.strict=true;}}]);return DropdownEditor;}(_autocompleteEditor.default);_pluginHooks.default.getSingleton().add('beforeValidate',function(value,row,col){var cellMeta=this.getCellMeta(row,this.propToCol(col));if(cellMeta.editor===DropdownEditor){if(cellMeta.strict===void 0){cellMeta.filter=false;cellMeta.strict=true;}}});var _default=DropdownEditor;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _textEditor=_interopRequireDefault(__webpack_require__(77));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var NumericEditor=function(_TextEditor){_inherits(NumericEditor,_TextEditor);function NumericEditor(){_classCallCheck(this,NumericEditor);return _possibleConstructorReturn(this,_getPrototypeOf(NumericEditor).apply(this,arguments));}
return NumericEditor;}(_textEditor.default);var _default=NumericEditor;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _textEditor=_interopRequireDefault(__webpack_require__(77));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var PasswordEditor=function(_TextEditor){_inherits(PasswordEditor,_TextEditor);function PasswordEditor(){_classCallCheck(this,PasswordEditor);return _possibleConstructorReturn(this,_getPrototypeOf(PasswordEditor).apply(this,arguments));}
_createClass(PasswordEditor,[{key:"createElements",value:function createElements(){_get(_getPrototypeOf(PasswordEditor.prototype),"createElements",this).call(this);this.TEXTAREA=document.createElement('input');this.TEXTAREA.setAttribute('type','password');this.TEXTAREA.className='handsontableInput';this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;(0,_element.empty)(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);}}]);return PasswordEditor;}(_textEditor.default);var _default=PasswordEditor;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _event=__webpack_require__(18);var _unicode=__webpack_require__(32);var _baseEditor=_interopRequireWildcard(__webpack_require__(74));var _object=__webpack_require__(2);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
var SelectEditor=_baseEditor.default.prototype.extend();SelectEditor.prototype.init=function(){this.select=document.createElement('SELECT');(0,_element.addClass)(this.select,'htSelectEditor');this.select.style.display='none';this.instance.rootElement.appendChild(this.select);this.registerHooks();};SelectEditor.prototype.registerHooks=function(){var _this=this;this.instance.addHook('afterScrollHorizontally',function(){return _this.refreshDimensions();});this.instance.addHook('afterScrollVertically',function(){return _this.refreshDimensions();});this.instance.addHook('afterColumnResize',function(){return _this.refreshDimensions();});this.instance.addHook('afterRowResize',function(){return _this.refreshDimensions();});};SelectEditor.prototype.prepare=function(){var _this2=this;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
_baseEditor.default.prototype.prepare.apply(this,args);var selectOptions=this.cellProperties.selectOptions;var options;if(typeof selectOptions==='function'){options=this.prepareOptions(selectOptions(this.row,this.col,this.prop));}else{options=this.prepareOptions(selectOptions);}
(0,_element.empty)(this.select);(0,_object.objectEach)(options,function(value,key){var optionElement=document.createElement('OPTION');optionElement.value=key;(0,_element.fastInnerHTML)(optionElement,value);_this2.select.appendChild(optionElement);});};SelectEditor.prototype.prepareOptions=function(optionsToPrepare){var preparedOptions={};if(Array.isArray(optionsToPrepare)){for(var i=0,len=optionsToPrepare.length;i<len;i++){preparedOptions[optionsToPrepare[i]]=optionsToPrepare[i];}}else if(_typeof(optionsToPrepare)==='object'){preparedOptions=optionsToPrepare;}
return preparedOptions;};SelectEditor.prototype.getValue=function(){return this.select.value;};SelectEditor.prototype.setValue=function(value){this.select.value=value;};var onBeforeKeyDown=function onBeforeKeyDown(event){var instance=this;var editor=instance.getActiveEditor();var previousOptionIndex=editor.select.selectedIndex-1;var nextOptionIndex=editor.select.selectedIndex+1;switch(event.keyCode){case _unicode.KEY_CODES.ARROW_UP:if(previousOptionIndex>=0){editor.select[previousOptionIndex].selected=true;}
(0,_event.stopImmediatePropagation)(event);event.preventDefault();break;case _unicode.KEY_CODES.ARROW_DOWN:if(nextOptionIndex<=editor.select.length-1){editor.select[nextOptionIndex].selected=true;}
(0,_event.stopImmediatePropagation)(event);event.preventDefault();break;default:break;}};SelectEditor.prototype.open=function(){this._opened=true;this.refreshDimensions();this.select.style.display='';this.instance.addHook('beforeKeyDown',onBeforeKeyDown);};SelectEditor.prototype.close=function(){this._opened=false;this.select.style.display='none';this.instance.removeHook('beforeKeyDown',onBeforeKeyDown);};SelectEditor.prototype.focus=function(){this.select.focus();};SelectEditor.prototype.refreshValue=function(){var sourceData=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=sourceData;this.setValue(sourceData);this.refreshDimensions();};SelectEditor.prototype.refreshDimensions=function(){if(this.state!==_baseEditor.EditorState.EDITING){return;}
this.TD=this.getEditedCell();if(!this.TD){this.close();return;}
var currentOffset=(0,_element.offset)(this.TD);var containerOffset=(0,_element.offset)(this.instance.rootElement);var scrollableContainer=(0,_element.getScrollableElement)(this.TD);var editorSection=this.checkEditorSection();var width=(0,_element.outerWidth)(this.TD)+1;var height=(0,_element.outerHeight)(this.TD)+1;var editTop=currentOffset.top-containerOffset.top-1-(scrollableContainer.scrollTop||0);var editLeft=currentOffset.left-containerOffset.left-1-(scrollableContainer.scrollLeft||0);var cssTransformOffset;switch(editorSection){case'top':cssTransformOffset=(0,_element.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case'left':cssTransformOffset=(0,_element.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case'top-left-corner':cssTransformOffset=(0,_element.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case'bottom-left-corner':cssTransformOffset=(0,_element.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case'bottom':cssTransformOffset=(0,_element.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode);break;default:break;}
if(this.instance.getSelectedLast()[0]===0){editTop+=1;}
if(this.instance.getSelectedLast()[1]===0){editLeft+=1;}
var selectStyle=this.select.style;if(cssTransformOffset&&cssTransformOffset!==-1){selectStyle[cssTransformOffset[0]]=cssTransformOffset[1];}else{(0,_element.resetCssTransform)(this.select);}
var cellComputedStyle=(0,_element.getComputedStyle)(this.TD);if(parseInt(cellComputedStyle.borderTopWidth,10)>0){height-=1;}
if(parseInt(cellComputedStyle.borderLeftWidth,10)>0){width-=1;}
selectStyle.height="".concat(height,"px");selectStyle.minWidth="".concat(width,"px");selectStyle.top="".concat(editTop,"px");selectStyle.left="".concat(editLeft,"px");selectStyle.margin='0px';};SelectEditor.prototype.getEditedCell=function(){var editorSection=this.checkEditorSection();var editedCell;switch(editorSection){case'top':editedCell=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=101;break;case'corner':editedCell=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=103;break;case'left':editedCell=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=102;break;default:editedCell=this.instance.getCell(this.row,this.col);this.select.style.zIndex='';break;}
return editedCell!==-1&&editedCell!==-2?editedCell:void 0;};var _default=SelectEditor;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);function cellDecorator(instance,TD,row,col,prop,value,cellProperties){var classesToAdd=[];var classesToRemove=[];if(cellProperties.className){if(TD.className){TD.className="".concat(TD.className," ").concat(cellProperties.className);}else{TD.className=cellProperties.className;}}
if(cellProperties.readOnly){classesToAdd.push(cellProperties.readOnlyCellClassName);}
if(cellProperties.valid===false&&cellProperties.invalidCellClassName){classesToAdd.push(cellProperties.invalidCellClassName);}else{classesToRemove.push(cellProperties.invalidCellClassName);}
if(cellProperties.wordWrap===false&&cellProperties.noWordWrapClassName){classesToAdd.push(cellProperties.noWordWrapClassName);}
if(!value&&cellProperties.placeholder){classesToAdd.push(cellProperties.placeholderCellClassName);}
(0,_element.removeClass)(TD,classesToRemove);(0,_element.addClass)(TD,classesToAdd);}
var _default=cellDecorator;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _src=__webpack_require__(8);var _index=__webpack_require__(19);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var clonableWRAPPER=document.createElement('DIV');clonableWRAPPER.className='htAutocompleteWrapper';var clonableARROW=document.createElement('DIV');clonableARROW.className='htAutocompleteArrow';clonableARROW.appendChild(document.createTextNode(String.fromCharCode(9660)));function autocompleteRenderer(instance,TD,row,col,prop,value,cellProperties){var rendererType=cellProperties.allowHtml?'html':'text';var ARROW=clonableARROW.cloneNode(true);for(var _len=arguments.length,args=new Array(_len>7?_len-7:0),_key=7;_key<_len;_key++){args[_key-7]=arguments[_key];}
(0,_index.getRenderer)(rendererType).apply(this,[instance,TD,row,col,prop,value,cellProperties].concat(args));if(!TD.firstChild){TD.appendChild(document.createTextNode(String.fromCharCode(160)));}
TD.insertBefore(ARROW,TD.firstChild);(0,_element.addClass)(TD,'htAutocomplete');if(!instance.acArrowListener){var eventManager=new _eventManager.default(instance);instance.acArrowListener=function(event){if((0,_element.hasClass)(event.target,'htAutocompleteArrow')){instance.view.wt.getSetting('onCellDblClick',null,new _src.CellCoords(row,col),TD);}};eventManager.addEventListener(instance.rootElement,'mousedown',instance.acArrowListener);instance.addHookOnce('afterDestroy',function(){eventManager.destroy();});}}
var _default=autocompleteRenderer;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _string=__webpack_require__(48);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _unicode=__webpack_require__(32);var _function=__webpack_require__(59);var _event=__webpack_require__(18);var _index=__webpack_require__(19);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var isListeningKeyDownEvent=new WeakMap();var isCheckboxListenerAdded=new WeakMap();var BAD_VALUE_CLASS='htBadValue';function checkboxRenderer(instance,TD,row,col,prop,value,cellProperties){for(var _len=arguments.length,args=new Array(_len>7?_len-7:0),_key=7;_key<_len;_key++){args[_key-7]=arguments[_key];}
(0,_index.getRenderer)('base').apply(this,[instance,TD,row,col,prop,value,cellProperties].concat(args));registerEvents(instance);var input=createInput();var labelOptions=cellProperties.label;var badValue=false;if(typeof cellProperties.checkedTemplate==='undefined'){cellProperties.checkedTemplate=true;}
if(typeof cellProperties.uncheckedTemplate==='undefined'){cellProperties.uncheckedTemplate=false;}
(0,_element.empty)(TD);if(value===cellProperties.checkedTemplate||(0,_string.equalsIgnoreCase)(value,cellProperties.checkedTemplate)){input.checked=true;}else if(value===cellProperties.uncheckedTemplate||(0,_string.equalsIgnoreCase)(value,cellProperties.uncheckedTemplate)){input.checked=false;}else if(value===null){(0,_element.addClass)(input,'noValue');}else{input.style.display='none';(0,_element.addClass)(input,BAD_VALUE_CLASS);badValue=true;}
input.setAttribute('data-row',row);input.setAttribute('data-col',col);if(!badValue&&labelOptions){var labelText='';if(labelOptions.value){labelText=typeof labelOptions.value==='function'?labelOptions.value.call(this,row,col,prop,value):labelOptions.value;}else if(labelOptions.property){labelText=instance.getDataAtRowProp(row,labelOptions.property);}
var label=createLabel(labelText);if(labelOptions.position==='before'){label.appendChild(input);}else{label.insertBefore(input,label.firstChild);}
input=label;}
TD.appendChild(input);if(badValue){TD.appendChild(document.createTextNode('#bad-value#'));}
if(!isListeningKeyDownEvent.has(instance)){isListeningKeyDownEvent.set(instance,true);instance.addHook('beforeKeyDown',onBeforeKeyDown);}
function onBeforeKeyDown(event){var toggleKeys='SPACE|ENTER';var switchOffKeys='DELETE|BACKSPACE';var isKeyCode=(0,_function.partial)(_unicode.isKey,event.keyCode);if(!instance.getSettings().enterBeginsEditing&&isKeyCode('ENTER')){return;}
if(isKeyCode("".concat(toggleKeys,"|").concat(switchOffKeys))&&!(0,_event.isImmediatePropagationStopped)(event)){eachSelectedCheckboxCell(function(){(0,_event.stopImmediatePropagation)(event);event.preventDefault();});}
if(isKeyCode(toggleKeys)){changeSelectedCheckboxesState();}
if(isKeyCode(switchOffKeys)){changeSelectedCheckboxesState(true);}}
function changeSelectedCheckboxesState(){var uncheckCheckbox=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var selRange=instance.getSelectedRangeLast();if(!selRange){return;}
var _selRange$getTopLeftC=selRange.getTopLeftCorner(),startRow=_selRange$getTopLeftC.row,startColumn=_selRange$getTopLeftC.col;var _selRange$getBottomRi=selRange.getBottomRightCorner(),endRow=_selRange$getBottomRi.row,endColumn=_selRange$getBottomRi.col;var changes=[];for(var visualRow=startRow;visualRow<=endRow;visualRow+=1){for(var visualColumn=startColumn;visualColumn<=endColumn;visualColumn+=1){var cachedCellProperties=instance.getCellMeta(visualRow,visualColumn);if(cachedCellProperties.type!=='checkbox'){return;}
if(cachedCellProperties.readOnly===true){continue;}
if(typeof cachedCellProperties.checkedTemplate==='undefined'){cachedCellProperties.checkedTemplate=true;}
if(typeof cachedCellProperties.uncheckedTemplate==='undefined'){cachedCellProperties.uncheckedTemplate=false;}
var dataAtCell=instance.getDataAtCell(visualRow,visualColumn);if(uncheckCheckbox===false){if([cachedCellProperties.checkedTemplate,cachedCellProperties.checkedTemplate.toString()].includes(dataAtCell)){changes.push([visualRow,visualColumn,cachedCellProperties.uncheckedTemplate]);}else if([cachedCellProperties.uncheckedTemplate,cachedCellProperties.uncheckedTemplate.toString(),null,void 0].includes(dataAtCell)){changes.push([visualRow,visualColumn,cachedCellProperties.checkedTemplate]);}}else{changes.push([visualRow,visualColumn,cachedCellProperties.uncheckedTemplate]);}}}
if(changes.length>0){instance.setDataAtCell(changes);}}
function eachSelectedCheckboxCell(callback){var selRange=instance.getSelectedRangeLast();if(!selRange){return;}
var topLeft=selRange.getTopLeftCorner();var bottomRight=selRange.getBottomRightCorner();for(var visualRow=topLeft.row;visualRow<=bottomRight.row;visualRow++){for(var visualColumn=topLeft.col;visualColumn<=bottomRight.col;visualColumn++){var cachedCellProperties=instance.getCellMeta(visualRow,visualColumn);if(cachedCellProperties.type!=='checkbox'){return;}
var cell=instance.getCell(visualRow,visualColumn);if(cell===null||cell===void 0){callback(visualRow,visualColumn,cachedCellProperties);}else{var checkboxes=cell.querySelectorAll('input[type=checkbox]');if(checkboxes.length>0&&!cachedCellProperties.readOnly){callback(checkboxes);}}}}}}
function registerEvents(instance){var eventManager=isCheckboxListenerAdded.get(instance);if(!eventManager){eventManager=new _eventManager.default(instance);eventManager.addEventListener(instance.rootElement,'click',function(event){return onClick(event,instance);});eventManager.addEventListener(instance.rootElement,'mouseup',function(event){return onMouseUp(event,instance);});eventManager.addEventListener(instance.rootElement,'change',function(event){return onChange(event,instance);});isCheckboxListenerAdded.set(instance,eventManager);}
return eventManager;}
function createInput(){var input=document.createElement('input');input.className='htCheckboxRendererInput';input.type='checkbox';input.setAttribute('autocomplete','off');input.setAttribute('tabindex','-1');return input.cloneNode(false);}
function createLabel(text){var label=document.createElement('label');label.className='htCheckboxRendererLabel';label.appendChild(document.createTextNode(text));return label.cloneNode(true);}
function onMouseUp(event,instance){if(!isCheckboxInput(event.target)){return;}
setTimeout(instance.listen,10);}
function onClick(event,instance){if(!isCheckboxInput(event.target)){return false;}
var row=parseInt(event.target.getAttribute('data-row'),10);var col=parseInt(event.target.getAttribute('data-col'),10);var cellProperties=instance.getCellMeta(row,col);if(cellProperties.readOnly){event.preventDefault();}}
function onChange(event,instance){if(!isCheckboxInput(event.target)){return false;}
var row=parseInt(event.target.getAttribute('data-row'),10);var col=parseInt(event.target.getAttribute('data-col'),10);var cellProperties=instance.getCellMeta(row,col);if(!cellProperties.readOnly){var newCheckboxValue=null;if(event.target.checked){newCheckboxValue=cellProperties.uncheckedTemplate===void 0?true:cellProperties.checkedTemplate;}else{newCheckboxValue=cellProperties.uncheckedTemplate===void 0?false:cellProperties.uncheckedTemplate;}
instance.setDataAtCell(row,col,newCheckboxValue);}}
function isCheckboxInput(element){return element.tagName==='INPUT'&&element.getAttribute('type')==='checkbox';}
var _default=checkboxRenderer;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _index=__webpack_require__(19);function htmlRenderer(instance,TD,row,col,prop,value){for(var _len=arguments.length,args=new Array(_len>6?_len-6:0),_key=6;_key<_len;_key++){args[_key-6]=arguments[_key];}
(0,_index.getRenderer)('base').apply(this,[instance,TD,row,col,prop,value].concat(args));(0,_element.fastInnerHTML)(TD,value===null||value===void 0?'':value);}
var _default=htmlRenderer;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _numbro=_interopRequireDefault(__webpack_require__(420));var _index=__webpack_require__(19);var _number=__webpack_require__(9);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function numericRenderer(instance,TD,row,col,prop,value,cellProperties){var newValue=value;if((0,_number.isNumeric)(newValue)){var numericFormat=cellProperties.numericFormat;var cellCulture=numericFormat&&numericFormat.culture||'-';var cellFormatPattern=numericFormat&&numericFormat.pattern;var className=cellProperties.className||'';var classArr=className.length?className.split(' '):[];if(typeof cellCulture!=='undefined'&&!_numbro.default.languages()[cellCulture]){var shortTag=cellCulture.replace('-','');var langData=_numbro.default.allLanguages?_numbro.default.allLanguages[cellCulture]:_numbro.default[shortTag];if(langData){_numbro.default.registerLanguage(langData);}}
_numbro.default.setLanguage(cellCulture);newValue=(0,_numbro.default)(newValue).format(cellFormatPattern||'0');if(classArr.indexOf('htLeft')<0&&classArr.indexOf('htCenter')<0&&classArr.indexOf('htRight')<0&&classArr.indexOf('htJustify')<0){classArr.push('htRight');}
if(classArr.indexOf('htNumeric')<0){classArr.push('htNumeric');}
cellProperties.className=classArr.join(' ');}
(0,_index.getRenderer)('text')(instance,TD,row,col,prop,newValue,cellProperties);}
var _default=numericRenderer;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _index=__webpack_require__(19);var _number=__webpack_require__(9);function passwordRenderer(instance,TD,row,col,prop,value,cellProperties){for(var _len=arguments.length,args=new Array(_len>7?_len-7:0),_key=7;_key<_len;_key++){args[_key-7]=arguments[_key];}
(0,_index.getRenderer)('text').apply(this,[instance,TD,row,col,prop,value,cellProperties].concat(args));var hashLength=cellProperties.hashLength||TD.innerHTML.length;var hashSymbol=cellProperties.hashSymbol||'*';var hash='';(0,_number.rangeEach)(hashLength-1,function(){hash+=hashSymbol;});(0,_element.fastInnerHTML)(TD,hash);}
var _default=passwordRenderer;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _mixed=__webpack_require__(14);var _index=__webpack_require__(19);function textRenderer(instance,TD,row,col,prop,value,cellProperties){for(var _len=arguments.length,args=new Array(_len>7?_len-7:0),_key=7;_key<_len;_key++){args[_key-7]=arguments[_key];}
(0,_index.getRenderer)('base').apply(this,[instance,TD,row,col,prop,value,cellProperties].concat(args));var escaped=value;if(!escaped&&cellProperties.placeholder){escaped=cellProperties.placeholder;}
escaped=(0,_mixed.stringify)(escaped);if(!instance.getSettings().trimWhitespace){escaped=escaped.replace(/ /g,String.fromCharCode(160));}
if(cellProperties.rendererTemplate){(0,_element.empty)(TD);var TEMPLATE=document.createElement('TEMPLATE');TEMPLATE.setAttribute('bind','{{}}');TEMPLATE.innerHTML=cellProperties.rendererTemplate;HTMLTemplateElement.decorate(TEMPLATE);TEMPLATE.model=instance.getSourceDataAtRow(row);TD.appendChild(TEMPLATE);}else{(0,_element.fastInnerText)(TD,escaped);}}
var _default=textRenderer;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=autocompleteValidator;function autocompleteValidator(value,callback){var valueToValidate=value;if(valueToValidate===null||valueToValidate===void 0){valueToValidate='';}
if(this.allowEmpty&&valueToValidate===''){callback(true);return;}
if(this.strict&&this.source){if(typeof this.source==='function'){this.source(valueToValidate,process(valueToValidate,callback));}else{process(valueToValidate,callback)(this.source);}}else{callback(true);}}
function process(value,callback){var originalVal=value;return function(source){var found=false;for(var s=0,slen=source.length;s<slen;s++){if(originalVal===source[s]){found=true;break;}}
callback(found);};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=dateValidator;exports.correctFormat=correctFormat;var _moment=_interopRequireDefault(__webpack_require__(67));var _date=__webpack_require__(421);var _editors=__webpack_require__(26);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function dateValidator(value,callback){var dateEditor=(0,_editors.getEditorInstance)('date',this.instance);var valueToValidate=value;var valid=true;if(valueToValidate===null||valueToValidate===void 0){valueToValidate='';}
var isValidDate=(0,_moment.default)(new Date(valueToValidate)).isValid()||(0,_moment.default)(valueToValidate,this.dateFormat||dateEditor.defaultDateFormat,true).isValid();var isValidFormat=(0,_moment.default)(valueToValidate,this.dateFormat||dateEditor.defaultDateFormat,true).isValid();if(this.allowEmpty&&valueToValidate===''){isValidDate=true;isValidFormat=true;}
if(!isValidDate){valid=false;}
if(!isValidDate&&isValidFormat){valid=true;}
if(isValidDate&&!isValidFormat){if(this.correctFormat===true){var correctedValue=correctFormat(valueToValidate,this.dateFormat);var row=this.instance.runHooks('unmodifyRow',this.row);var column=this.instance.runHooks('unmodifyCol',this.col);this.instance.setDataAtCell(row,column,correctedValue,'dateValidator');valid=true;}else{valid=false;}}
callback(valid);}
function correctFormat(value,dateFormat){var dateFromDate=(0,_moment.default)((0,_date.getNormalizedDate)(value));var dateFromMoment=(0,_moment.default)(value,dateFormat);var isAlphanumeric=value.search(/[A-z]/g)>-1;var date;if(dateFromDate.isValid()&&dateFromDate.format('x')===dateFromMoment.format('x')||!dateFromMoment.isValid()||isAlphanumeric){date=dateFromDate;}else{date=dateFromMoment;}
return date.format(dateFormat);}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=numericValidator;var _number=__webpack_require__(9);function numericValidator(value,callback){var valueToValidate=value;if(valueToValidate===null||valueToValidate===void 0){valueToValidate='';}
if(this.allowEmpty&&valueToValidate===''){callback(true);}else if(valueToValidate===''){callback(false);}else{callback((0,_number.isNumeric)(value));}}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=timeValidator;var _moment=_interopRequireDefault(__webpack_require__(67));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var STRICT_FORMATS=['YYYY-MM-DDTHH:mm:ss.SSSZ','X','x'];function timeValidator(value,callback){var timeFormat=this.timeFormat||'h:mm:ss a';var valid=true;var valueToValidate=value;if(valueToValidate===null){valueToValidate='';}
valueToValidate=/^\d{3,}$/.test(valueToValidate)?parseInt(valueToValidate,10):valueToValidate;var twoDigitValue=/^\d{1,2}$/.test(valueToValidate);if(twoDigitValue){valueToValidate+=':00';}
var date=(0,_moment.default)(valueToValidate,STRICT_FORMATS,true).isValid()?(0,_moment.default)(valueToValidate):(0,_moment.default)(valueToValidate,timeFormat);var isValidTime=date.isValid();var isValidFormat=(0,_moment.default)(valueToValidate,timeFormat,true).isValid()&&!twoDigitValue;if(this.allowEmpty&&valueToValidate===''){isValidTime=true;isValidFormat=true;}
if(!isValidTime){valid=false;}
if(!isValidTime&&isValidFormat){valid=true;}
if(isValidTime&&!isValidFormat){if(this.correctFormat===true){var correctedValue=date.format(timeFormat);var row=this.instance.runHooks('unmodifyRow',this.row);var column=this.instance.runHooks('unmodifyCol',this.col);this.instance.setDataAtCell(row,column,correctedValue,'timeValidator');valid=true;}else{valid=false;}}
callback(valid);}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var _validators=__webpack_require__(49);var CELL_TYPE='autocomplete';var _default={editor:(0,_editors.getEditor)(CELL_TYPE),renderer:(0,_renderers.getRenderer)(CELL_TYPE),validator:(0,_validators.getValidator)(CELL_TYPE)};exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var CELL_TYPE='checkbox';var _default={editor:(0,_editors.getEditor)(CELL_TYPE),renderer:(0,_renderers.getRenderer)(CELL_TYPE)};exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var _validators=__webpack_require__(49);var CELL_TYPE='date';var _default={editor:(0,_editors.getEditor)(CELL_TYPE),renderer:(0,_renderers.getRenderer)('autocomplete'),validator:(0,_validators.getValidator)(CELL_TYPE)};exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var _validators=__webpack_require__(49);var CELL_TYPE='dropdown';var _default={editor:(0,_editors.getEditor)(CELL_TYPE),renderer:(0,_renderers.getRenderer)('autocomplete'),validator:(0,_validators.getValidator)('autocomplete')};exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var CELL_TYPE='handsontable';var _default={editor:(0,_editors.getEditor)(CELL_TYPE),renderer:(0,_renderers.getRenderer)('autocomplete')};exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var _validators=__webpack_require__(49);var CELL_TYPE='numeric';var _default={editor:(0,_editors.getEditor)(CELL_TYPE),renderer:(0,_renderers.getRenderer)(CELL_TYPE),validator:(0,_validators.getValidator)(CELL_TYPE),dataType:'number'};exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var CELL_TYPE='password';var _default={editor:(0,_editors.getEditor)(CELL_TYPE),renderer:(0,_renderers.getRenderer)(CELL_TYPE),copyable:false};exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var CELL_TYPE='text';var _default={editor:(0,_editors.getEditor)(CELL_TYPE),renderer:(0,_renderers.getRenderer)(CELL_TYPE)};exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _editors=__webpack_require__(26);var _renderers=__webpack_require__(19);var _validators=__webpack_require__(49);var CELL_TYPE='time';var _default={editor:(0,_editors.getEditor)('text'),renderer:(0,_renderers.getRenderer)('text'),validator:(0,_validators.getValidator)(CELL_TYPE)};exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _SheetClip=_interopRequireDefault(__webpack_require__(422));var _data=__webpack_require__(122);var _setting=__webpack_require__(121);var _object=__webpack_require__(2);var _array=__webpack_require__(3);var _interval=_interopRequireDefault(__webpack_require__(645));var _number=__webpack_require__(9);var _multiMap=_interopRequireDefault(__webpack_require__(646));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function DataMap(instance,priv,GridSettings){var _this=this;this.instance=instance;this.priv=priv;this.GridSettings=GridSettings;this.dataSource=this.instance.getSettings().data;this.cachedLength=null;this.skipCache=false;this.latestSourceRowsCount=0;if(this.dataSource&&this.dataSource[0]){this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]);}else{this.duckSchema={};}
this.createMap();this.interval=_interval.default.create(function(){return _this.clearLengthCache();},'15fps');this.instance.addHook('skipLengthCache',function(delay){return _this.onSkipLengthCache(delay);});this.onSkipLengthCache(500);}
DataMap.prototype.DESTINATION_RENDERER=1;DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;DataMap.prototype.recursiveDuckSchema=function(object){return(0,_object.duckSchema)(object);};DataMap.prototype.recursiveDuckColumns=function(schema,lastCol,parent){var _this2=this;var lastColumn=lastCol;var propertyParent=parent;var prop;if(typeof lastColumn==='undefined'){lastColumn=0;propertyParent='';}
if(_typeof(schema)==='object'&&!Array.isArray(schema)){(0,_object.objectEach)(schema,function(value,key){if(value===null){prop=propertyParent+key;_this2.colToPropCache.push(prop);_this2.propToColCache.set(prop,lastColumn);lastColumn+=1;}else{lastColumn=_this2.recursiveDuckColumns(value,lastColumn,"".concat(key,"."));}});}
return lastColumn;};DataMap.prototype.createMap=function(){var i;var schema=this.getSchema();if(typeof schema==='undefined'){throw new Error('trying to create `columns` definition but you didn\'t provide `schema` nor `data`');}
this.colToPropCache=[];this.propToColCache=new _multiMap.default();var columns=this.instance.getSettings().columns;if(columns){var maxCols=this.instance.getSettings().maxCols;var columnsLen=Math.min(maxCols,columns.length);var filteredIndex=0;var columnsAsFunc=false;var schemaLen=(0,_object.deepObjectSize)(schema);if(typeof columns==='function'){columnsLen=schemaLen>0?schemaLen:this.instance.countSourceCols();columnsAsFunc=true;}
for(i=0;i<columnsLen;i++){var column=columnsAsFunc?columns(i):columns[i];if((0,_object.isObject)(column)){if(typeof column.data!=='undefined'){var index=columnsAsFunc?filteredIndex:i;this.colToPropCache[index]=column.data;this.propToColCache.set(column.data,index);}
filteredIndex+=1;}}}else{this.recursiveDuckColumns(schema);}};DataMap.prototype.colToProp=function(col){var physicalColumn=this.instance.runHooks('modifyCol',col);if(!isNaN(physicalColumn)&&this.colToPropCache&&typeof this.colToPropCache[physicalColumn]!=='undefined'){return this.colToPropCache[physicalColumn];}
return physicalColumn;};DataMap.prototype.propToCol=function(prop){var col;if(typeof this.propToColCache.get(prop)==='undefined'){col=prop;}else{col=this.propToColCache.get(prop);}
col=this.instance.runHooks('unmodifyCol',col);return col;};DataMap.prototype.getSchema=function(){var schema=this.instance.getSettings().dataSchema;if(schema){if(typeof schema==='function'){return schema();}
return schema;}
return this.duckSchema;};DataMap.prototype.createRow=function(index){var _this3=this;var amount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var source=arguments.length>2?arguments[2]:undefined;var numberOfCreatedRows=0;var rowIndex=index;if(typeof rowIndex!=='number'||rowIndex>=this.instance.countSourceRows()){rowIndex=this.instance.countSourceRows();}
var continueProcess=this.instance.runHooks('beforeCreateRow',rowIndex,amount,source);if(continueProcess===false){return 0;}
var maxRows=this.instance.getSettings().maxRows;var columnCount=this.instance.countCols();var _loop=function _loop(){var row=null;if(_this3.instance.dataType==='array'){if(_this3.instance.getSettings().dataSchema){row=(0,_object.deepClone)(_this3.getSchema());}else{row=[];(0,_number.rangeEach)(columnCount-1,function(){return row.push(null);});}}else if(_this3.instance.dataType==='function'){row=_this3.instance.getSettings().dataSchema(rowIndex);}else{row={};(0,_object.deepExtend)(row,_this3.getSchema());}
if(rowIndex===_this3.instance.countSourceRows()){_this3.dataSource.push(row);}else{_this3.spliceData(rowIndex,0,row);}
numberOfCreatedRows+=1;};while(numberOfCreatedRows<amount&&this.instance.countSourceRows()<maxRows){_loop();}
this.instance.runHooks('afterCreateRow',rowIndex,numberOfCreatedRows,source);this.instance.forceFullRender=true;return numberOfCreatedRows;};DataMap.prototype.createCol=function(index){var amount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var source=arguments.length>2?arguments[2]:undefined;if(!this.instance.isColumnModificationAllowed()){throw new Error('Cannot create new column. When data source in an object, '+'you can only have as much columns as defined in first data row, data schema or in the \'columns\' setting.'+'If you want to be able to add new columns, you have to use array datasource.');}
var rlen=this.instance.countSourceRows();var data=this.dataSource;var countColumns=this.instance.countCols();var columnIndex=typeof index!=='number'||index>=countColumns?countColumns:index;var constructor;var numberOfCreatedCols=0;var currentIndex;this.instance.runHooks('beforeCreateCol',columnIndex,amount,source);currentIndex=columnIndex;var maxCols=this.instance.getSettings().maxCols;while(numberOfCreatedCols<amount&&this.instance.countCols()<maxCols){constructor=(0,_setting.columnFactory)(this.GridSettings,this.priv.columnsSettingConflicts);if(typeof columnIndex!=='number'||columnIndex>=this.instance.countCols()){if(rlen>0){for(var r=0;r<rlen;r++){if(typeof data[r]==='undefined'){data[r]=[];}
data[r].push(null);}}else{data.push([null]);}
this.priv.columnSettings.push(constructor);}else{for(var row=0;row<rlen;row++){data[row].splice(currentIndex,0,null);}
this.priv.columnSettings.splice(currentIndex,0,constructor);}
numberOfCreatedCols+=1;currentIndex+=1;}
this.instance.runHooks('afterCreateCol',columnIndex,numberOfCreatedCols,source);this.instance.forceFullRender=true;return numberOfCreatedCols;};DataMap.prototype.removeRow=function(index){var amount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var source=arguments.length>2?arguments[2]:undefined;var rowIndex=typeof index!=='number'?-amount:index;var rowsAmount=this.instance.runHooks('modifyRemovedAmount',amount,rowIndex);rowIndex=(this.instance.countSourceRows()+rowIndex)%this.instance.countSourceRows();var logicRows=this.visualRowsToPhysical(rowIndex,rowsAmount);var actionWasNotCancelled=this.instance.runHooks('beforeRemoveRow',rowIndex,rowsAmount,logicRows,source);if(actionWasNotCancelled===false){return;}
var data=this.dataSource;var newData=this.filterData(rowIndex,rowsAmount);if(newData){data.length=0;Array.prototype.push.apply(data,newData);}
this.instance.runHooks('afterRemoveRow',rowIndex,rowsAmount,logicRows,source);this.instance.forceFullRender=true;};DataMap.prototype.removeCol=function(index){var amount=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var source=arguments.length>2?arguments[2]:undefined;if(this.instance.dataType==='object'||this.instance.getSettings().columns){throw new Error('cannot remove column with object data source or columns option specified');}
var columnIndex=typeof index!=='number'?-amount:index;columnIndex=(this.instance.countCols()+columnIndex)%this.instance.countCols();var logicColumns=this.visualColumnsToPhysical(columnIndex,amount);var descendingLogicColumns=logicColumns.slice(0).sort(function(a,b){return b-a;});var actionWasNotCancelled=this.instance.runHooks('beforeRemoveCol',columnIndex,amount,logicColumns,source);if(actionWasNotCancelled===false){return;}
var isTableUniform=true;var removedColumnsCount=descendingLogicColumns.length;var data=this.dataSource;for(var c=0;c<removedColumnsCount;c++){if(isTableUniform&&logicColumns[0]!==logicColumns[c]-c){isTableUniform=false;}}
if(isTableUniform){for(var r=0,rlen=this.instance.countSourceRows();r<rlen;r++){data[r].splice(logicColumns[0],amount);}}else{for(var _r=0,_rlen=this.instance.countSourceRows();_r<_rlen;_r++){for(var _c=0;_c<removedColumnsCount;_c++){data[_r].splice(descendingLogicColumns[_c],1);}}
for(var _c2=0;_c2<removedColumnsCount;_c2++){this.priv.columnSettings.splice(logicColumns[_c2],1);}}
this.instance.runHooks('afterRemoveCol',columnIndex,amount,logicColumns,source);this.instance.forceFullRender=true;};DataMap.prototype.spliceCol=function(col,index,amount){var colData=this.instance.getDataAtCol(col);var removed=colData.slice(index,index+amount);var after=colData.slice(index+amount);for(var _len=arguments.length,elements=new Array(_len>3?_len-3:0),_key=3;_key<_len;_key++){elements[_key-3]=arguments[_key];}
(0,_array.extendArray)(elements,after);var i=0;while(i<amount){elements.push(null);i+=1;}
(0,_array.to2dArray)(elements);this.instance.populateFromArray(index,col,elements,null,null,'spliceCol');return removed;};DataMap.prototype.spliceRow=function(row,index,amount){var rowData=this.instance.getSourceDataAtRow(row);var removed=rowData.slice(index,index+amount);var after=rowData.slice(index+amount);for(var _len2=arguments.length,elements=new Array(_len2>3?_len2-3:0),_key2=3;_key2<_len2;_key2++){elements[_key2-3]=arguments[_key2];}
(0,_array.extendArray)(elements,after);var i=0;while(i<amount){elements.push(null);i+=1;}
this.instance.populateFromArray(row,index,[elements],null,null,'spliceRow');return removed;};DataMap.prototype.spliceData=function(index,amount,element){var continueSplicing=this.instance.runHooks('beforeDataSplice',index,amount,element);if(continueSplicing!==false){this.dataSource.splice(index,amount,element);}};DataMap.prototype.filterData=function(index,amount){var physicalRows=this.visualRowsToPhysical(index,amount);var continueSplicing=this.instance.runHooks('beforeDataFilter',index,amount,physicalRows);if(continueSplicing!==false){var newData=this.dataSource.filter(function(row,rowIndex){return physicalRows.indexOf(rowIndex)===-1;});return newData;}};DataMap.prototype.get=function(row,prop){var physicalRow=this.instance.runHooks('modifyRow',row);var dataRow=this.dataSource[physicalRow];var modifiedRowData=this.instance.runHooks('modifyRowData',physicalRow);dataRow=isNaN(modifiedRowData)?modifiedRowData:dataRow;var value=null;if(dataRow&&dataRow.hasOwnProperty&&(0,_object.hasOwnProperty)(dataRow,prop)){value=dataRow[prop];}else if(typeof prop==='string'&&prop.indexOf('.')>-1){var sliced=prop.split('.');var out=dataRow;if(!out){return null;}
for(var i=0,ilen=sliced.length;i<ilen;i++){out=out[sliced[i]];if(typeof out==='undefined'){return null;}}
value=out;}else if(typeof prop==='function'){value=prop(this.dataSource.slice(physicalRow,physicalRow+1)[0]);}
if(this.instance.hasHook('modifyData')){var valueHolder=(0,_object.createObjectPropListener)(value);this.instance.runHooks('modifyData',physicalRow,this.propToCol(prop),valueHolder,'get');if(valueHolder.isTouched()){value=valueHolder.value;}}
return value;};var copyableLookup=(0,_data.cellMethodLookupFactory)('copyable',false);DataMap.prototype.getCopyable=function(row,prop){if(copyableLookup.call(this.instance,row,this.propToCol(prop))){return this.get(row,prop);}
return'';};DataMap.prototype.set=function(row,prop,value,source){var physicalRow=this.instance.runHooks('modifyRow',row,source||'datamapGet');var newValue=value;var dataRow=this.dataSource[physicalRow];var modifiedRowData=this.instance.runHooks('modifyRowData',physicalRow);dataRow=isNaN(modifiedRowData)?modifiedRowData:dataRow;if(this.instance.hasHook('modifyData')){var valueHolder=(0,_object.createObjectPropListener)(newValue);this.instance.runHooks('modifyData',physicalRow,this.propToCol(prop),valueHolder,'set');if(valueHolder.isTouched()){newValue=valueHolder.value;}}
if(dataRow&&dataRow.hasOwnProperty&&(0,_object.hasOwnProperty)(dataRow,prop)){dataRow[prop]=newValue;}else if(typeof prop==='string'&&prop.indexOf('.')>-1){var sliced=prop.split('.');var out=dataRow;var i=0;var ilen;for(i=0,ilen=sliced.length-1;i<ilen;i++){if(typeof out[sliced[i]]==='undefined'){out[sliced[i]]={};}
out=out[sliced[i]];}
out[sliced[i]]=newValue;}else if(typeof prop==='function'){prop(this.dataSource.slice(physicalRow,physicalRow+1)[0],newValue);}else{dataRow[prop]=newValue;}};DataMap.prototype.visualRowsToPhysical=function(index,amount){var totalRows=this.instance.countSourceRows();var logicRows=[];var physicRow=(totalRows+index)%totalRows;var rowsToRemove=amount;var row;while(physicRow<totalRows&&rowsToRemove){row=this.instance.runHooks('modifyRow',physicRow);logicRows.push(row);rowsToRemove-=1;physicRow+=1;}
return logicRows;};DataMap.prototype.visualColumnsToPhysical=function(index,amount){var totalCols=this.instance.countCols();var physicalCol=(totalCols+index)%totalCols;var visualCols=[];var colsToRemove=amount;while(physicalCol<totalCols&&colsToRemove){var col=this.instance.runHooks('modifyCol',physicalCol);visualCols.push(col);colsToRemove-=1;physicalCol+=1;}
return visualCols;};DataMap.prototype.clear=function(){for(var r=0;r<this.instance.countSourceRows();r++){for(var c=0;c<this.instance.countCols();c++){this.set(r,this.colToProp(c),'');}}};DataMap.prototype.clearLengthCache=function(){this.cachedLength=null;};DataMap.prototype.getLength=function(){var _this4=this;var maxRowsFromSettings=this.instance.getSettings().maxRows;var maxRows;if(maxRowsFromSettings<0||maxRowsFromSettings===0){maxRows=0;}else{maxRows=maxRowsFromSettings||Infinity;}
var length=this.instance.countSourceRows();if(this.instance.hasHook('modifyRow')){var reValidate=this.skipCache;this.interval.start();if(length!==this.latestSourceRowsCount){reValidate=true;}
this.latestSourceRowsCount=length;if(this.cachedLength===null||reValidate){(0,_number.rangeEach)(length-1,function(row){var physicalRow=_this4.instance.runHooks('modifyRow',row);if(physicalRow===null){length-=1;}});this.cachedLength=length;}else{length=this.cachedLength;}}else{this.interval.stop();}
return Math.min(length,maxRows);};DataMap.prototype.getAll=function(){var start={row:0,col:0};var end={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};if(start.row-end.row===0&&!this.instance.countSourceRows()){return[];}
return this.getRange(start,end,DataMap.prototype.DESTINATION_RENDERER);};DataMap.prototype.getRange=function(start,end,destination){var output=[];var r;var c;var row;var maxRows=this.instance.getSettings().maxRows;var maxCols=this.instance.getSettings().maxCols;if(maxRows===0||maxCols===0){return[];}
var getFn=destination===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;var rlen=Math.min(Math.max(maxRows-1,0),Math.max(start.row,end.row));var clen=Math.min(Math.max(maxCols-1,0),Math.max(start.col,end.col));for(r=Math.min(start.row,end.row);r<=rlen;r++){row=[];var physicalRow=this.instance.runHooks('modifyRow',r);for(c=Math.min(start.col,end.col);c<=clen;c++){if(physicalRow===null){break;}
row.push(getFn.call(this,r,this.colToProp(c)));}
if(physicalRow!==null){output.push(row);}}
return output;};DataMap.prototype.getText=function(start,end){return _SheetClip.default.stringify(this.getRange(start,end,this.DESTINATION_RENDERER));};DataMap.prototype.getCopyableText=function(start,end){return _SheetClip.default.stringify(this.getRange(start,end,this.DESTINATION_CLIPBOARD_GENERATOR));};DataMap.prototype.onSkipLengthCache=function(delay){var _this5=this;this.skipCache=true;setTimeout(function(){_this5.skipCache=false;},delay);};DataMap.prototype.destroy=function(){this.interval.stop();this.interval=null;this.instance=null;this.priv=null;this.GridSettings=null;this.dataSource=null;this.cachedLength=null;this.duckSchema=null;};var _default=DataMap;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.parseDelay=parseDelay;exports.default=void 0;var _feature=__webpack_require__(47);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Interval=function(){_createClass(Interval,null,[{key:"create",value:function create(func,delay){return new Interval(func,delay);}}]);function Interval(func,delay){var _this=this;_classCallCheck(this,Interval);this.timer=null;this.func=func;this.delay=parseDelay(delay);this.stopped=true;this._then=null;this._callback=function(){return _this.__callback();};}
_createClass(Interval,[{key:"start",value:function start(){if(this.stopped){this._then=Date.now();this.stopped=false;this.timer=(0,_feature.requestAnimationFrame)(this._callback);}
return this;}},{key:"stop",value:function stop(){if(!this.stopped){this.stopped=true;(0,_feature.cancelAnimationFrame)(this.timer);this.timer=null;}
return this;}},{key:"__callback",value:function __callback(){this.timer=(0,_feature.requestAnimationFrame)(this._callback);if(this.delay){var now=Date.now();var elapsed=now-this._then;if(elapsed>this.delay){this._then=now-elapsed%this.delay;this.func();}}else{this.func();}}}]);return Interval;}();var _default=Interval;exports.default=_default;function parseDelay(delay){var result=delay;if(typeof result==='string'&&/fps$/.test(result)){result=1000/parseInt(result.replace('fps','')||0,10);}
return result;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function MultiMap(){var map={arrayMap:[],weakMap:new WeakMap()};return{get:function get(key){if(canBeAnArrayMapKey(key)){return map.arrayMap[key];}else if(canBeAWeakMapKey(key)){return map.weakMap.get(key);}},set:function set(key,value){if(canBeAnArrayMapKey(key)){map.arrayMap[key]=value;}else if(canBeAWeakMapKey(key)){map.weakMap.set(key,value);}else{throw new Error('Invalid key type');}},delete:function _delete(key){if(canBeAnArrayMapKey(key)){delete map.arrayMap[key];}else if(canBeAWeakMapKey(key)){map.weakMap.delete(key);}}};function canBeAnArrayMapKey(obj){return obj!==null&&!isNaNSymbol(obj)&&(typeof obj==='string'||typeof obj==='number');}
function canBeAWeakMapKey(obj){return obj!==null&&(_typeof(obj)==='object'||typeof obj==='function');}
function isNaNSymbol(obj){return obj!==obj;}}
var _default=MultiMap;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _src=__webpack_require__(8);var _unicode=__webpack_require__(32);var _event=__webpack_require__(18);var _editors=__webpack_require__(26);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _baseEditor=__webpack_require__(74);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function EditorManager(instance,priv,selection){var _this=this;var eventManager=new _eventManager.default(instance);var destroyed=false;var lock=false;var activeEditor;function moveSelectionAfterEnter(shiftKey){var enterMoves=typeof priv.settings.enterMoves==='function'?priv.settings.enterMoves(event):priv.settings.enterMoves;if(shiftKey){selection.transformStart(-enterMoves.row,-enterMoves.col);}else{selection.transformStart(enterMoves.row,enterMoves.col,true);}}
function moveSelectionUp(shiftKey){if(shiftKey){selection.transformEnd(-1,0);}else{selection.transformStart(-1,0);}}
function moveSelectionDown(shiftKey){if(shiftKey){selection.transformEnd(1,0);}else{selection.transformStart(1,0);}}
function moveSelectionRight(shiftKey){if(shiftKey){selection.transformEnd(0,1);}else{selection.transformStart(0,1);}}
function moveSelectionLeft(shiftKey){if(shiftKey){selection.transformEnd(0,-1);}else{selection.transformStart(0,-1);}}
function onKeyDown(event){if(!instance.isListening()){return;}
instance.runHooks('beforeKeyDown',event);if(destroyed||event.keyCode===229){return;}
if((0,_event.isImmediatePropagationStopped)(event)){return;}
priv.lastKeyCode=event.keyCode;if(!selection.isSelected()){return;}
var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(activeEditor&&!activeEditor.isWaiting()){if(!(0,_unicode.isMetaKey)(event.keyCode)&&!(0,_unicode.isCtrlMetaKey)(event.keyCode)&&!ctrlDown&&!_this.isEditorOpened()){_this.openEditor('',event);return;}}
var rangeModifier=event.shiftKey?selection.setRangeEnd:selection.setRangeStart;var tabMoves;switch(event.keyCode){case _unicode.KEY_CODES.A:if(!_this.isEditorOpened()&&ctrlDown){instance.selectAll();event.preventDefault();(0,_event.stopPropagation)(event);}
break;case _unicode.KEY_CODES.ARROW_UP:if(_this.isEditorOpened()&&!activeEditor.isWaiting()){_this.closeEditorAndSaveChanges(ctrlDown);}
moveSelectionUp(event.shiftKey);event.preventDefault();(0,_event.stopPropagation)(event);break;case _unicode.KEY_CODES.ARROW_DOWN:if(_this.isEditorOpened()&&!activeEditor.isWaiting()){_this.closeEditorAndSaveChanges(ctrlDown);}
moveSelectionDown(event.shiftKey);event.preventDefault();(0,_event.stopPropagation)(event);break;case _unicode.KEY_CODES.ARROW_RIGHT:if(_this.isEditorOpened()&&!activeEditor.isWaiting()){_this.closeEditorAndSaveChanges(ctrlDown);}
moveSelectionRight(event.shiftKey);event.preventDefault();(0,_event.stopPropagation)(event);break;case _unicode.KEY_CODES.ARROW_LEFT:if(_this.isEditorOpened()&&!activeEditor.isWaiting()){_this.closeEditorAndSaveChanges(ctrlDown);}
moveSelectionLeft(event.shiftKey);event.preventDefault();(0,_event.stopPropagation)(event);break;case _unicode.KEY_CODES.TAB:tabMoves=typeof priv.settings.tabMoves==='function'?priv.settings.tabMoves(event):priv.settings.tabMoves;if(event.shiftKey){selection.transformStart(-tabMoves.row,-tabMoves.col);}else{selection.transformStart(tabMoves.row,tabMoves.col,true);}
event.preventDefault();(0,_event.stopPropagation)(event);break;case _unicode.KEY_CODES.BACKSPACE:case _unicode.KEY_CODES.DELETE:instance.emptySelectedCells();_this.prepareEditor();event.preventDefault();break;case _unicode.KEY_CODES.F2:if(activeEditor){activeEditor.enableFullEditMode();}
_this.openEditor(null,event);event.preventDefault();break;case _unicode.KEY_CODES.ENTER:if(_this.isEditorOpened()){if(activeEditor&&activeEditor.state!==_baseEditor.EditorState.WAITING){_this.closeEditorAndSaveChanges(ctrlDown);}
moveSelectionAfterEnter(event.shiftKey);}else if(instance.getSettings().enterBeginsEditing){if(activeEditor){activeEditor.enableFullEditMode();}
_this.openEditor(null,event);}else{moveSelectionAfterEnter(event.shiftKey);}
event.preventDefault();(0,_event.stopImmediatePropagation)(event);break;case _unicode.KEY_CODES.ESCAPE:if(_this.isEditorOpened()){_this.closeEditorAndRestoreOriginalValue(ctrlDown);activeEditor.focus();}
event.preventDefault();break;case _unicode.KEY_CODES.HOME:if(event.ctrlKey||event.metaKey){rangeModifier.call(selection,new _src.CellCoords(0,selection.selectedRange.current().from.col));}else{rangeModifier.call(selection,new _src.CellCoords(selection.selectedRange.current().from.row,0));}
event.preventDefault();(0,_event.stopPropagation)(event);break;case _unicode.KEY_CODES.END:if(event.ctrlKey||event.metaKey){rangeModifier.call(selection,new _src.CellCoords(instance.countRows()-1,selection.selectedRange.current().from.col));}else{rangeModifier.call(selection,new _src.CellCoords(selection.selectedRange.current().from.row,instance.countCols()-1));}
event.preventDefault();(0,_event.stopPropagation)(event);break;case _unicode.KEY_CODES.PAGE_UP:selection.transformStart(-instance.countVisibleRows(),0);event.preventDefault();(0,_event.stopPropagation)(event);break;case _unicode.KEY_CODES.PAGE_DOWN:selection.transformStart(instance.countVisibleRows(),0);event.preventDefault();(0,_event.stopPropagation)(event);break;default:break;}}
function init(){instance.addHook('afterDocumentKeyDown',onKeyDown);eventManager.addEventListener(document.documentElement,'keydown',function(event){if(!destroyed){instance.runHooks('afterDocumentKeyDown',event);}});eventManager.addEventListener(document.documentElement,'compositionstart',function(event){if(!destroyed&&activeEditor&&!activeEditor.isOpened()&&instance.isListening()){_this.openEditor('',event);}});function onDblClick(event,coords,elem){if(elem.nodeName==='TD'){if(activeEditor){activeEditor.enableFullEditMode();}
_this.openEditor(null,event);}}
instance.view.wt.update('onCellDblClick',onDblClick);}
this.lockEditor=function(){lock=true;};this.unlockEditor=function(){lock=false;};this.destroyEditor=function(revertOriginal){if(!lock){this.closeEditor(revertOriginal);}};this.getActiveEditor=function(){return activeEditor;};this.prepareEditor=function(){if(lock){return;}
if(activeEditor&&activeEditor.isWaiting()){this.closeEditor(false,false,function(dataSaved){if(dataSaved){_this.prepareEditor();}});return;}
var row=instance.selection.selectedRange.current().highlight.row;var col=instance.selection.selectedRange.current().highlight.col;var prop=instance.colToProp(col);var td=instance.getCell(row,col);var originalValue=instance.getSourceDataAtCell(instance.runHooks('modifyRow',row),col);var cellProperties=instance.getCellMeta(row,col);var editorClass=instance.getCellEditor(cellProperties);if(editorClass){activeEditor=(0,_editors.getEditorInstance)(editorClass,instance);activeEditor.prepare(row,col,prop,td,originalValue,cellProperties);}else{activeEditor=void 0;}};this.isEditorOpened=function(){return activeEditor&&activeEditor.isOpened();};this.openEditor=function(newInitialValue,event){if(!activeEditor){return;}
var readOnly=activeEditor.cellProperties.readOnly;if(readOnly){if(event&&event.keyCode===_unicode.KEY_CODES.ENTER){moveSelectionAfterEnter();}}else{activeEditor.beginEditing(newInitialValue,event);}};this.closeEditor=function(restoreOriginalValue,ctrlDown,callback){if(activeEditor){activeEditor.finishEditing(restoreOriginalValue,ctrlDown,callback);}else if(callback){callback(false);}};this.closeEditorAndSaveChanges=function(ctrlDown){return this.closeEditor(false,ctrlDown);};this.closeEditorAndRestoreOriginalValue=function(ctrlDown){return this.closeEditor(true,ctrlDown);};this.destroy=function(){destroyed=true;};init();}
var instances=new WeakMap();EditorManager.getInstance=function(hotInstance,hotSettings,selection,datamap){var editorManager=instances.get(hotInstance);if(!editorManager){editorManager=new EditorManager(hotInstance,hotSettings,selection,datamap);instances.set(hotInstance,editorManager);}
return editorManager;};var _default=EditorManager;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _event=__webpack_require__(18);var _src=_interopRequireDefault(__webpack_require__(8));var _mouseEventHandler=__webpack_require__(423);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
var clearTextSelection=function clearTextSelection(){if(window.getSelection){if(window.getSelection().empty){window.getSelection().empty();}else if(window.getSelection().removeAllRanges){window.getSelection().removeAllRanges();}}else if(document.selection){document.selection.empty();}};function TableView(instance){var _this=this;var that=this;this.eventManager=new _eventManager.default(instance);this.instance=instance;this.settings=instance.getSettings();this.selectionMouseDown=false;var originalStyle=instance.rootElement.getAttribute('style');if(originalStyle){instance.rootElement.setAttribute('data-originalstyle',originalStyle);}
(0,_element.addClass)(instance.rootElement,'handsontable');var table=document.createElement('TABLE');(0,_element.addClass)(table,'htCore');if(instance.getSettings().tableClassName){(0,_element.addClass)(table,instance.getSettings().tableClassName);}
this.THEAD=document.createElement('THEAD');table.appendChild(this.THEAD);this.TBODY=document.createElement('TBODY');table.appendChild(this.TBODY);instance.table=table;instance.container.insertBefore(table,instance.container.firstChild);this.eventManager.addEventListener(instance.rootElement,'mousedown',function(event){_this.selectionMouseDown=true;if(!that.isTextSelectionAllowed(event.target)){clearTextSelection();event.preventDefault();window.focus();}});this.eventManager.addEventListener(instance.rootElement,'mouseup',function(){_this.selectionMouseDown=false;});this.eventManager.addEventListener(instance.rootElement,'mousemove',function(event){if(_this.selectionMouseDown&&!that.isTextSelectionAllowed(event.target)){if(_this.settings.fragmentSelection){clearTextSelection();}
event.preventDefault();}});this.eventManager.addEventListener(document.documentElement,'keyup',function(event){if(instance.selection.isInProgress()&&!event.shiftKey){instance.selection.finish();}});var isMouseDown;this.isMouseDown=function(){return isMouseDown;};this.eventManager.addEventListener(document.documentElement,'mouseup',function(event){if(instance.selection.isInProgress()&&(0,_event.isLeftClick)(event)){instance.selection.finish();}
isMouseDown=false;if((0,_element.isOutsideInput)(document.activeElement)||!instance.selection.isSelected()&&!(0,_event.isRightClick)(event)){instance.unlisten();}});this.eventManager.addEventListener(document.documentElement,'contextmenu',function(event){if(instance.selection.isInProgress()&&(0,_event.isRightClick)(event)){instance.selection.finish();isMouseDown=false;}});this.eventManager.addEventListener(document.documentElement,'touchend',function(){if(instance.selection.isInProgress()){instance.selection.finish();}
isMouseDown=false;});this.eventManager.addEventListener(document.documentElement,'mousedown',function(event){var originalTarget=event.target;var eventX=event.x||event.clientX;var eventY=event.y||event.clientY;var next=event.target;if(isMouseDown||!instance.rootElement){return;}
if(next===instance.view.wt.wtTable.holder){var scrollbarWidth=(0,_element.getScrollbarWidth)();if(document.elementFromPoint(eventX+scrollbarWidth,eventY)!==instance.view.wt.wtTable.holder||document.elementFromPoint(eventX,eventY+scrollbarWidth)!==instance.view.wt.wtTable.holder){return;}}else{while(next!==document.documentElement){if(next===null){if(event.isTargetWebComponent){break;}
return;}
if(next===instance.rootElement){return;}
next=next.parentNode;}}
var outsideClickDeselects=typeof that.settings.outsideClickDeselects==='function'?that.settings.outsideClickDeselects(originalTarget):that.settings.outsideClickDeselects;if(outsideClickDeselects){instance.deselectCell();}else{instance.destroyEditor(false,false);}});this.eventManager.addEventListener(table,'selectstart',function(event){if(that.settings.fragmentSelection||(0,_element.isInput)(event.target)){return;}
event.preventDefault();});var walkontableConfig={debug:function debug(){return that.settings.debug;},externalRowCalculator:this.instance.getPlugin('autoRowSize')&&this.instance.getPlugin('autoRowSize').isEnabled(),table:table,preventOverflow:function preventOverflow(){return _this.settings.preventOverflow;},stretchH:function stretchH(){return that.settings.stretchH;},data:instance.getDataAtCell,totalRows:function totalRows(){return instance.countRows();},totalColumns:function totalColumns(){return instance.countCols();},fixedColumnsLeft:function fixedColumnsLeft(){return that.settings.fixedColumnsLeft;},fixedRowsTop:function fixedRowsTop(){return that.settings.fixedRowsTop;},fixedRowsBottom:function fixedRowsBottom(){return that.settings.fixedRowsBottom;},minSpareRows:function minSpareRows(){return that.settings.minSpareRows;},renderAllRows:that.settings.renderAllRows,rowHeaders:function rowHeaders(){var headerRenderers=[];if(instance.hasRowHeaders()){headerRenderers.push(function(row,TH){return that.appendRowHeader(row,TH);});}
instance.runHooks('afterGetRowHeaderRenderers',headerRenderers);return headerRenderers;},columnHeaders:function columnHeaders(){var headerRenderers=[];if(instance.hasColHeaders()){headerRenderers.push(function(column,TH){that.appendColHeader(column,TH);});}
instance.runHooks('afterGetColumnHeaderRenderers',headerRenderers);return headerRenderers;},columnWidth:instance.getColWidth,rowHeight:instance.getRowHeight,cellRenderer:function cellRenderer(row,col,TD){var cellProperties=that.instance.getCellMeta(row,col);var prop=that.instance.colToProp(col);var value=that.instance.getDataAtRowProp(row,prop);if(that.instance.hasHook('beforeValueRender')){value=that.instance.runHooks('beforeValueRender',value,cellProperties);}
that.instance.runHooks('beforeRenderer',TD,row,col,prop,value,cellProperties);that.instance.getCellRenderer(cellProperties)(that.instance,TD,row,col,prop,value,cellProperties);that.instance.runHooks('afterRenderer',TD,row,col,prop,value,cellProperties);},selections:that.instance.selection.highlight,hideBorderOnMouseDownOver:function hideBorderOnMouseDownOver(){return that.settings.fragmentSelection;},onCellMouseDown:function onCellMouseDown(event,coords,TD,wt){var blockCalculations={row:false,column:false,cell:false};instance.listen();that.activeWt=wt;isMouseDown=true;instance.runHooks('beforeOnCellMouseDown',event,coords,TD,blockCalculations);if((0,_event.isImmediatePropagationStopped)(event)){return;}
(0,_mouseEventHandler.handleMouseEvent)(event,{coords:coords,selection:instance.selection,controller:blockCalculations});instance.runHooks('afterOnCellMouseDown',event,coords,TD);that.activeWt=that.wt;},onCellContextMenu:function onCellContextMenu(event,coords,TD,wt){that.activeWt=wt;isMouseDown=false;if(instance.selection.isInProgress()){instance.selection.finish();}
instance.runHooks('beforeOnCellContextMenu',event,coords,TD);if((0,_event.isImmediatePropagationStopped)(event)){return;}
instance.runHooks('afterOnCellContextMenu',event,coords,TD);that.activeWt=that.wt;},onCellMouseOut:function onCellMouseOut(event,coords,TD,wt){that.activeWt=wt;instance.runHooks('beforeOnCellMouseOut',event,coords,TD);if((0,_event.isImmediatePropagationStopped)(event)){return;}
instance.runHooks('afterOnCellMouseOut',event,coords,TD);that.activeWt=that.wt;},onCellMouseOver:function onCellMouseOver(event,coords,TD,wt){var blockCalculations={row:false,column:false,cell:false};that.activeWt=wt;instance.runHooks('beforeOnCellMouseOver',event,coords,TD,blockCalculations);if((0,_event.isImmediatePropagationStopped)(event)){return;}
if(isMouseDown){(0,_mouseEventHandler.handleMouseEvent)(event,{coords:coords,selection:instance.selection,controller:blockCalculations});}
instance.runHooks('afterOnCellMouseOver',event,coords,TD);that.activeWt=that.wt;},onCellMouseUp:function onCellMouseUp(event,coords,TD,wt){that.activeWt=wt;instance.runHooks('beforeOnCellMouseUp',event,coords,TD);instance.runHooks('afterOnCellMouseUp',event,coords,TD);that.activeWt=that.wt;},onCellCornerMouseDown:function onCellCornerMouseDown(event){event.preventDefault();instance.runHooks('afterOnCellCornerMouseDown',event);},onCellCornerDblClick:function onCellCornerDblClick(event){event.preventDefault();instance.runHooks('afterOnCellCornerDblClick',event);},beforeDraw:function beforeDraw(force,skipRender){that.beforeRender(force,skipRender);},onDraw:function onDraw(force){that.onDraw(force);},onScrollVertically:function onScrollVertically(){instance.runHooks('afterScrollVertically');},onScrollHorizontally:function onScrollHorizontally(){instance.runHooks('afterScrollHorizontally');},onBeforeRemoveCellClassNames:function onBeforeRemoveCellClassNames(){return instance.runHooks('beforeRemoveCellClassNames');},onAfterDrawSelection:function onAfterDrawSelection(currentRow,currentColumn,cornersOfSelection,layerLevel){return instance.runHooks('afterDrawSelection',currentRow,currentColumn,cornersOfSelection,layerLevel);},onBeforeDrawBorders:function onBeforeDrawBorders(corners,borderClassName){instance.runHooks('beforeDrawBorders',corners,borderClassName);},onBeforeTouchScroll:function onBeforeTouchScroll(){instance.runHooks('beforeTouchScroll');},onAfterMomentumScroll:function onAfterMomentumScroll(){instance.runHooks('afterMomentumScroll');},onBeforeStretchingColumnWidth:function onBeforeStretchingColumnWidth(stretchedWidth,column){return instance.runHooks('beforeStretchingColumnWidth',stretchedWidth,column);},onModifyRowHeaderWidth:function onModifyRowHeaderWidth(rowHeaderWidth){return instance.runHooks('modifyRowHeaderWidth',rowHeaderWidth);},onModifyGetCellCoords:function onModifyGetCellCoords(row,column,topmost){return instance.runHooks('modifyGetCellCoords',row,column,topmost);},viewportRowCalculatorOverride:function viewportRowCalculatorOverride(calc){var rows=instance.countRows();var viewportOffset=that.settings.viewportRowRenderingOffset;if(viewportOffset==='auto'&&that.settings.fixedRowsTop){viewportOffset=10;}
if(typeof viewportOffset==='number'){calc.startRow=Math.max(calc.startRow-viewportOffset,0);calc.endRow=Math.min(calc.endRow+viewportOffset,rows-1);}
if(viewportOffset==='auto'){var center=calc.startRow+calc.endRow-calc.startRow;var offset=Math.ceil(center/rows*12);calc.startRow=Math.max(calc.startRow-offset,0);calc.endRow=Math.min(calc.endRow+offset,rows-1);}
instance.runHooks('afterViewportRowCalculatorOverride',calc);},viewportColumnCalculatorOverride:function viewportColumnCalculatorOverride(calc){var cols=instance.countCols();var viewportOffset=that.settings.viewportColumnRenderingOffset;if(viewportOffset==='auto'&&that.settings.fixedColumnsLeft){viewportOffset=10;}
if(typeof viewportOffset==='number'){calc.startColumn=Math.max(calc.startColumn-viewportOffset,0);calc.endColumn=Math.min(calc.endColumn+viewportOffset,cols-1);}
if(viewportOffset==='auto'){var center=calc.startColumn+calc.endColumn-calc.startColumn;var offset=Math.ceil(center/cols*12);calc.startRow=Math.max(calc.startColumn-offset,0);calc.endColumn=Math.min(calc.endColumn+offset,cols-1);}
instance.runHooks('afterViewportColumnCalculatorOverride',calc);},rowHeaderWidth:function rowHeaderWidth(){return that.settings.rowHeaderWidth;},columnHeaderHeight:function columnHeaderHeight(){var columnHeaderHeight=instance.runHooks('modifyColumnHeaderHeight');return that.settings.columnHeaderHeight||columnHeaderHeight;}};instance.runHooks('beforeInitWalkontable',walkontableConfig);this.wt=new _src.default(walkontableConfig);this.activeWt=this.wt;this.eventManager.addEventListener(that.wt.wtTable.spreader,'mousedown',function(event){if(event.target===that.wt.wtTable.spreader&&event.which===3){(0,_event.stopPropagation)(event);}});this.eventManager.addEventListener(that.wt.wtTable.spreader,'contextmenu',function(event){if(event.target===that.wt.wtTable.spreader&&event.which===3){(0,_event.stopPropagation)(event);}});this.eventManager.addEventListener(document.documentElement,'click',function(){if(that.settings.observeDOMVisibility){if(that.wt.drawInterrupted){that.instance.forceFullRender=true;that.render();}}});}
TableView.prototype.isTextSelectionAllowed=function(el){if((0,_element.isInput)(el)){return true;}
var isChildOfTableBody=(0,_element.isChildOf)(el,this.instance.view.wt.wtTable.spreader);if(this.settings.fragmentSelection===true&&isChildOfTableBody){return true;}
if(this.settings.fragmentSelection==='cell'&&this.isSelectedOnlyCell()&&isChildOfTableBody){return true;}
if(!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell()){return true;}
return false;};TableView.prototype.isSelectedOnlyCell=function(){var _ref=this.instance.getSelectedLast()||[],_ref2=_slicedToArray(_ref,4),row=_ref2[0],col=_ref2[1],rowEnd=_ref2[2],colEnd=_ref2[3];return row!==void 0&&row===rowEnd&&col===colEnd;};TableView.prototype.isCellEdited=function(){var activeEditor=this.instance.getActiveEditor();return activeEditor&&activeEditor.isOpened();};TableView.prototype.beforeRender=function(force,skipRender){if(force){this.instance.runHooks('beforeRender',this.instance.forceFullRender,skipRender);}};TableView.prototype.onDraw=function(force){if(force){this.instance.runHooks('afterRender',this.instance.forceFullRender);}};TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=false;this.instance.renderCall=false;};TableView.prototype.getCellAtCoords=function(coords,topmost){var td=this.wt.getCell(coords,topmost);if(td<0){return null;}
return td;};TableView.prototype.scrollViewport=function(coords,snapToTop,snapToRight,snapToBottom,snapToLeft){return this.wt.scrollViewport(coords,snapToTop,snapToRight,snapToBottom,snapToLeft);};TableView.prototype.scrollViewportHorizontally=function(column,snapToRight,snapToLeft){return this.wt.scrollViewportHorizontally(column,snapToRight,snapToLeft);};TableView.prototype.scrollViewportVertically=function(row,snapToTop,snapToBottom){return this.wt.scrollViewportVertically(row,snapToTop,snapToBottom);};TableView.prototype.appendRowHeader=function(row,TH){if(TH.firstChild){var container=TH.firstChild;if(!(0,_element.hasClass)(container,'relative')){(0,_element.empty)(TH);this.appendRowHeader(row,TH);return;}
this.updateCellHeader(container.querySelector('.rowHeader'),row,this.instance.getRowHeader);}else{var div=document.createElement('div');var span=document.createElement('span');div.className='relative';span.className='rowHeader';this.updateCellHeader(span,row,this.instance.getRowHeader);div.appendChild(span);TH.appendChild(div);}
this.instance.runHooks('afterGetRowHeader',row,TH);};TableView.prototype.appendColHeader=function(col,TH){if(TH.firstChild){var container=TH.firstChild;if((0,_element.hasClass)(container,'relative')){this.updateCellHeader(container.querySelector('.colHeader'),col,this.instance.getColHeader);}else{(0,_element.empty)(TH);this.appendColHeader(col,TH);}}else{var div=document.createElement('div');var span=document.createElement('span');div.className='relative';span.className='colHeader';this.updateCellHeader(span,col,this.instance.getColHeader);div.appendChild(span);TH.appendChild(div);}
this.instance.runHooks('afterGetColHeader',col,TH);};TableView.prototype.updateCellHeader=function(element,index,content){var renderedIndex=index;var parentOverlay=this.wt.wtOverlays.getParentOverlay(element)||this.wt;if(element.parentNode){if((0,_element.hasClass)(element,'colHeader')){renderedIndex=parentOverlay.wtTable.columnFilter.sourceToRendered(index);}else if((0,_element.hasClass)(element,'rowHeader')){renderedIndex=parentOverlay.wtTable.rowFilter.sourceToRendered(index);}}
if(renderedIndex>-1){(0,_element.fastInnerHTML)(element,content(index));}else{(0,_element.fastInnerText)(element,String.fromCharCode(160));(0,_element.addClass)(element,'cornerHeader');}};TableView.prototype.maximumVisibleElementWidth=function(leftOffset){var workspaceWidth=this.wt.wtViewport.getWorkspaceWidth();var maxWidth=workspaceWidth-leftOffset;return maxWidth>0?maxWidth:0;};TableView.prototype.maximumVisibleElementHeight=function(topOffset){var workspaceHeight=this.wt.wtViewport.getWorkspaceHeight();var maxHeight=workspaceHeight-topOffset;return maxHeight>0?maxHeight:0;};TableView.prototype.mainViewIsActive=function(){return this.wt===this.activeWt;};TableView.prototype.destroy=function(){this.wt.destroy();this.eventManager.destroy();};var _default=TableView;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _object=__webpack_require__(2);var _array=__webpack_require__(3);var _number=__webpack_require__(9);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var DataSource=function(){function DataSource(hotInstance){var dataSource=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_classCallCheck(this,DataSource);this.hot=hotInstance;this.data=dataSource;this.dataType='array';this.colToProp=function(){};this.propToCol=function(){};}
_createClass(DataSource,[{key:"getData",value:function getData(){var toArray=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var result=this.data;if(toArray){result=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},true);}
return result;}},{key:"setData",value:function setData(data){this.data=data;}},{key:"getAtColumn",value:function getAtColumn(column){var _this=this;var result=[];(0,_array.arrayEach)(this.data,function(row){var property=_this.colToProp(column);var value;if(typeof property==='string'){value=(0,_object.getProperty)(row,property);}else if(typeof property==='function'){value=property(row);}else{value=row[property];}
result.push(value);});return result;}},{key:"getAtRow",value:function getAtRow(row){return this.data[row];}},{key:"getAtCell",value:function getAtCell(row,column){var result=null;var modifyRowData=this.hot.runHooks('modifyRowData',row);var dataRow=isNaN(modifyRowData)?modifyRowData:this.data[row];if(dataRow){var prop=this.colToProp(column);if(typeof prop==='string'){result=(0,_object.getProperty)(dataRow,prop);}else if(typeof prop==='function'){result=prop(this.data.slice(row,row+1)[0]);}else{result=dataRow[prop];}}
return result;}},{key:"getByRange",value:function getByRange(start,end){var _this2=this;var toArray=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var startRow=Math.min(start.row,end.row);var startCol=Math.min(start.col,end.col);var endRow=Math.max(start.row,end.row);var endCol=Math.max(start.col,end.col);var result=[];(0,_number.rangeEach)(startRow,endRow,function(currentRow){var row=_this2.getAtRow(currentRow);var newRow;if(_this2.dataType==='array'){newRow=row.slice(startCol,endCol+1);}else if(_this2.dataType==='object'){newRow=toArray?[]:{};(0,_number.rangeEach)(startCol,endCol,function(column){var prop=_this2.colToProp(column);if(toArray){newRow.push(row[prop]);}else{newRow[prop]=row[prop];}});}
result.push(newRow);});return result;}},{key:"countRows",value:function countRows(){return Array.isArray(this.data)?this.data.length:0;}},{key:"countColumns",value:function countColumns(){var result=0;if(Array.isArray(this.data)){if(this.dataType==='array'){result=this.data[0].length;}else if(this.dataType==='object'){result=Object.keys(this.data[0]).length;}}
return result;}},{key:"destroy",value:function destroy(){this.data=null;this.hot=null;}}]);return DataSource;}();var _default=DataSource;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var C=_interopRequireWildcard(__webpack_require__(11));var _dictionary;function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
var dictionary=(_dictionary={languageCode:'en-US'},_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ROW_ABOVE,'Insert row above'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ROW_BELOW,'Insert row below'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_INSERT_LEFT,'Insert column left'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_INSERT_RIGHT,'Insert column right'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_REMOVE_ROW,['Remove row','Remove rows']),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_REMOVE_COLUMN,['Remove column','Remove columns']),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_UNDO,'Undo'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_REDO,'Redo'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_READ_ONLY,'Read only'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_CLEAR_COLUMN,'Clear column'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ALIGNMENT,'Alignment'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,'Left'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,'Center'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,'Right'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,'Justify'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,'Top'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,'Middle'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,'Bottom'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_FREEZE_COLUMN,'Freeze column'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,'Unfreeze column'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_BORDERS,'Borders'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_BORDERS_TOP,'Top'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_BORDERS_RIGHT,'Right'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,'Bottom'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_BORDERS_LEFT,'Left'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_REMOVE_BORDERS,'Remove border(s)'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_ADD_COMMENT,'Add comment'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_EDIT_COMMENT,'Edit comment'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_REMOVE_COMMENT,'Delete comment'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,'Read-only comment'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_MERGE_CELLS,'Merge cells'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_UNMERGE_CELLS,'Unmerge cells'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_COPY,'Copy'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_CUT,'Cut'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,'Insert child row'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,'Detach from parent'),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_HIDE_COLUMN,['Hide column','Hide columns']),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_SHOW_COLUMN,['Show column','Show columns']),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_HIDE_ROW,['Hide row','Hide rows']),_defineProperty(_dictionary,C.CONTEXTMENU_ITEMS_SHOW_ROW,['Show row','Show rows']),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_NONE,'None'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_EMPTY,'Is empty'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_NOT_EMPTY,'Is not empty'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_EQUAL,'Is equal to'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_NOT_EQUAL,'Is not equal to'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_BEGINS_WITH,'Begins with'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_ENDS_WITH,'Ends with'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_CONTAINS,'Contains'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_NOT_CONTAIN,'Does not contain'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_GREATER_THAN,'Greater than'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,'Greater than or equal to'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_LESS_THAN,'Less than'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,'Less than or equal to'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_BETWEEN,'Is between'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_NOT_BETWEEN,'Is not between'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_AFTER,'After'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_BEFORE,'Before'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_TODAY,'Today'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_TOMORROW,'Tomorrow'),_defineProperty(_dictionary,C.FILTERS_CONDITIONS_YESTERDAY,'Yesterday'),_defineProperty(_dictionary,C.FILTERS_VALUES_BLANK_CELLS,'Blank cells'),_defineProperty(_dictionary,C.FILTERS_DIVS_FILTER_BY_CONDITION,'Filter by condition'),_defineProperty(_dictionary,C.FILTERS_DIVS_FILTER_BY_VALUE,'Filter by value'),_defineProperty(_dictionary,C.FILTERS_LABELS_CONJUNCTION,'And'),_defineProperty(_dictionary,C.FILTERS_LABELS_DISJUNCTION,'Or'),_defineProperty(_dictionary,C.FILTERS_BUTTONS_SELECT_ALL,'Select all'),_defineProperty(_dictionary,C.FILTERS_BUTTONS_CLEAR,'Clear'),_defineProperty(_dictionary,C.FILTERS_BUTTONS_OK,'OK'),_defineProperty(_dictionary,C.FILTERS_BUTTONS_CANCEL,'Cancel'),_defineProperty(_dictionary,C.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,'Search'),_defineProperty(_dictionary,C.FILTERS_BUTTONS_PLACEHOLDER_VALUE,'Value'),_defineProperty(_dictionary,C.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,'Second value'),_dictionary);var _default=dictionary;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.registerPhraseFormatter=exports.register=register;exports.getPhraseFormatters=exports.getAll=getAll;var _staticRegister2=_interopRequireDefault(__webpack_require__(46));var _pluralize=_interopRequireDefault(__webpack_require__(652));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var _staticRegister=(0,_staticRegister2.default)('phraseFormatters'),registerGloballyPhraseFormatter=_staticRegister.register,getGlobalPhraseFormatters=_staticRegister.getValues;function register(name,formatterFn){registerGloballyPhraseFormatter(name,formatterFn);}
function getAll(){return getGlobalPhraseFormatters();}
register('pluralize',_pluralize.default);}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=pluralize;function pluralize(phrasePropositions,pluralForm){var isPluralizable=Array.isArray(phrasePropositions)&&Number.isInteger(pluralForm);if(isPluralizable){return phrasePropositions[pluralForm];}
return phrasePropositions;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.createHighlight=createHighlight;var _staticRegister2=_interopRequireDefault(__webpack_require__(46));var _activeHeader=_interopRequireDefault(__webpack_require__(654));var _area=_interopRequireDefault(__webpack_require__(655));var _cell=_interopRequireDefault(__webpack_require__(656));var _customSelection=_interopRequireDefault(__webpack_require__(657));var _fill=_interopRequireDefault(__webpack_require__(658));var _header=_interopRequireDefault(__webpack_require__(659));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var _staticRegister=(0,_staticRegister2.default)('highlight/types'),register=_staticRegister.register,getItem=_staticRegister.getItem;register('active-header',_activeHeader.default);register('area',_area.default);register('cell',_cell.default);register('custom-selection',_customSelection.default);register('fill',_fill.default);register('header',_header.default);function createHighlight(highlightType,options){return getItem(highlightType)(options);}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _src=__webpack_require__(8);function createHighlight(_ref){var activeHeaderClassName=_ref.activeHeaderClassName;var s=new _src.Selection({highlightHeaderClassName:activeHeaderClassName});return s;}
var _default=createHighlight;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _src=__webpack_require__(8);function createHighlight(_ref){var layerLevel=_ref.layerLevel,areaCornerVisible=_ref.areaCornerVisible;var s=new _src.Selection({className:'area',markIntersections:true,layerLevel:Math.min(layerLevel,7),border:{width:1,color:'#4b89ff',cornerVisible:areaCornerVisible}});return s;}
var _default=createHighlight;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _src=__webpack_require__(8);function createHighlight(_ref){var cellCornerVisible=_ref.cellCornerVisible;var s=new _src.Selection({className:'current',border:{width:2,color:'#4b89ff',cornerVisible:cellCornerVisible}});return s;}
var _default=createHighlight;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _src=__webpack_require__(8);function createHighlight(_ref){var border=_ref.border,cellRange=_ref.cellRange;var s=new _src.Selection(border,cellRange);return s;}
var _default=createHighlight;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _src=__webpack_require__(8);function createHighlight(){var s=new _src.Selection({className:'fill',border:{width:1,color:'#ff0000'}});return s;}
var _default=createHighlight;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _src=__webpack_require__(8);function createHighlight(_ref){var headerClassName=_ref.headerClassName,rowClassName=_ref.rowClassName,columnClassName=_ref.columnClassName;var s=new _src.Selection({className:'highlight',highlightHeaderClassName:headerClassName,highlightRowClassName:rowClassName,highlightColumnClassName:columnClassName});return s;}
var _default=createHighlight;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _highlight=_interopRequireWildcard(__webpack_require__(430));var _range=_interopRequireDefault(__webpack_require__(661));var _src=__webpack_require__(8);var _keyStateObserver=__webpack_require__(123);var _object=__webpack_require__(2);var _mixed=__webpack_require__(14);var _array=__webpack_require__(3);var _localHooks=_interopRequireDefault(__webpack_require__(68));var _transformation=_interopRequireDefault(__webpack_require__(662));var _utils=__webpack_require__(91);var _templateLiteralTag=__webpack_require__(58);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _templateObject(){var data=_taggedTemplateLiteral(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, columnEnd/columnPropEnd]]) \n        or as an array of CellRange objects."]);_templateObject=function _templateObject(){return data;};return data;}
function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0);}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Selection=function(){function Selection(settings,tableProps){var _this=this;_classCallCheck(this,Selection);this.settings=settings;this.tableProps=tableProps;this.inProgress=false;this.selectedByCorner=false;this.selectedByRowHeader=new Set();this.selectedByColumnHeader=new Set();this.selectedRange=new _range.default();this.highlight=new _highlight.default({headerClassName:settings.currentHeaderClassName,activeHeaderClassName:settings.activeHeaderClassName,rowClassName:settings.currentRowClassName,columnClassName:settings.currentColClassName,disableHighlight:this.settings.disableVisualSelection,cellCornerVisible:function cellCornerVisible(){return _this.isCellCornerVisible.apply(_this,arguments);},areaCornerVisible:function areaCornerVisible(){return _this.isAreaCornerVisible.apply(_this,arguments);}});this.transformation=new _transformation.default(this.selectedRange,{countRows:function countRows(){return _this.tableProps.countRows();},countCols:function countCols(){return _this.tableProps.countCols();},fixedRowsBottom:function fixedRowsBottom(){return settings.fixedRowsBottom;},minSpareRows:function minSpareRows(){return settings.minSpareRows;},minSpareCols:function minSpareCols(){return settings.minSpareCols;},autoWrapRow:function autoWrapRow(){return settings.autoWrapRow;},autoWrapCol:function autoWrapCol(){return settings.autoWrapCol;}});this.transformation.addLocalHook('beforeTransformStart',function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}
return _this.runLocalHooks.apply(_this,['beforeModifyTransformStart'].concat(args));});this.transformation.addLocalHook('afterTransformStart',function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2];}
return _this.runLocalHooks.apply(_this,['afterModifyTransformStart'].concat(args));});this.transformation.addLocalHook('beforeTransformEnd',function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3];}
return _this.runLocalHooks.apply(_this,['beforeModifyTransformEnd'].concat(args));});this.transformation.addLocalHook('afterTransformEnd',function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4];}
return _this.runLocalHooks.apply(_this,['afterModifyTransformEnd'].concat(args));});this.transformation.addLocalHook('insertRowRequire',function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5];}
return _this.runLocalHooks.apply(_this,['insertRowRequire'].concat(args));});this.transformation.addLocalHook('insertColRequire',function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++){args[_key6]=arguments[_key6];}
return _this.runLocalHooks.apply(_this,['insertColRequire'].concat(args));});}
_createClass(Selection,[{key:"getSelectedRange",value:function getSelectedRange(){return this.selectedRange;}},{key:"begin",value:function begin(){this.inProgress=true;}},{key:"finish",value:function finish(){this.runLocalHooks('afterSelectionFinished',Array.from(this.selectedRange));this.inProgress=false;}},{key:"isInProgress",value:function isInProgress(){return this.inProgress;}},{key:"setRangeStart",value:function setRangeStart(coords,multipleSelection){var fragment=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var isMultipleMode=this.settings.selectionMode==='multiple';var isMultipleSelection=(0,_mixed.isUndefined)(multipleSelection)?(0,_keyStateObserver.isPressedCtrlKey)():multipleSelection;var isRowNegative=coords.row<0;var isColumnNegative=coords.col<0;var selectedByCorner=isRowNegative&&isColumnNegative;if(isRowNegative){coords.row=0;}
if(isColumnNegative){coords.col=0;}
this.selectedByCorner=selectedByCorner;this.runLocalHooks("beforeSetRangeStart".concat(fragment?'Only':''),coords);if(!isMultipleMode||isMultipleMode&&!isMultipleSelection&&(0,_mixed.isUndefined)(multipleSelection)){this.selectedRange.clear();}
this.selectedRange.add(coords);if(this.getLayerLevel()===0){this.selectedByRowHeader.clear();this.selectedByColumnHeader.clear();}
if(!selectedByCorner&&isColumnNegative){this.selectedByRowHeader.add(this.getLayerLevel());}
if(!selectedByCorner&&isRowNegative){this.selectedByColumnHeader.add(this.getLayerLevel());}
if(!fragment){this.setRangeEnd(coords);}}},{key:"setRangeStartOnly",value:function setRangeStartOnly(coords,multipleSelection){this.setRangeStart(coords,multipleSelection,true);}},{key:"setRangeEnd",value:function setRangeEnd(coords){if(this.selectedRange.isEmpty()){return;}
this.runLocalHooks('beforeSetRangeEnd',coords);this.begin();var cellRange=this.selectedRange.current();if(this.settings.selectionMode!=='single'){cellRange.setTo(new _src.CellCoords(coords.row,coords.col));}
this.highlight.getCell().clear();if(this.highlight.isEnabledFor(_highlight.CELL_TYPE)){this.highlight.getCell().add(this.selectedRange.current().highlight);}
var layerLevel=this.getLayerLevel();if(layerLevel<this.highlight.layerLevel){(0,_array.arrayEach)(this.highlight.getAreas(),function(highlight){return void highlight.clear();});(0,_array.arrayEach)(this.highlight.getHeaders(),function(highlight){return void highlight.clear();});(0,_array.arrayEach)(this.highlight.getActiveHeaders(),function(highlight){return void highlight.clear();});}
this.highlight.useLayerLevel(layerLevel);var areaHighlight=this.highlight.createOrGetArea();var headerHighlight=this.highlight.createOrGetHeader();var activeHeaderHighlight=this.highlight.createOrGetActiveHeader();areaHighlight.clear();headerHighlight.clear();activeHeaderHighlight.clear();if(this.highlight.isEnabledFor(_highlight.AREA_TYPE)&&(this.isMultiple()||layerLevel>=1)){areaHighlight.add(cellRange.from).add(cellRange.to);if(layerLevel===1){this.highlight.useLayerLevel(layerLevel-1).createOrGetArea().add(this.selectedRange.previous().from);this.highlight.useLayerLevel(layerLevel);}}
if(this.highlight.isEnabledFor(_highlight.HEADER_TYPE)){if(this.settings.selectionMode==='single'){headerHighlight.add(cellRange.highlight);}else{headerHighlight.add(cellRange.from).add(cellRange.to);}}
if(this.isSelectedByRowHeader()){var isRowSelected=this.tableProps.countCols()===cellRange.getWidth();if(isRowSelected){activeHeaderHighlight.add(new _src.CellCoords(cellRange.from.row,-1)).add(new _src.CellCoords(cellRange.to.row,-1));}}
if(this.isSelectedByColumnHeader()){var isColumnSelected=this.tableProps.countRows()===cellRange.getHeight();if(isColumnSelected){activeHeaderHighlight.add(new _src.CellCoords(-1,cellRange.from.col)).add(new _src.CellCoords(-1,cellRange.to.col));}}
this.runLocalHooks('afterSetRangeEnd',coords);}},{key:"isMultiple",value:function isMultiple(){var isMultipleListener=(0,_object.createObjectPropListener)(!this.selectedRange.current().isSingle());this.runLocalHooks('afterIsMultipleSelection',isMultipleListener);return isMultipleListener.value;}},{key:"transformStart",value:function transformStart(rowDelta,colDelta,force){this.setRangeStart(this.transformation.transformStart(rowDelta,colDelta,force));}},{key:"transformEnd",value:function transformEnd(rowDelta,colDelta){this.setRangeEnd(this.transformation.transformEnd(rowDelta,colDelta));}},{key:"getLayerLevel",value:function getLayerLevel(){return this.selectedRange.size()-1;}},{key:"isSelected",value:function isSelected(){return!this.selectedRange.isEmpty();}},{key:"isSelectedByRowHeader",value:function isSelectedByRowHeader(){var layerLevel=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getLayerLevel();return layerLevel===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(layerLevel);}},{key:"isSelectedByColumnHeader",value:function isSelectedByColumnHeader(){var layerLevel=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getLayerLevel();return layerLevel===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(layerLevel);}},{key:"isSelectedByAnyHeader",value:function isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1);}},{key:"isSelectedByCorner",value:function isSelectedByCorner(){return this.selectedByCorner;}},{key:"inInSelection",value:function inInSelection(coords){return this.selectedRange.includes(coords);}},{key:"isCellCornerVisible",value:function isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple();}},{key:"isAreaCornerVisible",value:function isAreaCornerVisible(layerLevel){if(Number.isInteger(layerLevel)&&layerLevel!==this.getLayerLevel()){return false;}
return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple();}},{key:"clear",value:function clear(){this.selectedRange.clear();this.highlight.clear();}},{key:"deselect",value:function deselect(){if(!this.isSelected()){return;}
this.inProgress=false;this.clear();this.runLocalHooks('afterDeselect');}},{key:"selectAll",value:function selectAll(){this.clear();this.setRangeStart(new _src.CellCoords(-1,-1));this.selectedByRowHeader.add(this.getLayerLevel());this.selectedByColumnHeader.add(this.getLayerLevel());this.setRangeEnd(new _src.CellCoords(this.tableProps.countRows()-1,this.tableProps.countCols()-1));}},{key:"selectCells",value:function selectCells(selectionRanges){var _this2=this;var selectionType=(0,_utils.detectSelectionType)(selectionRanges);if(selectionType===_utils.SELECTION_TYPE_EMPTY){return false;}else if(selectionType===_utils.SELECTION_TYPE_UNRECOGNIZED){throw new Error((0,_templateLiteralTag.toSingleLine)(_templateObject()));}
var selectionSchemaNormalizer=(0,_utils.normalizeSelectionFactory)(selectionType,{propToCol:function propToCol(prop){return _this2.tableProps.propToCol(prop);},keepDirection:true});var countRows=this.tableProps.countRows();var countCols=this.tableProps.countCols();var isValid=!selectionRanges.some(function(selection){var _selectionSchemaNorma=selectionSchemaNormalizer(selection),_selectionSchemaNorma2=_slicedToArray(_selectionSchemaNorma,4),rowStart=_selectionSchemaNorma2[0],columnStart=_selectionSchemaNorma2[1],rowEnd=_selectionSchemaNorma2[2],columnEnd=_selectionSchemaNorma2[3];var _isValid=(0,_utils.isValidCoord)(rowStart,countRows)&&(0,_utils.isValidCoord)(columnStart,countCols)&&(0,_utils.isValidCoord)(rowEnd,countRows)&&(0,_utils.isValidCoord)(columnEnd,countCols);return!_isValid;});if(isValid){this.clear();(0,_array.arrayEach)(selectionRanges,function(selection){var _selectionSchemaNorma3=selectionSchemaNormalizer(selection),_selectionSchemaNorma4=_slicedToArray(_selectionSchemaNorma3,4),rowStart=_selectionSchemaNorma4[0],columnStart=_selectionSchemaNorma4[1],rowEnd=_selectionSchemaNorma4[2],columnEnd=_selectionSchemaNorma4[3];_this2.setRangeStartOnly(new _src.CellCoords(rowStart,columnStart),false);_this2.setRangeEnd(new _src.CellCoords(rowEnd,columnEnd));_this2.finish();});}
return isValid;}},{key:"selectColumns",value:function selectColumns(startColumn){var endColumn=arguments.length>1&&arguments[1]!==undefined?arguments[1]:startColumn;var start=typeof startColumn==='string'?this.tableProps.propToCol(startColumn):startColumn;var end=typeof endColumn==='string'?this.tableProps.propToCol(endColumn):endColumn;var countCols=this.tableProps.countCols();var isValid=(0,_utils.isValidCoord)(start,countCols)&&(0,_utils.isValidCoord)(end,countCols);if(isValid){this.setRangeStartOnly(new _src.CellCoords(-1,start));this.setRangeEnd(new _src.CellCoords(this.tableProps.countRows()-1,end));this.finish();}
return isValid;}},{key:"selectRows",value:function selectRows(startRow){var endRow=arguments.length>1&&arguments[1]!==undefined?arguments[1]:startRow;var countRows=this.tableProps.countRows();var isValid=(0,_utils.isValidCoord)(startRow,countRows)&&(0,_utils.isValidCoord)(endRow,countRows);if(isValid){this.setRangeStartOnly(new _src.CellCoords(startRow,-1));this.setRangeEnd(new _src.CellCoords(endRow,this.tableProps.countCols()-1));this.finish();}
return isValid;}}]);return Selection;}();(0,_object.mixin)(Selection,_localHooks.default);var _default=Selection;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _src=__webpack_require__(8);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var SelectionRange=function(){function SelectionRange(){_classCallCheck(this,SelectionRange);this.ranges=[];}
_createClass(SelectionRange,[{key:"isEmpty",value:function isEmpty(){return this.size()===0;}},{key:"set",value:function set(coords){this.clear();this.ranges.push(new _src.CellRange(coords));return this;}},{key:"add",value:function add(coords){this.ranges.push(new _src.CellRange(coords));return this;}},{key:"current",value:function current(){return this.peekByIndex(0);}},{key:"previous",value:function previous(){return this.peekByIndex(-1);}},{key:"includes",value:function includes(coords){return this.ranges.some(function(cellRange){return cellRange.includes(coords);});}},{key:"clear",value:function clear(){this.ranges.length=0;return this;}},{key:"size",value:function size(){return this.ranges.length;}},{key:"peekByIndex",value:function peekByIndex(){var offset=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var rangeIndex=this.size()+offset-1;var cellRange;if(rangeIndex>=0){cellRange=this.ranges[rangeIndex];}
return cellRange;}},{key:Symbol.iterator,value:function value(){return this.ranges[Symbol.iterator]();}}]);return SelectionRange;}();var _default=SelectionRange;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _src=__webpack_require__(8);var _object=__webpack_require__(2);var _localHooks=_interopRequireDefault(__webpack_require__(68));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Transformation=function(){function Transformation(range,options){_classCallCheck(this,Transformation);this.range=range;this.options=options;}
_createClass(Transformation,[{key:"transformStart",value:function transformStart(rowDelta,colDelta,force){var delta=new _src.CellCoords(rowDelta,colDelta);this.runLocalHooks('beforeTransformStart',delta);var totalRows=this.options.countRows();var totalCols=this.options.countCols();var fixedRowsBottom=this.options.fixedRowsBottom();var minSpareRows=this.options.minSpareRows();var minSpareCols=this.options.minSpareCols();var autoWrapRow=this.options.autoWrapRow();var autoWrapCol=this.options.autoWrapCol();var highlightCoords=this.range.current().highlight;if(highlightCoords.row+rowDelta>totalRows-1){if(force&&minSpareRows>0&&!(fixedRowsBottom&&highlightCoords.row>=totalRows-fixedRowsBottom-1)){this.runLocalHooks('insertRowRequire',totalRows);totalRows=this.options.countRows();}else if(autoWrapCol){delta.row=1-totalRows;delta.col=highlightCoords.col+delta.col===totalCols-1?1-totalCols:1;}}else if(autoWrapCol&&highlightCoords.row+delta.row<0&&highlightCoords.col+delta.col>=0){delta.row=totalRows-1;delta.col=highlightCoords.col+delta.col===0?totalCols-1:-1;}
if(highlightCoords.col+delta.col>totalCols-1){if(force&&minSpareCols>0){this.runLocalHooks('insertColRequire',totalCols);totalCols=this.options.countCols();}else if(autoWrapRow){delta.row=highlightCoords.row+delta.row===totalRows-1?1-totalRows:1;delta.col=1-totalCols;}}else if(autoWrapRow&&highlightCoords.col+delta.col<0&&highlightCoords.row+delta.row>=0){delta.row=highlightCoords.row+delta.row===0?totalRows-1:-1;delta.col=totalCols-1;}
var coords=new _src.CellCoords(highlightCoords.row+delta.row,highlightCoords.col+delta.col);var rowTransformDir=0;var colTransformDir=0;if(coords.row<0){rowTransformDir=-1;coords.row=0;}else if(coords.row>0&&coords.row>=totalRows){rowTransformDir=1;coords.row=totalRows-1;}
if(coords.col<0){colTransformDir=-1;coords.col=0;}else if(coords.col>0&&coords.col>=totalCols){colTransformDir=1;coords.col=totalCols-1;}
this.runLocalHooks('afterTransformStart',coords,rowTransformDir,colTransformDir);return coords;}},{key:"transformEnd",value:function transformEnd(rowDelta,colDelta){var delta=new _src.CellCoords(rowDelta,colDelta);this.runLocalHooks('beforeTransformEnd',delta);var totalRows=this.options.countRows();var totalCols=this.options.countCols();var cellRange=this.range.current();var coords=new _src.CellCoords(cellRange.to.row+delta.row,cellRange.to.col+delta.col);var rowTransformDir=0;var colTransformDir=0;if(coords.row<0){rowTransformDir=-1;coords.row=0;}else if(coords.row>0&&coords.row>=totalRows){rowTransformDir=1;coords.row=totalRows-1;}
if(coords.col<0){colTransformDir=-1;coords.col=0;}else if(coords.col>0&&coords.col>=totalCols){colTransformDir=1;coords.col=totalCols-1;}
this.runLocalHooks('afterTransformEnd',coords,rowTransformDir,colTransformDir);return coords;}}]);return Transformation;}();(0,_object.mixin)(Transformation,_localHooks.default);var _default=Transformation;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=jQueryWrapper;function jQueryWrapper(Handsontable){var jQuery=typeof window==='undefined'?false:window.jQuery;if(!jQuery){return;}
jQuery.fn.handsontable=function(action){var $this=this.first();var instance=$this.data('handsontable');if(typeof action!=='string'){var userSettings=action||{};if(instance){instance.updateSettings(userSettings);}else{instance=new Handsontable.Core($this[0],userSettings);$this.data('handsontable',instance);instance.init();}
return $this;}
var output;if(instance){if(typeof instance[action]!=='undefined'){var _instance$action;for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}
output=(_instance$action=instance[action]).call.apply(_instance$action,[instance].concat(args));if(action==='destroy'){$this.removeData();}}else{throw new Error("Handsontable do not provide action: ".concat(action));}}
return output;};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;var _persistentState=_interopRequireDefault(__webpack_require__(665));exports.PersistentState=_persistentState.default;var _autoColumnSize=_interopRequireDefault(__webpack_require__(667));exports.AutoColumnSize=_autoColumnSize.default;var _autofill=_interopRequireDefault(__webpack_require__(668));exports.AutoFill=_autofill.default;var _autoRowSize=_interopRequireDefault(__webpack_require__(670));exports.AutoRowSize=_autoRowSize.default;var _columnSorting=_interopRequireDefault(__webpack_require__(671));exports.ColumnSorting=_columnSorting.default;var _comments=_interopRequireDefault(__webpack_require__(682));exports.Comments=_comments.default;var _contextMenu=_interopRequireDefault(__webpack_require__(686));exports.ContextMenu=_contextMenu.default;var _copyPaste=_interopRequireDefault(__webpack_require__(703));exports.CopyPaste=_copyPaste.default;var _customBorders=_interopRequireDefault(__webpack_require__(711));exports.CustomBorders=_customBorders.default;var _dragToScroll=_interopRequireDefault(__webpack_require__(718));exports.DragToScroll=_dragToScroll.default;var _manualColumnFreeze=_interopRequireDefault(__webpack_require__(719));exports.ManualColumnFreeze=_manualColumnFreeze.default;var _manualColumnMove=_interopRequireDefault(__webpack_require__(723));exports.ManualColumnMove=_manualColumnMove.default;var _manualColumnResize=_interopRequireDefault(__webpack_require__(728));exports.ManualColumnResize=_manualColumnResize.default;var _manualRowMove=_interopRequireDefault(__webpack_require__(729));exports.ManualRowMove=_manualRowMove.default;var _manualRowResize=_interopRequireDefault(__webpack_require__(734));exports.ManualRowResize=_manualRowResize.default;var _mergeCells=_interopRequireDefault(__webpack_require__(735));exports.MergeCells=_mergeCells.default;var _multipleSelectionHandles=_interopRequireDefault(__webpack_require__(741));exports.MultipleSelectionHandles=_multipleSelectionHandles.default;var _observeChanges=_interopRequireDefault(__webpack_require__(742));exports.ObserveChanges=_observeChanges.default;var _search=_interopRequireDefault(__webpack_require__(746));exports.Search=_search.default;var _touchScroll=_interopRequireDefault(__webpack_require__(747));exports.TouchScroll=_touchScroll.default;var _undoRedo=_interopRequireDefault(__webpack_require__(748));exports.UndoRedo=_undoRedo.default;var _base=_interopRequireDefault(__webpack_require__(15));exports.Base=_base.default;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _plugins=__webpack_require__(13);var _storage=_interopRequireDefault(__webpack_require__(666));var _pluginHooks=_interopRequireDefault(__webpack_require__(22));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
_pluginHooks.default.getSingleton().register('persistentStateSave');_pluginHooks.default.getSingleton().register('persistentStateLoad');_pluginHooks.default.getSingleton().register('persistentStateReset');var PersistentState=function(_BasePlugin){_inherits(PersistentState,_BasePlugin);function PersistentState(hotInstance){var _this;_classCallCheck(this,PersistentState);_this=_possibleConstructorReturn(this,_getPrototypeOf(PersistentState).call(this,hotInstance));_this.storage=void 0;return _this;}
_createClass(PersistentState,[{key:"isEnabled",value:function isEnabled(){return!!this.hot.getSettings().persistentState;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
if(!this.storage){this.storage=new _storage.default(this.hot.rootElement.id);}
this.addHook('persistentStateSave',function(key,value){return _this2.saveValue(key,value);});this.addHook('persistentStateLoad',function(key,saveTo){return _this2.loadValue(key,saveTo);});this.addHook('persistentStateReset',function(){return _this2.resetValue();});_get(_getPrototypeOf(PersistentState.prototype),"enablePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){this.storage=void 0;_get(_getPrototypeOf(PersistentState.prototype),"disablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();_get(_getPrototypeOf(PersistentState.prototype),"updatePlugin",this).call(this);}},{key:"loadValue",value:function loadValue(key,saveTo){saveTo.value=this.storage.loadValue(key);}},{key:"saveValue",value:function saveValue(key,value){this.storage.saveValue(key,value);}},{key:"resetValue",value:function resetValue(key){if(typeof key==='undefined'){this.storage.resetAll();}else{this.storage.reset(key);}}},{key:"destroy",value:function destroy(){_get(_getPrototypeOf(PersistentState.prototype),"destroy",this).call(this);}}]);return PersistentState;}(_base.default);(0,_plugins.registerPlugin)('persistentState',PersistentState);var _default=PersistentState;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _array=__webpack_require__(3);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Storage=function(){function Storage(prefix){_classCallCheck(this,Storage);this.prefix=prefix;this.savedKeys=[];this.loadSavedKeys();}
_createClass(Storage,[{key:"saveValue",value:function saveValue(key,value){window.localStorage.setItem("".concat(this.prefix,"_").concat(key),JSON.stringify(value));if(this.savedKeys.indexOf(key)===-1){this.savedKeys.push(key);this.saveSavedKeys();}}},{key:"loadValue",value:function loadValue(key,defaultValue){var itemKey=typeof key==='undefined'?defaultValue:key;var value=window.localStorage.getItem("".concat(this.prefix,"_").concat(itemKey));return value===null?void 0:JSON.parse(value);}},{key:"reset",value:function reset(key){window.localStorage.removeItem("".concat(this.prefix,"_").concat(key));}},{key:"resetAll",value:function resetAll(){var _this=this;(0,_array.arrayEach)(this.savedKeys,function(value,index){window.localStorage.removeItem("".concat(_this.prefix,"_").concat(_this.savedKeys[index]));});this.clearSavedKeys();}},{key:"loadSavedKeys",value:function loadSavedKeys(){var keysJSON=window.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys"));var keys=typeof keysJSON==='string'?JSON.parse(keysJSON):void 0;this.savedKeys=keys||[];}},{key:"saveSavedKeys",value:function saveSavedKeys(){window.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys));}},{key:"clearSavedKeys",value:function clearSavedKeys(){this.savedKeys.length=0;this.saveSavedKeys();}}]);return Storage;}();var _default=Storage;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _array=__webpack_require__(3);var _feature=__webpack_require__(47);var _element=__webpack_require__(1);var _ghostTable=_interopRequireDefault(__webpack_require__(124));var _object=__webpack_require__(2);var _number=__webpack_require__(9);var _plugins=__webpack_require__(13);var _samplesGenerator=_interopRequireDefault(__webpack_require__(431));var _string=__webpack_require__(48);var _src=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
var privatePool=new WeakMap();var AutoColumnSize=function(_BasePlugin){_inherits(AutoColumnSize,_BasePlugin);_createClass(AutoColumnSize,null,[{key:"CALCULATION_STEP",get:function get(){return 50;}},{key:"SYNC_CALCULATION_LIMIT",get:function get(){return 50;}}]);function AutoColumnSize(hotInstance){var _this;_classCallCheck(this,AutoColumnSize);_this=_possibleConstructorReturn(this,_getPrototypeOf(AutoColumnSize).call(this,hotInstance));privatePool.set(_assertThisInitialized(_assertThisInitialized(_this)),{cachedColumnHeaders:[]});_this.widths=[];_this.ghostTable=new _ghostTable.default(_this.hot);_this.samplesGenerator=new _samplesGenerator.default(function(row,column){var cellMeta=_this.hot.getCellMeta(row,column);var cellValue='';if(!cellMeta.spanned){cellValue=_this.hot.getDataAtCell(row,column);}
var bundleCountSeed=0;if(cellMeta.label){var _cellMeta$label=cellMeta.label,labelValue=_cellMeta$label.value,labelProperty=_cellMeta$label.property;var labelText='';if(labelValue){labelText=typeof labelValue==='function'?labelValue(row,column,_this.hot.colToProp(column),cellValue):labelValue;}else if(labelProperty){labelText=_this.hot.getDataAtRowProp(row,labelProperty);}
bundleCountSeed=labelText.length;}
return{value:cellValue,bundleCountSeed:bundleCountSeed};});_this.firstCalculation=true;_this.inProgress=false;_this.addHook('beforeColumnResize',function(col,size,isDblClick){return _this.onBeforeColumnResize(col,size,isDblClick);});return _this;}
_createClass(AutoColumnSize,[{key:"isEnabled",value:function isEnabled(){return this.hot.getSettings().autoColumnSize!==false&&!this.hot.getSettings().colWidths;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
var setting=this.hot.getSettings().autoColumnSize;if(setting&&setting.useHeaders!==null&&setting.useHeaders!==void 0){this.ghostTable.setSetting('useHeaders',setting.useHeaders);}
this.setSamplingOptions();this.addHook('afterLoadData',function(){return _this2.onAfterLoadData();});this.addHook('beforeChange',function(changes){return _this2.onBeforeChange(changes);});this.addHook('beforeRender',function(force){return _this2.onBeforeRender(force);});this.addHook('modifyColWidth',function(width,col){return _this2.getColumnWidth(col,width);});this.addHook('afterInit',function(){return _this2.onAfterInit();});_get(_getPrototypeOf(AutoColumnSize.prototype),"enablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){var changedColumns=this.findColumnsWhereHeaderWasChanged();if(changedColumns.length){this.clearCache(changedColumns);}
_get(_getPrototypeOf(AutoColumnSize.prototype),"updatePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){_get(_getPrototypeOf(AutoColumnSize.prototype),"disablePlugin",this).call(this);}},{key:"calculateColumnsWidth",value:function calculateColumnsWidth(){var _this3=this;var colRange=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countCols()-1};var rowRange=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{from:0,to:this.hot.countRows()-1};var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var columnsRange=typeof colRange==='number'?{from:colRange,to:colRange}:colRange;var rowsRange=typeof rowRange==='number'?{from:rowRange,to:rowRange}:rowRange;(0,_number.rangeEach)(columnsRange.from,columnsRange.to,function(col){if(force||_this3.widths[col]===void 0&&!_this3.hot._getColWidthFromSettings(col)){var samples=_this3.samplesGenerator.generateColumnSamples(col,rowsRange);(0,_array.arrayEach)(samples,function(_ref){var _ref2=_slicedToArray(_ref,2),column=_ref2[0],sample=_ref2[1];return _this3.ghostTable.addColumn(column,sample);});}});if(this.ghostTable.columns.length){this.ghostTable.getWidths(function(col,width){_this3.widths[col]=width;});this.ghostTable.clean();}}},{key:"calculateAllColumnsWidth",value:function calculateAllColumnsWidth(){var _this4=this;var rowRange=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countRows()-1};var current=0;var length=this.hot.countCols()-1;var timer=null;this.inProgress=true;var loop=function loop(){if(!_this4.hot){(0,_feature.cancelAnimationFrame)(timer);_this4.inProgress=false;return;}
_this4.calculateColumnsWidth({from:current,to:Math.min(current+AutoColumnSize.CALCULATION_STEP,length)},rowRange);current=current+AutoColumnSize.CALCULATION_STEP+1;if(current<length){timer=(0,_feature.requestAnimationFrame)(loop);}else{(0,_feature.cancelAnimationFrame)(timer);_this4.inProgress=false;_this4.hot.view.wt.wtOverlays.adjustElementsSize(true);if(_this4.hot.view.wt.wtOverlays.leftOverlay.needFullRender){_this4.hot.view.wt.wtOverlays.leftOverlay.clone.draw();}}};var syncLimit=this.getSyncCalculationLimit();if(this.firstCalculation&&syncLimit>=0){this.calculateColumnsWidth({from:0,to:syncLimit},rowRange);this.firstCalculation=false;current=syncLimit+1;}
if(current<length){loop();}else{this.inProgress=false;}}},{key:"setSamplingOptions",value:function setSamplingOptions(){var setting=this.hot.getSettings().autoColumnSize;var samplingRatio=setting&&(0,_object.hasOwnProperty)(setting,'samplingRatio')?this.hot.getSettings().autoColumnSize.samplingRatio:void 0;var allowSampleDuplicates=setting&&(0,_object.hasOwnProperty)(setting,'allowSampleDuplicates')?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;if(samplingRatio&&!isNaN(samplingRatio)){this.samplesGenerator.setSampleCount(parseInt(samplingRatio,10));}
if(allowSampleDuplicates){this.samplesGenerator.setAllowDuplicates(allowSampleDuplicates);}}},{key:"recalculateAllColumnsWidth",value:function recalculateAllColumnsWidth(){if(this.hot.view&&(0,_element.isVisible)(this.hot.view.wt.wtTable.TABLE)){this.clearCache();this.calculateAllColumnsWidth();}}},{key:"getSyncCalculationLimit",value:function getSyncCalculationLimit(){var limit=AutoColumnSize.SYNC_CALCULATION_LIMIT;var colsLimit=this.hot.countCols()-1;if((0,_object.isObject)(this.hot.getSettings().autoColumnSize)){limit=this.hot.getSettings().autoColumnSize.syncLimit;if((0,_string.isPercentValue)(limit)){limit=(0,_number.valueAccordingPercent)(colsLimit,limit);}else{limit>>=0;}}
return Math.min(limit,colsLimit);}},{key:"getColumnWidth",value:function getColumnWidth(column){var defaultWidth=arguments.length>1&&arguments[1]!==undefined?arguments[1]:void 0;var keepMinimum=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var width=defaultWidth;if(width===void 0){width=this.widths[column];if(keepMinimum&&typeof width==='number'){width=Math.max(width,_src.ViewportColumnsCalculator.DEFAULT_WIDTH);}}
return width;}},{key:"getFirstVisibleColumn",value:function getFirstVisibleColumn(){var wot=this.hot.view.wt;if(wot.wtViewport.columnsVisibleCalculator){return wot.wtTable.getFirstVisibleColumn();}
if(wot.wtViewport.columnsRenderCalculator){return wot.wtTable.getFirstRenderedColumn();}
return-1;}},{key:"getLastVisibleColumn",value:function getLastVisibleColumn(){var wot=this.hot.view.wt;if(wot.wtViewport.columnsVisibleCalculator){return wot.wtTable.getLastVisibleColumn();}
if(wot.wtViewport.columnsRenderCalculator){return wot.wtTable.getLastRenderedColumn();}
return-1;}},{key:"findColumnsWhereHeaderWasChanged",value:function findColumnsWhereHeaderWasChanged(){var columnHeaders=this.hot.getColHeader();var _privatePool$get=privatePool.get(this),cachedColumnHeaders=_privatePool$get.cachedColumnHeaders;var changedColumns=(0,_array.arrayReduce)(columnHeaders,function(acc,columnTitle,physicalColumn){var cachedColumnsLength=cachedColumnHeaders.length;if(cachedColumnsLength-1<physicalColumn||cachedColumnHeaders[physicalColumn]!==columnTitle){acc.push(physicalColumn);}
if(cachedColumnsLength-1<physicalColumn){cachedColumnHeaders.push(columnTitle);}else{cachedColumnHeaders[physicalColumn]=columnTitle;}
return acc;},[]);return changedColumns;}},{key:"clearCache",value:function clearCache(){var _this5=this;var columns=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(columns.length){(0,_array.arrayEach)(columns,function(physicalIndex){_this5.widths[physicalIndex]=void 0;});}else{this.widths.length=0;}}},{key:"isNeedRecalculate",value:function isNeedRecalculate(){return!!(0,_array.arrayFilter)(this.widths,function(item){return item===void 0;}).length;}},{key:"onBeforeRender",value:function onBeforeRender(){var force=this.hot.renderCall;var rowsCount=this.hot.countRows();var firstVisibleColumn=this.getFirstVisibleColumn();var lastVisibleColumn=this.getLastVisibleColumn();if(firstVisibleColumn===null||lastVisibleColumn===null){return;}
if(!rowsCount){return;}
this.calculateColumnsWidth({from:firstVisibleColumn,to:lastVisibleColumn},void 0,force);if(this.isNeedRecalculate()&&!this.inProgress){this.calculateAllColumnsWidth();}}},{key:"onAfterLoadData",value:function onAfterLoadData(){var _this6=this;if(this.hot.view){this.recalculateAllColumnsWidth();}else{setTimeout(function(){if(_this6.hot){_this6.recalculateAllColumnsWidth();}},0);}}},{key:"onBeforeChange",value:function onBeforeChange(changes){var _this7=this;var changedColumns=(0,_array.arrayMap)(changes,function(_ref3){var _ref4=_slicedToArray(_ref3,2),column=_ref4[1];return _this7.hot.propToCol(column);});this.clearCache(changedColumns);}},{key:"onBeforeColumnResize",value:function onBeforeColumnResize(col,size,isDblClick){var newSize=size;if(isDblClick){this.calculateColumnsWidth(col,void 0,true);newSize=this.getColumnWidth(col,void 0,false);}
return newSize;}},{key:"onAfterInit",value:function onAfterInit(){privatePool.get(this).cachedColumnHeaders=this.hot.getColHeader();}},{key:"destroy",value:function destroy(){this.ghostTable.clean();_get(_getPrototypeOf(AutoColumnSize.prototype),"destroy",this).call(this);}}]);return AutoColumnSize;}(_base.default);(0,_plugins.registerPlugin)('autoColumnSize',AutoColumnSize);var _default=AutoColumnSize;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _element=__webpack_require__(1);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _plugins=__webpack_require__(13);var _src=__webpack_require__(8);var _utils=__webpack_require__(669);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
_pluginHooks.default.getSingleton().register('modifyAutofillRange');_pluginHooks.default.getSingleton().register('beforeAutofill');var INSERT_ROW_ALTER_ACTION_NAME='insert_row';var INTERVAL_FOR_ADDING_ROW=200;var Autofill=function(_BasePlugin){_inherits(Autofill,_BasePlugin);function Autofill(hotInstance){var _this;_classCallCheck(this,Autofill);_this=_possibleConstructorReturn(this,_getPrototypeOf(Autofill).call(this,hotInstance));_this.eventManager=new _eventManager.default(_assertThisInitialized(_assertThisInitialized(_this)));_this.addingStarted=false;_this.mouseDownOnCellCorner=false;_this.mouseDragOutside=false;_this.handleDraggedCells=0;_this.directions=[];_this.autoInsertRow=false;return _this;}
_createClass(Autofill,[{key:"isEnabled",value:function isEnabled(){return this.hot.getSettings().fillHandle;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.mapSettings();this.registerEvents();this.addHook('afterOnCellCornerMouseDown',function(event){return _this2.onAfterCellCornerMouseDown(event);});this.addHook('afterOnCellCornerDblClick',function(event){return _this2.onCellCornerDblClick(event);});this.addHook('beforeOnCellMouseOver',function(event,coords){return _this2.onBeforeCellMouseOver(coords);});_get(_getPrototypeOf(Autofill.prototype),"enablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();_get(_getPrototypeOf(Autofill.prototype),"updatePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){this.clearMappedSettings();_get(_getPrototypeOf(Autofill.prototype),"disablePlugin",this).call(this);}},{key:"getSelectionData",value:function getSelectionData(){var selRange={from:this.hot.getSelectedRangeLast().from,to:this.hot.getSelectedRangeLast().to};return this.hot.getData(selRange.from.row,selRange.from.col,selRange.to.row,selRange.to.col);}},{key:"fillIn",value:function fillIn(){if(this.hot.selection.highlight.getFill().isEmpty()){return false;}
var cornersOfSelectionAndDragAreas=this.hot.selection.highlight.getFill().getCorners();this.resetSelectionOfDraggedArea();var cornersOfSelectedCells=this.getCornersOfSelectedCells();cornersOfSelectionAndDragAreas=this.hot.runHooks('modifyAutofillRange',cornersOfSelectionAndDragAreas,cornersOfSelectedCells);var _getDragDirectionAndR=(0,_utils.getDragDirectionAndRange)(cornersOfSelectedCells,cornersOfSelectionAndDragAreas),directionOfDrag=_getDragDirectionAndR.directionOfDrag,startOfDragCoords=_getDragDirectionAndR.startOfDragCoords,endOfDragCoords=_getDragDirectionAndR.endOfDragCoords;if(startOfDragCoords&&startOfDragCoords.row>-1&&startOfDragCoords.col>-1){var selectionData=this.getSelectionData();this.hot.runHooks('beforeAutofill',startOfDragCoords,endOfDragCoords,selectionData);var deltas=(0,_utils.getDeltas)(startOfDragCoords,endOfDragCoords,selectionData,directionOfDrag);var fillData=selectionData;if(['up','left'].indexOf(directionOfDrag)>-1){fillData=[];var dragLength=null;var fillOffset=null;if(directionOfDrag==='up'){dragLength=endOfDragCoords.row-startOfDragCoords.row+1;fillOffset=dragLength%selectionData.length;for(var i=0;i<dragLength;i++){fillData.push(selectionData[(i+(selectionData.length-fillOffset))%selectionData.length]);}}else{dragLength=endOfDragCoords.col-startOfDragCoords.col+1;fillOffset=dragLength%selectionData[0].length;for(var _i=0;_i<selectionData.length;_i++){fillData.push([]);for(var j=0;j<dragLength;j++){fillData[_i].push(selectionData[_i][(j+(selectionData[_i].length-fillOffset))%selectionData[_i].length]);}}}}
this.hot.populateFromArray(startOfDragCoords.row,startOfDragCoords.col,fillData,endOfDragCoords.row,endOfDragCoords.col,"".concat(this.pluginName,".fill"),null,directionOfDrag,deltas);this.setSelection(cornersOfSelectionAndDragAreas);}else{this.hot._refreshBorders();}
return true;}},{key:"reduceSelectionAreaIfNeeded",value:function reduceSelectionAreaIfNeeded(coords){if(coords.row<0){coords.row=0;}
if(coords.col<0){coords.col=0;}
return coords;}},{key:"getCoordsOfDragAndDropBorders",value:function getCoordsOfDragAndDropBorders(coordsOfSelection){var topLeftCorner=this.hot.getSelectedRangeLast().getTopLeftCorner();var bottomRightCorner=this.hot.getSelectedRangeLast().getBottomRightCorner();var coords;if(this.directions.includes(_utils.DIRECTIONS.vertical)&&(bottomRightCorner.row<coordsOfSelection.row||topLeftCorner.row>coordsOfSelection.row)){coords=new _src.CellCoords(coordsOfSelection.row,bottomRightCorner.col);}else if(this.directions.includes(_utils.DIRECTIONS.horizontal)){coords=new _src.CellCoords(bottomRightCorner.row,coordsOfSelection.col);}else{return;}
return this.reduceSelectionAreaIfNeeded(coords);}},{key:"showBorder",value:function showBorder(coordsOfSelection){var coordsOfDragAndDropBorders=this.getCoordsOfDragAndDropBorders(coordsOfSelection);if(coordsOfDragAndDropBorders){this.redrawBorders(coordsOfDragAndDropBorders);}}},{key:"addRow",value:function addRow(){var _this3=this;this.hot._registerTimeout(setTimeout(function(){_this3.hot.alter(INSERT_ROW_ALTER_ACTION_NAME,void 0,1,"".concat(_this3.pluginName,".fill"));_this3.addingStarted=false;},INTERVAL_FOR_ADDING_ROW));}},{key:"addNewRowIfNeeded",value:function addNewRowIfNeeded(){if(this.hot.selection.highlight.getFill().cellRange&&this.addingStarted===false&&this.autoInsertRow){var cornersOfSelectedCells=this.hot.getSelectedLast();var cornersOfSelectedDragArea=this.hot.selection.highlight.getFill().getCorners();var nrOfTableRows=this.hot.countRows();if(cornersOfSelectedCells[2]<nrOfTableRows-1&&cornersOfSelectedDragArea[2]===nrOfTableRows-1){this.addingStarted=true;this.addRow();}}}},{key:"getCornersOfSelectedCells",value:function getCornersOfSelectedCells(){if(this.hot.selection.isMultiple()){return this.hot.selection.highlight.createOrGetArea().getCorners();}
return this.hot.selection.highlight.getCell().getCorners();}},{key:"getIndexOfLastAdjacentFilledInRow",value:function getIndexOfLastAdjacentFilledInRow(cornersOfSelectedCells){var data=this.hot.getData();var nrOfTableRows=this.hot.countRows();var lastFilledInRowIndex;for(var rowIndex=cornersOfSelectedCells[2]+1;rowIndex<nrOfTableRows;rowIndex++){for(var columnIndex=cornersOfSelectedCells[1];columnIndex<=cornersOfSelectedCells[3];columnIndex++){var dataInCell=data[rowIndex][columnIndex];if(dataInCell){return-1;}}
var dataInNextLeftCell=data[rowIndex][cornersOfSelectedCells[1]-1];var dataInNextRightCell=data[rowIndex][cornersOfSelectedCells[3]+1];if(!!dataInNextLeftCell||!!dataInNextRightCell){lastFilledInRowIndex=rowIndex;}}
return lastFilledInRowIndex;}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function addSelectionFromStartAreaToSpecificRowIndex(selectStartArea,rowIndex){this.hot.selection.highlight.getFill().clear().add(new _src.CellCoords(selectStartArea[0],selectStartArea[1])).add(new _src.CellCoords(rowIndex,selectStartArea[3]));}},{key:"setSelection",value:function setSelection(cornersOfArea){var _this$hot;(_this$hot=this.hot).selectCell.apply(_this$hot,_toConsumableArray(cornersOfArea).concat([false,false]));}},{key:"selectAdjacent",value:function selectAdjacent(){var cornersOfSelectedCells=this.getCornersOfSelectedCells();var lastFilledInRowIndex=this.getIndexOfLastAdjacentFilledInRow(cornersOfSelectedCells);if(lastFilledInRowIndex===-1||lastFilledInRowIndex===void 0){return false;}
this.addSelectionFromStartAreaToSpecificRowIndex(cornersOfSelectedCells,lastFilledInRowIndex);return true;}},{key:"resetSelectionOfDraggedArea",value:function resetSelectionOfDraggedArea(){this.handleDraggedCells=0;this.hot.selection.highlight.getFill().clear();}},{key:"redrawBorders",value:function redrawBorders(coords){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(coords);this.hot.view.render();}},{key:"getIfMouseWasDraggedOutside",value:function getIfMouseWasDraggedOutside(event){var tableBottom=(0,_element.offset)(this.hot.table).top-(window.pageYOffset||document.documentElement.scrollTop)+(0,_element.outerHeight)(this.hot.table);var tableRight=(0,_element.offset)(this.hot.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+(0,_element.outerWidth)(this.hot.table);return event.clientY>tableBottom&&event.clientX<=tableRight;}},{key:"registerEvents",value:function registerEvents(){var _this4=this;this.eventManager.addEventListener(document.documentElement,'mouseup',function(){return _this4.onMouseUp();});this.eventManager.addEventListener(document.documentElement,'mousemove',function(event){return _this4.onMouseMove(event);});}},{key:"onCellCornerDblClick",value:function onCellCornerDblClick(){var selectionApplied=this.selectAdjacent();if(selectionApplied){this.fillIn();}}},{key:"onAfterCellCornerMouseDown",value:function onAfterCellCornerMouseDown(){this.handleDraggedCells=1;this.mouseDownOnCellCorner=true;}},{key:"onBeforeCellMouseOver",value:function onBeforeCellMouseOver(coords){if(this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells){this.handleDraggedCells+=1;this.showBorder(coords);this.addNewRowIfNeeded();}}},{key:"onMouseUp",value:function onMouseUp(){if(this.handleDraggedCells){if(this.handleDraggedCells>1){this.fillIn();}
this.handleDraggedCells=0;this.mouseDownOnCellCorner=false;}}},{key:"onMouseMove",value:function onMouseMove(event){var mouseWasDraggedOutside=this.getIfMouseWasDraggedOutside(event);if(this.addingStarted===false&&this.handleDraggedCells>0&&mouseWasDraggedOutside){this.mouseDragOutside=true;this.addingStarted=true;}else{this.mouseDragOutside=false;}
if(this.mouseDragOutside&&this.autoInsertRow){this.addRow();}}},{key:"clearMappedSettings",value:function clearMappedSettings(){this.directions.length=0;this.autoInsertRow=false;}},{key:"mapSettings",value:function mapSettings(){var mappedSettings=(0,_utils.getMappedFillHandleSetting)(this.hot.getSettings().fillHandle);this.directions=mappedSettings.directions;this.autoInsertRow=mappedSettings.autoInsertRow;}},{key:"destroy",value:function destroy(){_get(_getPrototypeOf(Autofill.prototype),"destroy",this).call(this);}}]);return Autofill;}(_base.default);(0,_plugins.registerPlugin)('autofill',Autofill);var _default=Autofill;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.getDeltas=getDeltas;exports.getDragDirectionAndRange=getDragDirectionAndRange;exports.getMappedFillHandleSetting=getMappedFillHandleSetting;exports.DIRECTIONS=void 0;var _object=__webpack_require__(2);var _mixed=__webpack_require__(14);var _src=__webpack_require__(8);var DIRECTIONS={horizontal:'horizontal',vertical:'vertical'};exports.DIRECTIONS=DIRECTIONS;function getDeltas(start,end,data,direction){var rowsLength=data.length;var columnsLength=data?data[0].length:0;var deltas=[];var diffRow=end.row-start.row;var diffCol=end.col-start.col;if(['down','up'].indexOf(direction)!==-1){var arr=[];for(var col=0;col<=diffCol;col++){var startValue=parseInt(data[0][col],10);var endValue=parseInt(data[rowsLength-1][col],10);var delta=(direction==='down'?endValue-startValue:startValue-endValue)/(rowsLength-1)||0;arr.push(delta);}
deltas.push(arr);}
if(['right','left'].indexOf(direction)!==-1){for(var row=0;row<=diffRow;row++){var _startValue=parseInt(data[row][0],10);var _endValue=parseInt(data[row][columnsLength-1],10);var _delta=(direction==='right'?_endValue-_startValue:_startValue-_endValue)/(columnsLength-1)||0;deltas.push([_delta]);}}
return deltas;}
function getDragDirectionAndRange(startSelection,endSelection){var startOfDragCoords;var endOfDragCoords;var directionOfDrag;if(endSelection[0]===startSelection[0]&&endSelection[1]<startSelection[1]){directionOfDrag='left';startOfDragCoords=new _src.CellCoords(endSelection[0],endSelection[1]);endOfDragCoords=new _src.CellCoords(endSelection[2],startSelection[1]-1);}else if(endSelection[2]===startSelection[2]&&endSelection[0]===startSelection[0]&&endSelection[3]>startSelection[3]){directionOfDrag='right';startOfDragCoords=new _src.CellCoords(endSelection[0],startSelection[3]+1);endOfDragCoords=new _src.CellCoords(endSelection[2],endSelection[3]);}else if(endSelection[0]<startSelection[0]&&endSelection[1]===startSelection[1]){directionOfDrag='up';startOfDragCoords=new _src.CellCoords(endSelection[0],endSelection[1]);endOfDragCoords=new _src.CellCoords(startSelection[0]-1,endSelection[3]);}else if(endSelection[2]>startSelection[2]&&endSelection[1]===startSelection[1]){directionOfDrag='down';startOfDragCoords=new _src.CellCoords(startSelection[2]+1,endSelection[1]);endOfDragCoords=new _src.CellCoords(endSelection[2],endSelection[3]);}
return{directionOfDrag:directionOfDrag,startOfDragCoords:startOfDragCoords,endOfDragCoords:endOfDragCoords};}
function getMappedFillHandleSetting(fillHandle){var mappedSettings={};if(fillHandle===true){mappedSettings.directions=Object.keys(DIRECTIONS);mappedSettings.autoInsertRow=true;}else if((0,_object.isObject)(fillHandle)){if((0,_mixed.isDefined)(fillHandle.autoInsertRow)){if(fillHandle.direction===DIRECTIONS.horizontal){mappedSettings.autoInsertRow=false;}else{mappedSettings.autoInsertRow=fillHandle.autoInsertRow;}}else{mappedSettings.autoInsertRow=false;}
if((0,_mixed.isDefined)(fillHandle.direction)){mappedSettings.directions=[fillHandle.direction];}else{mappedSettings.directions=Object.keys(DIRECTIONS);}}else if(typeof fillHandle==='string'){mappedSettings.directions=[fillHandle];mappedSettings.autoInsertRow=true;}else{mappedSettings.directions=[];mappedSettings.autoInsertRow=false;}
return mappedSettings;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _array=__webpack_require__(3);var _feature=__webpack_require__(47);var _element=__webpack_require__(1);var _ghostTable=_interopRequireDefault(__webpack_require__(124));var _object=__webpack_require__(2);var _number=__webpack_require__(9);var _plugins=__webpack_require__(13);var _samplesGenerator=_interopRequireDefault(__webpack_require__(431));var _string=__webpack_require__(48);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var AutoRowSize=function(_BasePlugin){_inherits(AutoRowSize,_BasePlugin);_createClass(AutoRowSize,null,[{key:"CALCULATION_STEP",get:function get(){return 50;}},{key:"SYNC_CALCULATION_LIMIT",get:function get(){return 500;}}]);function AutoRowSize(hotInstance){var _this;_classCallCheck(this,AutoRowSize);_this=_possibleConstructorReturn(this,_getPrototypeOf(AutoRowSize).call(this,hotInstance));_this.heights=[];_this.ghostTable=new _ghostTable.default(_this.hot);_this.samplesGenerator=new _samplesGenerator.default(function(row,col){var cellValue;if(row>=0){cellValue=_this.hot.getDataAtCell(row,col);}else if(row===-1){cellValue=_this.hot.getColHeader(col);}
return{value:cellValue};});_this.firstCalculation=true;_this.inProgress=false;_this.addHook('beforeRowResize',function(row,size,isDblClick){return _this.onBeforeRowResize(row,size,isDblClick);});return _this;}
_createClass(AutoRowSize,[{key:"isEnabled",value:function isEnabled(){return this.hot.getSettings().autoRowSize===true||(0,_object.isObject)(this.hot.getSettings().autoRowSize);}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.setSamplingOptions();this.addHook('afterLoadData',function(){return _this2.onAfterLoadData();});this.addHook('beforeChange',function(changes){return _this2.onBeforeChange(changes);});this.addHook('beforeColumnMove',function(){return _this2.recalculateAllRowsHeight();});this.addHook('beforeColumnResize',function(){return _this2.recalculateAllRowsHeight();});this.addHook('beforeColumnSort',function(){return _this2.clearCache();});this.addHook('beforeRender',function(force){return _this2.onBeforeRender(force);});this.addHook('beforeRowMove',function(rowStart,rowEnd){return _this2.onBeforeRowMove(rowStart,rowEnd);});this.addHook('modifyRowHeight',function(height,row){return _this2.getRowHeight(row,height);});this.addHook('modifyColumnHeaderHeight',function(){return _this2.getColumnHeaderHeight();});_get(_getPrototypeOf(AutoRowSize.prototype),"enablePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){_get(_getPrototypeOf(AutoRowSize.prototype),"disablePlugin",this).call(this);}},{key:"calculateRowsHeight",value:function calculateRowsHeight(){var _this3=this;var rowRange=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countRows()-1};var colRange=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{from:0,to:this.hot.countCols()-1};var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var rowsRange=typeof rowRange==='number'?{from:rowRange,to:rowRange}:rowRange;var columnsRange=typeof colRange==='number'?{from:colRange,to:colRange}:colRange;if(this.hot.getColHeader(0)!==null){var samples=this.samplesGenerator.generateRowSamples(-1,columnsRange);this.ghostTable.addColumnHeadersRow(samples.get(-1));}
(0,_number.rangeEach)(rowsRange.from,rowsRange.to,function(row){if(force||_this3.heights[row]===void 0){var _samples=_this3.samplesGenerator.generateRowSamples(row,columnsRange);(0,_array.arrayEach)(_samples,function(_ref){var _ref2=_slicedToArray(_ref,2),rowIndex=_ref2[0],sample=_ref2[1];return _this3.ghostTable.addRow(rowIndex,sample);});}});if(this.ghostTable.rows.length){this.ghostTable.getHeights(function(row,height){_this3.heights[row]=height;});this.ghostTable.clean();}}},{key:"calculateAllRowsHeight",value:function calculateAllRowsHeight(){var _this4=this;var colRange=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{from:0,to:this.hot.countCols()-1};var current=0;var length=this.hot.countRows()-1;var timer=null;this.inProgress=true;var loop=function loop(){if(!_this4.hot){(0,_feature.cancelAnimationFrame)(timer);_this4.inProgress=false;return;}
_this4.calculateRowsHeight({from:current,to:Math.min(current+AutoRowSize.CALCULATION_STEP,length)},colRange);current=current+AutoRowSize.CALCULATION_STEP+1;if(current<length){timer=(0,_feature.requestAnimationFrame)(loop);}else{(0,_feature.cancelAnimationFrame)(timer);_this4.inProgress=false;_this4.hot.view.wt.wtOverlays.adjustElementsSize(true);if(_this4.hot.view.wt.wtOverlays.leftOverlay.needFullRender){_this4.hot.view.wt.wtOverlays.leftOverlay.clone.draw();}}};var syncLimit=this.getSyncCalculationLimit();if(this.firstCalculation&&syncLimit>=0){this.calculateRowsHeight({from:0,to:syncLimit},colRange);this.firstCalculation=false;current=syncLimit+1;}
if(current<length){loop();}else{this.inProgress=false;this.hot.view.wt.wtOverlays.adjustElementsSize(false);}}},{key:"setSamplingOptions",value:function setSamplingOptions(){var setting=this.hot.getSettings().autoRowSize;var samplingRatio=setting&&(0,_object.hasOwnProperty)(setting,'samplingRatio')?this.hot.getSettings().autoRowSize.samplingRatio:void 0;var allowSampleDuplicates=setting&&(0,_object.hasOwnProperty)(setting,'allowSampleDuplicates')?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;if(samplingRatio&&!isNaN(samplingRatio)){this.samplesGenerator.setSampleCount(parseInt(samplingRatio,10));}
if(allowSampleDuplicates){this.samplesGenerator.setAllowDuplicates(allowSampleDuplicates);}}},{key:"recalculateAllRowsHeight",value:function recalculateAllRowsHeight(){if((0,_element.isVisible)(this.hot.view.wt.wtTable.TABLE)){this.clearCache();this.calculateAllRowsHeight();}}},{key:"getSyncCalculationLimit",value:function getSyncCalculationLimit(){var limit=AutoRowSize.SYNC_CALCULATION_LIMIT;var rowsLimit=this.hot.countRows()-1;if((0,_object.isObject)(this.hot.getSettings().autoRowSize)){limit=this.hot.getSettings().autoRowSize.syncLimit;if((0,_string.isPercentValue)(limit)){limit=(0,_number.valueAccordingPercent)(rowsLimit,limit);}else{limit>>=0;}}
return Math.min(limit,rowsLimit);}},{key:"getRowHeight",value:function getRowHeight(row){var defaultHeight=arguments.length>1&&arguments[1]!==undefined?arguments[1]:void 0;var height=defaultHeight;if(this.heights[row]!==void 0&&this.heights[row]>(defaultHeight||0)){height=this.heights[row];}
return height;}},{key:"getColumnHeaderHeight",value:function getColumnHeaderHeight(){return this.heights[-1];}},{key:"getFirstVisibleRow",value:function getFirstVisibleRow(){var wot=this.hot.view.wt;if(wot.wtViewport.rowsVisibleCalculator){return wot.wtTable.getFirstVisibleRow();}
if(wot.wtViewport.rowsRenderCalculator){return wot.wtTable.getFirstRenderedRow();}
return-1;}},{key:"getLastVisibleRow",value:function getLastVisibleRow(){var wot=this.hot.view.wt;if(wot.wtViewport.rowsVisibleCalculator){return wot.wtTable.getLastVisibleRow();}
if(wot.wtViewport.rowsRenderCalculator){return wot.wtTable.getLastRenderedRow();}
return-1;}},{key:"clearCache",value:function clearCache(){this.heights.length=0;this.heights[-1]=void 0;}},{key:"clearCacheByRange",value:function clearCacheByRange(range){var _this5=this;var _ref3=typeof range==='number'?{from:range,to:range}:range,from=_ref3.from,to=_ref3.to;(0,_number.rangeEach)(Math.min(from,to),Math.max(from,to),function(row){_this5.heights[row]=void 0;});}},{key:"isNeedRecalculate",value:function isNeedRecalculate(){return!!(0,_array.arrayFilter)(this.heights,function(item){return item===void 0;}).length;}},{key:"onBeforeRender",value:function onBeforeRender(){var force=this.hot.renderCall;var fixedRowsBottom=this.hot.getSettings().fixedRowsBottom;var firstVisibleRow=this.getFirstVisibleRow();var lastVisibleRow=this.getLastVisibleRow();if(firstVisibleRow===null||lastVisibleRow===null){return;}
this.calculateRowsHeight({from:firstVisibleRow,to:lastVisibleRow},void 0,force);if(fixedRowsBottom){var totalRows=this.hot.countRows()-1;this.calculateRowsHeight({from:totalRows-fixedRowsBottom,to:totalRows});}
if(this.isNeedRecalculate()&&!this.inProgress){this.calculateAllRowsHeight();}}},{key:"onBeforeRowMove",value:function onBeforeRowMove(from,to){this.clearCacheByRange({from:from,to:to});this.calculateAllRowsHeight();}},{key:"onBeforeRowResize",value:function onBeforeRowResize(row,size,isDblClick){var newSize=size;if(isDblClick){this.calculateRowsHeight(row,void 0,true);newSize=this.getRowHeight(row);}
return newSize;}},{key:"onAfterLoadData",value:function onAfterLoadData(){var _this6=this;if(this.hot.view){this.recalculateAllRowsHeight();}else{setTimeout(function(){if(_this6.hot){_this6.recalculateAllRowsHeight();}},0);}}},{key:"onBeforeChange",value:function onBeforeChange(changes){var range=null;if(changes.length===1){range=changes[0][0];}else if(changes.length>1){range={from:changes[0][0],to:changes[changes.length-1][0]};}
if(range!==null){this.clearCacheByRange(range);}}},{key:"destroy",value:function destroy(){this.ghostTable.clean();_get(_getPrototypeOf(AutoRowSize.prototype),"destroy",this).call(this);}}]);return AutoRowSize;}(_base.default);(0,_plugins.registerPlugin)('autoRowSize',AutoRowSize);var _default=AutoRowSize;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _mixed=__webpack_require__(14);var _object=__webpack_require__(2);var _array=__webpack_require__(3);var _number=__webpack_require__(9);var _base=_interopRequireDefault(__webpack_require__(15));var _plugins=__webpack_require__(13);var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _keyStateObserver=__webpack_require__(123);var _columnStatesManager=__webpack_require__(672);var _utils=__webpack_require__(432);var _domHelpers=__webpack_require__(673);var _rowsMapper=_interopRequireDefault(__webpack_require__(674));var _rootComparator=__webpack_require__(675);var _sortService=__webpack_require__(78);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==='function'){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable;}));}ownKeys.forEach(function(key){_defineProperty(target,key,source[key]);});}return target;}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key];}}return target;}
function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key];}return target;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
var APPEND_COLUMN_CONFIG_STRATEGY='append';var REPLACE_COLUMN_CONFIG_STRATEGY='replace';var PLUGIN_KEY='columnSorting';(0,_sortService.registerRootComparator)(PLUGIN_KEY,_rootComparator.rootComparator);_pluginHooks.default.getSingleton().register('beforeColumnSort');_pluginHooks.default.getSingleton().register('afterColumnSort');var ColumnSorting=function(_BasePlugin){_inherits(ColumnSorting,_BasePlugin);function ColumnSorting(hotInstance){var _this2;_classCallCheck(this,ColumnSorting);_this2=_possibleConstructorReturn(this,_getPrototypeOf(ColumnSorting).call(this,hotInstance));_this2.columnStatesManager=new _columnStatesManager.ColumnStatesManager();_this2.rowsMapper=new _rowsMapper.default(_assertThisInitialized(_assertThisInitialized(_this2)));_this2.blockPluginTranslation=true;_this2.columnMetaCache=new Map();_this2.pluginKey=PLUGIN_KEY;return _this2;}
_createClass(ColumnSorting,[{key:"isEnabled",value:function isEnabled(){return!!this.hot.getSettings()[this.pluginKey];}},{key:"enablePlugin",value:function enablePlugin(){var _this3=this;if(this.enabled){return;}
if((0,_mixed.isUndefined)(this.hot.getSettings().observeChanges)){this.enableObserveChangesPlugin();}
this.addHook('afterTrimRow',function(){return _this3.sortByPresetSortStates();});this.addHook('afterUntrimRow',function(){return _this3.sortByPresetSortStates();});this.addHook('modifyRow',function(row,source){return _this3.onModifyRow(row,source);});this.addHook('unmodifyRow',function(row,source){return _this3.onUnmodifyRow(row,source);});this.addHook('afterGetColHeader',function(column,TH){return _this3.onAfterGetColHeader(column,TH);});this.addHook('beforeOnCellMouseDown',function(event,coords,TD,controller){return _this3.onBeforeOnCellMouseDown(event,coords,TD,controller);});this.addHook('afterOnCellMouseDown',function(event,target){return _this3.onAfterOnCellMouseDown(event,target);});this.addHook('afterCreateRow',function(index,amount){return _this3.onAfterCreateRow(index,amount);});this.addHook('afterRemoveRow',function(index,amount){return _this3.onAfterRemoveRow(index,amount);});this.addHook('afterInit',function(){return _this3.loadOrSortBySettings();});this.addHook('afterLoadData',function(initialLoad){return _this3.onAfterLoadData(initialLoad);});this.addHook('afterCreateCol',function(){return _this3.onAfterCreateCol();});this.addHook('afterRemoveCol',function(){return _this3.onAfterRemoveCol();});if(this.hot.view){this.loadOrSortBySettings();}
_get(_getPrototypeOf(ColumnSorting.prototype),"enablePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){var _this4=this;var clearColHeader=function clearColHeader(column,TH){var headerSpanElement=(0,_utils.getHeaderSpanElement)(TH);if((0,_utils.isFirstLevelColumnHeader)(column,TH)===false||headerSpanElement===null){return;}
_this4.updateHeaderClasses(headerSpanElement);};this.hot.addHook('afterGetColHeader',clearColHeader);this.hot.addHookOnce('afterRender',function(){_this4.hot.removeHook('afterGetColHeader',clearColHeader);});this.rowsMapper.clearMap();_get(_getPrototypeOf(ColumnSorting.prototype),"disablePlugin",this).call(this);}},{key:"sort",value:function sort(sortConfig){var _this5=this;var currentSortConfig=this.getSortConfig();var destinationSortConfigs=this.getNormalizedSortConfigs(sortConfig);var sortPossible=this.areValidSortConfigs(destinationSortConfigs);var allowSort=this.hot.runHooks('beforeColumnSort',currentSortConfig,destinationSortConfigs,sortPossible);if(allowSort===false){return;}
if(sortPossible){var translateColumnToPhysical=function translateColumnToPhysical(_ref){var visualColumn=_ref.column,restOfProperties=_objectWithoutProperties(_ref,["column"]);return _objectSpread({column:_this5.hot.toPhysicalColumn(visualColumn)},restOfProperties);};var internalSortStates=(0,_array.arrayMap)(destinationSortConfigs,function(columnSortConfig){return translateColumnToPhysical(columnSortConfig);});this.columnStatesManager.setSortStates(internalSortStates);this.sortByPresetSortStates();this.saveAllSortSettings();this.hot.render();this.hot.view.wt.draw(true);}
this.hot.runHooks('afterColumnSort',currentSortConfig,this.getSortConfig(),sortPossible);}},{key:"clearSort",value:function clearSort(){this.sort([]);}},{key:"isSorted",value:function isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty();}},{key:"getSortConfig",value:function getSortConfig(column){var _this6=this;var translateColumnToVisual=function translateColumnToVisual(_ref2){var physicalColumn=_ref2.column,restOfProperties=_objectWithoutProperties(_ref2,["column"]);return _objectSpread({column:_this6.hot.toVisualColumn(physicalColumn)},restOfProperties);};if((0,_mixed.isDefined)(column)){var physicalColumn=this.hot.toPhysicalColumn(column);var columnSortState=this.columnStatesManager.getColumnSortState(physicalColumn);if((0,_mixed.isDefined)(columnSortState)){return translateColumnToVisual(columnSortState);}
return;}
var sortStates=this.columnStatesManager.getSortStates();return(0,_array.arrayMap)(sortStates,function(columnState){return translateColumnToVisual(columnState);});}},{key:"setSortConfig",value:function setSortConfig(sortConfig){var _this7=this;var destinationSortConfigs=this.getNormalizedSortConfigs(sortConfig);if(this.areValidSortConfigs(destinationSortConfigs)){var translateColumnToPhysical=function translateColumnToPhysical(_ref3){var visualColumn=_ref3.column,restOfProperties=_objectWithoutProperties(_ref3,["column"]);return _objectSpread({column:_this7.hot.toPhysicalColumn(visualColumn)},restOfProperties);};var internalSortStates=(0,_array.arrayMap)(destinationSortConfigs,function(columnSortConfig){return translateColumnToPhysical(columnSortConfig);});this.columnStatesManager.setSortStates(internalSortStates);}}},{key:"getNormalizedSortConfigs",value:function getNormalizedSortConfigs(){var sortConfig=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(Array.isArray(sortConfig)){return sortConfig.slice(0,1);}
return[sortConfig].slice(0,1);}},{key:"areValidSortConfigs",value:function areValidSortConfigs(sortConfigs){if(Array.isArray(sortConfigs)===false){return false;}
var sortedColumns=sortConfigs.map(function(_ref4){var column=_ref4.column;return column;});var numberOfColumns=this.hot.countCols();var onlyExistingVisualIndexes=sortedColumns.every(function(visualColumn){return visualColumn<=numberOfColumns&&visualColumn>=0;});return(0,_utils.areValidSortStates)(sortConfigs)&&onlyExistingVisualIndexes;}},{key:"saveAllSortSettings",value:function saveAllSortSettings(){var allSortSettings=this.columnStatesManager.getAllColumnsProperties();allSortSettings.initialConfig=this.columnStatesManager.getSortStates();this.hot.runHooks('persistentStateSave','columnSorting',allSortSettings);}},{key:"getAllSavedSortSettings",value:function getAllSavedSortSettings(){var _this8=this;var storedAllSortSettings={};this.hot.runHooks('persistentStateLoad','columnSorting',storedAllSortSettings);var allSortSettings=storedAllSortSettings.value;var translateColumnToVisual=function translateColumnToVisual(_ref5){var physicalColumn=_ref5.column,restOfProperties=_objectWithoutProperties(_ref5,["column"]);return _objectSpread({column:_this8.hot.toVisualColumn(physicalColumn)},restOfProperties);};if((0,_mixed.isDefined)(allSortSettings)&&Array.isArray(allSortSettings.initialConfig)){allSortSettings.initialConfig=(0,_array.arrayMap)(allSortSettings.initialConfig,translateColumnToVisual);}
return allSortSettings;}},{key:"getColumnNextConfig",value:function getColumnNextConfig(column){var physicalColumn=this.hot.toPhysicalColumn(column);if(this.columnStatesManager.isColumnSorted(physicalColumn)){var columnSortConfig=this.getSortConfig(column);var sortOrder=(0,_utils.getNextSortOrder)(columnSortConfig.sortOrder);if((0,_mixed.isDefined)(sortOrder)){columnSortConfig.sortOrder=sortOrder;return columnSortConfig;}
return;}
var nrOfColumns=this.hot.countCols();if(Number.isInteger(column)&&column>=0&&column<nrOfColumns){return{column:column,sortOrder:(0,_utils.getNextSortOrder)()};}}},{key:"getNextSortConfig",value:function getNextSortConfig(columnToChange){var strategyId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:APPEND_COLUMN_CONFIG_STRATEGY;var physicalColumn=this.hot.toPhysicalColumn(columnToChange);var indexOfColumnToChange=this.columnStatesManager.getIndexOfColumnInSortQueue(physicalColumn);var isColumnSorted=this.columnStatesManager.isColumnSorted(physicalColumn);var currentSortConfig=this.getSortConfig();var nextColumnConfig=this.getColumnNextConfig(columnToChange);if(isColumnSorted){if((0,_mixed.isUndefined)(nextColumnConfig)){return[].concat(_toConsumableArray(currentSortConfig.slice(0,indexOfColumnToChange)),_toConsumableArray(currentSortConfig.slice(indexOfColumnToChange+1)));}
if(strategyId===APPEND_COLUMN_CONFIG_STRATEGY){return[].concat(_toConsumableArray(currentSortConfig.slice(0,indexOfColumnToChange)),_toConsumableArray(currentSortConfig.slice(indexOfColumnToChange+1)),[nextColumnConfig]);}else if(strategyId===REPLACE_COLUMN_CONFIG_STRATEGY){return[].concat(_toConsumableArray(currentSortConfig.slice(0,indexOfColumnToChange)),[nextColumnConfig],_toConsumableArray(currentSortConfig.slice(indexOfColumnToChange+1)));}}
if((0,_mixed.isDefined)(nextColumnConfig)){return currentSortConfig.concat(nextColumnConfig);}
return currentSortConfig;}},{key:"setMergedPluginSettings",value:function setMergedPluginSettings(column){var physicalColumnIndex=this.hot.toPhysicalColumn(column);var pluginMainSettings=this.hot.getSettings()[this.pluginKey];var storedColumnProperties=this.columnStatesManager.getAllColumnsProperties();var cellMeta=this.hot.getCellMeta(0,column);var columnMeta=Object.getPrototypeOf(cellMeta);var columnMetaHasPluginSettings=Object.hasOwnProperty.call(columnMeta,this.pluginKey);var pluginColumnConfig=columnMetaHasPluginSettings?columnMeta[this.pluginKey]:{};this.columnMetaCache.set(physicalColumnIndex,Object.assign(storedColumnProperties,pluginMainSettings,pluginColumnConfig));}},{key:"getFirstCellSettings",value:function getFirstCellSettings(column){var actualBlockTranslationFlag=this.blockPluginTranslation;this.blockPluginTranslation=true;if(this.columnMetaCache.size===0||this.columnMetaCache.size<this.hot.countCols()){this.rebuildColumnMetaCache();}
var cellMeta=this.hot.getCellMeta(0,column);this.blockPluginTranslation=actualBlockTranslationFlag;var cellMetaCopy=Object.create(cellMeta);cellMetaCopy[this.pluginKey]=this.columnMetaCache.get(this.hot.toPhysicalColumn(column));return cellMetaCopy;}},{key:"rebuildColumnMetaCache",value:function rebuildColumnMetaCache(){var _this9=this;var numberOfColumns=this.hot.countCols();if(numberOfColumns===0){this.columnMetaCache.clear();}else{(0,_number.rangeEach)(numberOfColumns-1,function(visualColumnIndex){return _this9.setMergedPluginSettings(visualColumnIndex);});}}},{key:"getNumberOfRowsToSort",value:function getNumberOfRowsToSort(numberOfRows){var settings=this.hot.getSettings();if(settings.maxRows<=numberOfRows){return settings.maxRows;}
return numberOfRows-settings.minSpareRows;}},{key:"sortByPresetSortStates",value:function sortByPresetSortStates(){var _this10=this;if(this.columnStatesManager.isListOfSortedColumnsEmpty()){this.rowsMapper.clearMap();return;}
var indexesWithData=[];var sortedColumnsList=this.columnStatesManager.getSortedColumns();var numberOfRows=this.hot.countRows();this.blockPluginTranslation=true;var getDataForSortedColumns=function getDataForSortedColumns(visualRowIndex){return(0,_array.arrayMap)(sortedColumnsList,function(physicalColumn){return _this10.hot.getDataAtCell(visualRowIndex,_this10.hot.toVisualColumn(physicalColumn));});};for(var visualRowIndex=0;visualRowIndex<this.getNumberOfRowsToSort(numberOfRows);visualRowIndex+=1){indexesWithData.push([visualRowIndex].concat(getDataForSortedColumns(visualRowIndex)));}
(0,_sortService.sort)(indexesWithData,this.pluginKey,(0,_array.arrayMap)(sortedColumnsList,function(physicalColumn){return _this10.columnStatesManager.getSortOrderOfColumn(physicalColumn);}),(0,_array.arrayMap)(sortedColumnsList,function(physicalColumn){return _this10.getFirstCellSettings(_this10.hot.toVisualColumn(physicalColumn));}));for(var _visualRowIndex=indexesWithData.length;_visualRowIndex<numberOfRows;_visualRowIndex+=1){indexesWithData.push([_visualRowIndex].concat(getDataForSortedColumns(_visualRowIndex)));}
this.blockPluginTranslation=false;this.rowsMapper._arrayMap=(0,_array.arrayMap)(indexesWithData,function(indexWithData){return indexWithData[0];});}},{key:"loadOrSortBySettings",value:function loadOrSortBySettings(){this.columnMetaCache.clear();var storedAllSortSettings=this.getAllSavedSortSettings();if((0,_object.isObject)(storedAllSortSettings)){this.sortBySettings(storedAllSortSettings);}else{var allSortSettings=this.hot.getSettings()[this.pluginKey];this.sortBySettings(allSortSettings);}}},{key:"sortBySettings",value:function sortBySettings(allSortSettings){if((0,_object.isObject)(allSortSettings)){this.columnStatesManager.updateAllColumnsProperties(allSortSettings);var initialConfig=allSortSettings.initialConfig;if(Array.isArray(initialConfig)||(0,_object.isObject)(initialConfig)){this.sort(initialConfig);}}else{this.hot.render();}}},{key:"enableObserveChangesPlugin",value:function enableObserveChangesPlugin(){var _this=this;this.hot._registerTimeout(setTimeout(function(){_this.hot.updateSettings({observeChanges:true});},0));}},{key:"onModifyRow",value:function onModifyRow(row,source){if(this.blockPluginTranslation===false&&source!==this.pluginName&&this.isSorted()){var rowInMapper=this.rowsMapper.getValueByIndex(row);row=rowInMapper===null?row:rowInMapper;}
return row;}},{key:"onUnmodifyRow",value:function onUnmodifyRow(row,source){if(this.blockPluginTranslation===false&&source!==this.pluginName&&this.isSorted()){row=this.rowsMapper.getIndexByValue(row);}
return row;}},{key:"onAfterGetColHeader",value:function onAfterGetColHeader(column,TH){var headerSpanElement=(0,_utils.getHeaderSpanElement)(TH);if((0,_utils.isFirstLevelColumnHeader)(column,TH)===false||headerSpanElement===null){return;}
var physicalColumn=this.hot.toPhysicalColumn(column);var pluginSettingsForColumn=this.getFirstCellSettings(column)[this.pluginKey];var showSortIndicator=pluginSettingsForColumn.indicator;var headerActionEnabled=pluginSettingsForColumn.headerAction;this.updateHeaderClasses(headerSpanElement,this.columnStatesManager,physicalColumn,showSortIndicator,headerActionEnabled);}},{key:"updateHeaderClasses",value:function updateHeaderClasses(headerSpanElement){(0,_element.removeClass)(headerSpanElement,(0,_domHelpers.getClassedToRemove)(headerSpanElement));if(this.enabled!==false){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}
(0,_element.addClass)(headerSpanElement,_domHelpers.getClassesToAdd.apply(void 0,args));}}},{key:"onUpdateSettings",value:function onUpdateSettings(newSettings){_get(_getPrototypeOf(ColumnSorting.prototype),"onUpdateSettings",this).call(this);this.columnMetaCache.clear();if((0,_mixed.isDefined)(newSettings[this.pluginKey])){this.sortBySettings(newSettings[this.pluginKey]);}}},{key:"onAfterLoadData",value:function onAfterLoadData(initialLoad){this.rowsMapper.clearMap();this.columnMetaCache.clear();if(initialLoad===true){if(this.hot.view){this.loadOrSortBySettings();}}}},{key:"onAfterCreateRow",value:function onAfterCreateRow(index,amount){this.rowsMapper.shiftItems(index,amount);}},{key:"onAfterRemoveRow",value:function onAfterRemoveRow(removedRows,amount){this.rowsMapper.unshiftItems(removedRows,amount);}},{key:"onAfterCreateCol",value:function onAfterCreateCol(){this.columnMetaCache.clear();}},{key:"onAfterRemoveCol",value:function onAfterRemoveCol(){this.columnMetaCache.clear();}},{key:"wasClickableHeaderClicked",value:function wasClickableHeaderClicked(event,column){var pluginSettingsForColumn=this.getFirstCellSettings(column)[this.pluginKey];var headerActionEnabled=pluginSettingsForColumn.headerAction;return headerActionEnabled&&event.realTarget.nodeName==='SPAN';}},{key:"onBeforeOnCellMouseDown",value:function onBeforeOnCellMouseDown(event,coords,TD,blockCalculations){if((0,_utils.wasHeaderClickedProperly)(coords.row,coords.col,event)===false){return;}
if(this.wasClickableHeaderClicked(event,coords.col)&&(0,_keyStateObserver.isPressedCtrlKey)()){blockCalculations.column=true;}}},{key:"onAfterOnCellMouseDown",value:function onAfterOnCellMouseDown(event,coords){if((0,_utils.wasHeaderClickedProperly)(coords.row,coords.col,event)===false){return;}
if(this.wasClickableHeaderClicked(event,coords.col)){if((0,_keyStateObserver.isPressedCtrlKey)()){this.hot.deselectCell();this.hot.selectColumns(coords.col);}
this.sort(this.getColumnNextConfig(coords.col));}}},{key:"destroy",value:function destroy(){this.rowsMapper.destroy();this.columnStatesManager.destroy();_get(_getPrototypeOf(ColumnSorting.prototype),"destroy",this).call(this);}}]);return ColumnSorting;}(_base.default);(0,_plugins.registerPlugin)(PLUGIN_KEY,ColumnSorting);var _default=ColumnSorting;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.ColumnStatesManager=void 0;var _object=__webpack_require__(2);var _array=__webpack_require__(3);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var inheritedColumnProperties=['sortEmptyCells','indicator','headerAction','compareFunctionFactory'];var SORT_EMPTY_CELLS_DEFAULT=false;var SHOW_SORT_INDICATOR_DEFAULT=true;var HEADER_ACTION_DEFAULT=true;var ColumnStatesManager=function(){function ColumnStatesManager(){_classCallCheck(this,ColumnStatesManager);this.sortedColumnsStates=[];this.sortEmptyCells=SORT_EMPTY_CELLS_DEFAULT;this.indicator=SHOW_SORT_INDICATOR_DEFAULT;this.headerAction=HEADER_ACTION_DEFAULT;this.compareFunctionFactory=void 0;}
_createClass(ColumnStatesManager,[{key:"updateAllColumnsProperties",value:function updateAllColumnsProperties(allSortSettings){var _this=this;if(!(0,_object.isObject)(allSortSettings)){return;}
(0,_object.objectEach)(allSortSettings,function(newValue,propertyName){if(inheritedColumnProperties.includes(propertyName)){_this[propertyName]=newValue;}});}},{key:"getAllColumnsProperties",value:function getAllColumnsProperties(){var columnProperties={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};if(typeof this.compareFunctionFactory==='function'){columnProperties.compareFunctionFactory=this.compareFunctionFactory;}
return columnProperties;}},{key:"getFirstSortedColumn",value:function getFirstSortedColumn(){var firstSortedColumn;if(this.getNumberOfSortedColumns()>0){firstSortedColumn=this.sortedColumnsStates[0].column;}
return firstSortedColumn;}},{key:"getSortOrderOfColumn",value:function getSortOrderOfColumn(searchedColumn){var searchedState=this.sortedColumnsStates.find(function(_ref){var column=_ref.column;return searchedColumn===column;});var sortOrder;if((0,_object.isObject)(searchedState)){sortOrder=searchedState.sortOrder;}
return sortOrder;}},{key:"getSortedColumns",value:function getSortedColumns(){return(0,_array.arrayMap)(this.sortedColumnsStates,function(_ref2){var column=_ref2.column;return column;});}},{key:"getIndexOfColumnInSortQueue",value:function getIndexOfColumnInSortQueue(column){return this.getSortedColumns().indexOf(column);}},{key:"getNumberOfSortedColumns",value:function getNumberOfSortedColumns(){return this.sortedColumnsStates.length;}},{key:"isListOfSortedColumnsEmpty",value:function isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0;}},{key:"isColumnSorted",value:function isColumnSorted(column){return this.getSortedColumns().includes(column);}},{key:"getSortStates",value:function getSortStates(){return(0,_object.deepClone)(this.sortedColumnsStates);}},{key:"getColumnSortState",value:function getColumnSortState(column){if(this.isColumnSorted(column)){return(0,_object.deepClone)(this.sortedColumnsStates[this.getIndexOfColumnInSortQueue(column)]);}}},{key:"setSortStates",value:function setSortStates(sortStates){this.sortedColumnsStates=sortStates;}},{key:"destroy",value:function destroy(){this.sortedColumnsStates.length=0;this.sortedColumnsStates=null;}}]);return ColumnStatesManager;}();exports.ColumnStatesManager=ColumnStatesManager;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.getClassesToAdd=getClassesToAdd;exports.getClassedToRemove=getClassedToRemove;var _utils=__webpack_require__(432);var HEADER_CLASS_ASC_SORT='ascending';var HEADER_CLASS_DESC_SORT='descending';var HEADER_CLASS_INDICATOR_DISABLED='indicatorDisabled';var HEADER_SORT_CLASS='columnSorting';var HEADER_ACTION_CLASS='sortAction';var orderToCssClass=new Map([[_utils.ASC_SORT_STATE,HEADER_CLASS_ASC_SORT],[_utils.DESC_SORT_STATE,HEADER_CLASS_DESC_SORT]]);function getClassesToAdd(columnStatesManager,column,showSortIndicator,headerAction){var cssClasses=[HEADER_SORT_CLASS];if(headerAction){cssClasses.push(HEADER_ACTION_CLASS);}
if(showSortIndicator===false){cssClasses.push(HEADER_CLASS_INDICATOR_DISABLED);}else if(columnStatesManager.isColumnSorted(column)){var columnOrder=columnStatesManager.getSortOrderOfColumn(column);cssClasses.push(orderToCssClass.get(columnOrder));}
return cssClasses;}
function getClassedToRemove(){return Array.from(orderToCssClass.values()).concat(HEADER_ACTION_CLASS,HEADER_CLASS_INDICATOR_DISABLED,HEADER_SORT_CLASS);}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _arrayMapper=_interopRequireDefault(__webpack_require__(125));var _object=__webpack_require__(2);var _number=__webpack_require__(9);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var RowsMapper=function(){function RowsMapper(){_classCallCheck(this,RowsMapper);}
_createClass(RowsMapper,[{key:"createMap",value:function createMap(length){var _this=this;var originLength=length===void 0?this._arrayMap.length:length;this._arrayMap.length=0;(0,_number.rangeEach)(originLength-1,function(itemIndex){_this._arrayMap[itemIndex]=itemIndex;});}},{key:"destroy",value:function destroy(){this._arrayMap=null;}}]);return RowsMapper;}();(0,_object.mixin)(RowsMapper,_arrayMapper.default);var _default=RowsMapper;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.rootComparator=rootComparator;var _sortService=__webpack_require__(78);function _toArray(arr){return _arrayWithHoles(arr)||_iterableToArray(arr)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function rootComparator(sortingOrders,columnMetas){return function(rowIndexWithValues,nextRowIndexWithValues){var _rowIndexWithValues=_toArray(rowIndexWithValues),values=_rowIndexWithValues.slice(1);var _nextRowIndexWithValu=_toArray(nextRowIndexWithValues),nextValues=_nextRowIndexWithValu.slice(1);return function getCompareResult(column){var sortingOrder=sortingOrders[column];var columnMeta=columnMetas[column];var value=values[column];var nextValue=nextValues[column];var pluginSettings=columnMeta.columnSorting;var compareFunctionFactory=pluginSettings.compareFunctionFactory?pluginSettings.compareFunctionFactory:(0,_sortService.getCompareFunctionFactory)(columnMeta.type);var compareResult=compareFunctionFactory(sortingOrder,columnMeta,pluginSettings)(value,nextValue);return compareResult;}(0);};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.compareFunctionFactory=compareFunctionFactory;exports.COLUMN_DATA_TYPE=void 0;var _mixed=__webpack_require__(14);var _sortService=__webpack_require__(78);function compareFunctionFactory(sortOrder,columnMeta,columnPluginSettings){return function(value,nextValue){var sortEmptyCells=columnPluginSettings.sortEmptyCells;if(typeof value==='string'){value=value.toLowerCase();}
if(typeof nextValue==='string'){nextValue=nextValue.toLowerCase();}
if(value===nextValue){return _sortService.DO_NOT_SWAP;}
if((0,_mixed.isEmpty)(value)){if((0,_mixed.isEmpty)(nextValue)){return _sortService.DO_NOT_SWAP;}
if(sortEmptyCells){return sortOrder==='asc'?_sortService.FIRST_BEFORE_SECOND:_sortService.FIRST_AFTER_SECOND;}
return _sortService.FIRST_AFTER_SECOND;}
if((0,_mixed.isEmpty)(nextValue)){if(sortEmptyCells){return sortOrder==='asc'?_sortService.FIRST_AFTER_SECOND:_sortService.FIRST_BEFORE_SECOND;}
return _sortService.FIRST_BEFORE_SECOND;}
if(isNaN(value)&&!isNaN(nextValue)){return sortOrder==='asc'?_sortService.FIRST_AFTER_SECOND:_sortService.FIRST_BEFORE_SECOND;}else if(!isNaN(value)&&isNaN(nextValue)){return sortOrder==='asc'?_sortService.FIRST_BEFORE_SECOND:_sortService.FIRST_AFTER_SECOND;}else if(!(isNaN(value)||isNaN(nextValue))){value=parseFloat(value);nextValue=parseFloat(nextValue);}
if(value<nextValue){return sortOrder==='asc'?_sortService.FIRST_BEFORE_SECOND:_sortService.FIRST_AFTER_SECOND;}
if(value>nextValue){return sortOrder==='asc'?_sortService.FIRST_AFTER_SECOND:_sortService.FIRST_BEFORE_SECOND;}
return _sortService.DO_NOT_SWAP;};}
var COLUMN_DATA_TYPE='default';exports.COLUMN_DATA_TYPE=COLUMN_DATA_TYPE;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.compareFunctionFactory=compareFunctionFactory;exports.COLUMN_DATA_TYPE=void 0;var _mixed=__webpack_require__(14);var _sortService=__webpack_require__(78);function compareFunctionFactory(sortOrder,columnMeta,columnPluginSettings){return function(value,nextValue){var parsedFirstValue=parseFloat(value);var parsedSecondValue=parseFloat(nextValue);var sortEmptyCells=columnPluginSettings.sortEmptyCells;if(parsedFirstValue===parsedSecondValue||isNaN(parsedFirstValue)&&isNaN(parsedSecondValue)){return _sortService.DO_NOT_SWAP;}
if(sortEmptyCells){if((0,_mixed.isEmpty)(value)){return sortOrder==='asc'?_sortService.FIRST_BEFORE_SECOND:_sortService.FIRST_AFTER_SECOND;}
if((0,_mixed.isEmpty)(nextValue)){return sortOrder==='asc'?_sortService.FIRST_AFTER_SECOND:_sortService.FIRST_BEFORE_SECOND;}}
if(isNaN(parsedFirstValue)){return _sortService.FIRST_AFTER_SECOND;}
if(isNaN(parsedSecondValue)){return _sortService.FIRST_BEFORE_SECOND;}
if(parsedFirstValue<parsedSecondValue){return sortOrder==='asc'?_sortService.FIRST_BEFORE_SECOND:_sortService.FIRST_AFTER_SECOND;}else if(parsedFirstValue>parsedSecondValue){return sortOrder==='asc'?_sortService.FIRST_AFTER_SECOND:_sortService.FIRST_BEFORE_SECOND;}
return _sortService.DO_NOT_SWAP;};}
var COLUMN_DATA_TYPE='numeric';exports.COLUMN_DATA_TYPE=COLUMN_DATA_TYPE;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.compareFunctionFactory=compareFunctionFactory;exports.COLUMN_DATA_TYPE=void 0;var _moment=_interopRequireDefault(__webpack_require__(67));var _mixed=__webpack_require__(14);var _sortService=__webpack_require__(78);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function compareFunctionFactory(sortOrder,columnMeta,columnPluginSettings){return function(value,nextValue){var sortEmptyCells=columnPluginSettings.sortEmptyCells;if(value===nextValue){return _sortService.DO_NOT_SWAP;}
if((0,_mixed.isEmpty)(value)){if((0,_mixed.isEmpty)(nextValue)){return _sortService.DO_NOT_SWAP;}
if(sortEmptyCells){return sortOrder==='asc'?_sortService.FIRST_BEFORE_SECOND:_sortService.FIRST_AFTER_SECOND;}
return _sortService.FIRST_AFTER_SECOND;}
if((0,_mixed.isEmpty)(nextValue)){if(sortEmptyCells){return sortOrder==='asc'?_sortService.FIRST_AFTER_SECOND:_sortService.FIRST_BEFORE_SECOND;}
return _sortService.FIRST_BEFORE_SECOND;}
var dateFormat=columnMeta.dateFormat;var firstDate=(0,_moment.default)(value,dateFormat);var nextDate=(0,_moment.default)(nextValue,dateFormat);if(!firstDate.isValid()){return _sortService.FIRST_AFTER_SECOND;}
if(!nextDate.isValid()){return _sortService.FIRST_BEFORE_SECOND;}
if(nextDate.isAfter(firstDate)){return sortOrder==='asc'?_sortService.FIRST_BEFORE_SECOND:_sortService.FIRST_AFTER_SECOND;}
if(nextDate.isBefore(firstDate)){return sortOrder==='asc'?_sortService.FIRST_AFTER_SECOND:_sortService.FIRST_BEFORE_SECOND;}
return _sortService.DO_NOT_SWAP;};}
var COLUMN_DATA_TYPE='date';exports.COLUMN_DATA_TYPE=COLUMN_DATA_TYPE;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.sort=sort;exports.FIRST_AFTER_SECOND=exports.FIRST_BEFORE_SECOND=exports.DO_NOT_SWAP=void 0;var _mergeSort=_interopRequireDefault(__webpack_require__(680));var _registry=__webpack_require__(433);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var DO_NOT_SWAP=0;exports.DO_NOT_SWAP=DO_NOT_SWAP;var FIRST_BEFORE_SECOND=-1;exports.FIRST_BEFORE_SECOND=FIRST_BEFORE_SECOND;var FIRST_AFTER_SECOND=1;exports.FIRST_AFTER_SECOND=FIRST_AFTER_SECOND;function sort(indexesWithData,rootComparatorId){var rootComparator=(0,_registry.getRootComparator)(rootComparatorId);for(var _len=arguments.length,argsForRootComparator=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){argsForRootComparator[_key-2]=arguments[_key];}
(0,_mergeSort.default)(indexesWithData,rootComparator.apply(void 0,argsForRootComparator));}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=mergeSort;var _linkedList=_interopRequireDefault(__webpack_require__(681));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var defaultCompareFunction=function defaultCompareFunction(a,b){var firstValue=a.toString();var secondValue=b.toString();if(firstValue===secondValue){return 0;}else if(firstValue<secondValue){return-1;}
return 1;};function mergeSort(array){var compareFunction=arguments.length>1&&arguments[1]!==undefined?arguments[1]:defaultCompareFunction;var startIndex=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var endIndex=arguments.length>3&&arguments[3]!==undefined?arguments[3]:array.length;if(Math.abs(endIndex-startIndex)<=1){return[];}
var middleIndex=Math.ceil((startIndex+endIndex)/2);mergeSort(array,compareFunction,startIndex,middleIndex);mergeSort(array,compareFunction,middleIndex,endIndex);return merge(array,compareFunction,startIndex,middleIndex,endIndex);}
function merge(array,compareFunction,startIndex,middleIndex,endIndex){var leftElements=new _linkedList.default();var rightElements=new _linkedList.default();var leftSize=middleIndex-startIndex;var rightSize=endIndex-middleIndex;var maxSize=Math.max(leftSize,rightSize);var size=endIndex-startIndex;for(var _i=0;_i<maxSize;_i+=1){if(_i<leftSize){leftElements.push(array[startIndex+_i]);}
if(_i<rightSize){rightElements.push(array[middleIndex+_i]);}}
var i=0;while(i<size){if(leftElements.first&&rightElements.first){if(compareFunction(leftElements.first.data,rightElements.first.data)>0){array[startIndex+i]=rightElements.shift().data;}else{array[startIndex+i]=leftElements.shift().data;}}else if(leftElements.first){array[startIndex+i]=leftElements.shift().data;}else{array[startIndex+i]=rightElements.shift().data;}
i+=1;}
return array;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=exports.NodeStructure=void 0;function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var NodeStructure=function NodeStructure(data){_classCallCheck(this,NodeStructure);this.data=data;this.next=null;this.prev=null;};exports.NodeStructure=NodeStructure;var LinkedList=function(){function LinkedList(){_classCallCheck(this,LinkedList);this.first=null;this.last=null;}
_createClass(LinkedList,[{key:"push",value:function push(data){var node=new NodeStructure(data);if(this.first===null){this.first=node;this.last=node;}else{var temp=this.last;this.last=node;node.prev=temp;temp.next=node;}}},{key:"unshift",value:function unshift(data){var node=new NodeStructure(data);if(this.first===null){this.first=node;this.last=node;}else{var temp=this.first;this.first=node;node.next=temp;temp.prev=node;}}},{key:"inorder",value:function inorder(callback){var temp=this.first;while(temp){callback(temp);temp=temp.next;}}},{key:"remove",value:function remove(data){if(this.first===null){return false;}
var temp=this.first;var next;var prev;while(temp){if(temp.data===data){next=temp.next;prev=temp.prev;if(next){next.prev=prev;}
if(prev){prev.next=next;}
if(temp===this.first){this.first=next;}
if(temp===this.last){this.last=prev;}
return true;}
temp=temp.next;}
return false;}},{key:"hasCycle",value:function hasCycle(){var fast=this.first;var slow=this.first;while(true){if(fast===null){return false;}
fast=fast.next;if(fast===null){return false;}
fast=fast.next;slow=slow.next;if(fast===slow){return true;}}}},{key:"pop",value:function pop(){if(this.last===null){return null;}
var temp=this.last;this.last=this.last.prev;return temp;}},{key:"shift",value:function shift(){if(this.first===null){return null;}
var temp=this.first;this.first=this.first.next;return temp;}},{key:"recursiveReverse",value:function recursiveReverse(){function inverse(current,next){if(!next){return;}
inverse(next,next.next);next.next=current;}
if(!this.first){return;}
inverse(this.first,this.first.next);this.first.next=null;var temp=this.first;this.first=this.last;this.last=temp;}},{key:"reverse",value:function reverse(){if(!this.first||!this.first.next){return;}
var current=this.first.next;var prev=this.first;var temp;while(current){temp=current.next;current.next=prev;prev.prev=current;prev=current;current=temp;}
this.first.next=null;this.last.prev=null;temp=this.first;this.first=prev;this.last=temp;}}]);return LinkedList;}();var _default=LinkedList;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _object=__webpack_require__(2);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _src=__webpack_require__(8);var _plugins=__webpack_require__(13);var _base=_interopRequireDefault(__webpack_require__(15));var _commentEditor=_interopRequireDefault(__webpack_require__(683));var _utils=__webpack_require__(30);var _displaySwitch=_interopRequireDefault(__webpack_require__(684));var C=_interopRequireWildcard(__webpack_require__(11));__webpack_require__(685);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
var privatePool=new WeakMap();var META_COMMENT='comment';var META_COMMENT_VALUE='value';var META_STYLE='style';var META_READONLY='readOnly';var Comments=function(_BasePlugin){_inherits(Comments,_BasePlugin);function Comments(hotInstance){var _this;_classCallCheck(this,Comments);_this=_possibleConstructorReturn(this,_getPrototypeOf(Comments).call(this,hotInstance));_this.editor=null;_this.displaySwitch=null;_this.eventManager=null;_this.range={};_this.mouseDown=false;_this.contextMenuEvent=false;_this.timer=null;privatePool.set(_assertThisInitialized(_assertThisInitialized(_this)),{tempEditorDimensions:{},cellBelowCursor:null});return _this;}
_createClass(Comments,[{key:"isEnabled",value:function isEnabled(){return!!this.hot.getSettings().comments;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
if(!this.editor){this.editor=new _commentEditor.default();}
if(!this.eventManager){this.eventManager=new _eventManager.default(this);}
if(!this.displaySwitch){this.displaySwitch=new _displaySwitch.default(this.getDisplayDelaySetting());}
this.addHook('afterContextMenuDefaultOptions',function(options){return _this2.addToContextMenu(options);});this.addHook('afterRenderer',function(TD,row,col,prop,value,cellProperties){return _this2.onAfterRenderer(TD,cellProperties);});this.addHook('afterScrollHorizontally',function(){return _this2.hide();});this.addHook('afterScrollVertically',function(){return _this2.hide();});this.addHook('afterBeginEditing',function(){return _this2.onAfterBeginEditing();});this.displaySwitch.addLocalHook('hide',function(){return _this2.hide();});this.displaySwitch.addLocalHook('show',function(row,col){return _this2.showAtCell(row,col);});this.registerListeners();_get(_getPrototypeOf(Comments.prototype),"enablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();_get(_getPrototypeOf(Comments.prototype),"updatePlugin",this).call(this);this.displaySwitch.updateDelay(this.getDisplayDelaySetting());}},{key:"disablePlugin",value:function disablePlugin(){_get(_getPrototypeOf(Comments.prototype),"disablePlugin",this).call(this);}},{key:"registerListeners",value:function registerListeners(){var _this3=this;this.eventManager.addEventListener(document,'mouseover',function(event){return _this3.onMouseOver(event);});this.eventManager.addEventListener(document,'mousedown',function(event){return _this3.onMouseDown(event);});this.eventManager.addEventListener(document,'mouseup',function(){return _this3.onMouseUp();});this.eventManager.addEventListener(this.editor.getInputElement(),'blur',function(){return _this3.onEditorBlur();});this.eventManager.addEventListener(this.editor.getInputElement(),'mousedown',function(event){return _this3.onEditorMouseDown(event);});this.eventManager.addEventListener(this.editor.getInputElement(),'mouseup',function(event){return _this3.onEditorMouseUp(event);});}},{key:"setRange",value:function setRange(range){this.range=range;}},{key:"clearRange",value:function clearRange(){this.range={};}},{key:"targetIsCellWithComment",value:function targetIsCellWithComment(event){var closestCell=(0,_element.closest)(event.target,'TD','TBODY');return!!(closestCell&&(0,_element.hasClass)(closestCell,'htCommentCell')&&(0,_element.closest)(closestCell,[this.hot.rootElement]));}},{key:"targetIsCommentTextArea",value:function targetIsCommentTextArea(event){return this.editor.getInputElement()===event.target;}},{key:"setComment",value:function setComment(value){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');}
var editorValue=this.editor.getValue();var comment='';if(value!==null&&value!==void 0){comment=value;}else if(editorValue!==null&&editorValue!==void 0){comment=editorValue;}
var row=this.range.from.row;var col=this.range.from.col;this.updateCommentMeta(row,col,_defineProperty({},META_COMMENT_VALUE,comment));this.hot.render();}},{key:"setCommentAtCell",value:function setCommentAtCell(row,column,value){this.setRange({from:new _src.CellCoords(row,column)});this.setComment(value);}},{key:"removeComment",value:function removeComment(){var forceRender=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');}
this.hot.setCellMeta(this.range.from.row,this.range.from.col,META_COMMENT,void 0);if(forceRender){this.hot.render();}
this.hide();}},{key:"removeCommentAtCell",value:function removeCommentAtCell(row,column){var forceRender=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;this.setRange({from:new _src.CellCoords(row,column)});this.removeComment(forceRender);}},{key:"getComment",value:function getComment(){var row=this.range.from.row;var column=this.range.from.col;return this.getCommentMeta(row,column,META_COMMENT_VALUE);}},{key:"getCommentAtCell",value:function getCommentAtCell(row,column){return this.getCommentMeta(row,column,META_COMMENT_VALUE);}},{key:"show",value:function show(){if(!this.range.from){throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');}
var meta=this.hot.getCellMeta(this.range.from.row,this.range.from.col);this.refreshEditor(true);this.editor.setValue(meta[META_COMMENT]?meta[META_COMMENT][META_COMMENT_VALUE]:null||'');if(this.editor.hidden){this.editor.show();}
return true;}},{key:"showAtCell",value:function showAtCell(row,column){this.setRange({from:new _src.CellCoords(row,column)});return this.show();}},{key:"hide",value:function hide(){if(!this.editor.hidden){this.editor.hide();}}},{key:"refreshEditor",value:function refreshEditor(){var force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!force&&(!this.range.from||!this.editor.isVisible())){return;}
var scrollableElement=(0,_element.getScrollableElement)(this.hot.view.wt.wtTable.TABLE);var TD=this.hot.view.wt.wtTable.getCell(this.range.from);var row=this.range.from.row;var column=this.range.from.col;var cellOffset=(0,_element.offset)(TD);var lastColWidth=this.hot.view.wt.wtTable.getStretchedColumnWidth(column);var cellTopOffset=cellOffset.top<0?0:cellOffset.top;var cellLeftOffset=cellOffset.left;if(this.hot.view.wt.wtViewport.hasVerticalScroll()&&scrollableElement!==window){cellTopOffset-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition();}
if(this.hot.view.wt.wtViewport.hasHorizontalScroll()&&scrollableElement!==window){cellLeftOffset-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition();}
var x=cellLeftOffset+lastColWidth;var y=cellTopOffset;var commentStyle=this.getCommentMeta(row,column,META_STYLE);var readOnly=this.getCommentMeta(row,column,META_READONLY);if(commentStyle){this.editor.setSize(commentStyle.width,commentStyle.height);}else{this.editor.resetSize();}
this.editor.setReadOnlyState(readOnly);this.editor.setPosition(x,y);}},{key:"checkSelectionCommentsConsistency",value:function checkSelectionCommentsConsistency(){var selected=this.hot.getSelectedRangeLast();if(!selected){return false;}
var hasComment=false;var cell=selected.from;if(this.getCommentMeta(cell.row,cell.col,META_COMMENT_VALUE)){hasComment=true;}
return hasComment;}},{key:"updateCommentMeta",value:function updateCommentMeta(row,column,metaObject){var oldComment=this.hot.getCellMeta(row,column)[META_COMMENT];var newComment;if(oldComment){newComment=(0,_object.deepClone)(oldComment);(0,_object.deepExtend)(newComment,metaObject);}else{newComment=metaObject;}
this.hot.setCellMeta(row,column,META_COMMENT,newComment);}},{key:"getCommentMeta",value:function getCommentMeta(row,column,property){var cellMeta=this.hot.getCellMeta(row,column);if(!cellMeta[META_COMMENT]){return void 0;}
return cellMeta[META_COMMENT][property];}},{key:"onMouseDown",value:function onMouseDown(event){this.mouseDown=true;if(!this.hot.view||!this.hot.view.wt){return;}
if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(event)){var eventCell=(0,_element.closest)(event.target,'TD','TBODY');var coordinates=null;if(eventCell){coordinates=this.hot.view.wt.wtTable.getCoords(eventCell);}
if(!eventCell||this.range.from&&coordinates&&(this.range.from.row!==coordinates.row||this.range.from.col!==coordinates.col)){this.hide();}}
this.contextMenuEvent=false;}},{key:"onMouseOver",value:function onMouseOver(event){var priv=privatePool.get(this);priv.cellBelowCursor=document.elementFromPoint(event.clientX,event.clientY);if(this.mouseDown||this.editor.isFocused()||(0,_element.hasClass)(event.target,'wtBorder')||priv.cellBelowCursor!==event.target||!this.editor){return;}
if(this.targetIsCellWithComment(event)){var coordinates=this.hot.view.wt.wtTable.getCoords(event.target);var range={from:new _src.CellCoords(coordinates.row,coordinates.col)};this.displaySwitch.show(range);}else if((0,_element.isChildOf)(event.target,document)&&!this.targetIsCommentTextArea(event)){this.displaySwitch.hide();}}},{key:"onMouseUp",value:function onMouseUp(){this.mouseDown=false;}},{key:"onAfterRenderer",value:function onAfterRenderer(TD,cellProperties){if(cellProperties[META_COMMENT]&&cellProperties[META_COMMENT][META_COMMENT_VALUE]){(0,_element.addClass)(TD,cellProperties.commentedCellClassName);}}},{key:"onEditorBlur",value:function onEditorBlur(){this.setComment();}},{key:"onEditorMouseDown",value:function onEditorMouseDown(event){var priv=privatePool.get(this);priv.tempEditorDimensions={width:(0,_element.outerWidth)(event.target),height:(0,_element.outerHeight)(event.target)};}},{key:"onEditorMouseUp",value:function onEditorMouseUp(event){var priv=privatePool.get(this);var currentWidth=(0,_element.outerWidth)(event.target);var currentHeight=(0,_element.outerHeight)(event.target);if(currentWidth!==priv.tempEditorDimensions.width+1||currentHeight!==priv.tempEditorDimensions.height+2){this.updateCommentMeta(this.range.from.row,this.range.from.col,_defineProperty({},META_STYLE,{width:currentWidth,height:currentHeight}));}}},{key:"onContextMenuAddComment",value:function onContextMenuAddComment(){var _this4=this;this.displaySwitch.cancelHiding();var coords=this.hot.getSelectedRangeLast();this.contextMenuEvent=true;this.setRange({from:coords.from});this.show();setTimeout(function(){if(_this4.hot){_this4.hot.deselectCell();_this4.editor.focus();}},10);}},{key:"onContextMenuRemoveComment",value:function onContextMenuRemoveComment(){var _this$hot$getSelected=this.hot.getSelectedRangeLast(),from=_this$hot$getSelected.from,to=_this$hot$getSelected.to;this.contextMenuEvent=true;for(var i=from.row;i<=to.row;i++){for(var j=from.col;j<=to.col;j++){this.removeCommentAtCell(i,j,false);}}
this.hot.render();}},{key:"onContextMenuMakeReadOnly",value:function onContextMenuMakeReadOnly(){var _this$hot$getSelected2=this.hot.getSelectedRangeLast(),from=_this$hot$getSelected2.from,to=_this$hot$getSelected2.to;this.contextMenuEvent=true;for(var i=from.row;i<=to.row;i++){for(var j=from.col;j<=to.col;j++){var currentState=!!this.getCommentMeta(i,j,META_READONLY);this.updateCommentMeta(i,j,_defineProperty({},META_READONLY,!currentState));}}}},{key:"addToContextMenu",value:function addToContextMenu(defaultOptions){var _this5=this;defaultOptions.items.push({name:'---------'},{key:'commentsAddEdit',name:function name(){if(_this5.checkSelectionCommentsConsistency()){return _this5.hot.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_EDIT_COMMENT);}
return _this5.hot.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ADD_COMMENT);},callback:function callback(){return _this5.onContextMenuAddComment();},disabled:function disabled(){return!(this.getSelectedLast()&&!this.selection.isSelectedByCorner());}},{key:'commentsRemove',name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_REMOVE_COMMENT);},callback:function callback(){return _this5.onContextMenuRemoveComment();},disabled:function disabled(){return _this5.hot.selection.isSelectedByCorner();}},{key:'commentsReadOnly',name:function name(){var _this6=this;var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);var hasProperty=(0,_utils.checkSelectionConsistency)(this.getSelectedRangeLast(),function(row,col){var readOnlyProperty=_this6.getCellMeta(row,col)[META_COMMENT];if(readOnlyProperty){readOnlyProperty=readOnlyProperty[META_READONLY];}
if(readOnlyProperty){return true;}});if(hasProperty){label=(0,_utils.markLabelAsSelected)(label);}
return label;},callback:function callback(){return _this5.onContextMenuMakeReadOnly();},disabled:function disabled(){return _this5.hot.selection.isSelectedByCorner()||!_this5.checkSelectionCommentsConsistency();}});}},{key:"getDisplayDelaySetting",value:function getDisplayDelaySetting(){var commentSetting=this.hot.getSettings().comments;if((0,_object.isObject)(commentSetting)){return commentSetting.displayDelay;}
return void 0;}},{key:"onAfterBeginEditing",value:function onAfterBeginEditing(){this.hide();}},{key:"destroy",value:function destroy(){if(this.editor){this.editor.destroy();}
if(this.displaySwitch){this.displaySwitch.destroy();}
_get(_getPrototypeOf(Comments.prototype),"destroy",this).call(this);}}]);return Comments;}(_base.default);(0,_plugins.registerPlugin)('comments',Comments);var _default=Comments;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var CommentEditor=function(){_createClass(CommentEditor,null,[{key:"CLASS_EDITOR_CONTAINER",get:function get(){return'htCommentsContainer';}},{key:"CLASS_EDITOR",get:function get(){return'htComments';}},{key:"CLASS_INPUT",get:function get(){return'htCommentTextArea';}},{key:"CLASS_CELL",get:function get(){return'htCommentCell';}}]);function CommentEditor(){_classCallCheck(this,CommentEditor);this.editor=this.createEditor();this.editorStyle=this.editor.style;this.hidden=true;this.hide();}
_createClass(CommentEditor,[{key:"setPosition",value:function setPosition(x,y){this.editorStyle.left="".concat(x,"px");this.editorStyle.top="".concat(y,"px");}},{key:"setSize",value:function setSize(width,height){if(width&&height){var input=this.getInputElement();input.style.width="".concat(width,"px");input.style.height="".concat(height,"px");}}},{key:"resetSize",value:function resetSize(){var input=this.getInputElement();input.style.width='';input.style.height='';}},{key:"setReadOnlyState",value:function setReadOnlyState(state){var input=this.getInputElement();input.readOnly=state;}},{key:"show",value:function show(){this.editorStyle.display='block';this.hidden=false;}},{key:"hide",value:function hide(){this.editorStyle.display='none';this.hidden=true;}},{key:"isVisible",value:function isVisible(){return this.editorStyle.display==='block';}},{key:"setValue",value:function setValue(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var comment=value||'';this.getInputElement().value=comment;}},{key:"getValue",value:function getValue(){return this.getInputElement().value;}},{key:"isFocused",value:function isFocused(){return document.activeElement===this.getInputElement();}},{key:"focus",value:function focus(){this.getInputElement().focus();}},{key:"createEditor",value:function createEditor(){var editor=document.createElement('div');var textArea=document.createElement('textarea');var container=document.querySelector(".".concat(CommentEditor.CLASS_EDITOR_CONTAINER));if(!container){container=document.createElement('div');(0,_element.addClass)(container,CommentEditor.CLASS_EDITOR_CONTAINER);document.body.appendChild(container);}
(0,_element.addClass)(editor,CommentEditor.CLASS_EDITOR);(0,_element.addClass)(textArea,CommentEditor.CLASS_INPUT);editor.appendChild(textArea);container.appendChild(editor);return editor;}},{key:"getInputElement",value:function getInputElement(){return this.editor.querySelector(".".concat(CommentEditor.CLASS_INPUT));}},{key:"destroy",value:function destroy(){this.editor.parentNode.removeChild(this.editor);this.editor=null;this.editorStyle=null;}}]);return CommentEditor;}();var _default=CommentEditor;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _function=__webpack_require__(59);var _object=__webpack_require__(2);var _localHooks=_interopRequireDefault(__webpack_require__(68));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var DEFAULT_DISPLAY_DELAY=250;var DEFAULT_HIDE_DELAY=250;var DisplaySwitch=function(){function DisplaySwitch(displayDelay){_classCallCheck(this,DisplaySwitch);this.wasLastActionShow=true;this.showDebounced=null;this.hidingTimer=null;this.updateDelay(displayDelay);}
_createClass(DisplaySwitch,[{key:"hide",value:function hide(){var _this=this;this.wasLastActionShow=false;this.hidingTimer=setTimeout(function(){if(_this.wasLastActionShow===false){_this.runLocalHooks('hide');}},DEFAULT_HIDE_DELAY);}},{key:"show",value:function show(range){this.wasLastActionShow=true;this.showDebounced(range);}},{key:"cancelHiding",value:function cancelHiding(){this.wasLastActionShow=true;clearTimeout(this.hidingTimer);this.hidingTimer=null;}},{key:"updateDelay",value:function updateDelay(){var _this2=this;var displayDelay=arguments.length>0&&arguments[0]!==undefined?arguments[0]:DEFAULT_DISPLAY_DELAY;this.showDebounced=(0,_function.debounce)(function(range){if(_this2.wasLastActionShow){_this2.runLocalHooks('show',range.from.row,range.from.col);}},displayDelay);}},{key:"destroy",value:function destroy(){this.clearLocalHooks();}}]);return DisplaySwitch;}();(0,_object.mixin)(DisplaySwitch,_localHooks.default);var _default=DisplaySwitch;exports.default=_default;}),(function(module,exports){}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _array=__webpack_require__(3);var _commandExecutor=_interopRequireDefault(__webpack_require__(687));var _eventManager=_interopRequireDefault(__webpack_require__(10));var _itemsFactory=_interopRequireDefault(__webpack_require__(688));var _menu=_interopRequireDefault(__webpack_require__(700));var _plugins=__webpack_require__(13);var _event=__webpack_require__(18);var _element=__webpack_require__(1);var _predefinedItems=__webpack_require__(127);__webpack_require__(702);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
_pluginHooks.default.getSingleton().register('afterContextMenuDefaultOptions');_pluginHooks.default.getSingleton().register('beforeContextMenuShow');_pluginHooks.default.getSingleton().register('afterContextMenuShow');_pluginHooks.default.getSingleton().register('afterContextMenuHide');_pluginHooks.default.getSingleton().register('afterContextMenuExecute');var ContextMenu=function(_BasePlugin){_inherits(ContextMenu,_BasePlugin);_createClass(ContextMenu,null,[{key:"DEFAULT_ITEMS",get:function get(){return[_predefinedItems.ROW_ABOVE,_predefinedItems.ROW_BELOW,_predefinedItems.SEPARATOR,_predefinedItems.COLUMN_LEFT,_predefinedItems.COLUMN_RIGHT,_predefinedItems.SEPARATOR,_predefinedItems.REMOVE_ROW,_predefinedItems.REMOVE_COLUMN,_predefinedItems.SEPARATOR,_predefinedItems.UNDO,_predefinedItems.REDO,_predefinedItems.SEPARATOR,_predefinedItems.READ_ONLY,_predefinedItems.SEPARATOR,_predefinedItems.ALIGNMENT];}}]);function ContextMenu(hotInstance){var _this;_classCallCheck(this,ContextMenu);_this=_possibleConstructorReturn(this,_getPrototypeOf(ContextMenu).call(this,hotInstance));_this.eventManager=new _eventManager.default(_assertThisInitialized(_assertThisInitialized(_this)));_this.commandExecutor=new _commandExecutor.default(_this.hot);_this.itemsFactory=null;_this.menu=null;return _this;}
_createClass(ContextMenu,[{key:"isEnabled",value:function isEnabled(){return this.hot.getSettings().contextMenu;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.itemsFactory=new _itemsFactory.default(this.hot,ContextMenu.DEFAULT_ITEMS);var settings=this.hot.getSettings().contextMenu;var predefinedItems={items:this.itemsFactory.getItems(settings)};if(typeof settings.callback==='function'){this.commandExecutor.setCommonCallback(settings.callback);}
_get(_getPrototypeOf(ContextMenu.prototype),"enablePlugin",this).call(this);var delayedInitialization=function delayedInitialization(){if(!_this2.hot){return;}
_this2.hot.runHooks('afterContextMenuDefaultOptions',predefinedItems);_this2.itemsFactory.setPredefinedItems(predefinedItems.items);var menuItems=_this2.itemsFactory.getItems(settings);_this2.menu=new _menu.default(_this2.hot,{className:'htContextMenu',keepInViewport:true});_this2.hot.runHooks('beforeContextMenuSetItems',menuItems);_this2.menu.setMenuItems(menuItems);_this2.menu.addLocalHook('beforeOpen',function(){return _this2.onMenuBeforeOpen();});_this2.menu.addLocalHook('afterOpen',function(){return _this2.onMenuAfterOpen();});_this2.menu.addLocalHook('afterClose',function(){return _this2.onMenuAfterClose();});_this2.menu.addLocalHook('executeCommand',function(){var _this2$executeCommand;for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++){params[_key]=arguments[_key];}
return(_this2$executeCommand=_this2.executeCommand).call.apply(_this2$executeCommand,[_this2].concat(params));});_this2.addHook('afterOnCellContextMenu',function(event){return _this2.onAfterOnCellContextMenu(event);});(0,_array.arrayEach)(menuItems,function(command){return _this2.commandExecutor.registerCommand(command.key,command);});};this.callOnPluginsReady(function(){if(_this2.isPluginsReady){setTimeout(delayedInitialization,0);}else{delayedInitialization();}});}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();_get(_getPrototypeOf(ContextMenu.prototype),"updatePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){this.close();if(this.menu){this.menu.destroy();this.menu=null;}
_get(_getPrototypeOf(ContextMenu.prototype),"disablePlugin",this).call(this);}},{key:"open",value:function open(event){if(!this.menu){return;}
this.menu.open();this.menu.setPosition({top:parseInt((0,_event.pageY)(event),10)-(0,_element.getWindowScrollTop)(),left:parseInt((0,_event.pageX)(event),10)-(0,_element.getWindowScrollLeft)()});this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv;}},{key:"close",value:function close(){if(!this.menu){return;}
this.menu.close();}},{key:"executeCommand",value:function executeCommand(commandName){var _this$commandExecutor;for(var _len2=arguments.length,params=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){params[_key2-1]=arguments[_key2];}
(_this$commandExecutor=this.commandExecutor).execute.apply(_this$commandExecutor,[commandName].concat(params));}},{key:"onAfterOnCellContextMenu",value:function onAfterOnCellContextMenu(event){var settings=this.hot.getSettings();var showRowHeaders=settings.rowHeaders;var showColHeaders=settings.colHeaders;function isValidElement(element){return element.nodeName==='TD'||element.parentNode.nodeName==='TD';}
var element=event.realTarget;this.close();if((0,_element.hasClass)(element,'handsontableInput')){return;}
event.preventDefault();(0,_event.stopPropagation)(event);if(!(showRowHeaders||showColHeaders)){if(!isValidElement(element)&&!((0,_element.hasClass)(element,'current')&&(0,_element.hasClass)(element,'wtBorder'))){return;}}
this.open(event);}},{key:"onMenuBeforeOpen",value:function onMenuBeforeOpen(){this.hot.runHooks('beforeContextMenuShow',this);}},{key:"onMenuAfterOpen",value:function onMenuAfterOpen(){this.hot.runHooks('afterContextMenuShow',this);}},{key:"onMenuAfterClose",value:function onMenuAfterClose(){this.hot.listen();this.hot.runHooks('afterContextMenuHide',this);}},{key:"destroy",value:function destroy(){this.close();if(this.menu){this.menu.destroy();}
_get(_getPrototypeOf(ContextMenu.prototype),"destroy",this).call(this);}}]);return ContextMenu;}(_base.default);ContextMenu.SEPARATOR={name:_predefinedItems.SEPARATOR};(0,_plugins.registerPlugin)('contextMenu',ContextMenu);var _default=ContextMenu;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _array=__webpack_require__(3);var _object=__webpack_require__(2);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var CommandExecutor=function(){function CommandExecutor(hotInstance){_classCallCheck(this,CommandExecutor);this.hot=hotInstance;this.commands={};this.commonCallback=null;}
_createClass(CommandExecutor,[{key:"registerCommand",value:function registerCommand(name,commandDescriptor){this.commands[name]=commandDescriptor;}},{key:"setCommonCallback",value:function setCommonCallback(callback){this.commonCallback=callback;}},{key:"execute",value:function execute(commandName){var _this=this;for(var _len=arguments.length,params=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){params[_key-1]=arguments[_key];}
var commandSplit=commandName.split(':');var commandNamePrimary=commandSplit[0];var subCommandName=commandSplit.length===2?commandSplit[1]:null;var command=this.commands[commandNamePrimary];if(!command){throw new Error("Menu command '".concat(commandNamePrimary,"' not exists."));}
if(subCommandName&&command.submenu){command=findSubCommand(subCommandName,command.submenu.items);}
if(command.disabled===true){return;}
if(typeof command.disabled==='function'&&command.disabled.call(this.hot)===true){return;}
if((0,_object.hasOwnProperty)(command,'submenu')){return;}
var callbacks=[];if(typeof command.callback==='function'){callbacks.push(command.callback);}
if(typeof this.commonCallback==='function'){callbacks.push(this.commonCallback);}
params.unshift(commandSplit.join(':'));(0,_array.arrayEach)(callbacks,function(callback){return callback.apply(_this.hot,params);});}}]);return CommandExecutor;}();function findSubCommand(subCommandName,subCommands){var command;(0,_array.arrayEach)(subCommands,function(cmd){var cmds=cmd.key?cmd.key.split(':'):null;if(Array.isArray(cmds)&&cmds[1]===subCommandName){command=cmd;return false;}});return command;}
var _default=CommandExecutor;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _object=__webpack_require__(2);var _array=__webpack_require__(3);var _predefinedItems=__webpack_require__(127);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var ItemsFactory=function(){function ItemsFactory(hotInstance){var orderPattern=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;_classCallCheck(this,ItemsFactory);this.hot=hotInstance;this.predefinedItems=(0,_predefinedItems.predefinedItems)();this.defaultOrderPattern=orderPattern;}
_createClass(ItemsFactory,[{key:"setPredefinedItems",value:function setPredefinedItems(predefinedItemsCollection){var _this=this;var items={};this.defaultOrderPattern.length=0;(0,_object.objectEach)(predefinedItemsCollection,function(value,key){var menuItemKey='';if(value.name===_predefinedItems.SEPARATOR){items[_predefinedItems.SEPARATOR]=value;menuItemKey=_predefinedItems.SEPARATOR;}else if(isNaN(parseInt(key,10))){value.key=value.key===void 0?key:value.key;items[key]=value;menuItemKey=value.key;}else{items[value.key]=value;menuItemKey=value.key;}
_this.defaultOrderPattern.push(menuItemKey);});this.predefinedItems=items;}},{key:"getItems",value:function getItems(){var pattern=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return _getItems(pattern,this.defaultOrderPattern,this.predefinedItems);}}]);return ItemsFactory;}();function _getItems(){var itemsPattern=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var defaultPattern=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var items=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var result=[];var pattern=itemsPattern;if(pattern&&pattern.items){pattern=pattern.items;}else if(!Array.isArray(pattern)){pattern=defaultPattern;}
if((0,_object.isObject)(pattern)){(0,_object.objectEach)(pattern,function(value,key){var item=items[typeof value==='string'?value:key];if(!item){item=value;}
if((0,_object.isObject)(value)){(0,_object.extend)(item,value);}else if(typeof item==='string'){item={name:item};}
if(item.key===void 0){item.key=key;}
result.push(item);});}else{(0,_array.arrayEach)(pattern,function(name,key){var item=items[name];if(!item&&_predefinedItems.ITEMS.indexOf(name)>=0){return;}
if(!item){item={name:name,key:"".concat(key)};}
if((0,_object.isObject)(name)){(0,_object.extend)(item,name);}
if(item.key===void 0){item.key=key;}
result.push(item);});}
return result;}
var _default=ItemsFactory;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=alignmentItem;exports.KEY=void 0;var _utils=__webpack_require__(30);var _separator=__webpack_require__(126);var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
var KEY='alignment';exports.KEY=KEY;function alignmentItem(){return{key:KEY,name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ALIGNMENT);},disabled:function disabled(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner());},submenu:{items:[{key:"".concat(KEY,":left"),name:function name(){var _this=this;var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT);var hasClass=(0,_utils.checkSelectionConsistency)(this.getSelectedRange(),function(row,col){var className=_this.getCellMeta(row,col).className;if(className&&className.indexOf('htLeft')!==-1){return true;}});if(hasClass){label=(0,_utils.markLabelAsSelected)(label);}
return label;},callback:function callback(){var _this2=this;var selectedRange=this.getSelectedRange();var stateBefore=(0,_utils.getAlignmentClasses)(selectedRange,function(row,col){return _this2.getCellMeta(row,col).className;});var type='horizontal';var alignment='htLeft';this.runHooks('beforeCellAlignment',stateBefore,selectedRange,type,alignment);(0,_utils.align)(selectedRange,type,alignment,function(row,col){return _this2.getCellMeta(row,col);},function(row,col,key,value){return _this2.setCellMeta(row,col,key,value);});this.render();},disabled:false},{key:"".concat(KEY,":center"),name:function name(){var _this3=this;var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER);var hasClass=(0,_utils.checkSelectionConsistency)(this.getSelectedRange(),function(row,col){var className=_this3.getCellMeta(row,col).className;if(className&&className.indexOf('htCenter')!==-1){return true;}});if(hasClass){label=(0,_utils.markLabelAsSelected)(label);}
return label;},callback:function callback(){var _this4=this;var selectedRange=this.getSelectedRange();var stateBefore=(0,_utils.getAlignmentClasses)(selectedRange,function(row,col){return _this4.getCellMeta(row,col).className;});var type='horizontal';var alignment='htCenter';this.runHooks('beforeCellAlignment',stateBefore,selectedRange,type,alignment);(0,_utils.align)(selectedRange,type,alignment,function(row,col){return _this4.getCellMeta(row,col);},function(row,col,key,value){return _this4.setCellMeta(row,col,key,value);});this.render();},disabled:false},{key:"".concat(KEY,":right"),name:function name(){var _this5=this;var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT);var hasClass=(0,_utils.checkSelectionConsistency)(this.getSelectedRange(),function(row,col){var className=_this5.getCellMeta(row,col).className;if(className&&className.indexOf('htRight')!==-1){return true;}});if(hasClass){label=(0,_utils.markLabelAsSelected)(label);}
return label;},callback:function callback(){var _this6=this;var selectedRange=this.getSelectedRange();var stateBefore=(0,_utils.getAlignmentClasses)(selectedRange,function(row,col){return _this6.getCellMeta(row,col).className;});var type='horizontal';var alignment='htRight';this.runHooks('beforeCellAlignment',stateBefore,selectedRange,type,alignment);(0,_utils.align)(selectedRange,type,alignment,function(row,col){return _this6.getCellMeta(row,col);},function(row,col,key,value){return _this6.setCellMeta(row,col,key,value);});this.render();},disabled:false},{key:"".concat(KEY,":justify"),name:function name(){var _this7=this;var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY);var hasClass=(0,_utils.checkSelectionConsistency)(this.getSelectedRange(),function(row,col){var className=_this7.getCellMeta(row,col).className;if(className&&className.indexOf('htJustify')!==-1){return true;}});if(hasClass){label=(0,_utils.markLabelAsSelected)(label);}
return label;},callback:function callback(){var _this8=this;var selectedRange=this.getSelectedRange();var stateBefore=(0,_utils.getAlignmentClasses)(selectedRange,function(row,col){return _this8.getCellMeta(row,col).className;});var type='horizontal';var alignment='htJustify';this.runHooks('beforeCellAlignment',stateBefore,selectedRange,type,alignment);(0,_utils.align)(selectedRange,type,alignment,function(row,col){return _this8.getCellMeta(row,col);},function(row,col,key,value){return _this8.setCellMeta(row,col,key,value);});this.render();},disabled:false},{name:_separator.KEY},{key:"".concat(KEY,":top"),name:function name(){var _this9=this;var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ALIGNMENT_TOP);var hasClass=(0,_utils.checkSelectionConsistency)(this.getSelectedRange(),function(row,col){var className=_this9.getCellMeta(row,col).className;if(className&&className.indexOf('htTop')!==-1){return true;}});if(hasClass){label=(0,_utils.markLabelAsSelected)(label);}
return label;},callback:function callback(){var _this10=this;var selectedRange=this.getSelectedRange();var stateBefore=(0,_utils.getAlignmentClasses)(selectedRange,function(row,col){return _this10.getCellMeta(row,col).className;});var type='vertical';var alignment='htTop';this.runHooks('beforeCellAlignment',stateBefore,selectedRange,type,alignment);(0,_utils.align)(selectedRange,type,alignment,function(row,col){return _this10.getCellMeta(row,col);},function(row,col,key,value){return _this10.setCellMeta(row,col,key,value);});this.render();},disabled:false},{key:"".concat(KEY,":middle"),name:function name(){var _this11=this;var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE);var hasClass=(0,_utils.checkSelectionConsistency)(this.getSelectedRange(),function(row,col){var className=_this11.getCellMeta(row,col).className;if(className&&className.indexOf('htMiddle')!==-1){return true;}});if(hasClass){label=(0,_utils.markLabelAsSelected)(label);}
return label;},callback:function callback(){var _this12=this;var selectedRange=this.getSelectedRange();var stateBefore=(0,_utils.getAlignmentClasses)(selectedRange,function(row,col){return _this12.getCellMeta(row,col).className;});var type='vertical';var alignment='htMiddle';this.runHooks('beforeCellAlignment',stateBefore,selectedRange,type,alignment);(0,_utils.align)(selectedRange,type,alignment,function(row,col){return _this12.getCellMeta(row,col);},function(row,col,key,value){return _this12.setCellMeta(row,col,key,value);});this.render();},disabled:false},{key:"".concat(KEY,":bottom"),name:function name(){var _this13=this;var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM);var hasClass=(0,_utils.checkSelectionConsistency)(this.getSelectedRange(),function(row,col){var className=_this13.getCellMeta(row,col).className;if(className&&className.indexOf('htBottom')!==-1){return true;}});if(hasClass){label=(0,_utils.markLabelAsSelected)(label);}
return label;},callback:function callback(){var _this14=this;var selectedRange=this.getSelectedRange();var stateBefore=(0,_utils.getAlignmentClasses)(selectedRange,function(row,col){return _this14.getCellMeta(row,col).className;});var type='vertical';var alignment='htBottom';this.runHooks('beforeCellAlignment',stateBefore,selectedRange,type,alignment);(0,_utils.align)(selectedRange,type,alignment,function(row,col){return _this14.getCellMeta(row,col);},function(row,col,key,value){return _this14.setCellMeta(row,col,key,value);});this.render();},disabled:false}]}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=clearColumnItem;exports.KEY=void 0;var _utils=__webpack_require__(30);var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
var KEY='clear_column';exports.KEY=KEY;function clearColumnItem(){return{key:KEY,name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_CLEAR_COLUMN);},callback:function callback(key,selection){var column=selection[0].start.col;if(this.countRows()){this.populateFromArray(0,column,[[null]],Math.max(selection[0].start.row,selection[0].end.row),column,'ContextMenu.clearColumn');}},disabled:function disabled(){var selected=(0,_utils.getValidSelection)(this);if(!selected){return true;}
var _selected$=_slicedToArray(selected[0],3),startRow=_selected$[0],startColumn=_selected$[1],endRow=_selected$[2];var entireRowSelection=[startRow,0,endRow,this.countCols()-1];var rowSelected=entireRowSelection.join(',')===selected.join(',');return startColumn<0||this.countCols()>=this.getSettings().maxCols||rowSelected;}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=columnLeftItem;exports.KEY=void 0;var _utils=__webpack_require__(30);var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
var KEY='col_left';exports.KEY=KEY;function columnLeftItem(){return{key:KEY,name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_INSERT_LEFT);},callback:function callback(key,normalizedSelection){var latestSelection=normalizedSelection[Math.max(normalizedSelection.length-1,0)];this.alter('insert_col',latestSelection.start.col,1,'ContextMenu.columnLeft');},disabled:function disabled(){var selected=(0,_utils.getValidSelection)(this);if(!selected){return true;}
if(!this.isColumnModificationAllowed()){return true;}
var _selected$=_slicedToArray(selected[0],3),startRow=_selected$[0],startColumn=_selected$[1],endRow=_selected$[2];var entireRowSelection=[startRow,0,endRow,this.countCols()-1];var rowSelected=entireRowSelection.join(',')===selected.join(',');var onlyOneColumn=this.countCols()===1;return startColumn<0||this.countCols()>=this.getSettings().maxCols||!onlyOneColumn&&rowSelected;},hidden:function hidden(){return!this.getSettings().allowInsertColumn;}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=columnRightItem;exports.KEY=void 0;var _utils=__webpack_require__(30);var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
var KEY='col_right';exports.KEY=KEY;function columnRightItem(){return{key:KEY,name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_INSERT_RIGHT);},callback:function callback(key,normalizedSelection){var latestSelection=normalizedSelection[Math.max(normalizedSelection.length-1,0)];this.alter('insert_col',latestSelection.end.col+1,1,'ContextMenu.columnRight');},disabled:function disabled(){var selected=(0,_utils.getValidSelection)(this);if(!selected){return true;}
if(!this.isColumnModificationAllowed()){return true;}
var _selected$=_slicedToArray(selected[0],3),startRow=_selected$[0],startColumn=_selected$[1],endRow=_selected$[2];var entireRowSelection=[startRow,0,endRow,this.countCols()-1];var rowSelected=entireRowSelection.join(',')===selected.join(',');var onlyOneColumn=this.countCols()===1;return startColumn<0||this.countCols()>=this.getSettings().maxCols||!onlyOneColumn&&rowSelected;},hidden:function hidden(){return!this.getSettings().allowInsertColumn;}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=readOnlyItem;exports.KEY=void 0;var _utils=__webpack_require__(30);var _array=__webpack_require__(3);var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
var KEY='make_read_only';exports.KEY=KEY;function readOnlyItem(){return{key:KEY,name:function name(){var _this=this;var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_READ_ONLY);var atLeastOneReadOnly=(0,_utils.checkSelectionConsistency)(this.getSelectedRange(),function(row,col){return _this.getCellMeta(row,col).readOnly;});if(atLeastOneReadOnly){label=(0,_utils.markLabelAsSelected)(label);}
return label;},callback:function callback(){var _this2=this;var ranges=this.getSelectedRange();var atLeastOneReadOnly=(0,_utils.checkSelectionConsistency)(ranges,function(row,col){return _this2.getCellMeta(row,col).readOnly;});(0,_array.arrayEach)(ranges,function(range){range.forAll(function(row,col){_this2.setCellMeta(row,col,'readOnly',!atLeastOneReadOnly);});});this.render();},disabled:function disabled(){return!(this.getSelectedRange()&&!this.selection.isSelectedByCorner());}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=redoItem;exports.KEY=void 0;var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
var KEY='redo';exports.KEY=KEY;function redoItem(){return{key:KEY,name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_REDO);},callback:function callback(){this.redo();},disabled:function disabled(){return this.undoRedo&&!this.undoRedo.isRedoAvailable();}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=removeColumnItem;exports.KEY=void 0;var _utils=__webpack_require__(30);var _utils2=__webpack_require__(91);var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
var KEY='remove_col';exports.KEY=KEY;function removeColumnItem(){return{key:KEY,name:function name(){var selection=this.getSelected();var pluralForm=0;if(selection){if(selection.length>1){pluralForm=1;}else{var _selection$=_slicedToArray(selection[0],4),fromColumn=_selection$[1],toColumn=_selection$[3];if(fromColumn-toColumn!==0){pluralForm=1;}}}
return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_REMOVE_COLUMN,pluralForm);},callback:function callback(){this.alter('remove_col',(0,_utils2.transformSelectionToColumnDistance)(this.getSelected()),null,'ContextMenu.removeColumn');},disabled:function disabled(){var selected=(0,_utils.getValidSelection)(this);var totalColumns=this.countCols();if(!selected){return true;}
return this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner()||!this.isColumnModificationAllowed()||!totalColumns;},hidden:function hidden(){return!this.getSettings().allowRemoveColumn;}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=removeRowItem;exports.KEY=void 0;var _utils=__webpack_require__(30);var _utils2=__webpack_require__(91);var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
var KEY='remove_row';exports.KEY=KEY;function removeRowItem(){return{key:KEY,name:function name(){var selection=this.getSelected();var pluralForm=0;if(selection){if(selection.length>1){pluralForm=1;}else{var _selection$=_slicedToArray(selection[0],3),fromRow=_selection$[0],toRow=_selection$[2];if(fromRow-toRow!==0){pluralForm=1;}}}
return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_REMOVE_ROW,pluralForm);},callback:function callback(){this.alter('remove_row',(0,_utils2.transformSelectionToRowDistance)(this.getSelected()),1,'ContextMenu.removeRow');},disabled:function disabled(){var selected=(0,_utils.getValidSelection)(this);var totalRows=this.countRows();if(!selected){return true;}
return this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner()||!totalRows;},hidden:function hidden(){return!this.getSettings().allowRemoveRow;}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=rowAboveItem;exports.KEY=void 0;var _utils=__webpack_require__(30);var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
var KEY='row_above';exports.KEY=KEY;function rowAboveItem(){return{key:KEY,name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ROW_ABOVE);},callback:function callback(key,normalizedSelection){var latestSelection=normalizedSelection[Math.max(normalizedSelection.length-1,0)];this.alter('insert_row',latestSelection.start.row,1,'ContextMenu.rowAbove');},disabled:function disabled(){var selected=(0,_utils.getValidSelection)(this);if(!selected){return true;}
return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows;},hidden:function hidden(){return!this.getSettings().allowInsertRow;}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=rowBelowItem;exports.KEY=void 0;var _utils=__webpack_require__(30);var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
var KEY='row_below';exports.KEY=KEY;function rowBelowItem(){return{key:KEY,name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_ROW_BELOW);},callback:function callback(key,normalizedSelection){var latestSelection=normalizedSelection[Math.max(normalizedSelection.length-1,0)];this.alter('insert_row',latestSelection.end.row+1,1,'ContextMenu.rowBelow');},disabled:function disabled(){var selected=(0,_utils.getValidSelection)(this);if(!selected){return true;}
return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows;},hidden:function hidden(){return!this.getSettings().allowInsertRow;}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=undoItem;exports.KEY=void 0;var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
var KEY='undo';exports.KEY=KEY;function undoItem(){return{key:KEY,name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_UNDO);},callback:function callback(){this.undo();},disabled:function disabled(){return this.undoRedo&&!this.undoRedo.isUndoAvailable();}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _core=_interopRequireDefault(__webpack_require__(120));var _element=__webpack_require__(1);var _array=__webpack_require__(3);var _cursor=_interopRequireDefault(__webpack_require__(701));var _eventManager=_interopRequireDefault(__webpack_require__(10));var _object=__webpack_require__(2);var _mixed=__webpack_require__(14);var _function=__webpack_require__(59);var _utils=__webpack_require__(30);var _unicode=__webpack_require__(32);var _localHooks=_interopRequireDefault(__webpack_require__(68));var _predefinedItems=__webpack_require__(127);var _event=__webpack_require__(18);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var MIN_WIDTH=215;var Menu=function(){function Menu(hotInstance,options){_classCallCheck(this,Menu);this.hot=hotInstance;this.options=options||{parent:null,name:null,className:'',keepInViewport:true,standalone:false,minWidth:MIN_WIDTH};this.eventManager=new _eventManager.default(this);this.container=this.createContainer(this.options.name);this.hotMenu=null;this.hotSubMenus={};this.parentMenu=this.options.parent||null;this.menuItems=null;this.origOutsideClickDeselects=null;this.keyEvent=false;this.offset={above:0,below:0,left:0,right:0};this._afterScrollCallback=null;this.registerEvents();}
_createClass(Menu,[{key:"registerEvents",value:function registerEvents(){var _this=this;this.eventManager.addEventListener(document.documentElement,'mousedown',function(event){return _this.onDocumentMouseDown(event);});}},{key:"setMenuItems",value:function setMenuItems(menuItems){this.menuItems=menuItems;}},{key:"setOffset",value:function setOffset(area){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;this.offset[area]=offset;}},{key:"isSubMenu",value:function isSubMenu(){return this.parentMenu!==null;}},{key:"open",value:function open(){var _this2=this;this.runLocalHooks('beforeOpen');this.container.removeAttribute('style');this.container.style.display='block';var delayedOpenSubMenu=(0,_function.debounce)(function(row){return _this2.openSubMenu(row);},300);var minWidthOfMenu=this.options.minWidth||MIN_WIDTH;var filteredItems=(0,_array.arrayFilter)(this.menuItems,function(item){return(0,_utils.isItemHidden)(item,_this2.hot);});filteredItems=(0,_utils.filterSeparators)(filteredItems,_predefinedItems.SEPARATOR);var settings={data:filteredItems,colHeaders:false,autoColumnSize:true,modifyColWidth:function modifyColWidth(width){if((0,_mixed.isDefined)(width)&&width<minWidthOfMenu){return minWidthOfMenu;}
return width;},autoRowSize:false,readOnly:true,copyPaste:false,columns:[{data:'name',renderer:function renderer(hot,TD,row,col,prop,value){return _this2.menuItemRenderer(hot,TD,row,col,prop,value);}}],renderAllRows:true,fragmentSelection:'cell',disableVisualSelection:'area',beforeKeyDown:function beforeKeyDown(event){return _this2.onBeforeKeyDown(event);},afterOnCellMouseOver:function afterOnCellMouseOver(event,coords){if(_this2.isAllSubMenusClosed()){delayedOpenSubMenu(coords.row);}else{_this2.openSubMenu(coords.row);}},rowHeights:function rowHeights(row){return filteredItems[row].name===_predefinedItems.SEPARATOR?1:23;}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=false;this.hotMenu=new _core.default(this.container,settings);this.hotMenu.addHook('afterInit',function(){return _this2.onAfterInit();});this.hotMenu.addHook('afterSelection',function(){return _this2.onAfterSelection.apply(_this2,arguments);});this.hotMenu.init();this.hotMenu.listen();this.blockMainTableCallbacks();this.runLocalHooks('afterOpen');}},{key:"close",value:function close(){var closeParent=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!this.isOpened()){return;}
if(closeParent&&this.parentMenu){this.parentMenu.close();}else{this.closeAllSubMenus();this.container.style.display='none';this.releaseMainTableCallbacks();this.hotMenu.destroy();this.hotMenu=null;this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects;this.runLocalHooks('afterClose');if(this.parentMenu){this.parentMenu.hotMenu.listen();}}}},{key:"openSubMenu",value:function openSubMenu(row){if(!this.hotMenu){return false;}
var cell=this.hotMenu.getCell(row,0);this.closeAllSubMenus();if(!cell||!(0,_utils.hasSubMenu)(cell)){return false;}
var dataItem=this.hotMenu.getSourceDataAtRow(row);var subMenu=new Menu(this.hot,{parent:this,name:dataItem.name,className:this.options.className,keepInViewport:true});subMenu.setMenuItems(dataItem.submenu.items);subMenu.open();subMenu.setPosition(cell.getBoundingClientRect());this.hotSubMenus[dataItem.key]=subMenu;return subMenu;}},{key:"closeSubMenu",value:function closeSubMenu(row){var dataItem=this.hotMenu.getSourceDataAtRow(row);var menus=this.hotSubMenus[dataItem.key];if(menus){menus.destroy();delete this.hotSubMenus[dataItem.key];}}},{key:"closeAllSubMenus",value:function closeAllSubMenus(){var _this3=this;(0,_array.arrayEach)(this.hotMenu.getData(),function(value,row){return _this3.closeSubMenu(row);});}},{key:"isAllSubMenusClosed",value:function isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0;}},{key:"destroy",value:function destroy(){this.clearLocalHooks();this.close();this.parentMenu=null;this.eventManager.destroy();}},{key:"isOpened",value:function isOpened(){return this.hotMenu!==null;}},{key:"executeCommand",value:function executeCommand(event){if(!this.isOpened()||!this.hotMenu.getSelectedLast()){return;}
var selectedItem=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]);this.runLocalHooks('select',selectedItem,event);if(selectedItem.isCommand===false||selectedItem.name===_predefinedItems.SEPARATOR){return;}
var selRanges=this.hot.getSelectedRange();var normalizedSelection=selRanges?(0,_utils.normalizeSelection)(selRanges):[];var autoClose=true;if(selectedItem.disabled===true||typeof selectedItem.disabled==='function'&&selectedItem.disabled.call(this.hot)===true||selectedItem.submenu){autoClose=false;}
this.runLocalHooks('executeCommand',selectedItem.key,normalizedSelection,event);if(this.isSubMenu()){this.parentMenu.runLocalHooks('executeCommand',selectedItem.key,normalizedSelection,event);}
if(autoClose){this.close(true);}}},{key:"setPosition",value:function setPosition(coords){var cursor=new _cursor.default(coords);if(this.options.keepInViewport){if(cursor.fitsBelow(this.container)){this.setPositionBelowCursor(cursor);}else if(cursor.fitsAbove(this.container)){this.setPositionAboveCursor(cursor);}else{this.setPositionBelowCursor(cursor);}
if(cursor.fitsOnRight(this.container)){this.setPositionOnRightOfCursor(cursor);}else{this.setPositionOnLeftOfCursor(cursor);}}else{this.setPositionBelowCursor(cursor);this.setPositionOnRightOfCursor(cursor);}}},{key:"setPositionAboveCursor",value:function setPositionAboveCursor(cursor){var top=this.offset.above+cursor.top-this.container.offsetHeight;if(this.isSubMenu()){top=cursor.top+cursor.cellHeight-this.container.offsetHeight+3;}
this.container.style.top="".concat(top,"px");}},{key:"setPositionBelowCursor",value:function setPositionBelowCursor(cursor){var top=this.offset.below+cursor.top;if(this.isSubMenu()){top=cursor.top-1;}
this.container.style.top="".concat(top,"px");}},{key:"setPositionOnRightOfCursor",value:function setPositionOnRightOfCursor(cursor){var left;if(this.isSubMenu()){left=1+cursor.left+cursor.cellWidth;}else{left=this.offset.right+1+cursor.left;}
this.container.style.left="".concat(left,"px");}},{key:"setPositionOnLeftOfCursor",value:function setPositionOnLeftOfCursor(cursor){var left=this.offset.left+cursor.left-this.container.offsetWidth+(0,_element.getScrollbarWidth)()+4;this.container.style.left="".concat(left,"px");}},{key:"selectFirstCell",value:function selectFirstCell(){var cell=this.hotMenu.getCell(0,0);if((0,_utils.isSeparator)(cell)||(0,_utils.isDisabled)(cell)||(0,_utils.isSelectionDisabled)(cell)){this.selectNextCell(0,0);}else{this.hotMenu.selectCell(0,0);}}},{key:"selectLastCell",value:function selectLastCell(){var lastRow=this.hotMenu.countRows()-1;var cell=this.hotMenu.getCell(lastRow,0);if((0,_utils.isSeparator)(cell)||(0,_utils.isDisabled)(cell)||(0,_utils.isSelectionDisabled)(cell)){this.selectPrevCell(lastRow,0);}else{this.hotMenu.selectCell(lastRow,0);}}},{key:"selectNextCell",value:function selectNextCell(row,col){var nextRow=row+1;var cell=nextRow<this.hotMenu.countRows()?this.hotMenu.getCell(nextRow,col):null;if(!cell){return;}
if((0,_utils.isSeparator)(cell)||(0,_utils.isDisabled)(cell)||(0,_utils.isSelectionDisabled)(cell)){this.selectNextCell(nextRow,col);}else{this.hotMenu.selectCell(nextRow,col);}}},{key:"selectPrevCell",value:function selectPrevCell(row,col){var prevRow=row-1;var cell=prevRow>=0?this.hotMenu.getCell(prevRow,col):null;if(!cell){return;}
if((0,_utils.isSeparator)(cell)||(0,_utils.isDisabled)(cell)||(0,_utils.isSelectionDisabled)(cell)){this.selectPrevCell(prevRow,col);}else{this.hotMenu.selectCell(prevRow,col);}}},{key:"menuItemRenderer",value:function menuItemRenderer(hot,TD,row,col,prop,value){var _this4=this;var item=hot.getSourceDataAtRow(row);var wrapper=document.createElement('div');var isSubMenu=function isSubMenu(itemToTest){return(0,_object.hasOwnProperty)(itemToTest,'submenu');};var itemIsSeparator=function itemIsSeparator(itemToTest){return new RegExp(_predefinedItems.SEPARATOR,'i').test(itemToTest.name);};var itemIsDisabled=function itemIsDisabled(itemToTest){return itemToTest.disabled===true||typeof itemToTest.disabled==='function'&&itemToTest.disabled.call(_this4.hot)===true;};var itemIsSelectionDisabled=function itemIsSelectionDisabled(itemToTest){return itemToTest.disableSelection;};var itemValue=value;if(typeof itemValue==='function'){itemValue=itemValue.call(this.hot);}
(0,_element.empty)(TD);(0,_element.addClass)(wrapper,'htItemWrapper');TD.appendChild(wrapper);if(itemIsSeparator(item)){(0,_element.addClass)(TD,'htSeparator');}else if(typeof item.renderer==='function'){(0,_element.addClass)(TD,'htCustomMenuRenderer');TD.appendChild(item.renderer(hot,wrapper,row,col,prop,itemValue));}else{(0,_element.fastInnerHTML)(wrapper,itemValue);}
if(itemIsDisabled(item)){(0,_element.addClass)(TD,'htDisabled');this.eventManager.addEventListener(TD,'mouseenter',function(){return hot.deselectCell();});}else if(itemIsSelectionDisabled(item)){(0,_element.addClass)(TD,'htSelectionDisabled');this.eventManager.addEventListener(TD,'mouseenter',function(){return hot.deselectCell();});}else if(isSubMenu(item)){(0,_element.addClass)(TD,'htSubmenu');if(itemIsSelectionDisabled(item)){this.eventManager.addEventListener(TD,'mouseenter',function(){return hot.deselectCell();});}else{this.eventManager.addEventListener(TD,'mouseenter',function(){return hot.selectCell(row,col,void 0,void 0,false,false);});}}else{(0,_element.removeClass)(TD,'htSubmenu');(0,_element.removeClass)(TD,'htDisabled');if(itemIsSelectionDisabled(item)){this.eventManager.addEventListener(TD,'mouseenter',function(){return hot.deselectCell();});}else{this.eventManager.addEventListener(TD,'mouseenter',function(){return hot.selectCell(row,col,void 0,void 0,false,false);});}}}},{key:"createContainer",value:function createContainer(){var name=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var className=name;var container;if(className){if((0,_function.isFunction)(className)){className=className.call(this.hot);if(className===null||(0,_mixed.isUndefined)(className)){className='';}else{className=className.toString();}}
className=className.replace(/[^A-z0-9]/g,'_');className="".concat(this.options.className,"Sub_").concat(className);container=document.querySelector(".".concat(this.options.className,".").concat(className));}else{container=document.querySelector(".".concat(this.options.className));}
if(!container){container=document.createElement('div');(0,_element.addClass)(container,"htMenu ".concat(this.options.className));if(className){(0,_element.addClass)(container,className);}
document.getElementsByTagName('body')[0].appendChild(container);}
return container;}},{key:"blockMainTableCallbacks",value:function blockMainTableCallbacks(){this._afterScrollCallback=function(){};this.hot.addHook('afterScrollVertically',this._afterScrollCallback);this.hot.addHook('afterScrollHorizontally',this._afterScrollCallback);}},{key:"releaseMainTableCallbacks",value:function releaseMainTableCallbacks(){if(this._afterScrollCallback){this.hot.removeHook('afterScrollVertically',this._afterScrollCallback);this.hot.removeHook('afterScrollHorizontally',this._afterScrollCallback);this._afterScrollCallback=null;}}},{key:"onBeforeKeyDown",value:function onBeforeKeyDown(event){var selection=this.hotMenu.getSelectedLast();var stopEvent=false;this.keyEvent=true;switch(event.keyCode){case _unicode.KEY_CODES.ESCAPE:this.close();stopEvent=true;break;case _unicode.KEY_CODES.ENTER:if(selection){if(this.hotMenu.getSourceDataAtRow(selection[0]).submenu){stopEvent=true;}else{this.executeCommand(event);this.close(true);}}
break;case _unicode.KEY_CODES.ARROW_DOWN:if(selection){this.selectNextCell(selection[0],selection[1]);}else{this.selectFirstCell();}
stopEvent=true;break;case _unicode.KEY_CODES.ARROW_UP:if(selection){this.selectPrevCell(selection[0],selection[1]);}else{this.selectLastCell();}
stopEvent=true;break;case _unicode.KEY_CODES.ARROW_RIGHT:if(selection){var menu=this.openSubMenu(selection[0]);if(menu){menu.selectFirstCell();}}
stopEvent=true;break;case _unicode.KEY_CODES.ARROW_LEFT:if(selection&&this.isSubMenu()){this.close();if(this.parentMenu){this.parentMenu.hotMenu.listen();}
stopEvent=true;}
break;default:break;}
if(stopEvent){event.preventDefault();(0,_event.stopImmediatePropagation)(event);}
this.keyEvent=false;}},{key:"onAfterInit",value:function onAfterInit(){var data=this.hotMenu.getSettings().data;var hiderStyle=this.hotMenu.view.wt.wtTable.hider.style;var holderStyle=this.hotMenu.view.wt.wtTable.holder.style;var currentHiderWidth=parseInt(hiderStyle.width,10);var realHeight=(0,_array.arrayReduce)(data,function(accumulator,value){return accumulator+(value.name===_predefinedItems.SEPARATOR?1:26);},0);holderStyle.width="".concat(currentHiderWidth+22,"px");holderStyle.height="".concat(realHeight+4,"px");hiderStyle.height=holderStyle.height;}},{key:"onAfterSelection",value:function onAfterSelection(r,c,r2,c2,preventScrolling){if(this.keyEvent===false){preventScrolling.value=true;}}},{key:"onDocumentMouseDown",value:function onDocumentMouseDown(event){if(!this.isOpened()){return;}
if(this.container&&(0,_element.isChildOf)(event.target,this.container)){this.executeCommand(event);}
if(this.options.standalone&&this.hotMenu&&!(0,_element.isChildOf)(event.target,this.hotMenu.rootElement)){this.close(true);}else if((this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,_element.isChildOf)(event.target,'.htMenu')&&(0,_element.isChildOf)(event.target,document)){this.close(true);}}}]);return Menu;}();(0,_object.mixin)(Menu,_localHooks.default);var _default=Menu;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _event=__webpack_require__(18);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var Cursor=function(){function Cursor(object){_classCallCheck(this,Cursor);var windowScrollTop=(0,_element.getWindowScrollTop)();var windowScrollLeft=(0,_element.getWindowScrollLeft)();var top;var topRelative;var left;var leftRelative;var cellHeight;var cellWidth;this.type=this.getSourceType(object);if(this.type==='literal'){top=parseInt(object.top,10);left=parseInt(object.left,10);cellHeight=object.height||0;cellWidth=object.width||0;topRelative=top;leftRelative=left;top+=windowScrollTop;left+=windowScrollLeft;}else if(this.type==='event'){top=parseInt((0,_event.pageY)(object),10);left=parseInt((0,_event.pageX)(object),10);cellHeight=object.target.clientHeight;cellWidth=object.target.clientWidth;topRelative=top-windowScrollTop;leftRelative=left-windowScrollLeft;}
this.top=top;this.topRelative=topRelative;this.left=left;this.leftRelative=leftRelative;this.scrollTop=windowScrollTop;this.scrollLeft=windowScrollLeft;this.cellHeight=cellHeight;this.cellWidth=cellWidth;}
_createClass(Cursor,[{key:"getSourceType",value:function getSourceType(object){var type='literal';if(object instanceof Event){type='event';}
return type;}},{key:"fitsAbove",value:function fitsAbove(element){return this.topRelative>=element.offsetHeight;}},{key:"fitsBelow",value:function fitsBelow(element){var viewportHeight=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window.innerHeight;return this.topRelative+element.offsetHeight<=viewportHeight;}},{key:"fitsOnRight",value:function fitsOnRight(element){var viewportWidth=arguments.length>1&&arguments[1]!==undefined?arguments[1]:window.innerWidth;return this.leftRelative+this.cellWidth+element.offsetWidth<=viewportWidth;}},{key:"fitsOnLeft",value:function fitsOnLeft(element){return this.leftRelative>=element.offsetWidth;}}]);return Cursor;}();var _default=Cursor;exports.default=_default;}),(function(module,exports){}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _SheetClip=_interopRequireDefault(__webpack_require__(422));var _array=__webpack_require__(3);var _number=__webpack_require__(9);var _element=__webpack_require__(1);var _plugins=__webpack_require__(13);var _copy=_interopRequireDefault(__webpack_require__(704));var _cut=_interopRequireDefault(__webpack_require__(705));var _pasteEvent=_interopRequireDefault(__webpack_require__(706));var _focusableElement=__webpack_require__(708);var _utils=__webpack_require__(709);__webpack_require__(710);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
_pluginHooks.default.getSingleton().register('afterCopyLimit');_pluginHooks.default.getSingleton().register('modifyCopyableRange');_pluginHooks.default.getSingleton().register('beforeCut');_pluginHooks.default.getSingleton().register('afterCut');_pluginHooks.default.getSingleton().register('beforePaste');_pluginHooks.default.getSingleton().register('afterPaste');_pluginHooks.default.getSingleton().register('beforeCopy');_pluginHooks.default.getSingleton().register('afterCopy');var ROWS_LIMIT=1000;var COLUMNS_LIMIT=1000;var privatePool=new WeakMap();var CopyPaste=function(_BasePlugin){_inherits(CopyPaste,_BasePlugin);function CopyPaste(hotInstance){var _this;_classCallCheck(this,CopyPaste);_this=_possibleConstructorReturn(this,_getPrototypeOf(CopyPaste).call(this,hotInstance));_this.columnsLimit=COLUMNS_LIMIT;_this.copyableRanges=[];_this.pasteMode='overwrite';_this.rowsLimit=ROWS_LIMIT;privatePool.set(_assertThisInitialized(_assertThisInitialized(_this)),{isTriggeredByCopy:false,isTriggeredByCut:false,isBeginEditing:false,isFragmentSelectionEnabled:false});return _this;}
_createClass(CopyPaste,[{key:"isEnabled",value:function isEnabled(){return!!this.hot.getSettings().copyPaste;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
var settings=this.hot.getSettings();var priv=privatePool.get(this);priv.isFragmentSelectionEnabled=settings.fragmentSelection;if(_typeof(settings.copyPaste)==='object'){this.pasteMode=settings.copyPaste.pasteMode||this.pasteMode;this.rowsLimit=settings.copyPaste.rowsLimit||this.rowsLimit;this.columnsLimit=settings.copyPaste.columnsLimit||this.columnsLimit;}
this.addHook('afterContextMenuDefaultOptions',function(options){return _this2.onAfterContextMenuDefaultOptions(options);});this.addHook('afterOnCellMouseUp',function(){return _this2.onAfterOnCellMouseUp();});this.addHook('afterSelectionEnd',function(){return _this2.onAfterSelectionEnd();});this.addHook('beforeKeyDown',function(){return _this2.onBeforeKeyDown();});this.focusableElement=(0,_focusableElement.createElement)();this.focusableElement.addLocalHook('copy',function(event){return _this2.onCopy(event);}).addLocalHook('cut',function(event){return _this2.onCut(event);}).addLocalHook('paste',function(event){return _this2.onPaste(event);});_get(_getPrototypeOf(CopyPaste.prototype),"enablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();this.getOrCreateFocusableElement();_get(_getPrototypeOf(CopyPaste.prototype),"updatePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){if(this.focusableElement){(0,_focusableElement.destroyElement)(this.focusableElement);}
_get(_getPrototypeOf(CopyPaste.prototype),"disablePlugin",this).call(this);}},{key:"copy",value:function copy(){var priv=privatePool.get(this);priv.isTriggeredByCopy=true;this.getOrCreateFocusableElement();this.focusableElement.focus();document.execCommand('copy');}},{key:"cut",value:function cut(){var priv=privatePool.get(this);priv.isTriggeredByCut=true;this.getOrCreateFocusableElement();this.focusableElement.focus();document.execCommand('cut');}},{key:"getRangedCopyableData",value:function getRangedCopyableData(ranges){var _this3=this;var dataSet=[];var copyableRows=[];var copyableColumns=[];(0,_array.arrayEach)(ranges,function(range){(0,_number.rangeEach)(range.startRow,range.endRow,function(row){if(copyableRows.indexOf(row)===-1){copyableRows.push(row);}});(0,_number.rangeEach)(range.startCol,range.endCol,function(column){if(copyableColumns.indexOf(column)===-1){copyableColumns.push(column);}});});(0,_array.arrayEach)(copyableRows,function(row){var rowSet=[];(0,_array.arrayEach)(copyableColumns,function(column){rowSet.push(_this3.hot.getCopyableData(row,column));});dataSet.push(rowSet);});return _SheetClip.default.stringify(dataSet);}},{key:"getRangedData",value:function getRangedData(ranges){var _this4=this;var dataSet=[];var copyableRows=[];var copyableColumns=[];(0,_array.arrayEach)(ranges,function(range){(0,_number.rangeEach)(range.startRow,range.endRow,function(row){if(copyableRows.indexOf(row)===-1){copyableRows.push(row);}});(0,_number.rangeEach)(range.startCol,range.endCol,function(column){if(copyableColumns.indexOf(column)===-1){copyableColumns.push(column);}});});(0,_array.arrayEach)(copyableRows,function(row){var rowSet=[];(0,_array.arrayEach)(copyableColumns,function(column){rowSet.push(_this4.hot.getCopyableData(row,column));});dataSet.push(rowSet);});return dataSet;}},{key:"paste",value:function paste(){var pastableText=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var pastableHtml=arguments.length>1&&arguments[1]!==undefined?arguments[1]:pastableText;if(!pastableText&&!pastableHtml){return;}
var pasteData=new _pasteEvent.default();if(pastableText){pasteData.clipboardData.setData('text/plain',pastableText);}
if(pastableHtml){pasteData.clipboardData.setData('text/html',pastableHtml);}
this.getOrCreateFocusableElement();this.onPaste(pasteData);}},{key:"setCopyableText",value:function setCopyableText(){var selRange=this.hot.getSelectedRangeLast();if(!selRange){return;}
var topLeft=selRange.getTopLeftCorner();var bottomRight=selRange.getBottomRightCorner();var startRow=topLeft.row;var startCol=topLeft.col;var endRow=bottomRight.row;var endCol=bottomRight.col;var finalEndRow=Math.min(endRow,startRow+this.rowsLimit-1);var finalEndCol=Math.min(endCol,startCol+this.columnsLimit-1);this.copyableRanges.length=0;this.copyableRanges.push({startRow:startRow,startCol:startCol,endRow:finalEndRow,endCol:finalEndCol});this.copyableRanges=this.hot.runHooks('modifyCopyableRange',this.copyableRanges);if(endRow!==finalEndRow||endCol!==finalEndCol){this.hot.runHooks('afterCopyLimit',endRow-startRow+1,endCol-startCol+1,this.rowsLimit,this.columnsLimit);}}},{key:"getOrCreateFocusableElement",value:function getOrCreateFocusableElement(){var editor=this.hot.getActiveEditor();var editableElement=editor?editor.TEXTAREA:void 0;if(editableElement){this.focusableElement.setFocusableElement(editableElement);}else{this.focusableElement.useSecondaryElement();}}},{key:"isEditorOpened",value:function isEditorOpened(){var editor=this.hot.getActiveEditor();return editor&&editor.isOpened();}},{key:"populateValues",value:function populateValues(inputArray){var selection=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.hot.getSelectedLast();if(!inputArray.length){return;}
var newValuesMaxRow=inputArray.length-1;var newValuesMaxColumn=inputArray[0].length-1;var startRow=Math.min(selection[0],selection[2]);var endRow=Math.max(selection[0],selection[2],newValuesMaxRow+startRow);var startColumn=Math.min(selection[1],selection[3]);var endColumn=Math.max(selection[1],selection[3],newValuesMaxColumn+startColumn);var newValues=[];for(var row=startRow,valuesRow=0;row<=endRow;row+=1){var newRow=[];for(var column=startColumn,valuesColumn=0;column<=endColumn;column+=1){newRow.push(inputArray[valuesRow][valuesColumn]);valuesColumn=valuesColumn===newValuesMaxColumn?0:valuesColumn+=1;}
newValues.push(newRow);valuesRow=valuesRow===newValuesMaxRow?0:valuesRow+=1;}
this.hot.populateFromArray(startRow,startColumn,newValues,void 0,void 0,'CopyPaste.paste',this.pasteMode);return[startRow,startColumn,endRow,endColumn];}},{key:"onCopy",value:function onCopy(event){var priv=privatePool.get(this);if(!this.hot.isListening()&&!priv.isTriggeredByCopy||this.isEditorOpened()){return;}
this.setCopyableText();priv.isTriggeredByCopy=false;var rangedData=this.getRangedData(this.copyableRanges);var allowCopying=!!this.hot.runHooks('beforeCopy',rangedData,this.copyableRanges);if(allowCopying){var textPlain=_SheetClip.default.stringify(rangedData);if(event&&event.clipboardData){var textHTML=(0,_utils.arrayToTable)(rangedData);event.clipboardData.setData('text/plain',textPlain);event.clipboardData.setData('text/html',textHTML);}else if(typeof ClipboardEvent==='undefined'){window.clipboardData.setData('Text',textPlain);}
this.hot.runHooks('afterCopy',rangedData,this.copyableRanges);}
event.preventDefault();}},{key:"onCut",value:function onCut(event){var priv=privatePool.get(this);if(!this.hot.isListening()&&!priv.isTriggeredByCut||this.isEditorOpened()){return;}
this.setCopyableText();priv.isTriggeredByCut=false;var rangedData=this.getRangedData(this.copyableRanges);var allowCuttingOut=!!this.hot.runHooks('beforeCut',rangedData,this.copyableRanges);if(allowCuttingOut){var textPlain=_SheetClip.default.stringify(rangedData);if(event&&event.clipboardData){var textHTML=(0,_utils.arrayToTable)(rangedData);event.clipboardData.setData('text/plain',textPlain);event.clipboardData.setData('text/html',textHTML);}else if(typeof ClipboardEvent==='undefined'){window.clipboardData.setData('Text',textPlain);}
this.hot.emptySelectedCells();this.hot.runHooks('afterCut',rangedData,this.copyableRanges);}
event.preventDefault();}},{key:"onPaste",value:function onPaste(event){if(!this.hot.isListening()||this.isEditorOpened()){return;}
if(event&&event.preventDefault){event.preventDefault();}
var pastedData;if(event&&typeof event.clipboardData!=='undefined'){var textHTML=event.clipboardData.getData('text/html');if(textHTML&&/(<table)|(<TABLE)/.test(textHTML)){pastedData=(0,_utils.tableToArray)(textHTML);}else{pastedData=event.clipboardData.getData('text/plain');}}else if(typeof ClipboardEvent==='undefined'&&typeof window.clipboardData!=='undefined'){pastedData=window.clipboardData.getData('Text');}
var inputArray=typeof pastedData!=='string'?pastedData:_SheetClip.default.parse(pastedData);if(inputArray.length===0){return;}
if(this.hot.runHooks('beforePaste',inputArray,this.copyableRanges)===false){return;}
var _this$populateValues=this.populateValues(inputArray),_this$populateValues2=_slicedToArray(_this$populateValues,4),startRow=_this$populateValues2[0],startColumn=_this$populateValues2[1],endRow=_this$populateValues2[2],endColumn=_this$populateValues2[3];this.hot.selectCell(startRow,startColumn,Math.min(this.hot.countRows()-1,endRow),Math.min(this.hot.countCols()-1,endColumn));this.hot.runHooks('afterPaste',inputArray,this.copyableRanges);}},{key:"onAfterContextMenuDefaultOptions",value:function onAfterContextMenuDefaultOptions(options){options.items.push({name:'---------'},(0,_copy.default)(this),(0,_cut.default)(this));}},{key:"onAfterOnCellMouseUp",value:function onAfterOnCellMouseUp(){if(!this.hot.isListening()||this.isEditorOpened()){return;}
this.getOrCreateFocusableElement();this.focusableElement.focus();}},{key:"onAfterSelectionEnd",value:function onAfterSelectionEnd(){var _privatePool$get=privatePool.get(this),isFragmentSelectionEnabled=_privatePool$get.isFragmentSelectionEnabled;if(this.isEditorOpened()){return;}
this.getOrCreateFocusableElement();if(isFragmentSelectionEnabled&&this.focusableElement.getFocusableElement()!==document.activeElement&&(0,_element.getSelectionText)()){return;}
this.setCopyableText();this.focusableElement.focus();}},{key:"onBeforeKeyDown",value:function onBeforeKeyDown(){if(!this.hot.isListening()||this.isEditorOpened()){return;}
var activeElement=document.activeElement;var activeEditor=this.hot.getActiveEditor();if(!activeEditor||activeElement!==this.focusableElement.getFocusableElement()&&activeElement!==activeEditor.select){return;}
this.getOrCreateFocusableElement();this.focusableElement.focus();}},{key:"destroy",value:function destroy(){if(this.focusableElement){(0,_focusableElement.destroyElement)(this.focusableElement);this.focusableElement=null;}
_get(_getPrototypeOf(CopyPaste.prototype),"destroy",this).call(this);}}]);return CopyPaste;}(_base.default);(0,_plugins.registerPlugin)('CopyPaste',CopyPaste);var _default=CopyPaste;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=copyItem;var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function copyItem(copyPastePlugin){return{key:'copy',name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_COPY);},callback:function callback(){copyPastePlugin.copy();},disabled:function disabled(){var selected=this.getSelected();if(!selected||selected.length>1){return true;}
return false;},hidden:false};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=cutItem;var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function cutItem(copyPastePlugin){return{key:'cut',name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_CUT);},callback:function callback(){copyPastePlugin.cut();},disabled:function disabled(){var selected=this.getSelected();if(!selected||selected.length>1){return true;}
return false;},hidden:false};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _clipboardData=_interopRequireDefault(__webpack_require__(707));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var PasteEvent=function PasteEvent(){_classCallCheck(this,PasteEvent);this.clipboardData=new _clipboardData.default();};exports.default=PasteEvent;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var ClipboardData=function(){function ClipboardData(){_classCallCheck(this,ClipboardData);this.data={};}
_createClass(ClipboardData,[{key:"setData",value:function setData(type,value){this.data[type]=value;}},{key:"getData",value:function getData(type){return this.data[type]||void 0;}}]);return ClipboardData;}();exports.default=ClipboardData;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.createElement=createElement;exports.deactivateElement=deactivateElement;exports.destroyElement=destroyElement;var _eventManager=_interopRequireDefault(__webpack_require__(10));var _localHooks=_interopRequireDefault(__webpack_require__(68));var _object=__webpack_require__(2);var _browser=__webpack_require__(42);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var FocusableWrapper=function(){function FocusableWrapper(){_classCallCheck(this,FocusableWrapper);this.mainElement=null;this.eventManager=new _eventManager.default(this);this.listenersCount=new WeakSet();}
_createClass(FocusableWrapper,[{key:"useSecondaryElement",value:function useSecondaryElement(){var el=createOrGetSecondaryElement();if(!this.listenersCount.has(el)){this.listenersCount.add(el);forwardEventsToLocalHooks(this.eventManager,el,this);}
this.mainElement=el;}},{key:"setFocusableElement",value:function setFocusableElement(element){if(!this.listenersCount.has(element)){this.listenersCount.add(element);forwardEventsToLocalHooks(this.eventManager,element,this);}
this.mainElement=element;}},{key:"getFocusableElement",value:function getFocusableElement(){return this.mainElement;}},{key:"focus",value:function focus(){this.mainElement.value=' ';if(!(0,_browser.isMobileBrowser)()){this.mainElement.select();}}}]);return FocusableWrapper;}();(0,_object.mixin)(FocusableWrapper,_localHooks.default);var refCounter=0;function createElement(){var focusableWrapper=new FocusableWrapper();refCounter+=1;return focusableWrapper;}
function deactivateElement(wrapper){wrapper.eventManager.clear();}
var runLocalHooks=function runLocalHooks(eventName,subject){return function(event){return subject.runLocalHooks(eventName,event);};};function forwardEventsToLocalHooks(eventManager,element,subject){eventManager.addEventListener(element,'copy',runLocalHooks('copy',subject));eventManager.addEventListener(element,'cut',runLocalHooks('cut',subject));eventManager.addEventListener(element,'paste',runLocalHooks('paste',subject));}
var secondaryElement;function createOrGetSecondaryElement(){if(secondaryElement){if(!secondaryElement.parentElement){document.body.appendChild(secondaryElement);}
return secondaryElement;}
var element=document.createElement('textarea');secondaryElement=element;element.id='HandsontableCopyPaste';element.className='copyPaste';element.tabIndex=-1;element.autocomplete='off';element.wrap='hard';element.value=' ';document.body.appendChild(element);return element;}
function destroyElement(wrapper){if(!(wrapper instanceof FocusableWrapper)){return;}
if(refCounter>0){refCounter-=1;}
deactivateElement(wrapper);if(refCounter<=0){refCounter=0;if(secondaryElement&&secondaryElement.parentNode){secondaryElement.parentNode.removeChild(secondaryElement);secondaryElement=null;}
wrapper.mainElement=null;}}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.arrayToTable=arrayToTable;exports.tableToArray=tableToArray;var _mixed=__webpack_require__(14);function arrayToTable(input){var inputLen=input.length;var result=['<table>'];var tempElement=document.createElement('div');document.documentElement.appendChild(tempElement);for(var row=0;row<inputLen;row+=1){var rowData=input[row];var columnsLen=rowData.length;var columnsResult=[];if(row===0){result.push('<tbody>');}
for(var column=0;column<columnsLen;column+=1){tempElement.innerText="".concat((0,_mixed.isEmpty)(rowData[column])?'':rowData[column]);columnsResult.push("<td>".concat(tempElement.innerHTML,"</td>"));}
result.push.apply(result,['<tr>'].concat(columnsResult,['</tr>']));if(row+1===inputLen){result.push('</tbody>');}}
document.documentElement.removeChild(tempElement);result.push('</table>');return result.join('');}
function isHTMLTable(element){return(element&&element.nodeName||'').toLowerCase()==='table';}
function tableToArray(element){var result=[];var checkElement=element;if(typeof checkElement==='string'){var tempElem=document.createElement('div');tempElem.innerHTML=checkElement.replace(/\n/g,'');checkElement=tempElem.querySelector('table');}
if(checkElement&&isHTMLTable(checkElement)){var rows=checkElement.rows;var rowsLen=rows&&rows.length;var tempArray=[];for(var row=0;row<rowsLen;row+=1){var cells=rows[row].cells;var cellsLen=cells.length;var newRow=[];for(var column=0;column<cellsLen;column+=1){var cell=cells[column];cell.innerHTML=cell.innerHTML.trim().replace(/<br(.|)>(\n?)/,'\n');var cellText=cell.innerText;newRow.push(cellText);}
tempArray.push(newRow);}
result.push.apply(result,tempArray);}
return result;}}),(function(module,exports){}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _plugins=__webpack_require__(13);var _object=__webpack_require__(2);var _number=__webpack_require__(9);var _array=__webpack_require__(3);var _src=__webpack_require__(8);var C=_interopRequireWildcard(__webpack_require__(11));var _contextMenuItem=__webpack_require__(712);var _utils=__webpack_require__(69);var _selection=__webpack_require__(429);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var CustomBorders=function(_BasePlugin){_inherits(CustomBorders,_BasePlugin);function CustomBorders(hotInstance){var _this;_classCallCheck(this,CustomBorders);_this=_possibleConstructorReturn(this,_getPrototypeOf(CustomBorders).call(this,hotInstance));_this.savedBorders=[];return _this;}
_createClass(CustomBorders,[{key:"isEnabled",value:function isEnabled(){return!!this.hot.getSettings().customBorders;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.addHook('afterContextMenuDefaultOptions',function(options){return _this2.onAfterContextMenuDefaultOptions(options);});this.addHook('afterInit',function(){return _this2.onAfterInit();});_get(_getPrototypeOf(CustomBorders.prototype),"enablePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){this.hideBorders();_get(_getPrototypeOf(CustomBorders.prototype),"disablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();this.changeBorderSettings();_get(_getPrototypeOf(CustomBorders.prototype),"updatePlugin",this).call(this);}},{key:"setBorders",value:function setBorders(selectionRanges,borderObject){var _this3=this;var defaultBorderKeys=['top','right','bottom','left'];var borderKeys=borderObject?Object.keys(borderObject):defaultBorderKeys;var selectionType=(0,_selection.detectSelectionType)(selectionRanges);var selectionSchemaNormalizer=(0,_selection.normalizeSelectionFactory)(selectionType);(0,_array.arrayEach)(selectionRanges,function(selection){var _selectionSchemaNorma=selectionSchemaNormalizer(selection),_selectionSchemaNorma2=_slicedToArray(_selectionSchemaNorma,4),rowStart=_selectionSchemaNorma2[0],columnStart=_selectionSchemaNorma2[1],rowEnd=_selectionSchemaNorma2[2],columnEnd=_selectionSchemaNorma2[3];var _loop=function _loop(row){var _loop2=function _loop2(col){(0,_array.arrayEach)(borderKeys,function(borderKey){_this3.prepareBorderFromCustomAdded(row,col,borderObject,borderKey);});};for(var col=columnStart;col<=columnEnd;col+=1){_loop2(col);}};for(var row=rowStart;row<=rowEnd;row+=1){_loop(row);}});}},{key:"getBorders",value:function getBorders(selectionRanges){var _this4=this;if(!Array.isArray(selectionRanges)){return this.savedBorders;}
var selectionType=(0,_selection.detectSelectionType)(selectionRanges);var selectionSchemaNormalizer=(0,_selection.normalizeSelectionFactory)(selectionType);var selectedBorders=[];(0,_array.arrayEach)(selectionRanges,function(selection){var _selectionSchemaNorma3=selectionSchemaNormalizer(selection),_selectionSchemaNorma4=_slicedToArray(_selectionSchemaNorma3,4),rowStart=_selectionSchemaNorma4[0],columnStart=_selectionSchemaNorma4[1],rowEnd=_selectionSchemaNorma4[2],columnEnd=_selectionSchemaNorma4[3];var _loop3=function _loop3(row){var _loop4=function _loop4(col){(0,_array.arrayEach)(_this4.savedBorders,function(border){if(border.row===row&&border.col===col){selectedBorders.push(border);}});};for(var col=columnStart;col<=columnEnd;col+=1){_loop4(col);}};for(var row=rowStart;row<=rowEnd;row+=1){_loop3(row);}});return selectedBorders;}},{key:"clearBorders",value:function clearBorders(selectionRanges){var _this5=this;if(selectionRanges){this.setBorders(selectionRanges);}else{(0,_array.arrayEach)(this.savedBorders,function(border){_this5.clearBordersFromSelectionSettings(border.id);_this5.clearNullCellRange();_this5.hot.removeCellMeta(border.row,border.col,'borders');});this.savedBorders.length=0;}}},{key:"insertBorderIntoSettings",value:function insertBorderIntoSettings(border,place){var hasSavedBorders=this.checkSavedBorders(border);if(!hasSavedBorders){this.savedBorders.push(border);}
var coordinates={row:border.row,col:border.col};var cellRange=new _src.CellRange(coordinates,coordinates,coordinates);var hasCustomSelections=this.checkCustomSelections(border,cellRange,place);if(!hasCustomSelections){this.hot.selection.highlight.addCustomSelection({border:border,cellRange:cellRange});this.hot.view.wt.draw(true);}}},{key:"prepareBorderFromCustomAdded",value:function prepareBorderFromCustomAdded(row,column,borderDescriptor,place){var border=(0,_utils.createEmptyBorders)(row,column);if(borderDescriptor){border=(0,_utils.extendDefaultBorder)(border,borderDescriptor);(0,_array.arrayEach)(this.hot.selection.highlight.customSelections,function(customSelection){if(border.id===customSelection.settings.id){Object.assign(customSelection.settings,borderDescriptor);border=customSelection.settings;return false;}});}
this.hot.setCellMeta(row,column,'borders',border);this.insertBorderIntoSettings(border,place);}},{key:"prepareBorderFromCustomAddedRange",value:function prepareBorderFromCustomAddedRange(rowDecriptor){var _this6=this;var range=rowDecriptor.range;(0,_number.rangeEach)(range.from.row,range.to.row,function(rowIndex){(0,_number.rangeEach)(range.from.col,range.to.col,function(colIndex){var border=(0,_utils.createEmptyBorders)(rowIndex,colIndex);var add=0;if(rowIndex===range.from.row){add+=1;if((0,_object.hasOwnProperty)(rowDecriptor,'top')){border.top=rowDecriptor.top;}}
if(rowIndex===range.to.row){add+=1;if((0,_object.hasOwnProperty)(rowDecriptor,'bottom')){border.bottom=rowDecriptor.bottom;}}
if(colIndex===range.from.col){add+=1;if((0,_object.hasOwnProperty)(rowDecriptor,'left')){border.left=rowDecriptor.left;}}
if(colIndex===range.to.col){add+=1;if((0,_object.hasOwnProperty)(rowDecriptor,'right')){border.right=rowDecriptor.right;}}
if(add>0){_this6.hot.setCellMeta(rowIndex,colIndex,'borders',border);_this6.insertBorderIntoSettings(border);}});});}},{key:"removeAllBorders",value:function removeAllBorders(row,column){var borderId=(0,_utils.createId)(row,column);this.spliceBorder(borderId);this.clearBordersFromSelectionSettings(borderId);this.clearNullCellRange();this.hot.removeCellMeta(row,column,'borders');}},{key:"setBorder",value:function setBorder(row,column,place,remove){var bordersMeta=this.hot.getCellMeta(row,column).borders;if(!bordersMeta||bordersMeta.border===void 0){bordersMeta=(0,_utils.createEmptyBorders)(row,column);}
if(remove){bordersMeta[place]=(0,_utils.createSingleEmptyBorder)();var hideCount=this.countHide(bordersMeta);if(hideCount===4){this.removeAllBorders(row,column);}else{var customSelectionsChecker=this.checkCustomSelectionsFromContextMenu(bordersMeta,place,remove);if(!customSelectionsChecker){this.insertBorderIntoSettings(bordersMeta);}
this.hot.setCellMeta(row,column,'borders',bordersMeta);}}else{bordersMeta[place]=(0,_utils.createDefaultCustomBorder)();var _customSelectionsChecker=this.checkCustomSelectionsFromContextMenu(bordersMeta,place,remove);if(!_customSelectionsChecker){this.insertBorderIntoSettings(bordersMeta);}
this.hot.setCellMeta(row,column,'borders',bordersMeta);}}},{key:"prepareBorder",value:function prepareBorder(selected,place,remove){var _this7=this;(0,_array.arrayEach)(selected,function(_ref){var start=_ref.start,end=_ref.end;if(start.row===end.row&&start.col===end.col){if(place==='noBorders'){_this7.removeAllBorders(start.row,start.col);}else{_this7.setBorder(start.row,start.col,place,remove);}}else{switch(place){case'noBorders':(0,_number.rangeEach)(start.col,end.col,function(colIndex){(0,_number.rangeEach)(start.row,end.row,function(rowIndex){_this7.removeAllBorders(rowIndex,colIndex);});});break;case'top':(0,_number.rangeEach)(start.col,end.col,function(topCol){_this7.setBorder(start.row,topCol,place,remove);});break;case'right':(0,_number.rangeEach)(start.row,end.row,function(rowRight){_this7.setBorder(rowRight,end.col,place,remove);});break;case'bottom':(0,_number.rangeEach)(start.col,end.col,function(bottomCol){_this7.setBorder(end.row,bottomCol,place,remove);});break;case'left':(0,_number.rangeEach)(start.row,end.row,function(rowLeft){_this7.setBorder(rowLeft,start.col,place,remove);});break;default:break;}}});}},{key:"createCustomBorders",value:function createCustomBorders(customBorders){var _this8=this;(0,_array.arrayEach)(customBorders,function(customBorder){if(customBorder.range){_this8.prepareBorderFromCustomAddedRange(customBorder);}else{_this8.prepareBorderFromCustomAdded(customBorder.row,customBorder.col,customBorder);}});}},{key:"countHide",value:function countHide(border){var values=Object.values(border);return(0,_array.arrayReduce)(values,function(accumulator,value){var result=accumulator;if(value.hide){result+=1;}
return result;},0);}},{key:"clearBordersFromSelectionSettings",value:function clearBordersFromSelectionSettings(borderId){var index=(0,_array.arrayMap)(this.hot.selection.highlight.customSelections,function(customSelection){return customSelection.settings.id;}).indexOf(borderId);if(index>-1){this.hot.selection.highlight.customSelections[index].clear();}
this.hot.view.wt.draw(true);}},{key:"clearNullCellRange",value:function clearNullCellRange(){var _this9=this;(0,_array.arrayEach)(this.hot.selection.highlight.customSelections,function(customSelection,index){if(customSelection.cellRange===null){_this9.hot.selection.highlight.customSelections.splice(index,1);return false;}});}},{key:"hideBorders",value:function hideBorders(){var _this10=this;(0,_array.arrayEach)(this.savedBorders,function(border){_this10.clearBordersFromSelectionSettings(border.id);});}},{key:"spliceBorder",value:function spliceBorder(borderId){var index=(0,_array.arrayMap)(this.savedBorders,function(border){return border.id;}).indexOf(borderId);if(index>-1){this.savedBorders.splice(index,1);}}},{key:"checkSavedBorders",value:function checkSavedBorders(border){var _this11=this;var check=false;var hideCount=this.countHide(border);if(hideCount===4){this.spliceBorder(border.id);check=true;}else{(0,_array.arrayEach)(this.savedBorders,function(savedBorder,index){if(border.id===savedBorder.id){_this11.savedBorders[index]=border;check=true;return false;}});}
return check;}},{key:"checkCustomSelectionsFromContextMenu",value:function checkCustomSelectionsFromContextMenu(border,place,remove){var check=false;(0,_array.arrayEach)(this.hot.selection.highlight.customSelections,function(customSelection){if(border.id===customSelection.settings.id){(0,_object.objectEach)(customSelection.instanceBorders,function(borderObject){borderObject.toggleHiddenClass(place,remove);});check=true;return false;}});return check;}},{key:"checkCustomSelections",value:function checkCustomSelections(border,cellRange,place){var hideCount=this.countHide(border);var check=false;if(hideCount===4){this.removeAllBorders(border.row,border.col);this.clearBordersFromSelectionSettings(border.id);this.clearNullCellRange();check=true;}else{(0,_array.arrayEach)(this.hot.selection.highlight.customSelections,function(customSelection){if(border.id===customSelection.settings.id){customSelection.cellRange=cellRange;if(place){(0,_object.objectEach)(customSelection.instanceBorders,function(borderObject){borderObject.changeBorderStyle(place,border);});}
check=true;return false;}});}
return check;}},{key:"changeBorderSettings",value:function changeBorderSettings(){var customBorders=this.hot.getSettings().customBorders;if(Array.isArray(customBorders)){if(!customBorders.length){this.savedBorders=customBorders;}
this.createCustomBorders(customBorders);}else if(customBorders!==void 0){this.createCustomBorders(this.savedBorders);}}},{key:"onAfterContextMenuDefaultOptions",value:function onAfterContextMenuDefaultOptions(defaultOptions){if(!this.hot.getSettings().customBorders){return;}
defaultOptions.items.push({name:'---------'},{key:'borders',name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_BORDERS);},disabled:function disabled(){return this.selection.isSelectedByCorner();},submenu:{items:[(0,_contextMenuItem.top)(this),(0,_contextMenuItem.right)(this),(0,_contextMenuItem.bottom)(this),(0,_contextMenuItem.left)(this),(0,_contextMenuItem.noBorders)(this)]}});}},{key:"onAfterInit",value:function onAfterInit(){this.changeBorderSettings();}},{key:"destroy",value:function destroy(){_get(_getPrototypeOf(CustomBorders.prototype),"destroy",this).call(this);}}]);return CustomBorders;}(_base.default);(0,_plugins.registerPlugin)('customBorders',CustomBorders);var _default=CustomBorders;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;var _bottom=_interopRequireDefault(__webpack_require__(713));exports.bottom=_bottom.default;var _left=_interopRequireDefault(__webpack_require__(714));exports.left=_left.default;var _noBorders=_interopRequireDefault(__webpack_require__(715));exports.noBorders=_noBorders.default;var _right=_interopRequireDefault(__webpack_require__(716));exports.right=_right.default;var _top=_interopRequireDefault(__webpack_require__(717));exports.top=_top.default;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=bottom;var C=_interopRequireWildcard(__webpack_require__(11));var _utils=__webpack_require__(69);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function bottom(customBordersPlugin){return{key:'borders:bottom',name:function name(){var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);var hasBorder=(0,_utils.checkSelectionBorders)(this,'bottom');if(hasBorder){label=(0,_utils.markSelected)(label);}
return label;},callback:function callback(key,selected){var hasBorder=(0,_utils.checkSelectionBorders)(this,'bottom');customBordersPlugin.prepareBorder(selected,'bottom',hasBorder);}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=left;var C=_interopRequireWildcard(__webpack_require__(11));var _utils=__webpack_require__(69);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function left(customBordersPlugin){return{key:'borders:left',name:function name(){var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_BORDERS_LEFT);var hasBorder=(0,_utils.checkSelectionBorders)(this,'left');if(hasBorder){label=(0,_utils.markSelected)(label);}
return label;},callback:function callback(key,selected){var hasBorder=(0,_utils.checkSelectionBorders)(this,'left');customBordersPlugin.prepareBorder(selected,'left',hasBorder);}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=noBorders;var C=_interopRequireWildcard(__webpack_require__(11));var _utils=__webpack_require__(69);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function noBorders(customBordersPlugin){return{key:'borders:no_borders',name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_REMOVE_BORDERS);},callback:function callback(key,selected){customBordersPlugin.prepareBorder(selected,'noBorders');},disabled:function disabled(){return!(0,_utils.checkSelectionBorders)(this);}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=right;var C=_interopRequireWildcard(__webpack_require__(11));var _utils=__webpack_require__(69);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function right(customBordersPlugin){return{key:'borders:right',name:function name(){var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_BORDERS_RIGHT);var hasBorder=(0,_utils.checkSelectionBorders)(this,'right');if(hasBorder){label=(0,_utils.markSelected)(label);}
return label;},callback:function callback(key,selected){var hasBorder=(0,_utils.checkSelectionBorders)(this,'right');customBordersPlugin.prepareBorder(selected,'right',hasBorder);}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=top;var C=_interopRequireWildcard(__webpack_require__(11));var _utils=__webpack_require__(69);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function top(customBordersPlugin){return{key:'borders:top',name:function name(){var label=this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_BORDERS_TOP);var hasBorder=(0,_utils.checkSelectionBorders)(this,'top');if(hasBorder){label=(0,_utils.markSelected)(label);}
return label;},callback:function callback(key,selected){var hasBorder=(0,_utils.checkSelectionBorders)(this,'top');customBordersPlugin.prepareBorder(selected,'top',hasBorder);}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _eventManager=_interopRequireDefault(__webpack_require__(10));var _plugins=__webpack_require__(13);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
var DragToScroll=function(_BasePlugin){_inherits(DragToScroll,_BasePlugin);function DragToScroll(hotInstance){var _this;_classCallCheck(this,DragToScroll);_this=_possibleConstructorReturn(this,_getPrototypeOf(DragToScroll).call(this,hotInstance));_this.eventManager=new _eventManager.default(_assertThisInitialized(_assertThisInitialized(_this)));_this.boundaries=null;_this.callback=null;_this.listening=false;return _this;}
_createClass(DragToScroll,[{key:"isEnabled",value:function isEnabled(){return!!this.hot.getSettings().dragToScroll;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.addHook('afterOnCellMouseDown',function(){return _this2.setupListening();});this.addHook('afterOnCellCornerMouseDown',function(){return _this2.setupListening();});this.registerEvents();_get(_getPrototypeOf(DragToScroll.prototype),"enablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();_get(_getPrototypeOf(DragToScroll.prototype),"updatePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){this.unregisterEvents();_get(_getPrototypeOf(DragToScroll.prototype),"disablePlugin",this).call(this);}},{key:"setBoundaries",value:function setBoundaries(boundaries){this.boundaries=boundaries;}},{key:"setCallback",value:function setCallback(callback){this.callback=callback;}},{key:"check",value:function check(x,y){var diffX=0;var diffY=0;if(y<this.boundaries.top){diffY=y-this.boundaries.top;}else if(y>this.boundaries.bottom){diffY=y-this.boundaries.bottom;}
if(x<this.boundaries.left){diffX=x-this.boundaries.left;}else if(x>this.boundaries.right){diffX=x-this.boundaries.right;}
this.callback(diffX,diffY);}},{key:"registerEvents",value:function registerEvents(){var _this3=this;this.eventManager.addEventListener(document,'mouseup',function(){return _this3.onMouseUp();});this.eventManager.addEventListener(document,'mousemove',function(event){return _this3.onMouseMove(event);});}},{key:"unregisterEvents",value:function unregisterEvents(){this.eventManager.clear();}},{key:"setupListening",value:function setupListening(){var scrollHandler=this.hot.view.wt.wtTable.holder;if(scrollHandler===window){return;}
this.setBoundaries(scrollHandler.getBoundingClientRect());this.setCallback(function(scrollX,scrollY){if(scrollX<0){scrollHandler.scrollLeft-=50;}else if(scrollX>0){scrollHandler.scrollLeft+=50;}
if(scrollY<0){scrollHandler.scrollTop-=20;}else if(scrollY>0){scrollHandler.scrollTop+=20;}});this.listening=true;}},{key:"onMouseMove",value:function onMouseMove(event){if(this.listening){this.check(event.clientX,event.clientY);}}},{key:"onMouseUp",value:function onMouseUp(){this.listening=false;}},{key:"destroy",value:function destroy(){_get(_getPrototypeOf(DragToScroll.prototype),"destroy",this).call(this);}}]);return DragToScroll;}(_base.default);(0,_plugins.registerPlugin)('dragToScroll',DragToScroll);var _default=DragToScroll;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _plugins=__webpack_require__(13);var _array=__webpack_require__(3);var _freezeColumn=_interopRequireDefault(__webpack_require__(720));var _unfreezeColumn=_interopRequireDefault(__webpack_require__(721));__webpack_require__(722);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
var privatePool=new WeakMap();var ManualColumnFreeze=function(_BasePlugin){_inherits(ManualColumnFreeze,_BasePlugin);function ManualColumnFreeze(hotInstance){var _this;_classCallCheck(this,ManualColumnFreeze);_this=_possibleConstructorReturn(this,_getPrototypeOf(ManualColumnFreeze).call(this,hotInstance));privatePool.set(_assertThisInitialized(_assertThisInitialized(_this)),{moveByFreeze:false,afterFirstUse:false});_this.frozenColumnsBasePositions=[];_this.manualColumnMovePlugin=void 0;return _this;}
_createClass(ManualColumnFreeze,[{key:"isEnabled",value:function isEnabled(){return!!this.hot.getSettings().manualColumnFreeze;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.addHook('afterContextMenuDefaultOptions',function(options){return _this2.addContextMenuEntry(options);});this.addHook('afterInit',function(){return _this2.onAfterInit();});this.addHook('beforeColumnMove',function(rows,target){return _this2.onBeforeColumnMove(rows,target);});_get(_getPrototypeOf(ManualColumnFreeze.prototype),"enablePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){var priv=privatePool.get(this);priv.afterFirstUse=false;priv.moveByFreeze=false;_get(_getPrototypeOf(ManualColumnFreeze.prototype),"disablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();_get(_getPrototypeOf(ManualColumnFreeze.prototype),"updatePlugin",this).call(this);}},{key:"freezeColumn",value:function freezeColumn(column){var priv=privatePool.get(this);var settings=this.hot.getSettings();if(!priv.afterFirstUse){priv.afterFirstUse=true;}
if(settings.fixedColumnsLeft===this.hot.countCols()||column<=settings.fixedColumnsLeft-1){return;}
priv.moveByFreeze=true;if(column!==this.getMovePlugin().columnsMapper.getValueByIndex(column)){this.frozenColumnsBasePositions[settings.fixedColumnsLeft]=column;}
this.getMovePlugin().moveColumn(column,settings.fixedColumnsLeft);settings.fixedColumnsLeft+=1;}},{key:"unfreezeColumn",value:function unfreezeColumn(column){var priv=privatePool.get(this);var settings=this.hot.getSettings();if(!priv.afterFirstUse){priv.afterFirstUse=true;}
if(settings.fixedColumnsLeft<=0||column>settings.fixedColumnsLeft-1){return;}
var returnCol=this.getBestColumnReturnPosition(column);priv.moveByFreeze=true;settings.fixedColumnsLeft-=1;this.getMovePlugin().moveColumn(column,returnCol+1);}},{key:"getMovePlugin",value:function getMovePlugin(){if(!this.manualColumnMovePlugin){this.manualColumnMovePlugin=this.hot.getPlugin('manualColumnMove');}
return this.manualColumnMovePlugin;}},{key:"getBestColumnReturnPosition",value:function getBestColumnReturnPosition(column){var movePlugin=this.getMovePlugin();var settings=this.hot.getSettings();var i=settings.fixedColumnsLeft;var j=movePlugin.columnsMapper.getValueByIndex(i);var initialCol;if(this.frozenColumnsBasePositions[column]===null||this.frozenColumnsBasePositions[column]===void 0){initialCol=movePlugin.columnsMapper.getValueByIndex(column);while(j!==null&&j<=initialCol){i+=1;j=movePlugin.columnsMapper.getValueByIndex(i);}}else{initialCol=this.frozenColumnsBasePositions[column];this.frozenColumnsBasePositions[column]=void 0;while(j!==null&&j<=initialCol){i+=1;j=movePlugin.columnsMapper.getValueByIndex(i);}
i=j;}
return i-1;}},{key:"addContextMenuEntry",value:function addContextMenuEntry(options){options.items.push({name:'---------'},(0,_freezeColumn.default)(this),(0,_unfreezeColumn.default)(this));}},{key:"onAfterInit",value:function onAfterInit(){if(!this.getMovePlugin().isEnabled()){this.getMovePlugin().enablePlugin();}}},{key:"onBeforeColumnMove",value:function onBeforeColumnMove(rows,target){var priv=privatePool.get(this);if(priv.afterFirstUse&&!priv.moveByFreeze){var frozenLen=this.hot.getSettings().fixedColumnsLeft;var disallowMoving=target<frozenLen;if(!disallowMoving){(0,_array.arrayEach)(rows,function(value){if(value<frozenLen){disallowMoving=true;return false;}});}
if(disallowMoving){return false;}}
if(priv.moveByFreeze){priv.moveByFreeze=false;}}},{key:"destroy",value:function destroy(){_get(_getPrototypeOf(ManualColumnFreeze.prototype),"destroy",this).call(this);}}]);return ManualColumnFreeze;}(_base.default);(0,_plugins.registerPlugin)('manualColumnFreeze',ManualColumnFreeze);var _default=ManualColumnFreeze;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=freezeColumnItem;var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function freezeColumnItem(manualColumnFreezePlugin){return{key:'freeze_column',name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_FREEZE_COLUMN);},callback:function callback(key,selected){var _selected=_slicedToArray(selected,1),selectedColumn=_selected[0].start.col;manualColumnFreezePlugin.freezeColumn(selectedColumn);this.render();this.view.wt.wtOverlays.adjustElementsSize(true);},hidden:function hidden(){var selection=this.getSelectedRange();var hide=false;if(selection===void 0){hide=true;}else if(selection.length>1){hide=true;}else if(selection[0].from.col!==selection[0].to.col||selection[0].from.col<=this.getSettings().fixedColumnsLeft-1){hide=true;}
return hide;}};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=unfreezeColumnItem;var C=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function unfreezeColumnItem(manualColumnFreezePlugin){return{key:'unfreeze_column',name:function name(){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN);},callback:function callback(key,selected){var _selected=_slicedToArray(selected,1),selectedColumn=_selected[0].start.col;manualColumnFreezePlugin.unfreezeColumn(selectedColumn);this.render();this.view.wt.wtOverlays.adjustElementsSize(true);},hidden:function hidden(){var selection=this.getSelectedRange();var hide=false;if(selection===void 0){hide=true;}else if(selection.length>1){hide=true;}else if(selection[0].from.col!==selection[0].to.col||selection[0].from.col>=this.getSettings().fixedColumnsLeft){hide=true;}
return hide;}};}}),(function(module,exports){}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _array=__webpack_require__(3);var _element=__webpack_require__(1);var _number=__webpack_require__(9);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _plugins=__webpack_require__(13);var _columnsMapper=_interopRequireDefault(__webpack_require__(724));var _backlight=_interopRequireDefault(__webpack_require__(725));var _guideline=_interopRequireDefault(__webpack_require__(726));__webpack_require__(727);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
_pluginHooks.default.getSingleton().register('beforeColumnMove');_pluginHooks.default.getSingleton().register('afterColumnMove');_pluginHooks.default.getSingleton().register('unmodifyCol');var privatePool=new WeakMap();var CSS_PLUGIN='ht__manualColumnMove';var CSS_SHOW_UI='show-ui';var CSS_ON_MOVING='on-moving--columns';var CSS_AFTER_SELECTION='after-selection--columns';var ManualColumnMove=function(_BasePlugin){_inherits(ManualColumnMove,_BasePlugin);function ManualColumnMove(hotInstance){var _this;_classCallCheck(this,ManualColumnMove);_this=_possibleConstructorReturn(this,_getPrototypeOf(ManualColumnMove).call(this,hotInstance));privatePool.set(_assertThisInitialized(_assertThisInitialized(_this)),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}});_this.removedColumns=[];_this.columnsMapper=new _columnsMapper.default(_assertThisInitialized(_assertThisInitialized(_this)));_this.eventManager=new _eventManager.default(_assertThisInitialized(_assertThisInitialized(_this)));_this.backlight=new _backlight.default(hotInstance);_this.guideline=new _guideline.default(hotInstance);return _this;}
_createClass(ManualColumnMove,[{key:"isEnabled",value:function isEnabled(){return!!this.hot.getSettings().manualColumnMove;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.addHook('beforeOnCellMouseDown',function(event,coords,TD,blockCalculations){return _this2.onBeforeOnCellMouseDown(event,coords,TD,blockCalculations);});this.addHook('beforeOnCellMouseOver',function(event,coords,TD,blockCalculations){return _this2.onBeforeOnCellMouseOver(event,coords,TD,blockCalculations);});this.addHook('afterScrollVertically',function(){return _this2.onAfterScrollVertically();});this.addHook('modifyCol',function(row,source){return _this2.onModifyCol(row,source);});this.addHook('beforeRemoveCol',function(index,amount){return _this2.onBeforeRemoveCol(index,amount);});this.addHook('afterRemoveCol',function(){return _this2.onAfterRemoveCol();});this.addHook('afterCreateCol',function(index,amount){return _this2.onAfterCreateCol(index,amount);});this.addHook('afterLoadData',function(){return _this2.onAfterLoadData();});this.addHook('unmodifyCol',function(column){return _this2.onUnmodifyCol(column);});this.registerEvents();(0,_element.addClass)(this.hot.rootElement,CSS_PLUGIN);_get(_getPrototypeOf(ManualColumnMove.prototype),"enablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();_get(_getPrototypeOf(ManualColumnMove.prototype),"updatePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){var pluginSettings=this.hot.getSettings().manualColumnMove;if(Array.isArray(pluginSettings)){this.columnsMapper.clearMap();}
(0,_element.removeClass)(this.hot.rootElement,CSS_PLUGIN);this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();_get(_getPrototypeOf(ManualColumnMove.prototype),"disablePlugin",this).call(this);}},{key:"moveColumn",value:function moveColumn(column,target){this.moveColumns([column],target);}},{key:"moveColumns",value:function moveColumns(columns,target){var _this3=this;var visualColumns=_toConsumableArray(columns);var priv=privatePool.get(this);var beforeColumnHook=this.hot.runHooks('beforeColumnMove',visualColumns,target);priv.disallowMoving=!beforeColumnHook;if(beforeColumnHook!==false){(0,_array.arrayEach)(columns,function(column,index,array){array[index]=_this3.columnsMapper.getValueByIndex(column);});(0,_array.arrayEach)(columns,function(column,index){var actualPosition=_this3.columnsMapper.getIndexByValue(column);if(actualPosition!==target){_this3.columnsMapper.moveColumn(actualPosition,target+index);}});this.columnsMapper.clearNull();}
this.hot.runHooks('afterColumnMove',visualColumns,target);}},{key:"changeSelection",value:function changeSelection(startColumn,endColumn){this.hot.selectColumns(startColumn,endColumn);}},{key:"getColumnsWidth",value:function getColumnsWidth(from,to){var width=0;for(var i=from;i<to;i++){var columnWidth=0;if(i<0){columnWidth=this.hot.view.wt.wtViewport.getRowHeaderWidth()||0;}else{columnWidth=this.hot.view.wt.wtTable.getStretchedColumnWidth(i)||0;}
width+=columnWidth;}
return width;}},{key:"initialSettings",value:function initialSettings(){var pluginSettings=this.hot.getSettings().manualColumnMove;if(Array.isArray(pluginSettings)){this.moveColumns(pluginSettings,0);}else if(pluginSettings!==void 0){this.persistentStateLoad();}}},{key:"isFixedColumnsLeft",value:function isFixedColumnsLeft(column){return column<this.hot.getSettings().fixedColumnsLeft;}},{key:"persistentStateSave",value:function persistentStateSave(){this.hot.runHooks('persistentStateSave','manualColumnMove',this.columnsMapper._arrayMap);}},{key:"persistentStateLoad",value:function persistentStateLoad(){var storedState={};this.hot.runHooks('persistentStateLoad','manualColumnMove',storedState);if(storedState.value){this.columnsMapper._arrayMap=storedState.value;}}},{key:"prepareColumnsToMoving",value:function prepareColumnsToMoving(start,end){var selectedColumns=[];(0,_number.rangeEach)(start,end,function(i){selectedColumns.push(i);});return selectedColumns;}},{key:"refreshPositions",value:function refreshPositions(){var priv=privatePool.get(this);var firstVisible=this.hot.view.wt.wtTable.getFirstVisibleColumn();var lastVisible=this.hot.view.wt.wtTable.getLastVisibleColumn();var wtTable=this.hot.view.wt.wtTable;var scrollableElement=this.hot.view.wt.wtOverlays.scrollableElement;var scrollLeft=typeof scrollableElement.scrollX==='number'?scrollableElement.scrollX:scrollableElement.scrollLeft;var tdOffsetLeft=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,priv.coordsColumn);var mouseOffsetLeft=priv.target.eventPageX-(priv.rootElementOffset-(scrollableElement.scrollX===void 0?scrollLeft:0));var hiderWidth=wtTable.hider.offsetWidth;var tbodyOffsetLeft=wtTable.TBODY.offsetLeft;var backlightElemMarginLeft=this.backlight.getOffset().left;var backlightElemWidth=this.backlight.getSize().width;var rowHeaderWidth=0;if(priv.rootElementOffset+wtTable.holder.offsetWidth+scrollLeft<priv.target.eventPageX){if(priv.coordsColumn<priv.countCols){priv.coordsColumn+=1;}}
if(priv.hasRowHeaders){rowHeaderWidth=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth;}
if(this.isFixedColumnsLeft(priv.coordsColumn)){tdOffsetLeft+=scrollLeft;}
tdOffsetLeft+=rowHeaderWidth;if(priv.coordsColumn<0){if(priv.fixedColumns>0){priv.target.col=0;}else{priv.target.col=firstVisible>0?firstVisible-1:firstVisible;}}else if(priv.target.TD.offsetWidth/2+tdOffsetLeft<=mouseOffsetLeft){var newCoordsCol=priv.coordsColumn>=priv.countCols?priv.countCols-1:priv.coordsColumn;priv.target.col=newCoordsCol+1;tdOffsetLeft+=priv.target.TD.offsetWidth;if(priv.target.col>lastVisible&&lastVisible<priv.countCols){this.hot.scrollViewportTo(void 0,lastVisible+1,void 0,true);}}else{priv.target.col=priv.coordsColumn;if(priv.target.col<=firstVisible&&priv.target.col>=priv.fixedColumns&&firstVisible>0){this.hot.scrollViewportTo(void 0,firstVisible-1);}}
if(priv.target.col<=firstVisible&&priv.target.col>=priv.fixedColumns&&firstVisible>0){this.hot.scrollViewportTo(void 0,firstVisible-1);}
var backlightLeft=mouseOffsetLeft;var guidelineLeft=tdOffsetLeft;if(mouseOffsetLeft+backlightElemWidth+backlightElemMarginLeft>=hiderWidth){backlightLeft=hiderWidth-backlightElemWidth-backlightElemMarginLeft;}else if(mouseOffsetLeft+backlightElemMarginLeft<tbodyOffsetLeft+rowHeaderWidth){backlightLeft=tbodyOffsetLeft+rowHeaderWidth+Math.abs(backlightElemMarginLeft);}
if(tdOffsetLeft>=hiderWidth-1){guidelineLeft=hiderWidth-1;}else if(guidelineLeft===0){guidelineLeft=1;}else if(scrollableElement.scrollX!==void 0&&priv.coordsColumn<priv.fixedColumns){guidelineLeft-=priv.rootElementOffset<=scrollableElement.scrollX?priv.rootElementOffset:0;}
this.backlight.setPosition(null,backlightLeft);this.guideline.setPosition(null,guidelineLeft);}},{key:"updateColumnsMapper",value:function updateColumnsMapper(){var countCols=this.hot.countSourceCols();var columnsMapperLen=this.columnsMapper._arrayMap.length;if(columnsMapperLen===0){this.columnsMapper.createMap(countCols||this.hot.getSettings().startCols);}else if(columnsMapperLen<countCols){var diff=countCols-columnsMapperLen;this.columnsMapper.insertItems(columnsMapperLen,diff);}else if(columnsMapperLen>countCols){var maxIndex=countCols-1;var columnsToRemove=[];(0,_array.arrayEach)(this.columnsMapper._arrayMap,function(value,index){if(value>maxIndex){columnsToRemove.push(index);}});this.columnsMapper.removeItems(columnsToRemove);}}},{key:"registerEvents",value:function registerEvents(){var _this4=this;this.eventManager.addEventListener(document.documentElement,'mousemove',function(event){return _this4.onMouseMove(event);});this.eventManager.addEventListener(document.documentElement,'mouseup',function(){return _this4.onMouseUp();});}},{key:"unregisterEvents",value:function unregisterEvents(){this.eventManager.clear();}},{key:"onBeforeOnCellMouseDown",value:function onBeforeOnCellMouseDown(event,coords,TD,blockCalculations){var wtTable=this.hot.view.wt.wtTable;var isHeaderSelection=this.hot.selection.isSelectedByColumnHeader();var selection=this.hot.getSelectedRangeLast();var priv=privatePool.get(this);var isSortingElement=event.realTarget.className.indexOf('sortAction')>-1;if(!selection||!isHeaderSelection||priv.pressed||event.button!==0||isSortingElement){priv.pressed=false;priv.columnsToMove.length=0;(0,_element.removeClass)(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI]);return;}
var guidelineIsNotReady=this.guideline.isBuilt()&&!this.guideline.isAppended();var backlightIsNotReady=this.backlight.isBuilt()&&!this.backlight.isAppended();if(guidelineIsNotReady&&backlightIsNotReady){this.guideline.appendTo(wtTable.hider);this.backlight.appendTo(wtTable.hider);}
var from=selection.from,to=selection.to;var start=Math.min(from.col,to.col);var end=Math.max(from.col,to.col);if(coords.row<0&&coords.col>=start&&coords.col<=end){blockCalculations.column=true;priv.pressed=true;priv.target.eventPageX=event.pageX;priv.coordsColumn=coords.col;priv.target.TD=TD;priv.target.col=coords.col;priv.columnsToMove=this.prepareColumnsToMoving(start,end);priv.hasRowHeaders=!!this.hot.getSettings().rowHeaders;priv.countCols=this.hot.countCols();priv.fixedColumns=this.hot.getSettings().fixedColumnsLeft;priv.rootElementOffset=(0,_element.offset)(this.hot.rootElement).left;var countColumnsFrom=priv.hasRowHeaders?-1:0;var topPos=wtTable.holder.scrollTop+wtTable.getColumnHeaderHeight(0)+1;var fixedColumns=coords.col<priv.fixedColumns;var scrollableElement=this.hot.view.wt.wtOverlays.scrollableElement;var wrapperIsWindow=scrollableElement.scrollX?scrollableElement.scrollX-priv.rootElementOffset:0;var mouseOffset=event.layerX-(fixedColumns?wrapperIsWindow:0);var leftOffset=Math.abs(this.getColumnsWidth(start,coords.col)+mouseOffset);this.backlight.setPosition(topPos,this.getColumnsWidth(countColumnsFrom,start)+leftOffset);this.backlight.setSize(this.getColumnsWidth(start,end+1),wtTable.hider.offsetHeight-topPos);this.backlight.setOffset(null,leftOffset*-1);(0,_element.addClass)(this.hot.rootElement,CSS_ON_MOVING);}else{(0,_element.removeClass)(this.hot.rootElement,CSS_AFTER_SELECTION);priv.pressed=false;priv.columnsToMove.length=0;}}},{key:"onMouseMove",value:function onMouseMove(event){var priv=privatePool.get(this);if(!priv.pressed){return;}
if(event.realTarget===this.backlight.element){var width=this.backlight.getSize().width;this.backlight.setSize(0);setTimeout(function(){this.backlight.setPosition(width);});}
priv.target.eventPageX=event.pageX;this.refreshPositions();}},{key:"onBeforeOnCellMouseOver",value:function onBeforeOnCellMouseOver(event,coords,TD,blockCalculations){var selectedRange=this.hot.getSelectedRangeLast();var priv=privatePool.get(this);if(!selectedRange||!priv.pressed){return;}
if(priv.columnsToMove.indexOf(coords.col)>-1){(0,_element.removeClass)(this.hot.rootElement,CSS_SHOW_UI);}else{(0,_element.addClass)(this.hot.rootElement,CSS_SHOW_UI);}
blockCalculations.row=true;blockCalculations.column=true;blockCalculations.cell=true;priv.coordsColumn=coords.col;priv.target.TD=TD;}},{key:"onMouseUp",value:function onMouseUp(){var priv=privatePool.get(this);priv.coordsColumn=void 0;priv.pressed=false;priv.backlightWidth=0;(0,_element.removeClass)(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI,CSS_AFTER_SELECTION]);if(this.hot.selection.isSelectedByColumnHeader()){(0,_element.addClass)(this.hot.rootElement,CSS_AFTER_SELECTION);}
if(priv.columnsToMove.length<1||priv.target.col===void 0||priv.columnsToMove.indexOf(priv.target.col)>-1){return;}
this.moveColumns(priv.columnsToMove,priv.target.col);this.persistentStateSave();this.hot.render();this.hot.view.wt.wtOverlays.adjustElementsSize(true);if(!priv.disallowMoving){var selectionStart=this.columnsMapper.getIndexByValue(priv.columnsToMove[0]);var selectionEnd=this.columnsMapper.getIndexByValue(priv.columnsToMove[priv.columnsToMove.length-1]);this.changeSelection(selectionStart,selectionEnd);}
priv.columnsToMove.length=0;}},{key:"onAfterScrollVertically",value:function onAfterScrollVertically(){var wtTable=this.hot.view.wt.wtTable;var headerHeight=wtTable.getColumnHeaderHeight(0)+1;var scrollTop=wtTable.holder.scrollTop;var posTop=headerHeight+scrollTop;this.backlight.setPosition(posTop);this.backlight.setSize(null,wtTable.hider.offsetHeight-posTop);}},{key:"onAfterCreateCol",value:function onAfterCreateCol(index,amount){this.columnsMapper.shiftItems(index,amount);}},{key:"onBeforeRemoveCol",value:function onBeforeRemoveCol(index,amount){var _this5=this;this.removedColumns.length=0;if(index!==false){(0,_number.rangeEach)(index,index+amount-1,function(removedIndex){_this5.removedColumns.push(_this5.hot.runHooks('modifyCol',removedIndex,_this5.pluginName));});}}},{key:"onAfterRemoveCol",value:function onAfterRemoveCol(){this.columnsMapper.unshiftItems(this.removedColumns);}},{key:"onAfterLoadData",value:function onAfterLoadData(){this.updateColumnsMapper();}},{key:"onModifyCol",value:function onModifyCol(column,source){var physicalColumn=column;if(source!==this.pluginName){var columnInMapper=this.columnsMapper.getValueByIndex(physicalColumn);physicalColumn=columnInMapper===null?physicalColumn:columnInMapper;}
return physicalColumn;}},{key:"onUnmodifyCol",value:function onUnmodifyCol(column){var indexInMapper=this.columnsMapper.getIndexByValue(column);return indexInMapper===null?column:indexInMapper;}},{key:"onAfterPluginsInitialized",value:function onAfterPluginsInitialized(){this.updateColumnsMapper();this.initialSettings();this.backlight.build();this.guideline.build();}},{key:"destroy",value:function destroy(){this.backlight.destroy();this.guideline.destroy();_get(_getPrototypeOf(ManualColumnMove.prototype),"destroy",this).call(this);}}]);return ManualColumnMove;}(_base.default);(0,_plugins.registerPlugin)('ManualColumnMove',ManualColumnMove);var _default=ManualColumnMove;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _arrayMapper=_interopRequireDefault(__webpack_require__(125));var _array=__webpack_require__(3);var _object=__webpack_require__(2);var _number=__webpack_require__(9);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var ColumnsMapper=function(){function ColumnsMapper(manualColumnMove){_classCallCheck(this,ColumnsMapper);this.manualColumnMove=manualColumnMove;}
_createClass(ColumnsMapper,[{key:"createMap",value:function createMap(length){var _this=this;var originLength=length===void 0?this._arrayMap.length:length;this._arrayMap.length=0;(0,_number.rangeEach)(originLength-1,function(itemIndex){_this._arrayMap[itemIndex]=itemIndex;});}},{key:"destroy",value:function destroy(){this._arrayMap=null;}},{key:"moveColumn",value:function moveColumn(from,to){var indexToMove=this._arrayMap[from];this._arrayMap[from]=null;this._arrayMap.splice(to,0,indexToMove);}},{key:"clearNull",value:function clearNull(){this._arrayMap=(0,_array.arrayFilter)(this._arrayMap,function(i){return i!==null;});}}]);return ColumnsMapper;}();(0,_object.mixin)(ColumnsMapper,_arrayMapper.default);var _default=ColumnsMapper;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(434));var _element=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var CSS_CLASSNAME='ht__manualColumnMove--backlight';var BacklightUI=function(_BaseUI){_inherits(BacklightUI,_BaseUI);function BacklightUI(){_classCallCheck(this,BacklightUI);return _possibleConstructorReturn(this,_getPrototypeOf(BacklightUI).apply(this,arguments));}
_createClass(BacklightUI,[{key:"build",value:function build(){_get(_getPrototypeOf(BacklightUI.prototype),"build",this).call(this);(0,_element.addClass)(this._element,CSS_CLASSNAME);}}]);return BacklightUI;}(_base.default);var _default=BacklightUI;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(434));var _element=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var CSS_CLASSNAME='ht__manualColumnMove--guideline';var GuidelineUI=function(_BaseUI){_inherits(GuidelineUI,_BaseUI);function GuidelineUI(){_classCallCheck(this,GuidelineUI);return _possibleConstructorReturn(this,_getPrototypeOf(GuidelineUI).apply(this,arguments));}
_createClass(GuidelineUI,[{key:"build",value:function build(){_get(_getPrototypeOf(GuidelineUI.prototype),"build",this).call(this);(0,_element.addClass)(this._element,CSS_CLASSNAME);}}]);return GuidelineUI;}(_base.default);var _default=GuidelineUI;exports.default=_default;}),(function(module,exports){}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _element=__webpack_require__(1);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _event=__webpack_require__(18);var _array=__webpack_require__(3);var _number=__webpack_require__(9);var _plugins=__webpack_require__(13);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
var ManualColumnResize=function(_BasePlugin){_inherits(ManualColumnResize,_BasePlugin);function ManualColumnResize(hotInstance){var _this;_classCallCheck(this,ManualColumnResize);_this=_possibleConstructorReturn(this,_getPrototypeOf(ManualColumnResize).call(this,hotInstance));_this.currentTH=null;_this.currentCol=null;_this.selectedCols=[];_this.currentWidth=null;_this.newSize=null;_this.startY=null;_this.startWidth=null;_this.startOffset=null;_this.handle=document.createElement('DIV');_this.guide=document.createElement('DIV');_this.eventManager=new _eventManager.default(_assertThisInitialized(_assertThisInitialized(_this)));_this.pressed=null;_this.dblclick=0;_this.autoresizeTimeout=null;_this.manualColumnWidths=[];(0,_element.addClass)(_this.handle,'manualColumnResizer');(0,_element.addClass)(_this.guide,'manualColumnResizerGuide');return _this;}
_createClass(ManualColumnResize,[{key:"isEnabled",value:function isEnabled(){return this.hot.getSettings().manualColumnResize;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.manualColumnWidths=[];var initialColumnWidth=this.hot.getSettings().manualColumnResize;var loadedManualColumnWidths=this.loadManualColumnWidths();this.addHook('modifyColWidth',function(width,col){return _this2.onModifyColWidth(width,col);});this.addHook('beforeStretchingColumnWidth',function(stretchedWidth,column){return _this2.onBeforeStretchingColumnWidth(stretchedWidth,column);});this.addHook('beforeColumnResize',function(currentColumn,newSize,isDoubleClick){return _this2.onBeforeColumnResize(currentColumn,newSize,isDoubleClick);});if(typeof loadedManualColumnWidths!=='undefined'){this.manualColumnWidths=loadedManualColumnWidths;}else if(Array.isArray(initialColumnWidth)){this.manualColumnWidths=initialColumnWidth;}else{this.manualColumnWidths=[];}
this.bindEvents();_get(_getPrototypeOf(ManualColumnResize.prototype),"enablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){var initialColumnWidth=this.hot.getSettings().manualColumnResize;if(Array.isArray(initialColumnWidth)){this.manualColumnWidths=initialColumnWidth;}else if(!initialColumnWidth){this.manualColumnWidths=[];}}},{key:"disablePlugin",value:function disablePlugin(){_get(_getPrototypeOf(ManualColumnResize.prototype),"disablePlugin",this).call(this);}},{key:"saveManualColumnWidths",value:function saveManualColumnWidths(){this.hot.runHooks('persistentStateSave','manualColumnWidths',this.manualColumnWidths);}},{key:"loadManualColumnWidths",value:function loadManualColumnWidths(){var storedState={};this.hot.runHooks('persistentStateLoad','manualColumnWidths',storedState);return storedState.value;}},{key:"setupHandlePosition",value:function setupHandlePosition(TH){var _this3=this;if(!TH.parentNode){return false;}
this.currentTH=TH;var col=this.hot.view.wt.wtTable.getCoords(TH).col;var headerHeight=(0,_element.outerHeight)(this.currentTH);if(col>=0){var box=this.currentTH.getBoundingClientRect();this.currentCol=col;this.selectedCols=[];if(this.hot.selection.isSelected()&&this.hot.selection.isSelectedByColumnHeader()){var _this$hot$getSelected=this.hot.getSelectedRangeLast(),from=_this$hot$getSelected.from,to=_this$hot$getSelected.to;var start=from.col;var end=to.col;if(start>=end){start=to.col;end=from.col;}
if(this.currentCol>=start&&this.currentCol<=end){(0,_number.rangeEach)(start,end,function(i){return _this3.selectedCols.push(i);});}else{this.selectedCols.push(this.currentCol);}}else{this.selectedCols.push(this.currentCol);}
this.startOffset=box.left-6;this.startWidth=parseInt(box.width,10);this.handle.style.top="".concat(box.top,"px");this.handle.style.left="".concat(this.startOffset+this.startWidth,"px");this.handle.style.height="".concat(headerHeight,"px");this.hot.rootElement.appendChild(this.handle);}}},{key:"refreshHandlePosition",value:function refreshHandlePosition(){this.handle.style.left="".concat(this.startOffset+this.currentWidth,"px");}},{key:"setupGuidePosition",value:function setupGuidePosition(){var handleHeight=parseInt((0,_element.outerHeight)(this.handle),10);var handleBottomPosition=parseInt(this.handle.style.top,10)+handleHeight;var maximumVisibleElementHeight=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,_element.addClass)(this.handle,'active');(0,_element.addClass)(this.guide,'active');this.guide.style.top="".concat(handleBottomPosition,"px");this.guide.style.left=this.handle.style.left;this.guide.style.height="".concat(maximumVisibleElementHeight-handleHeight,"px");this.hot.rootElement.appendChild(this.guide);}},{key:"refreshGuidePosition",value:function refreshGuidePosition(){this.guide.style.left=this.handle.style.left;}},{key:"hideHandleAndGuide",value:function hideHandleAndGuide(){(0,_element.removeClass)(this.handle,'active');(0,_element.removeClass)(this.guide,'active');}},{key:"checkIfColumnHeader",value:function checkIfColumnHeader(element){if(element!==this.hot.rootElement){var parent=element.parentNode;if(parent.tagName==='THEAD'){return true;}
return this.checkIfColumnHeader(parent);}
return false;}},{key:"getTHFromTargetElement",value:function getTHFromTargetElement(element){if(element.tagName!=='TABLE'){if(element.tagName==='TH'){return element;}
return this.getTHFromTargetElement(element.parentNode);}
return null;}},{key:"onMouseOver",value:function onMouseOver(event){if(this.checkIfColumnHeader(event.target)){var th=this.getTHFromTargetElement(event.target);if(!th){return;}
var colspan=th.getAttribute('colspan');if(th&&(colspan===null||colspan===1)){if(!this.pressed){this.setupHandlePosition(th);}}}}},{key:"afterMouseDownTimeout",value:function afterMouseDownTimeout(){var _this4=this;var render=function render(){_this4.hot.forceFullRender=true;_this4.hot.view.render();_this4.hot.view.wt.wtOverlays.adjustElementsSize(true);};var resize=function resize(selectedCol,forceRender){var hookNewSize=_this4.hot.runHooks('beforeColumnResize',selectedCol,_this4.newSize,true);if(hookNewSize!==void 0){_this4.newSize=hookNewSize;}
if(_this4.hot.getSettings().stretchH==='all'){_this4.clearManualSize(selectedCol);}else{_this4.setManualSize(selectedCol,_this4.newSize);}
if(forceRender){render();}
_this4.saveManualColumnWidths();_this4.hot.runHooks('afterColumnResize',selectedCol,_this4.newSize,true);};if(this.dblclick>=2){var selectedColsLength=this.selectedCols.length;if(selectedColsLength>1){(0,_array.arrayEach)(this.selectedCols,function(selectedCol){resize(selectedCol);});render();}else{(0,_array.arrayEach)(this.selectedCols,function(selectedCol){resize(selectedCol,true);});}}
this.dblclick=0;this.autoresizeTimeout=null;}},{key:"onMouseDown",value:function onMouseDown(event){var _this5=this;if((0,_element.hasClass)(event.target,'manualColumnResizer')){this.setupGuidePosition();this.pressed=this.hot;if(this.autoresizeTimeout===null){this.autoresizeTimeout=setTimeout(function(){return _this5.afterMouseDownTimeout();},500);this.hot._registerTimeout(this.autoresizeTimeout);}
this.dblclick+=1;this.startX=(0,_event.pageX)(event);this.newSize=this.startWidth;}}},{key:"onMouseMove",value:function onMouseMove(event){var _this6=this;if(this.pressed){this.currentWidth=this.startWidth+((0,_event.pageX)(event)-this.startX);(0,_array.arrayEach)(this.selectedCols,function(selectedCol){_this6.newSize=_this6.setManualSize(selectedCol,_this6.currentWidth);});this.refreshHandlePosition();this.refreshGuidePosition();}}},{key:"onMouseUp",value:function onMouseUp(){var _this7=this;var render=function render(){_this7.hot.forceFullRender=true;_this7.hot.view.render();_this7.hot.view.wt.wtOverlays.adjustElementsSize(true);};var resize=function resize(selectedCol,forceRender){_this7.hot.runHooks('beforeColumnResize',selectedCol,_this7.newSize,false);if(forceRender){render();}
_this7.saveManualColumnWidths();_this7.hot.runHooks('afterColumnResize',selectedCol,_this7.newSize);};if(this.pressed){this.hideHandleAndGuide();this.pressed=false;if(this.newSize!==this.startWidth){var selectedColsLength=this.selectedCols.length;if(selectedColsLength>1){(0,_array.arrayEach)(this.selectedCols,function(selectedCol){resize(selectedCol);});render();}else{(0,_array.arrayEach)(this.selectedCols,function(selectedCol){resize(selectedCol,true);});}}
this.setupHandlePosition(this.currentTH);}}},{key:"bindEvents",value:function bindEvents(){var _this8=this;this.eventManager.addEventListener(this.hot.rootElement,'mouseover',function(e){return _this8.onMouseOver(e);});this.eventManager.addEventListener(this.hot.rootElement,'mousedown',function(e){return _this8.onMouseDown(e);});this.eventManager.addEventListener(window,'mousemove',function(e){return _this8.onMouseMove(e);});this.eventManager.addEventListener(window,'mouseup',function(){return _this8.onMouseUp();});}},{key:"setManualSize",value:function setManualSize(column,width){var newWidth=Math.max(width,20);var physicalColumn=this.hot.runHooks('modifyCol',column);this.manualColumnWidths[physicalColumn]=newWidth;return newWidth;}},{key:"clearManualSize",value:function clearManualSize(column){var physicalColumn=this.hot.runHooks('modifyCol',column);this.manualColumnWidths[physicalColumn]=void 0;}},{key:"onModifyColWidth",value:function onModifyColWidth(width,column){var newWidth=width;if(this.enabled){var physicalColumn=this.hot.runHooks('modifyCol',column);var columnWidth=this.manualColumnWidths[physicalColumn];if(this.hot.getSettings().manualColumnResize&&columnWidth){newWidth=columnWidth;}}
return newWidth;}},{key:"onBeforeStretchingColumnWidth",value:function onBeforeStretchingColumnWidth(stretchedWidth,column){var width=this.manualColumnWidths[column];if(width===void 0){width=stretchedWidth;}
return width;}},{key:"onBeforeColumnResize",value:function onBeforeColumnResize(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={};}}]);return ManualColumnResize;}(_base.default);(0,_plugins.registerPlugin)('manualColumnResize',ManualColumnResize);var _default=ManualColumnResize;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _array=__webpack_require__(3);var _element=__webpack_require__(1);var _number=__webpack_require__(9);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _plugins=__webpack_require__(13);var _rowsMapper=_interopRequireDefault(__webpack_require__(730));var _backlight=_interopRequireDefault(__webpack_require__(731));var _guideline=_interopRequireDefault(__webpack_require__(732));__webpack_require__(733);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
_pluginHooks.default.getSingleton().register('beforeRowMove');_pluginHooks.default.getSingleton().register('afterRowMove');_pluginHooks.default.getSingleton().register('unmodifyRow');var privatePool=new WeakMap();var CSS_PLUGIN='ht__manualRowMove';var CSS_SHOW_UI='show-ui';var CSS_ON_MOVING='on-moving--rows';var CSS_AFTER_SELECTION='after-selection--rows';var ManualRowMove=function(_BasePlugin){_inherits(ManualRowMove,_BasePlugin);function ManualRowMove(hotInstance){var _this;_classCallCheck(this,ManualRowMove);_this=_possibleConstructorReturn(this,_getPrototypeOf(ManualRowMove).call(this,hotInstance));privatePool.set(_assertThisInitialized(_assertThisInitialized(_this)),{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}});_this.removedRows=[];_this.rowsMapper=new _rowsMapper.default(_assertThisInitialized(_assertThisInitialized(_this)));_this.eventManager=new _eventManager.default(_assertThisInitialized(_assertThisInitialized(_this)));_this.backlight=new _backlight.default(hotInstance);_this.guideline=new _guideline.default(hotInstance);return _this;}
_createClass(ManualRowMove,[{key:"isEnabled",value:function isEnabled(){return!!this.hot.getSettings().manualRowMove;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.addHook('beforeOnCellMouseDown',function(event,coords,TD,blockCalculations){return _this2.onBeforeOnCellMouseDown(event,coords,TD,blockCalculations);});this.addHook('beforeOnCellMouseOver',function(event,coords,TD,blockCalculations){return _this2.onBeforeOnCellMouseOver(event,coords,TD,blockCalculations);});this.addHook('afterScrollHorizontally',function(){return _this2.onAfterScrollHorizontally();});this.addHook('modifyRow',function(row,source){return _this2.onModifyRow(row,source);});this.addHook('beforeRemoveRow',function(index,amount){return _this2.onBeforeRemoveRow(index,amount);});this.addHook('afterRemoveRow',function(){return _this2.onAfterRemoveRow();});this.addHook('afterCreateRow',function(index,amount){return _this2.onAfterCreateRow(index,amount);});this.addHook('afterLoadData',function(){return _this2.onAfterLoadData();});this.addHook('beforeColumnSort',function(column,order){return _this2.onBeforeColumnSort(column,order);});this.addHook('unmodifyRow',function(row){return _this2.onUnmodifyRow(row);});this.registerEvents();(0,_element.addClass)(this.hot.rootElement,CSS_PLUGIN);_get(_getPrototypeOf(ManualRowMove.prototype),"enablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();this.onAfterPluginsInitialized();_get(_getPrototypeOf(ManualRowMove.prototype),"updatePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){var pluginSettings=this.hot.getSettings().manualRowMove;if(Array.isArray(pluginSettings)){this.rowsMapper.clearMap();}
(0,_element.removeClass)(this.hot.rootElement,CSS_PLUGIN);this.unregisterEvents();this.backlight.destroy();this.guideline.destroy();_get(_getPrototypeOf(ManualRowMove.prototype),"disablePlugin",this).call(this);}},{key:"moveRow",value:function moveRow(row,target){this.moveRows([row],target);}},{key:"moveRows",value:function moveRows(rows,target){var _this3=this;var visualRows=_toConsumableArray(rows);var priv=privatePool.get(this);var beforeMoveHook=this.hot.runHooks('beforeRowMove',visualRows,target);priv.disallowMoving=beforeMoveHook===false;if(!priv.disallowMoving){(0,_array.arrayEach)(rows,function(row,index,array){array[index]=_this3.rowsMapper.getValueByIndex(row);});(0,_array.arrayEach)(rows,function(row,index){var actualPosition=_this3.rowsMapper.getIndexByValue(row);if(actualPosition!==target){_this3.rowsMapper.moveRow(actualPosition,target+index);}});this.rowsMapper.clearNull();}
this.hot.runHooks('afterRowMove',visualRows,target);}},{key:"changeSelection",value:function changeSelection(startRow,endRow){this.hot.selectRows(startRow,endRow);}},{key:"getRowsHeight",value:function getRowsHeight(from,to){var height=0;for(var i=from;i<to;i++){var rowHeight=this.hot.view.wt.wtTable.getRowHeight(i)||23;height+=rowHeight;}
return height;}},{key:"initialSettings",value:function initialSettings(){var pluginSettings=this.hot.getSettings().manualRowMove;if(Array.isArray(pluginSettings)){this.moveRows(pluginSettings,0);}else if(pluginSettings!==void 0){var persistentState=this.persistentStateLoad();if(persistentState.length){this.moveRows(persistentState,0);}}}},{key:"isFixedRowTop",value:function isFixedRowTop(row){return row<this.hot.getSettings().fixedRowsTop;}},{key:"isFixedRowBottom",value:function isFixedRowBottom(row){return row>this.hot.getSettings().fixedRowsBottom;}},{key:"persistentStateSave",value:function persistentStateSave(){this.hot.runHooks('persistentStateSave','manualRowMove',this.rowsMapper._arrayMap);}},{key:"persistentStateLoad",value:function persistentStateLoad(){var storedState={};this.hot.runHooks('persistentStateLoad','manualRowMove',storedState);return storedState.value?storedState.value:[];}},{key:"prepareRowsToMoving",value:function prepareRowsToMoving(){var selection=this.hot.getSelectedRangeLast();var selectedRows=[];if(!selection){return selectedRows;}
var from=selection.from,to=selection.to;var start=Math.min(from.row,to.row);var end=Math.max(from.row,to.row);(0,_number.rangeEach)(start,end,function(i){selectedRows.push(i);});return selectedRows;}},{key:"refreshPositions",value:function refreshPositions(){var priv=privatePool.get(this);var coords=priv.target.coords;var firstVisible=this.hot.view.wt.wtTable.getFirstVisibleRow();var lastVisible=this.hot.view.wt.wtTable.getLastVisibleRow();var fixedRows=this.hot.getSettings().fixedRowsTop;var countRows=this.hot.countRows();if(coords.row<fixedRows&&firstVisible>0){this.hot.scrollViewportTo(firstVisible-1);}
if(coords.row>=lastVisible&&lastVisible<countRows){this.hot.scrollViewportTo(lastVisible+1,undefined,true);}
var wtTable=this.hot.view.wt.wtTable;var TD=priv.target.TD;var rootElementOffset=(0,_element.offset)(this.hot.rootElement);var tdOffsetTop=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,coords.row);var mouseOffsetTop=priv.target.eventPageY-rootElementOffset.top+wtTable.holder.scrollTop;var hiderHeight=wtTable.hider.offsetHeight;var tbodyOffsetTop=wtTable.TBODY.offsetTop;var backlightElemMarginTop=this.backlight.getOffset().top;var backlightElemHeight=this.backlight.getSize().height;if(this.isFixedRowTop(coords.row)){tdOffsetTop+=wtTable.holder.scrollTop;}
if(coords.row<0){priv.target.row=firstVisible>0?firstVisible-1:firstVisible;}else if(TD.offsetHeight/2+tdOffsetTop<=mouseOffsetTop){priv.target.row=coords.row+1;tdOffsetTop+=coords.row===0?TD.offsetHeight-1:TD.offsetHeight;}else{priv.target.row=coords.row;}
var backlightTop=mouseOffsetTop;var guidelineTop=tdOffsetTop;if(mouseOffsetTop+backlightElemHeight+backlightElemMarginTop>=hiderHeight){backlightTop=hiderHeight-backlightElemHeight-backlightElemMarginTop;}else if(mouseOffsetTop+backlightElemMarginTop<tbodyOffsetTop){backlightTop=tbodyOffsetTop+Math.abs(backlightElemMarginTop);}
if(tdOffsetTop>=hiderHeight-1){guidelineTop=hiderHeight-1;}
var topOverlayHeight=0;if(this.hot.view.wt.wtOverlays.topOverlay){topOverlayHeight=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight;}
if(coords.row>=fixedRows&&guidelineTop-wtTable.holder.scrollTop<topOverlayHeight){this.hot.scrollViewportTo(coords.row);}
this.backlight.setPosition(backlightTop);this.guideline.setPosition(guidelineTop);}},{key:"updateRowsMapper",value:function updateRowsMapper(){var countRows=this.hot.countSourceRows();var rowsMapperLen=this.rowsMapper._arrayMap.length;if(rowsMapperLen===0){this.rowsMapper.createMap(countRows||this.hot.getSettings().startRows);}else if(rowsMapperLen<countRows){var diff=countRows-rowsMapperLen;this.rowsMapper.insertItems(rowsMapperLen,diff);}else if(rowsMapperLen>countRows){var maxIndex=countRows-1;var rowsToRemove=[];(0,_array.arrayEach)(this.rowsMapper._arrayMap,function(value,index){if(value>maxIndex){rowsToRemove.push(index);}});this.rowsMapper.removeItems(rowsToRemove);}}},{key:"registerEvents",value:function registerEvents(){var _this4=this;this.eventManager.addEventListener(document.documentElement,'mousemove',function(event){return _this4.onMouseMove(event);});this.eventManager.addEventListener(document.documentElement,'mouseup',function(){return _this4.onMouseUp();});}},{key:"unregisterEvents",value:function unregisterEvents(){this.eventManager.clear();}},{key:"onBeforeColumnSort",value:function onBeforeColumnSort(column,order){var priv=privatePool.get(this);priv.disallowMoving=order!==void 0;}},{key:"onBeforeOnCellMouseDown",value:function onBeforeOnCellMouseDown(event,coords,TD,blockCalculations){var wtTable=this.hot.view.wt.wtTable;var isHeaderSelection=this.hot.selection.isSelectedByRowHeader();var selection=this.hot.getSelectedRangeLast();var priv=privatePool.get(this);if(!selection||!isHeaderSelection||priv.pressed||event.button!==0){priv.pressed=false;priv.rowsToMove.length=0;(0,_element.removeClass)(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI]);return;}
var guidelineIsNotReady=this.guideline.isBuilt()&&!this.guideline.isAppended();var backlightIsNotReady=this.backlight.isBuilt()&&!this.backlight.isAppended();if(guidelineIsNotReady&&backlightIsNotReady){this.guideline.appendTo(wtTable.hider);this.backlight.appendTo(wtTable.hider);}
var from=selection.from,to=selection.to;var start=Math.min(from.row,to.row);var end=Math.max(from.row,to.row);if(coords.col<0&&coords.row>=start&&coords.row<=end){blockCalculations.row=true;priv.pressed=true;priv.target.eventPageY=event.pageY;priv.target.coords=coords;priv.target.TD=TD;priv.rowsToMove=this.prepareRowsToMoving();var leftPos=wtTable.holder.scrollLeft+this.hot.view.wt.wtViewport.getRowHeaderWidth();this.backlight.setPosition(null,leftPos);this.backlight.setSize(wtTable.hider.offsetWidth-leftPos,this.getRowsHeight(start,end+1));this.backlight.setOffset((this.getRowsHeight(start,coords.row)+event.layerY)*-1,null);(0,_element.addClass)(this.hot.rootElement,CSS_ON_MOVING);this.refreshPositions();}else{(0,_element.removeClass)(this.hot.rootElement,CSS_AFTER_SELECTION);priv.pressed=false;priv.rowsToMove.length=0;}}},{key:"onMouseMove",value:function onMouseMove(event){var priv=privatePool.get(this);if(!priv.pressed){return;}
if(event.realTarget===this.backlight.element){var height=this.backlight.getSize().height;this.backlight.setSize(null,0);setTimeout(function(){this.backlight.setPosition(null,height);});}
priv.target.eventPageY=event.pageY;this.refreshPositions();}},{key:"onBeforeOnCellMouseOver",value:function onBeforeOnCellMouseOver(event,coords,TD,blockCalculations){var selectedRange=this.hot.getSelectedRangeLast();var priv=privatePool.get(this);if(!selectedRange||!priv.pressed){return;}
if(priv.rowsToMove.indexOf(coords.row)>-1){(0,_element.removeClass)(this.hot.rootElement,CSS_SHOW_UI);}else{(0,_element.addClass)(this.hot.rootElement,CSS_SHOW_UI);}
blockCalculations.row=true;blockCalculations.column=true;blockCalculations.cell=true;priv.target.coords=coords;priv.target.TD=TD;}},{key:"onMouseUp",value:function onMouseUp(){var priv=privatePool.get(this);var target=priv.target.row;var rowsLen=priv.rowsToMove.length;priv.pressed=false;priv.backlightHeight=0;(0,_element.removeClass)(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI,CSS_AFTER_SELECTION]);if(this.hot.selection.isSelectedByRowHeader()){(0,_element.addClass)(this.hot.rootElement,CSS_AFTER_SELECTION);}
if(rowsLen<1||target===void 0||priv.rowsToMove.indexOf(target)>-1||priv.rowsToMove[rowsLen-1]===target-1){return;}
this.moveRows(priv.rowsToMove,target);this.persistentStateSave();this.hot.render();if(!priv.disallowMoving){var selectionStart=this.rowsMapper.getIndexByValue(priv.rowsToMove[0]);var selectionEnd=this.rowsMapper.getIndexByValue(priv.rowsToMove[rowsLen-1]);this.changeSelection(selectionStart,selectionEnd);}
priv.rowsToMove.length=0;}},{key:"onAfterScrollHorizontally",value:function onAfterScrollHorizontally(){var wtTable=this.hot.view.wt.wtTable;var headerWidth=this.hot.view.wt.wtViewport.getRowHeaderWidth();var scrollLeft=wtTable.holder.scrollLeft;var posLeft=headerWidth+scrollLeft;this.backlight.setPosition(null,posLeft);this.backlight.setSize(wtTable.hider.offsetWidth-posLeft);}},{key:"onAfterCreateRow",value:function onAfterCreateRow(index,amount){this.rowsMapper.shiftItems(index,amount);}},{key:"onBeforeRemoveRow",value:function onBeforeRemoveRow(index,amount){var _this5=this;this.removedRows.length=0;if(index!==false){(0,_number.rangeEach)(index,index+amount-1,function(removedIndex){_this5.removedRows.push(_this5.hot.runHooks('modifyRow',removedIndex,_this5.pluginName));});}}},{key:"onAfterRemoveRow",value:function onAfterRemoveRow(){this.rowsMapper.unshiftItems(this.removedRows);}},{key:"onAfterLoadData",value:function onAfterLoadData(){this.updateRowsMapper();}},{key:"onModifyRow",value:function onModifyRow(row,source){var physicalRow=row;if(source!==this.pluginName){var rowInMapper=this.rowsMapper.getValueByIndex(physicalRow);physicalRow=rowInMapper===null?physicalRow:rowInMapper;}
return physicalRow;}},{key:"onUnmodifyRow",value:function onUnmodifyRow(row){var indexInMapper=this.rowsMapper.getIndexByValue(row);return indexInMapper===null?row:indexInMapper;}},{key:"onAfterPluginsInitialized",value:function onAfterPluginsInitialized(){this.updateRowsMapper();this.initialSettings();this.backlight.build();this.guideline.build();}},{key:"destroy",value:function destroy(){this.backlight.destroy();this.guideline.destroy();this.rowsMapper.destroy();_get(_getPrototypeOf(ManualRowMove.prototype),"destroy",this).call(this);}}]);return ManualRowMove;}(_base.default);(0,_plugins.registerPlugin)('ManualRowMove',ManualRowMove);var _default=ManualRowMove;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _arrayMapper=_interopRequireDefault(__webpack_require__(125));var _array=__webpack_require__(3);var _object=__webpack_require__(2);var _number=__webpack_require__(9);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var RowsMapper=function(){function RowsMapper(manualRowMove){_classCallCheck(this,RowsMapper);this.manualRowMove=manualRowMove;}
_createClass(RowsMapper,[{key:"createMap",value:function createMap(length){var _this=this;var originLength=length===void 0?this._arrayMap.length:length;this._arrayMap.length=0;(0,_number.rangeEach)(originLength-1,function(itemIndex){_this._arrayMap[itemIndex]=itemIndex;});}},{key:"destroy",value:function destroy(){this._arrayMap=null;}},{key:"moveRow",value:function moveRow(from,to){var indexToMove=this._arrayMap[from];this._arrayMap[from]=null;this._arrayMap.splice(to,0,indexToMove);}},{key:"clearNull",value:function clearNull(){this._arrayMap=(0,_array.arrayFilter)(this._arrayMap,function(i){return i!==null;});}}]);return RowsMapper;}();(0,_object.mixin)(RowsMapper,_arrayMapper.default);var _default=RowsMapper;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(435));var _element=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var CSS_CLASSNAME='ht__manualRowMove--backlight';var BacklightUI=function(_BaseUI){_inherits(BacklightUI,_BaseUI);function BacklightUI(){_classCallCheck(this,BacklightUI);return _possibleConstructorReturn(this,_getPrototypeOf(BacklightUI).apply(this,arguments));}
_createClass(BacklightUI,[{key:"build",value:function build(){_get(_getPrototypeOf(BacklightUI.prototype),"build",this).call(this);(0,_element.addClass)(this._element,CSS_CLASSNAME);}}]);return BacklightUI;}(_base.default);var _default=BacklightUI;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(435));var _element=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var CSS_CLASSNAME='ht__manualRowMove--guideline';var GuidelineUI=function(_BaseUI){_inherits(GuidelineUI,_BaseUI);function GuidelineUI(){_classCallCheck(this,GuidelineUI);return _possibleConstructorReturn(this,_getPrototypeOf(GuidelineUI).apply(this,arguments));}
_createClass(GuidelineUI,[{key:"build",value:function build(){_get(_getPrototypeOf(GuidelineUI.prototype),"build",this).call(this);(0,_element.addClass)(this._element,CSS_CLASSNAME);}}]);return GuidelineUI;}(_base.default);var _default=GuidelineUI;exports.default=_default;}),(function(module,exports){}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _element=__webpack_require__(1);var _eventManager=_interopRequireDefault(__webpack_require__(10));var _event=__webpack_require__(18);var _array=__webpack_require__(3);var _number=__webpack_require__(9);var _plugins=__webpack_require__(13);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
var ManualRowResize=function(_BasePlugin){_inherits(ManualRowResize,_BasePlugin);function ManualRowResize(hotInstance){var _this;_classCallCheck(this,ManualRowResize);_this=_possibleConstructorReturn(this,_getPrototypeOf(ManualRowResize).call(this,hotInstance));_this.currentTH=null;_this.currentRow=null;_this.selectedRows=[];_this.currentHeight=null;_this.newSize=null;_this.startY=null;_this.startHeight=null;_this.startOffset=null;_this.handle=document.createElement('DIV');_this.guide=document.createElement('DIV');_this.eventManager=new _eventManager.default(_assertThisInitialized(_assertThisInitialized(_this)));_this.pressed=null;_this.dblclick=0;_this.autoresizeTimeout=null;_this.manualRowHeights=[];(0,_element.addClass)(_this.handle,'manualRowResizer');(0,_element.addClass)(_this.guide,'manualRowResizerGuide');return _this;}
_createClass(ManualRowResize,[{key:"isEnabled",value:function isEnabled(){return this.hot.getSettings().manualRowResize;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.manualRowHeights=[];var initialRowHeights=this.hot.getSettings().manualRowResize;var loadedManualRowHeights=this.loadManualRowHeights();if(typeof loadedManualRowHeights!=='undefined'){this.manualRowHeights=loadedManualRowHeights;}else if(Array.isArray(initialRowHeights)){this.manualRowHeights=initialRowHeights;}else{this.manualRowHeights=[];}
this.addHook('modifyRowHeight',function(height,row){return _this2.onModifyRowHeight(height,row);});this.bindEvents();_get(_getPrototypeOf(ManualRowResize.prototype),"enablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){var initialRowHeights=this.hot.getSettings().manualRowResize;if(Array.isArray(initialRowHeights)){this.manualRowHeights=initialRowHeights;}else if(!initialRowHeights){this.manualRowHeights=[];}}},{key:"disablePlugin",value:function disablePlugin(){_get(_getPrototypeOf(ManualRowResize.prototype),"disablePlugin",this).call(this);}},{key:"saveManualRowHeights",value:function saveManualRowHeights(){this.hot.runHooks('persistentStateSave','manualRowHeights',this.manualRowHeights);}},{key:"loadManualRowHeights",value:function loadManualRowHeights(){var storedState={};this.hot.runHooks('persistentStateLoad','manualRowHeights',storedState);return storedState.value;}},{key:"setupHandlePosition",value:function setupHandlePosition(TH){var _this3=this;this.currentTH=TH;var row=this.hot.view.wt.wtTable.getCoords(TH).row;var headerWidth=(0,_element.outerWidth)(this.currentTH);if(row>=0){var box=this.currentTH.getBoundingClientRect();this.currentRow=row;this.selectedRows=[];if(this.hot.selection.isSelected()&&this.hot.selection.isSelectedByRowHeader()){var _this$hot$getSelected=this.hot.getSelectedRangeLast(),from=_this$hot$getSelected.from,to=_this$hot$getSelected.to;var start=from.row;var end=to.row;if(start>=end){start=to.row;end=from.row;}
if(this.currentRow>=start&&this.currentRow<=end){(0,_number.rangeEach)(start,end,function(i){return _this3.selectedRows.push(i);});}else{this.selectedRows.push(this.currentRow);}}else{this.selectedRows.push(this.currentRow);}
this.startOffset=box.top-6;this.startHeight=parseInt(box.height,10);this.handle.style.left="".concat(box.left,"px");this.handle.style.top="".concat(this.startOffset+this.startHeight,"px");this.handle.style.width="".concat(headerWidth,"px");this.hot.rootElement.appendChild(this.handle);}}},{key:"refreshHandlePosition",value:function refreshHandlePosition(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px");}},{key:"setupGuidePosition",value:function setupGuidePosition(){var handleWidth=parseInt((0,_element.outerWidth)(this.handle),10);var handleRightPosition=parseInt(this.handle.style.left,10)+handleWidth;var maximumVisibleElementWidth=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,_element.addClass)(this.handle,'active');(0,_element.addClass)(this.guide,'active');this.guide.style.top=this.handle.style.top;this.guide.style.left="".concat(handleRightPosition,"px");this.guide.style.width="".concat(maximumVisibleElementWidth-handleWidth,"px");this.hot.rootElement.appendChild(this.guide);}},{key:"refreshGuidePosition",value:function refreshGuidePosition(){this.guide.style.top=this.handle.style.top;}},{key:"hideHandleAndGuide",value:function hideHandleAndGuide(){(0,_element.removeClass)(this.handle,'active');(0,_element.removeClass)(this.guide,'active');}},{key:"checkIfRowHeader",value:function checkIfRowHeader(element){if(element!==this.hot.rootElement){var parent=element.parentNode;if(parent.tagName==='TBODY'){return true;}
return this.checkIfRowHeader(parent);}
return false;}},{key:"getTHFromTargetElement",value:function getTHFromTargetElement(element){if(element.tagName!=='TABLE'){if(element.tagName==='TH'){return element;}
return this.getTHFromTargetElement(element.parentNode);}
return null;}},{key:"onMouseOver",value:function onMouseOver(event){if(this.checkIfRowHeader(event.target)){var th=this.getTHFromTargetElement(event.target);if(th){if(!this.pressed){this.setupHandlePosition(th);}}}}},{key:"afterMouseDownTimeout",value:function afterMouseDownTimeout(){var _this4=this;var render=function render(){_this4.hot.forceFullRender=true;_this4.hot.view.render();_this4.hot.view.wt.wtOverlays.adjustElementsSize(true);};var resize=function resize(selectedRow,forceRender){var hookNewSize=_this4.hot.runHooks('beforeRowResize',selectedRow,_this4.newSize,true);if(hookNewSize!==void 0){_this4.newSize=hookNewSize;}
_this4.setManualSize(selectedRow,_this4.newSize);if(forceRender){render();}
_this4.hot.runHooks('afterRowResize',selectedRow,_this4.newSize,true);};if(this.dblclick>=2){var selectedRowsLength=this.selectedRows.length;if(selectedRowsLength>1){(0,_array.arrayEach)(this.selectedRows,function(selectedRow){resize(selectedRow);});render();}else{(0,_array.arrayEach)(this.selectedRows,function(selectedRow){resize(selectedRow,true);});}}
this.dblclick=0;this.autoresizeTimeout=null;}},{key:"onMouseDown",value:function onMouseDown(event){var _this5=this;if((0,_element.hasClass)(event.target,'manualRowResizer')){this.setupGuidePosition();this.pressed=this.hot;if(this.autoresizeTimeout===null){this.autoresizeTimeout=setTimeout(function(){return _this5.afterMouseDownTimeout();},500);this.hot._registerTimeout(this.autoresizeTimeout);}
this.dblclick+=1;this.startY=(0,_event.pageY)(event);this.newSize=this.startHeight;}}},{key:"onMouseMove",value:function onMouseMove(event){var _this6=this;if(this.pressed){this.currentHeight=this.startHeight+((0,_event.pageY)(event)-this.startY);(0,_array.arrayEach)(this.selectedRows,function(selectedRow){_this6.newSize=_this6.setManualSize(selectedRow,_this6.currentHeight);});this.refreshHandlePosition();this.refreshGuidePosition();}}},{key:"onMouseUp",value:function onMouseUp(){var _this7=this;var render=function render(){_this7.hot.forceFullRender=true;_this7.hot.view.render();_this7.hot.view.wt.wtOverlays.adjustElementsSize(true);};var runHooks=function runHooks(selectedRow,forceRender){_this7.hot.runHooks('beforeRowResize',selectedRow,_this7.newSize);if(forceRender){render();}
_this7.saveManualRowHeights();_this7.hot.runHooks('afterRowResize',selectedRow,_this7.newSize,false);};if(this.pressed){this.hideHandleAndGuide();this.pressed=false;if(this.newSize!==this.startHeight){var selectedRowsLength=this.selectedRows.length;if(selectedRowsLength>1){(0,_array.arrayEach)(this.selectedRows,function(selectedRow){runHooks(selectedRow);});render();}else{(0,_array.arrayEach)(this.selectedRows,function(selectedRow){runHooks(selectedRow,true);});}}
this.setupHandlePosition(this.currentTH);}}},{key:"bindEvents",value:function bindEvents(){var _this8=this;this.eventManager.addEventListener(this.hot.rootElement,'mouseover',function(e){return _this8.onMouseOver(e);});this.eventManager.addEventListener(this.hot.rootElement,'mousedown',function(e){return _this8.onMouseDown(e);});this.eventManager.addEventListener(window,'mousemove',function(e){return _this8.onMouseMove(e);});this.eventManager.addEventListener(window,'mouseup',function(){return _this8.onMouseUp();});}},{key:"setManualSize",value:function setManualSize(row,height){var physicalRow=this.hot.runHooks('modifyRow',row);this.manualRowHeights[physicalRow]=height;return height;}},{key:"onModifyRowHeight",value:function onModifyRowHeight(height,row){if(this.enabled){var autoRowSizePlugin=this.hot.getPlugin('autoRowSize');var autoRowHeightResult=autoRowSizePlugin?autoRowSizePlugin.heights[row]:null;var physicalRow=this.hot.runHooks('modifyRow',row);var manualRowHeight=this.manualRowHeights[physicalRow];if(manualRowHeight!==void 0&&(manualRowHeight===autoRowHeightResult||manualRowHeight>(height||0))){return manualRowHeight;}}
return height;}}]);return ManualRowResize;}(_base.default);(0,_plugins.registerPlugin)('manualRowResize',ManualRowResize);var _default=ManualRowResize;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _plugins=__webpack_require__(13);var _event=__webpack_require__(18);var _src=__webpack_require__(8);var _cellsCollection=_interopRequireDefault(__webpack_require__(736));var _cellCoords=_interopRequireDefault(__webpack_require__(128));var _autofill=_interopRequireDefault(__webpack_require__(737));var _selection=_interopRequireDefault(__webpack_require__(738));var _toggleMerge=_interopRequireDefault(__webpack_require__(739));var _array=__webpack_require__(3);var _object=__webpack_require__(2);var _console=__webpack_require__(76);var _number=__webpack_require__(9);var _utils=__webpack_require__(436);__webpack_require__(740);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
_pluginHooks.default.getSingleton().register('beforeMergeCells');_pluginHooks.default.getSingleton().register('afterMergeCells');_pluginHooks.default.getSingleton().register('beforeUnmergeCells');_pluginHooks.default.getSingleton().register('afterUnmergeCells');var privatePool=new WeakMap();var MergeCells=function(_BasePlugin){_inherits(MergeCells,_BasePlugin);function MergeCells(hotInstance){var _this;_classCallCheck(this,MergeCells);_this=_possibleConstructorReturn(this,_getPrototypeOf(MergeCells).call(this,hotInstance));privatePool.set(_assertThisInitialized(_assertThisInitialized(_this)),{lastDesiredCoords:null});_this.mergedCellsCollection=null;_this.autofillCalculations=null;_this.selectionCalculations=null;return _this;}
_createClass(MergeCells,[{key:"isEnabled",value:function isEnabled(){return!!this.hot.getSettings().mergeCells;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.mergedCellsCollection=new _cellsCollection.default(this);this.autofillCalculations=new _autofill.default(this);this.selectionCalculations=new _selection.default(this);this.addHook('afterInit',function(){return _this2.onAfterInit.apply(_this2,arguments);});this.addHook('beforeKeyDown',function(){return _this2.onBeforeKeyDown.apply(_this2,arguments);});this.addHook('modifyTransformStart',function(){return _this2.onModifyTransformStart.apply(_this2,arguments);});this.addHook('afterModifyTransformStart',function(){return _this2.onAfterModifyTransformStart.apply(_this2,arguments);});this.addHook('modifyTransformEnd',function(){return _this2.onModifyTransformEnd.apply(_this2,arguments);});this.addHook('modifyGetCellCoords',function(){return _this2.onModifyGetCellCoords.apply(_this2,arguments);});this.addHook('beforeSetRangeEnd',function(){return _this2.onBeforeSetRangeEnd.apply(_this2,arguments);});this.addHook('afterIsMultipleSelection',function(){return _this2.onAfterIsMultipleSelection.apply(_this2,arguments);});this.addHook('afterRenderer',function(){return _this2.onAfterRenderer.apply(_this2,arguments);});this.addHook('afterContextMenuDefaultOptions',function(){return _this2.addMergeActionsToContextMenu.apply(_this2,arguments);});this.addHook('afterGetCellMeta',function(){return _this2.onAfterGetCellMeta.apply(_this2,arguments);});this.addHook('afterViewportRowCalculatorOverride',function(){return _this2.onAfterViewportRowCalculatorOverride.apply(_this2,arguments);});this.addHook('afterViewportColumnCalculatorOverride',function(){return _this2.onAfterViewportColumnCalculatorOverride.apply(_this2,arguments);});this.addHook('modifyAutofillRange',function(){return _this2.onModifyAutofillRange.apply(_this2,arguments);});this.addHook('afterCreateCol',function(){return _this2.onAfterCreateCol.apply(_this2,arguments);});this.addHook('afterRemoveCol',function(){return _this2.onAfterRemoveCol.apply(_this2,arguments);});this.addHook('afterCreateRow',function(){return _this2.onAfterCreateRow.apply(_this2,arguments);});this.addHook('afterRemoveRow',function(){return _this2.onAfterRemoveRow.apply(_this2,arguments);});this.addHook('afterChange',function(){return _this2.onAfterChange.apply(_this2,arguments);});this.addHook('beforeDrawBorders',function(){return _this2.onBeforeDrawAreaBorders.apply(_this2,arguments);});this.addHook('afterDrawSelection',function(){return _this2.onAfterDrawSelection.apply(_this2,arguments);});this.addHook('beforeRemoveCellClassNames',function(){return _this2.onBeforeRemoveCellClassNames.apply(_this2,arguments);});_get(_getPrototypeOf(MergeCells.prototype),"enablePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){this.clearCollections();this.hot.render();_get(_getPrototypeOf(MergeCells.prototype),"disablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){var settings=this.hot.getSettings().mergeCells;this.disablePlugin();this.enablePlugin();this.generateFromSettings(settings);_get(_getPrototypeOf(MergeCells.prototype),"updatePlugin",this).call(this);}},{key:"validateSetting",value:function validateSetting(setting){var valid=true;if(!setting){return false;}
if(_cellCoords.default.containsNegativeValues(setting)){(0,_console.warn)(_cellCoords.default.NEGATIVE_VALUES_WARNING(setting));valid=false;}else if(_cellCoords.default.isOutOfBounds(setting,this.hot.countRows(),this.hot.countCols())){(0,_console.warn)(_cellCoords.default.IS_OUT_OF_BOUNDS_WARNING(setting));valid=false;}else if(_cellCoords.default.isSingleCell(setting)){(0,_console.warn)(_cellCoords.default.IS_SINGLE_CELL(setting));valid=false;}else if(_cellCoords.default.containsZeroSpan(setting)){(0,_console.warn)(_cellCoords.default.ZERO_SPAN_WARNING(setting));valid=false;}
return valid;}},{key:"generateFromSettings",value:function generateFromSettings(settings){var _this3=this;if(Array.isArray(settings)){var _this$hot;var populationArgumentsList=[];(0,_array.arrayEach)(settings,function(setting){if(!_this3.validateSetting(setting)){return;}
var highlight=new _src.CellCoords(setting.row,setting.col);var rangeEnd=new _src.CellCoords(setting.row+setting.rowspan-1,setting.col+setting.colspan-1);var mergeRange=new _src.CellRange(highlight,highlight,rangeEnd);populationArgumentsList.push(_this3.mergeRange(mergeRange,true,true));});populationArgumentsList=populationArgumentsList.filter(function(value){return value!==true;});var bulkPopulationData=this.getBulkCollectionData(populationArgumentsList);(_this$hot=this.hot).populateFromArray.apply(_this$hot,_toConsumableArray(bulkPopulationData));}}},{key:"getBulkCollectionData",value:function getBulkCollectionData(populationArgumentsList){var _this$hot2;var populationDataRange=this.getBulkCollectionDataRange(populationArgumentsList);var dataAtRange=(_this$hot2=this.hot).getData.apply(_this$hot2,_toConsumableArray(populationDataRange));var newDataAtRange=dataAtRange.splice(0);(0,_array.arrayEach)(populationArgumentsList,function(mergedCellArguments){var _mergedCellArguments=_slicedToArray(mergedCellArguments,3),mergedCellRowIndex=_mergedCellArguments[0],mergedCellColumnIndex=_mergedCellArguments[1],mergedCellData=_mergedCellArguments[2];(0,_array.arrayEach)(mergedCellData,function(mergedCellRow,rowIndex){(0,_array.arrayEach)(mergedCellRow,function(mergedCellElement,columnIndex){newDataAtRange[mergedCellRowIndex-populationDataRange[0]+rowIndex][mergedCellColumnIndex-populationDataRange[1]+columnIndex]=mergedCellElement;});});});return[populationDataRange[0],populationDataRange[1],newDataAtRange];}},{key:"getBulkCollectionDataRange",value:function getBulkCollectionDataRange(populationArgumentsList){var start=[0,0];var end=[0,0];var mergedCellRow=null;var mergedCellColumn=null;var mergedCellData=null;(0,_array.arrayEach)(populationArgumentsList,function(mergedCellArguments){mergedCellRow=mergedCellArguments[0];mergedCellColumn=mergedCellArguments[1];mergedCellData=mergedCellArguments[2];start[0]=Math.min(mergedCellRow,start[0]);start[1]=Math.min(mergedCellColumn,start[1]);end[0]=Math.max(mergedCellRow+mergedCellData.length-1,end[0]);end[1]=Math.max(mergedCellColumn+mergedCellData[0].length-1,end[1]);});return[].concat(start,end);}},{key:"clearCollections",value:function clearCollections(){this.mergedCellsCollection.clear();}},{key:"canMergeRange",value:function canMergeRange(newMergedCellInfo){var auto=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return auto?true:this.validateSetting(newMergedCellInfo);}},{key:"toggleMergeOnSelection",value:function toggleMergeOnSelection(){var currentRange=this.hot.getSelectedRangeLast();if(!currentRange){return;}
currentRange.setDirection('NW-SE');var from=currentRange.from,to=currentRange.to;this.toggleMerge(currentRange);this.hot.selectCell(from.row,from.col,to.row,to.col,false);}},{key:"mergeSelection",value:function mergeSelection(){var cellRange=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.hot.getSelectedRangeLast();if(!cellRange){return;}
cellRange.setDirection('NW-SE');var from=cellRange.from,to=cellRange.to;this.unmergeRange(cellRange,true);this.mergeRange(cellRange);this.hot.selectCell(from.row,from.col,to.row,to.col,false);}},{key:"unmergeSelection",value:function unmergeSelection(){var cellRange=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.hot.getSelectedRangeLast();if(!cellRange){return;}
var from=cellRange.from,to=cellRange.to;this.unmergeRange(cellRange,true);this.hot.selectCell(from.row,from.col,to.row,to.col,false);}},{key:"mergeRange",value:function mergeRange(cellRange){var _this4=this;var auto=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var preventPopulation=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var topLeft=cellRange.getTopLeftCorner();var bottomRight=cellRange.getBottomRightCorner();var mergeParent={row:topLeft.row,col:topLeft.col,rowspan:bottomRight.row-topLeft.row+1,colspan:bottomRight.col-topLeft.col+1};var clearedData=[];var populationInfo=null;if(!this.canMergeRange(mergeParent,auto)){return false;}
this.hot.runHooks('beforeMergeCells',cellRange,auto);(0,_number.rangeEach)(0,mergeParent.rowspan-1,function(i){(0,_number.rangeEach)(0,mergeParent.colspan-1,function(j){var clearedValue=null;if(!clearedData[i]){clearedData[i]=[];}
if(i===0&&j===0){clearedValue=_this4.hot.getDataAtCell(mergeParent.row,mergeParent.col);}else{_this4.hot.setCellMeta(mergeParent.row+i,mergeParent.col+j,'hidden',true);}
clearedData[i][j]=clearedValue;});});this.hot.setCellMeta(mergeParent.row,mergeParent.col,'spanned',true);var mergedCellAdded=this.mergedCellsCollection.add(mergeParent);if(mergedCellAdded){if(preventPopulation){populationInfo=[mergeParent.row,mergeParent.col,clearedData];}else{this.hot.populateFromArray(mergeParent.row,mergeParent.col,clearedData,void 0,void 0,this.pluginName);}
this.hot.runHooks('afterMergeCells',cellRange,mergeParent,auto);return populationInfo;}
return true;}},{key:"unmergeRange",value:function unmergeRange(cellRange){var _this5=this;var auto=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var mergedCells=this.mergedCellsCollection.getWithinRange(cellRange);if(!mergedCells){return;}
this.hot.runHooks('beforeUnmergeCells',cellRange,auto);(0,_array.arrayEach)(mergedCells,function(currentCollection){_this5.mergedCellsCollection.remove(currentCollection.row,currentCollection.col);(0,_number.rangeEach)(0,currentCollection.rowspan-1,function(i){(0,_number.rangeEach)(0,currentCollection.colspan-1,function(j){_this5.hot.removeCellMeta(currentCollection.row+i,currentCollection.col+j,'hidden');});});_this5.hot.removeCellMeta(currentCollection.row,currentCollection.col,'spanned');});this.hot.render();this.hot.runHooks('afterUnmergeCells',cellRange,auto);}},{key:"toggleMerge",value:function toggleMerge(cellRange){var mergedCell=this.mergedCellsCollection.get(cellRange.from.row,cellRange.from.col);var mergedCellCoversWholeRange=mergedCell.row===cellRange.from.row&&mergedCell.col===cellRange.from.col&&mergedCell.row+mergedCell.rowspan-1===cellRange.to.row&&mergedCell.col+mergedCell.colspan-1===cellRange.to.col;if(mergedCellCoversWholeRange){this.unmergeRange(cellRange);}else{this.mergeSelection(cellRange);}}},{key:"merge",value:function merge(startRow,startColumn,endRow,endColumn){var start=new _src.CellCoords(startRow,startColumn);var end=new _src.CellCoords(endRow,endColumn);this.mergeRange(new _src.CellRange(start,start,end));}},{key:"unmerge",value:function unmerge(startRow,startColumn,endRow,endColumn){var start=new _src.CellCoords(startRow,startColumn);var end=new _src.CellCoords(endRow,endColumn);this.unmergeRange(new _src.CellRange(start,start,end));}},{key:"onAfterInit",value:function onAfterInit(){this.generateFromSettings(this.hot.getSettings().mergeCells);this.hot.render();}},{key:"onBeforeKeyDown",value:function onBeforeKeyDown(event){var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(ctrlDown&&event.keyCode===77){this.toggleMerge(this.hot.getSelectedRangeLast());this.hot.render();(0,_event.stopImmediatePropagation)(event);}}},{key:"onAfterIsMultipleSelection",value:function onAfterIsMultipleSelection(isMultiple){if(isMultiple){var mergedCells=this.mergedCellsCollection.mergedCells;var selectionRange=this.hot.getSelectedRangeLast();for(var group=0;group<mergedCells.length;group+=1){if(selectionRange.highlight.row===mergedCells[group].row&&selectionRange.highlight.col===mergedCells[group].col&&selectionRange.to.row===mergedCells[group].row+mergedCells[group].rowspan-1&&selectionRange.to.col===mergedCells[group].col+mergedCells[group].colspan-1){return false;}}}
return isMultiple;}},{key:"onModifyTransformStart",value:function onModifyTransformStart(delta){var priv=privatePool.get(this);var currentlySelectedRange=this.hot.getSelectedRangeLast();var newDelta={row:delta.row,col:delta.col};var nextPosition=null;var currentPosition=new _src.CellCoords(currentlySelectedRange.highlight.row,currentlySelectedRange.highlight.col);var mergedParent=this.mergedCellsCollection.get(currentPosition.row,currentPosition.col);if(!priv.lastDesiredCoords){priv.lastDesiredCoords=new _src.CellCoords(null,null);}
if(mergedParent){var mergeTopLeft=new _src.CellCoords(mergedParent.row,mergedParent.col);var mergeBottomRight=new _src.CellCoords(mergedParent.row+mergedParent.rowspan-1,mergedParent.col+mergedParent.colspan-1);var mergeRange=new _src.CellRange(mergeTopLeft,mergeTopLeft,mergeBottomRight);if(!mergeRange.includes(priv.lastDesiredCoords)){priv.lastDesiredCoords=new _src.CellCoords(null,null);}
newDelta.row=priv.lastDesiredCoords.row?priv.lastDesiredCoords.row-currentPosition.row:newDelta.row;newDelta.col=priv.lastDesiredCoords.col?priv.lastDesiredCoords.col-currentPosition.col:newDelta.col;if(delta.row>0){newDelta.row=mergedParent.row+mergedParent.rowspan-1-currentPosition.row+delta.row;}else if(delta.row<0){newDelta.row=currentPosition.row-mergedParent.row+delta.row;}
if(delta.col>0){newDelta.col=mergedParent.col+mergedParent.colspan-1-currentPosition.col+delta.col;}else if(delta.col<0){newDelta.col=currentPosition.col-mergedParent.col+delta.col;}}
nextPosition=new _src.CellCoords(currentlySelectedRange.highlight.row+newDelta.row,currentlySelectedRange.highlight.col+newDelta.col);var nextParentIsMerged=this.mergedCellsCollection.get(nextPosition.row,nextPosition.col);if(nextParentIsMerged){priv.lastDesiredCoords=nextPosition;newDelta={row:nextParentIsMerged.row-currentPosition.row,col:nextParentIsMerged.col-currentPosition.col};}
if(newDelta.row!==0){delta.row=newDelta.row;}
if(newDelta.col!==0){delta.col=newDelta.col;}}},{key:"onModifyTransformEnd",value:function onModifyTransformEnd(delta){var _this6=this;var currentSelectionRange=this.hot.getSelectedRangeLast();var newDelta=(0,_object.clone)(delta);var newSelectionRange=this.selectionCalculations.getUpdatedSelectionRange(currentSelectionRange,delta);var tempDelta=(0,_object.clone)(newDelta);var mergedCellsWithinRange=this.mergedCellsCollection.getWithinRange(newSelectionRange,true);do{tempDelta=(0,_object.clone)(newDelta);this.selectionCalculations.getUpdatedSelectionRange(currentSelectionRange,newDelta);(0,_array.arrayEach)(mergedCellsWithinRange,function(mergedCell){_this6.selectionCalculations.snapDelta(newDelta,currentSelectionRange,mergedCell);});}while(newDelta.row!==tempDelta.row||newDelta.col!==tempDelta.col);delta.row=newDelta.row;delta.col=newDelta.col;}},{key:"onModifyGetCellCoords",value:function onModifyGetCellCoords(row,column){var mergeParent=this.mergedCellsCollection.get(row,column);return mergeParent?[mergeParent.row,mergeParent.col,mergeParent.row+mergeParent.rowspan-1,mergeParent.col+mergeParent.colspan-1]:void 0;}},{key:"addMergeActionsToContextMenu",value:function addMergeActionsToContextMenu(defaultOptions){defaultOptions.items.push({name:'---------'},(0,_toggleMerge.default)(this));}},{key:"onAfterRenderer",value:function onAfterRenderer(TD,row,col){var mergedCell=this.mergedCellsCollection.get(row,col);(0,_utils.applySpanProperties)(TD,mergedCell,row,col);}},{key:"onBeforeSetRangeEnd",value:function onBeforeSetRangeEnd(coords){var selRange=this.hot.getSelectedRangeLast();selRange.highlight=new _src.CellCoords(selRange.highlight.row,selRange.highlight.col);selRange.to=coords;var rangeExpanded=false;if(selRange.from.row===0&&selRange.to.row===this.hot.countRows()-1||selRange.from.col===0&&selRange.to.col===this.hot.countCols()-1){return;}
do{rangeExpanded=false;for(var i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1){var cellInfo=this.mergedCellsCollection.mergedCells[i];var mergedCellRange=cellInfo.getRange();if(selRange.expandByRange(mergedCellRange)){coords.row=selRange.to.row;coords.col=selRange.to.col;rangeExpanded=true;}}}while(rangeExpanded);}},{key:"onAfterGetCellMeta",value:function onAfterGetCellMeta(row,col,cellProperties){var mergeParent=this.mergedCellsCollection.get(row,col);if(mergeParent&&(mergeParent.row!==row||mergeParent.col!==col)){cellProperties.copyable=false;}}},{key:"onAfterViewportRowCalculatorOverride",value:function onAfterViewportRowCalculatorOverride(calc){var _this7=this;var colCount=this.hot.countCols();var mergeParent;(0,_number.rangeEach)(0,colCount-1,function(c){mergeParent=_this7.mergedCellsCollection.get(calc.startRow,c);if(mergeParent){if(mergeParent.row<calc.startRow){calc.startRow=mergeParent.row;return _this7.onAfterViewportRowCalculatorOverride.call(_this7,calc);}}
mergeParent=_this7.mergedCellsCollection.get(calc.endRow,c);if(mergeParent){var mergeEnd=mergeParent.row+mergeParent.rowspan-1;if(mergeEnd>calc.endRow){calc.endRow=mergeEnd;return _this7.onAfterViewportRowCalculatorOverride.call(_this7,calc);}}
return true;});}},{key:"onAfterViewportColumnCalculatorOverride",value:function onAfterViewportColumnCalculatorOverride(calc){var _this8=this;var rowCount=this.hot.countRows();var mergeParent;(0,_number.rangeEach)(0,rowCount-1,function(r){mergeParent=_this8.mergedCellsCollection.get(r,calc.startColumn);if(mergeParent&&mergeParent.col<calc.startColumn){calc.startColumn=mergeParent.col;return _this8.onAfterViewportColumnCalculatorOverride.call(_this8,calc);}
mergeParent=_this8.mergedCellsCollection.get(r,calc.endColumn);if(mergeParent){var mergeEnd=mergeParent.col+mergeParent.colspan-1;if(mergeEnd>calc.endColumn){calc.endColumn=mergeEnd;return _this8.onAfterViewportColumnCalculatorOverride.call(_this8,calc);}}
return true;});}},{key:"onModifyAutofillRange",value:function onModifyAutofillRange(drag,select){this.autofillCalculations.correctSelectionAreaSize(select);var dragDirection=this.autofillCalculations.getDirection(select,drag);var dragArea=drag;if(this.autofillCalculations.dragAreaOverlapsCollections(select,dragArea,dragDirection)){dragArea=select;return dragArea;}
var mergedCellsWithinSelectionArea=this.mergedCellsCollection.getWithinRange({from:{row:select[0],col:select[1]},to:{row:select[2],col:select[3]}});if(!mergedCellsWithinSelectionArea){return dragArea;}
dragArea=this.autofillCalculations.snapDragArea(select,dragArea,dragDirection,mergedCellsWithinSelectionArea);return dragArea;}},{key:"onAfterCreateCol",value:function onAfterCreateCol(column,count){this.mergedCellsCollection.shiftCollections('right',column,count);}},{key:"onAfterRemoveCol",value:function onAfterRemoveCol(column,count){this.mergedCellsCollection.shiftCollections('left',column,count);}},{key:"onAfterCreateRow",value:function onAfterCreateRow(row,count,source){if(source==='auto'){return;}
this.mergedCellsCollection.shiftCollections('down',row,count);}},{key:"onAfterRemoveRow",value:function onAfterRemoveRow(row,count){this.mergedCellsCollection.shiftCollections('up',row,count);}},{key:"onAfterChange",value:function onAfterChange(changes,source){if(source!=='Autofill.fill'){return;}
this.autofillCalculations.recreateAfterDataPopulation(changes);}},{key:"onBeforeDrawAreaBorders",value:function onBeforeDrawAreaBorders(corners,className){if(className&&className==='area'){var selectedRange=this.hot.getSelectedRangeLast();var mergedCellsWithinRange=this.mergedCellsCollection.getWithinRange(selectedRange);(0,_array.arrayEach)(mergedCellsWithinRange,function(mergedCell){if(selectedRange.getBottomRightCorner().row===mergedCell.getLastRow()&&selectedRange.getBottomRightCorner().col===mergedCell.getLastColumn()){corners[2]=mergedCell.row;corners[3]=mergedCell.col;}});}}},{key:"onAfterModifyTransformStart",value:function onAfterModifyTransformStart(coords,rowTransformDir,colTransformDir){if(!this.enabled){return;}
var mergedCellAtCoords=this.mergedCellsCollection.get(coords.row,coords.col);if(!mergedCellAtCoords){return;}
var goingDown=rowTransformDir>0;var goingUp=rowTransformDir<0;var goingLeft=colTransformDir<0;var goingRight=colTransformDir>0;var mergedCellOnBottomEdge=mergedCellAtCoords.row+mergedCellAtCoords.rowspan-1===this.hot.countRows()-1;var mergedCellOnTopEdge=mergedCellAtCoords.row===0;var mergedCellOnRightEdge=mergedCellAtCoords.col+mergedCellAtCoords.colspan-1===this.hot.countCols()-1;var mergedCellOnLeftEdge=mergedCellAtCoords.col===0;if(goingDown&&mergedCellOnBottomEdge||goingUp&&mergedCellOnTopEdge||goingRight&&mergedCellOnRightEdge||goingLeft&&mergedCellOnLeftEdge){coords.row=mergedCellAtCoords.row;coords.col=mergedCellAtCoords.col;}}},{key:"onAfterDrawSelection",value:function onAfterDrawSelection(currentRow,currentColumn,cornersOfSelection,layerLevel){return this.selectionCalculations.getSelectedMergedCellClassName(currentRow,currentColumn,cornersOfSelection,layerLevel);}},{key:"onBeforeRemoveCellClassNames",value:function onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove();}}]);return MergeCells;}(_base.default);(0,_plugins.registerPlugin)('mergeCells',MergeCells);var _default=MergeCells;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _cellCoords=_interopRequireDefault(__webpack_require__(128));var _index=__webpack_require__(8);var _number=__webpack_require__(9);var _console=__webpack_require__(76);var _array=__webpack_require__(3);var _utils=__webpack_require__(436);var _templateLiteralTag=__webpack_require__(58);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _templateObject(){var data=_taggedTemplateLiteral(["The merged cell declared at [",", ","], overlaps with the other declared merged \n    cell. The overlapping merged cell was not added to the table, please fix your setup."]);_templateObject=function _templateObject(){return data;};return data;}
function _taggedTemplateLiteral(strings,raw){if(!raw){raw=strings.slice(0);}return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}));}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var MergedCellsCollection=function(){function MergedCellsCollection(plugin){_classCallCheck(this,MergedCellsCollection);this.plugin=plugin;this.mergedCells=[];this.hot=plugin.hot;}
_createClass(MergedCellsCollection,[{key:"get",value:function get(row,column){var mergedCells=this.mergedCells;var result=false;(0,_array.arrayEach)(mergedCells,function(mergedCell){if(mergedCell.row<=row&&mergedCell.row+mergedCell.rowspan-1>=row&&mergedCell.col<=column&&mergedCell.col+mergedCell.colspan-1>=column){result=mergedCell;return false;}
return true;});return result;}},{key:"getByRange",value:function getByRange(range){var mergedCells=this.mergedCells;var result=false;(0,_array.arrayEach)(mergedCells,function(mergedCell){if(mergedCell.row<=range.from.row&&mergedCell.row+mergedCell.rowspan-1>=range.to.row&&mergedCell.col<=range.from.col&&mergedCell.col+mergedCell.colspan-1>=range.to.col){result=mergedCell;return result;}
return true;});return result;}},{key:"getWithinRange",value:function getWithinRange(range){var countPartials=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var mergedCells=this.mergedCells;var foundMergedCells=[];var testedRange=range;if(!testedRange.includesRange){var from=new _index.CellCoords(testedRange.from.row,testedRange.from.col);var to=new _index.CellCoords(testedRange.to.row,testedRange.to.col);testedRange=new _index.CellRange(from,from,to);}
(0,_array.arrayEach)(mergedCells,function(mergedCell){var mergedCellTopLeft=new _index.CellCoords(mergedCell.row,mergedCell.col);var mergedCellBottomRight=new _index.CellCoords(mergedCell.row+mergedCell.rowspan-1,mergedCell.col+mergedCell.colspan-1);var mergedCellRange=new _index.CellRange(mergedCellTopLeft,mergedCellTopLeft,mergedCellBottomRight);if(countPartials){if(testedRange.overlaps(mergedCellRange)){foundMergedCells.push(mergedCell);}}else if(testedRange.includesRange(mergedCellRange)){foundMergedCells.push(mergedCell);}});return foundMergedCells.length?foundMergedCells:false;}},{key:"add",value:function add(mergedCellInfo){var mergedCells=this.mergedCells;var row=mergedCellInfo.row;var column=mergedCellInfo.col;var rowspan=mergedCellInfo.rowspan;var colspan=mergedCellInfo.colspan;var newMergedCell=new _cellCoords.default(row,column,rowspan,colspan);var alreadyExists=this.get(row,column);var isOverlapping=this.isOverlapping(newMergedCell);if(!alreadyExists&&!isOverlapping){if(this.hot){newMergedCell.normalize(this.hot);}
mergedCells.push(newMergedCell);return newMergedCell;}
(0,_console.warn)(MergedCellsCollection.IS_OVERLAPPING_WARNING(newMergedCell));return false;}},{key:"remove",value:function remove(row,column){var mergedCells=this.mergedCells;var wantedCollection=this.get(row,column);var wantedCollectionIndex=wantedCollection?this.mergedCells.indexOf(wantedCollection):null;if(wantedCollection&&wantedCollectionIndex!==false){mergedCells.splice(wantedCollectionIndex,1);return wantedCollection;}
return false;}},{key:"clear",value:function clear(){var _this=this;var mergedCells=this.mergedCells;var mergedCellParentsToClear=[];var hiddenCollectionElements=[];(0,_array.arrayEach)(mergedCells,function(mergedCell){var TD=_this.hot.getCell(mergedCell.row,mergedCell.col);if(TD){mergedCellParentsToClear.push([TD,_this.get(mergedCell.row,mergedCell.col),mergedCell.row,mergedCell.col]);}});this.mergedCells.length=0;(0,_array.arrayEach)(mergedCellParentsToClear,function(mergedCell,i){(0,_number.rangeEach)(0,mergedCell.rowspan-1,function(j){(0,_number.rangeEach)(0,mergedCell.colspan-1,function(k){if(k!==0||j!==0){var TD=_this.hot.getCell(mergedCell.row+j,mergedCell.col+k);if(TD){hiddenCollectionElements.push([TD,null,null,null]);}}});});mergedCellParentsToClear[i][1]=null;});(0,_array.arrayEach)(mergedCellParentsToClear,function(mergedCellParents){_utils.applySpanProperties.apply(void 0,_toConsumableArray(mergedCellParents));});(0,_array.arrayEach)(hiddenCollectionElements,function(hiddenCollectionElement){_utils.applySpanProperties.apply(void 0,_toConsumableArray(hiddenCollectionElement));});}},{key:"isOverlapping",value:function isOverlapping(mergedCell){var mergedCellRange=new _index.CellRange(null,new _index.CellCoords(mergedCell.row,mergedCell.col),new _index.CellCoords(mergedCell.row+mergedCell.rowspan-1,mergedCell.col+mergedCell.colspan-1));var result=false;(0,_array.arrayEach)(this.mergedCells,function(col){var currentRange=new _index.CellRange(null,new _index.CellCoords(col.row,col.col),new _index.CellCoords(col.row+col.rowspan-1,col.col+col.colspan-1));if(currentRange.overlaps(mergedCellRange)){result=true;return false;}
return true;});return result;}},{key:"isMergedParent",value:function isMergedParent(row,column){var mergedCells=this.mergedCells;var result=false;(0,_array.arrayEach)(mergedCells,function(mergedCell){if(mergedCell.row===row&&mergedCell.col===column){result=true;return false;}
return true;});return result;}},{key:"shiftCollections",value:function shiftCollections(direction,index,count){var _this2=this;var shiftVector=[0,0];switch(direction){case'right':shiftVector[0]+=count;break;case'left':shiftVector[0]-=count;break;case'down':shiftVector[1]+=count;break;case'up':shiftVector[1]-=count;break;default:}
(0,_array.arrayEach)(this.mergedCells,function(currentMerge){currentMerge.shift(shiftVector,index);});(0,_number.rangeEachReverse)(this.mergedCells.length-1,0,function(i){var currentMerge=_this2.mergedCells[i];if(currentMerge&&currentMerge.removed){_this2.mergedCells.splice(_this2.mergedCells.indexOf(currentMerge),1);}});}}],[{key:"IS_OVERLAPPING_WARNING",value:function IS_OVERLAPPING_WARNING(newMergedCell){return(0,_templateLiteralTag.toSingleLine)(_templateObject(),newMergedCell.row,newMergedCell.col);}}]);return MergedCellsCollection;}();var _default=MergedCellsCollection;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _object=__webpack_require__(2);var _src=__webpack_require__(8);var _array=__webpack_require__(3);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var AutofillCalculations=function(){function AutofillCalculations(plugin){_classCallCheck(this,AutofillCalculations);this.plugin=plugin;this.mergedCellsCollection=this.plugin.mergedCellsCollection;this.currentFillData=null;}
_createClass(AutofillCalculations,[{key:"correctSelectionAreaSize",value:function correctSelectionAreaSize(selectionArea){if(selectionArea[0]===selectionArea[2]&&selectionArea[1]===selectionArea[3]){var mergedCell=this.mergedCellsCollection.get(selectionArea[0],selectionArea[1]);if(mergedCell){selectionArea[2]=selectionArea[0]+mergedCell.rowspan-1;selectionArea[3]=selectionArea[1]+mergedCell.colspan-1;}}}},{key:"getDirection",value:function getDirection(selectionArea,finalArea){var direction=null;if(finalArea[0]===selectionArea[0]&&finalArea[1]===selectionArea[1]&&finalArea[3]===selectionArea[3]){direction='down';}else if(finalArea[2]===selectionArea[2]&&finalArea[1]===selectionArea[1]&&finalArea[3]===selectionArea[3]){direction='up';}else if(finalArea[1]===selectionArea[1]&&finalArea[2]===selectionArea[2]){direction='right';}else{direction='left';}
return direction;}},{key:"snapDragArea",value:function snapDragArea(baseArea,dragArea,dragDirection,foundMergedCells){var newDragArea=dragArea.slice(0);var fillSize=this.getAutofillSize(baseArea,dragArea,dragDirection);var _baseArea=_slicedToArray(baseArea,4),baseAreaStartRow=_baseArea[0],baseAreaStartColumn=_baseArea[1],baseAreaEndRow=_baseArea[2],baseAreaEndColumn=_baseArea[3];var verticalDirection=['up','down'].indexOf(dragDirection)>-1;var fullCycle=verticalDirection?baseAreaEndRow-baseAreaStartRow+1:baseAreaEndColumn-baseAreaStartColumn+1;var fulls=Math.floor(fillSize/fullCycle)*fullCycle;var partials=fillSize-fulls;var farthestCollection=this.getFarthestCollection(baseArea,dragArea,dragDirection,foundMergedCells);if(farthestCollection){if(dragDirection==='down'){var fill=farthestCollection.row+farthestCollection.rowspan-baseAreaStartRow-partials;var newLimit=newDragArea[2]+fill;if(newLimit>=this.plugin.hot.countRows()){newDragArea[2]-=partials;}else{newDragArea[2]+=partials?fill:0;}}else if(dragDirection==='right'){var _fill=farthestCollection.col+farthestCollection.colspan-baseAreaStartColumn-partials;var _newLimit=newDragArea[3]+_fill;if(_newLimit>=this.plugin.hot.countCols()){newDragArea[3]-=partials;}else{newDragArea[3]+=partials?_fill:0;}}else if(dragDirection==='up'){var _fill2=baseAreaEndRow-partials-farthestCollection.row+1;var _newLimit2=newDragArea[0]+_fill2;if(_newLimit2<0){newDragArea[0]+=partials;}else{newDragArea[0]-=partials?_fill2:0;}}else if(dragDirection==='left'){var _fill3=baseAreaEndColumn-partials-farthestCollection.col+1;var _newLimit3=newDragArea[1]+_fill3;if(_newLimit3<0){newDragArea[1]+=partials;}else{newDragArea[1]-=partials?_fill3:0;}}}
this.updateCurrentFillCache({baseArea:baseArea,dragDirection:dragDirection,foundMergedCells:foundMergedCells,fillSize:fillSize,dragArea:newDragArea,cycleLength:fullCycle});return newDragArea;}},{key:"updateCurrentFillCache",value:function updateCurrentFillCache(updateObject){if(!this.currentFillData){this.currentFillData={};}
(0,_object.extend)(this.currentFillData,updateObject);}},{key:"getAutofillSize",value:function getAutofillSize(baseArea,dragArea,direction){var _baseArea2=_slicedToArray(baseArea,4),baseAreaStartRow=_baseArea2[0],baseAreaStartColumn=_baseArea2[1],baseAreaEndRow=_baseArea2[2],baseAreaEndColumn=_baseArea2[3];var _dragArea=_slicedToArray(dragArea,4),dragAreaStartRow=_dragArea[0],dragAreaStartColumn=_dragArea[1],dragAreaEndRow=_dragArea[2],dragAreaEndColumn=_dragArea[3];switch(direction){case'up':return baseAreaStartRow-dragAreaStartRow;case'down':return dragAreaEndRow-baseAreaEndRow;case'left':return baseAreaStartColumn-dragAreaStartColumn;case'right':return dragAreaEndColumn-baseAreaEndColumn;default:return null;}}},{key:"getDragArea",value:function getDragArea(baseArea,dragArea,direction){var _baseArea3=_slicedToArray(baseArea,4),baseAreaStartRow=_baseArea3[0],baseAreaStartColumn=_baseArea3[1],baseAreaEndRow=_baseArea3[2],baseAreaEndColumn=_baseArea3[3];var _dragArea2=_slicedToArray(dragArea,4),dragAreaStartRow=_dragArea2[0],dragAreaStartColumn=_dragArea2[1],dragAreaEndRow=_dragArea2[2],dragAreaEndColumn=_dragArea2[3];switch(direction){case'up':return[dragAreaStartRow,dragAreaStartColumn,baseAreaStartRow-1,baseAreaEndColumn];case'down':return[baseAreaEndRow+1,baseAreaStartColumn,dragAreaEndRow,baseAreaEndColumn];case'left':return[dragAreaStartRow,dragAreaStartColumn,baseAreaEndRow,baseAreaStartColumn-1];case'right':return[baseAreaStartRow,baseAreaEndColumn+1,dragAreaEndRow,dragAreaEndColumn];default:return null;}}},{key:"getFarthestCollection",value:function getFarthestCollection(baseArea,dragArea,direction,mergedCellArray){var _baseArea4=_slicedToArray(baseArea,4),baseAreaStartRow=_baseArea4[0],baseAreaStartColumn=_baseArea4[1],baseAreaEndRow=_baseArea4[2],baseAreaEndColumn=_baseArea4[3];var verticalDirection=['up','down'].indexOf(direction)>-1;var baseEnd=verticalDirection?baseAreaEndRow:baseAreaEndColumn;var baseStart=verticalDirection?baseAreaStartRow:baseAreaStartColumn;var fillSize=this.getAutofillSize(baseArea,dragArea,direction);var fullCycle=verticalDirection?baseAreaEndRow-baseAreaStartRow+1:baseAreaEndColumn-baseAreaStartColumn+1;var fulls=Math.floor(fillSize/fullCycle)*fullCycle;var partials=fillSize-fulls;var inclusionFunctionName=null;var farthestCollection=null;var endOfDragRecreationIndex=null;switch(direction){case'up':inclusionFunctionName='includesVertically';endOfDragRecreationIndex=baseEnd-partials+1;break;case'left':inclusionFunctionName='includesHorizontally';endOfDragRecreationIndex=baseEnd-partials+1;break;case'down':inclusionFunctionName='includesVertically';endOfDragRecreationIndex=baseStart+partials-1;break;case'right':inclusionFunctionName='includesHorizontally';endOfDragRecreationIndex=baseStart+partials-1;break;default:}
(0,_array.arrayEach)(mergedCellArray,function(currentCollection){if(currentCollection[inclusionFunctionName](endOfDragRecreationIndex)&&currentCollection.isFarther(farthestCollection,direction)){farthestCollection=currentCollection;}});return farthestCollection;}},{key:"recreateAfterDataPopulation",value:function recreateAfterDataPopulation(changes){if(!this.currentFillData){return;}
var fillRange=this.getRangeFromChanges(changes);var foundMergedCells=this.currentFillData.foundMergedCells;var dragDirection=this.currentFillData.dragDirection;var inBounds=function inBounds(current,offset){switch(dragDirection){case'up':return current.row-offset>=fillRange.from.row;case'down':return current.row+current.rowspan-1+offset<=fillRange.to.row;case'left':return current.col-offset>=fillRange.from.column;case'right':return current.col+current.colspan-1+offset<=fillRange.to.column;default:return null;}};var fillOffset=0;var current=null;var multiplier=1;do{for(var j=0;j<foundMergedCells.length;j+=1){current=foundMergedCells[j];fillOffset=multiplier*this.currentFillData.cycleLength;if(inBounds(current,fillOffset)){switch(dragDirection){case'up':this.plugin.mergedCellsCollection.add({row:current.row-fillOffset,rowspan:current.rowspan,col:current.col,colspan:current.colspan});break;case'down':this.plugin.mergedCellsCollection.add({row:current.row+fillOffset,rowspan:current.rowspan,col:current.col,colspan:current.colspan});break;case'left':this.plugin.mergedCellsCollection.add({row:current.row,rowspan:current.rowspan,col:current.col-fillOffset,colspan:current.colspan});break;case'right':this.plugin.mergedCellsCollection.add({row:current.row,rowspan:current.rowspan,col:current.col+fillOffset,colspan:current.colspan});break;default:}}
if(j===foundMergedCells.length-1){multiplier+=1;}}}while(inBounds(current,fillOffset));this.currentFillData=null;this.plugin.hot.render();}},{key:"getRangeFromChanges",value:function getRangeFromChanges(changes){var _this=this;var rows={min:null,max:null};var columns={min:null,max:null};(0,_array.arrayEach)(changes,function(change){var rowIndex=change[0];var columnIndex=_this.plugin.hot.propToCol(change[1]);if(rows.min===null||rowIndex<rows.min){rows.min=rowIndex;}
if(rows.max===null||rowIndex>rows.max){rows.max=rowIndex;}
if(columns.min===null||columnIndex<columns.min){columns.min=columnIndex;}
if(columns.max===null||columnIndex>columns.max){columns.max=columnIndex;}});return{from:{row:rows.min,column:columns.min},to:{row:rows.max,column:columns.max}};}},{key:"dragAreaOverlapsCollections",value:function dragAreaOverlapsCollections(baseArea,fullArea,direction){var dragArea=this.getDragArea(baseArea,fullArea,direction);var _dragArea3=_slicedToArray(dragArea,4),dragAreaStartRow=_dragArea3[0],dragAreaStartColumn=_dragArea3[1],dragAreaEndRow=_dragArea3[2],dragAreaEndColumn=_dragArea3[3];var topLeft=new _src.CellCoords(dragAreaStartRow,dragAreaStartColumn);var bottomRight=new _src.CellCoords(dragAreaEndRow,dragAreaEndColumn);var dragRange=new _src.CellRange(topLeft,topLeft,bottomRight);return!!this.mergedCellsCollection.getWithinRange(dragRange,true);}}]);return AutofillCalculations;}();var _default=AutofillCalculations;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _src=__webpack_require__(8);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var SelectionCalculations=function(){function SelectionCalculations(plugin){_classCallCheck(this,SelectionCalculations);this.plugin=plugin;this.fullySelectedMergedCellClassName='fullySelectedMergedCell';}
_createClass(SelectionCalculations,[{key:"snapDelta",value:function snapDelta(delta,selectionRange,mergedCell){var cellCoords=selectionRange.to;var newRow=cellCoords.row+delta.row;var newColumn=cellCoords.col+delta.col;if(delta.row){this.jumpOverMergedCell(delta,mergedCell,newRow);}else if(delta.col){this.jumpOverMergedCell(delta,mergedCell,newColumn);}}},{key:"jumpOverMergedCell",value:function jumpOverMergedCell(delta,mergedCell,newIndex){var flatDelta=delta.row||delta.col;var includesIndex=null;var firstIndex=null;var lastIndex=null;if(delta.row){includesIndex=mergedCell.includesVertically(newIndex);firstIndex=mergedCell.row;lastIndex=mergedCell.getLastRow();}else if(delta.col){includesIndex=mergedCell.includesHorizontally(newIndex);firstIndex=mergedCell.col;lastIndex=mergedCell.getLastColumn();}
if(flatDelta===0){return;}else if(flatDelta>0){if(includesIndex&&newIndex!==firstIndex){flatDelta+=lastIndex-newIndex+1;}}else if(includesIndex&&newIndex!==lastIndex){flatDelta-=newIndex-firstIndex+1;}
if(delta.row){delta.row=flatDelta;}else if(delta.col){delta.col=flatDelta;}}},{key:"getUpdatedSelectionRange",value:function getUpdatedSelectionRange(oldSelectionRange,delta){return new _src.CellRange(oldSelectionRange.highlight,oldSelectionRange.from,new _src.CellCoords(oldSelectionRange.to.row+delta.row,oldSelectionRange.to.col+delta.col));}},{key:"getSelectedMergedCellClassName",value:function getSelectedMergedCellClassName(currentRow,currentColumn,cornersOfSelection,layerLevel){var _cornersOfSelection=_slicedToArray(cornersOfSelection,4),startRow=_cornersOfSelection[0],startColumn=_cornersOfSelection[1],endRow=_cornersOfSelection[2],endColumn=_cornersOfSelection[3];if(layerLevel===void 0){return;}
if(currentRow>=startRow&&currentRow<=endRow&&currentColumn>=startColumn&&currentColumn<=endColumn){var isMergedCellParent=this.plugin.mergedCellsCollection.isMergedParent(currentRow,currentColumn);if(!isMergedCellParent){return;}
var mergedCell=this.plugin.mergedCellsCollection.get(currentRow,currentColumn);if(!mergedCell){return;}
if(mergedCell.row+mergedCell.rowspan-1<=endRow&&mergedCell.col+mergedCell.colspan-1<=endColumn){return"".concat(this.fullySelectedMergedCellClassName,"-").concat(layerLevel);}else if(this.plugin.selectionCalculations.isMergeCellFullySelected(mergedCell,this.plugin.hot.getSelectedRange())){return"".concat(this.fullySelectedMergedCellClassName,"-multiple");}}}},{key:"isMergeCellFullySelected",value:function isMergeCellFullySelected(mergedCell,selectionRangesArray){var mergedCellIndividualCoords=[];if(!selectionRangesArray||!mergedCell){return false;}
for(var r=0;r<mergedCell.rowspan;r+=1){for(var c=0;c<mergedCell.colspan;c+=1){mergedCellIndividualCoords.push(new _src.CellCoords(mergedCell.row+r,mergedCell.col+c));}}
for(var i=0;i<mergedCellIndividualCoords.length;i+=1){var insideSelections=[];for(var s=0;s<selectionRangesArray.length;s+=1){insideSelections[s]=selectionRangesArray[s].includes(mergedCellIndividualCoords[i]);}
if(!insideSelections.includes(true)){return false;}}
return true;}},{key:"getSelectedMergedCellClassNameToRemove",value:function getSelectedMergedCellClassNameToRemove(){var classNames=[];for(var i=0;i<=7;i+=1){classNames.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(i));}
classNames.push("".concat(this.fullySelectedMergedCellClassName,"-multiple"));return classNames;}}]);return SelectionCalculations;}();var _default=SelectionCalculations;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=toggleMergeItem;var C=_interopRequireWildcard(__webpack_require__(11));var _cellCoords=_interopRequireDefault(__webpack_require__(128));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}}newObj.default=obj;return newObj;}}
function toggleMergeItem(plugin){return{key:'mergeCells',name:function name(){var sel=this.getSelectedLast();if(sel){var info=plugin.mergedCellsCollection.get(sel[0],sel[1]);if(info.row===sel[0]&&info.col===sel[1]&&info.row+info.rowspan-1===sel[2]&&info.col+info.colspan-1===sel[3]){return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_UNMERGE_CELLS);}}
return this.getTranslatedPhrase(C.CONTEXTMENU_ITEMS_MERGE_CELLS);},callback:function callback(){plugin.toggleMergeOnSelection();},disabled:function disabled(){var sel=this.getSelectedLast();if(!sel){return true;}
var isSingleCell=_cellCoords.default.isSingleCell({row:sel[0],col:sel[1],rowspan:sel[2]-sel[0]+1,colspan:sel[3]-sel[1]+1});return isSingleCell||this.selection.isSelectedByCorner();},hidden:false};}}),(function(module,exports){}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _browser=__webpack_require__(42);var _base=_interopRequireDefault(__webpack_require__(15));var _eventManager=_interopRequireDefault(__webpack_require__(10));var _plugins=__webpack_require__(13);var _src=__webpack_require__(8);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var MultipleSelectionHandles=function(_BasePlugin){_inherits(MultipleSelectionHandles,_BasePlugin);function MultipleSelectionHandles(hotInstance){var _this2;_classCallCheck(this,MultipleSelectionHandles);_this2=_possibleConstructorReturn(this,_getPrototypeOf(MultipleSelectionHandles).call(this,hotInstance));_this2.dragged=[];_this2.eventManager=null;_this2.lastSetCell=null;return _this2;}
_createClass(MultipleSelectionHandles,[{key:"isEnabled",value:function isEnabled(){return(0,_browser.isMobileBrowser)();}},{key:"enablePlugin",value:function enablePlugin(){if(this.enabled){return;}
if(!this.eventManager){this.eventManager=new _eventManager.default(this);}
this.registerListeners();_get(_getPrototypeOf(MultipleSelectionHandles.prototype),"enablePlugin",this).call(this);}},{key:"registerListeners",value:function registerListeners(){var _this=this;function removeFromDragged(query){if(_this.dragged.length===1){_this.dragged.splice(0,_this.dragged.length);return true;}
var entryPosition=_this.dragged.indexOf(query);if(entryPosition===-1){return false;}else if(entryPosition===0){_this.dragged=_this.dragged.slice(0,1);}else if(entryPosition===1){_this.dragged=_this.dragged.slice(-1);}}
this.eventManager.addEventListener(this.hot.rootElement,'touchstart',function(event){var selectedRange;if((0,_element.hasClass)(event.target,'topLeftSelectionHandle-HitArea')){selectedRange=_this.hot.getSelectedRangeLast();_this.dragged.push('topLeft');_this.touchStartRange={width:selectedRange.getWidth(),height:selectedRange.getHeight(),direction:selectedRange.getDirection()};event.preventDefault();return false;}else if((0,_element.hasClass)(event.target,'bottomRightSelectionHandle-HitArea')){selectedRange=_this.hot.getSelectedRangeLast();_this.dragged.push('bottomRight');_this.touchStartRange={width:selectedRange.getWidth(),height:selectedRange.getHeight(),direction:selectedRange.getDirection()};event.preventDefault();return false;}});this.eventManager.addEventListener(this.hot.rootElement,'touchend',function(event){if((0,_element.hasClass)(event.target,'topLeftSelectionHandle-HitArea')){removeFromDragged.call(_this,'topLeft');_this.touchStartRange=void 0;event.preventDefault();return false;}else if((0,_element.hasClass)(event.target,'bottomRightSelectionHandle-HitArea')){removeFromDragged.call(_this,'bottomRight');_this.touchStartRange=void 0;event.preventDefault();return false;}});this.eventManager.addEventListener(this.hot.rootElement,'touchmove',function(event){var scrollTop=(0,_element.getWindowScrollTop)();var scrollLeft=(0,_element.getWindowScrollLeft)();var targetCoords;var selectedRange;var rangeWidth;var rangeHeight;var rangeDirection;var newRangeCoords;if(_this.dragged.length===0){return;}
var endTarget=document.elementFromPoint(event.touches[0].screenX-scrollLeft,event.touches[0].screenY-scrollTop);if(!endTarget||endTarget===_this.lastSetCell){return;}
if(endTarget.nodeName==='TD'||endTarget.nodeName==='TH'){targetCoords=_this.hot.getCoords(endTarget);if(targetCoords.col===-1){targetCoords.col=0;}
selectedRange=_this.hot.getSelectedRangeLast();rangeWidth=selectedRange.getWidth();rangeHeight=selectedRange.getHeight();rangeDirection=selectedRange.getDirection();if(rangeWidth===1&&rangeHeight===1){_this.hot.selection.setRangeEnd(targetCoords);}
newRangeCoords=_this.getCurrentRangeCoords(selectedRange,targetCoords,_this.touchStartRange.direction,rangeDirection,_this.dragged[0]);if(newRangeCoords.start!==null){_this.hot.selection.setRangeStart(newRangeCoords.start);}
_this.hot.selection.setRangeEnd(newRangeCoords.end);_this.lastSetCell=endTarget;}
event.preventDefault();});}},{key:"getCurrentRangeCoords",value:function getCurrentRangeCoords(selectedRange,currentTouch,touchStartDirection,currentDirection,draggedHandle){var topLeftCorner=selectedRange.getTopLeftCorner();var bottomRightCorner=selectedRange.getBottomRightCorner();var bottomLeftCorner=selectedRange.getBottomLeftCorner();var topRightCorner=selectedRange.getTopRightCorner();var newCoords={start:null,end:null};switch(touchStartDirection){case'NE-SW':switch(currentDirection){case'NE-SW':case'NW-SE':if(draggedHandle==='topLeft'){newCoords={start:new _src.CellCoords(currentTouch.row,selectedRange.highlight.col),end:new _src.CellCoords(bottomLeftCorner.row,currentTouch.col)};}else{newCoords={start:new _src.CellCoords(selectedRange.highlight.row,currentTouch.col),end:new _src.CellCoords(currentTouch.row,topLeftCorner.col)};}
break;case'SE-NW':if(draggedHandle==='bottomRight'){newCoords={start:new _src.CellCoords(bottomRightCorner.row,currentTouch.col),end:new _src.CellCoords(currentTouch.row,topLeftCorner.col)};}
break;default:break;}
break;case'NW-SE':switch(currentDirection){case'NE-SW':if(draggedHandle==='topLeft'){newCoords={start:currentTouch,end:bottomLeftCorner};}else{newCoords.end=currentTouch;}
break;case'NW-SE':if(draggedHandle==='topLeft'){newCoords={start:currentTouch,end:bottomRightCorner};}else{newCoords.end=currentTouch;}
break;case'SE-NW':if(draggedHandle==='topLeft'){newCoords={start:currentTouch,end:topLeftCorner};}else{newCoords.end=currentTouch;}
break;case'SW-NE':if(draggedHandle==='topLeft'){newCoords={start:currentTouch,end:topRightCorner};}else{newCoords.end=currentTouch;}
break;default:break;}
break;case'SW-NE':switch(currentDirection){case'NW-SE':if(draggedHandle==='bottomRight'){newCoords={start:new _src.CellCoords(currentTouch.row,topLeftCorner.col),end:new _src.CellCoords(bottomLeftCorner.row,currentTouch.col)};}else{newCoords={start:new _src.CellCoords(topLeftCorner.row,currentTouch.col),end:new _src.CellCoords(currentTouch.row,bottomRightCorner.col)};}
break;case'SW-NE':if(draggedHandle==='topLeft'){newCoords={start:new _src.CellCoords(selectedRange.highlight.row,currentTouch.col),end:new _src.CellCoords(currentTouch.row,bottomRightCorner.col)};}else{newCoords={start:new _src.CellCoords(currentTouch.row,topLeftCorner.col),end:new _src.CellCoords(topLeftCorner.row,currentTouch.col)};}
break;case'SE-NW':if(draggedHandle==='bottomRight'){newCoords={start:new _src.CellCoords(currentTouch.row,topRightCorner.col),end:new _src.CellCoords(topLeftCorner.row,currentTouch.col)};}else if(draggedHandle==='topLeft'){newCoords={start:bottomLeftCorner,end:currentTouch};}
break;default:break;}
break;case'SE-NW':switch(currentDirection){case'NW-SE':case'NE-SW':case'SW-NE':if(draggedHandle==='topLeft'){newCoords.end=currentTouch;}
break;case'SE-NW':if(draggedHandle==='topLeft'){newCoords.end=currentTouch;}else{newCoords={start:currentTouch,end:topLeftCorner};}
break;default:break;}
break;default:break;}
return newCoords;}},{key:"isDragged",value:function isDragged(){return this.dragged.length>0;}}]);return MultipleSelectionHandles;}(_base.default);(0,_plugins.registerPlugin)('multipleSelectionHandles',MultipleSelectionHandles);var _default=MultipleSelectionHandles;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _dataObserver=_interopRequireDefault(__webpack_require__(743));var _array=__webpack_require__(3);var _plugins=__webpack_require__(13);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var ObserveChanges=function(_BasePlugin){_inherits(ObserveChanges,_BasePlugin);function ObserveChanges(hotInstance){var _this;_classCallCheck(this,ObserveChanges);_this=_possibleConstructorReturn(this,_getPrototypeOf(ObserveChanges).call(this,hotInstance));_this.observer=null;return _this;}
_createClass(ObserveChanges,[{key:"isEnabled",value:function isEnabled(){return this.hot.getSettings().observeChanges;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
if(!this.observer){this.observer=new _dataObserver.default(this.hot.getSourceData());this._exposePublicApi();}
this.observer.addLocalHook('change',function(patches){return _this2.onDataChange(patches);});this.addHook('afterCreateRow',function(){return _this2.onAfterTableAlter();});this.addHook('afterRemoveRow',function(){return _this2.onAfterTableAlter();});this.addHook('afterCreateCol',function(){return _this2.onAfterTableAlter();});this.addHook('afterRemoveCol',function(){return _this2.onAfterTableAlter();});this.addHook('afterChange',function(changes,source){return _this2.onAfterTableAlter(source);});this.addHook('afterLoadData',function(firstRun){return _this2.onAfterLoadData(firstRun);});_get(_getPrototypeOf(ObserveChanges.prototype),"enablePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){if(this.observer){this.observer.destroy();this.observer=null;this._deletePublicApi();}
_get(_getPrototypeOf(ObserveChanges.prototype),"disablePlugin",this).call(this);}},{key:"onDataChange",value:function onDataChange(patches){var _this3=this;if(!this.observer.isPaused()){var sourceName="".concat(this.pluginName,".change");var actions={add:function add(patch){if(isNaN(patch.col)){_this3.hot.runHooks('afterCreateRow',patch.row,1,sourceName);}else{_this3.hot.runHooks('afterCreateCol',patch.col,1,sourceName);}},remove:function remove(patch){if(isNaN(patch.col)){_this3.hot.runHooks('afterRemoveRow',patch.row,1,sourceName);}else{_this3.hot.runHooks('afterRemoveCol',patch.col,1,sourceName);}},replace:function replace(patch){_this3.hot.runHooks('afterChange',[[patch.row,patch.col,null,patch.value]],sourceName);}};(0,_array.arrayEach)(patches,function(patch){if(actions[patch.op]){actions[patch.op](patch);}});this.hot.render();}
this.hot.runHooks('afterChangesObserved');}},{key:"onAfterTableAlter",value:function onAfterTableAlter(source){var _this4=this;if(source!=='loadData'){this.observer.pause();this.hot.addHookOnce('afterChangesObserved',function(){return _this4.observer.resume();});}}},{key:"onAfterLoadData",value:function onAfterLoadData(firstRun){if(!firstRun){this.observer.setObservedData(this.hot.getSourceData());}}},{key:"destroy",value:function destroy(){if(this.observer){this.observer.destroy();this._deletePublicApi();}
_get(_getPrototypeOf(ObserveChanges.prototype),"destroy",this).call(this);}},{key:"_exposePublicApi",value:function _exposePublicApi(){var _this5=this;var hot=this.hot;hot.pauseObservingChanges=function(){return _this5.observer.pause();};hot.resumeObservingChanges=function(){return _this5.observer.resume();};hot.isPausedObservingChanges=function(){return _this5.observer.isPaused();};}},{key:"_deletePublicApi",value:function _deletePublicApi(){var hot=this.hot;delete hot.pauseObservingChanges;delete hot.resumeObservingChanges;delete hot.isPausedObservingChanges;}}]);return ObserveChanges;}(_base.default);var _default=ObserveChanges;exports.default=_default;(0,_plugins.registerPlugin)('observeChanges',ObserveChanges);}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _jsonPatchDuplex=_interopRequireDefault(__webpack_require__(744));var _localHooks=_interopRequireDefault(__webpack_require__(68));var _object=__webpack_require__(2);var _utils=__webpack_require__(745);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
var DataObserver=function(){function DataObserver(observedData){_classCallCheck(this,DataObserver);this.observedData=null;this.observer=null;this.paused=false;this.setObservedData(observedData);}
_createClass(DataObserver,[{key:"setObservedData",value:function setObservedData(observedData){var _this=this;if(this.observer){_jsonPatchDuplex.default.unobserve(this.observedData,this.observer);}
this.observedData=observedData;this.observer=_jsonPatchDuplex.default.observe(this.observedData,function(patches){return _this.onChange(patches);});}},{key:"isPaused",value:function isPaused(){return this.paused;}},{key:"pause",value:function pause(){this.paused=true;}},{key:"resume",value:function resume(){this.paused=false;}},{key:"onChange",value:function onChange(patches){this.runLocalHooks('change',(0,_utils.cleanPatches)(patches));}},{key:"destroy",value:function destroy(){_jsonPatchDuplex.default.unobserve(this.observedData,this.observer);this.observedData=null;this.observer=null;}}]);return DataObserver;}();(0,_object.mixin)(DataObserver,_localHooks.default);var _default=DataObserver;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
var __extends=void 0&&(void 0).__extends||function(d,b){for(var p in b){if(b.hasOwnProperty(p))d[p]=b[p];}
function __(){this.constructor=d;}
d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __());};var OriginalError=Error;var jsonpatch;(function(jsonpatch){var _objectKeys=function _objectKeys(obj){if(_isArray(obj)){var keys=new Array(obj.length);for(var k=0;k<keys.length;k++){keys[k]=""+k;}
return keys;}
if(Object.keys){return Object.keys(obj);}
var keys=[];for(var i in obj){if(obj.hasOwnProperty(i)){keys.push(i);}}
return keys;};function _equals(a,b){switch(_typeof(a)){case'undefined':case'boolean':case'string':case'number':return a===b;case'object':if(a===null)return b===null;if(_isArray(a)){if(!_isArray(b)||a.length!==b.length)return false;for(var i=0,l=a.length;i<l;i++){if(!_equals(a[i],b[i]))return false;}
return true;}
var bKeys=_objectKeys(b);var bLength=bKeys.length;if(_objectKeys(a).length!==bLength)return false;for(var i=0;i<bLength;i++){if(!_equals(a[i],b[i]))return false;}
return true;default:return false;}}
var objOps={add:function add(obj,key){obj[key]=this.value;return true;},remove:function remove(obj,key){delete obj[key];return true;},replace:function replace(obj,key){obj[key]=this.value;return true;},move:function move(obj,key,tree){var temp={op:"_get",path:this.from};apply(tree,[temp]);apply(tree,[{op:"remove",path:this.from}]);apply(tree,[{op:"add",path:this.path,value:temp.value}]);return true;},copy:function copy(obj,key,tree){var temp={op:"_get",path:this.from};apply(tree,[temp]);apply(tree,[{op:"add",path:this.path,value:temp.value}]);return true;},test:function test(obj,key){return _equals(obj[key],this.value);},_get:function _get(obj,key){this.value=obj[key];}};var arrOps={add:function add(arr,i){arr.splice(i,0,this.value);return true;},remove:function remove(arr,i){arr.splice(i,1);return true;},replace:function replace(arr,i){arr[i]=this.value;return true;},move:objOps.move,copy:objOps.copy,test:objOps.test,_get:objOps._get};var rootOps={add:function add(obj){rootOps.remove.call(this,obj);for(var key in this.value){if(this.value.hasOwnProperty(key)){obj[key]=this.value[key];}}
return true;},remove:function remove(obj){for(var key in obj){if(obj.hasOwnProperty(key)){objOps.remove.call(this,obj,key);}}
return true;},replace:function replace(obj){apply(obj,[{op:"remove",path:this.path}]);apply(obj,[{op:"add",path:this.path,value:this.value}]);return true;},move:objOps.move,copy:objOps.copy,test:function test(obj){return JSON.stringify(obj)===JSON.stringify(this.value);},_get:function _get(obj){this.value=obj;}};var observeOps={add:function add(patches,path){var patch={op:"add",path:path+escapePathComponent(this.name),value:this.object[this.name]};patches.push(patch);},'delete':function _delete(patches,path){var patch={op:"remove",path:path+escapePathComponent(this.name)};patches.push(patch);},update:function update(patches,path){var patch={op:"replace",path:path+escapePathComponent(this.name),value:this.object[this.name]};patches.push(patch);}};function escapePathComponent(str){if(str.indexOf('/')===-1&&str.indexOf('~')===-1)return str;return str.replace(/~/g,'~0').replace(/\//g,'~1');}
function _getPathRecursive(root,obj){var found;for(var key in root){if(root.hasOwnProperty(key)){if(root[key]===obj){return escapePathComponent(key)+'/';}else if(_typeof(root[key])==='object'){found=_getPathRecursive(root[key],obj);if(found!=''){return escapePathComponent(key)+'/'+found;}}}}
return'';}
function getPath(root,obj){if(root===obj){return'/';}
var path=_getPathRecursive(root,obj);if(path===''){throw new OriginalError("Object not found in root");}
return'/'+path;}
var beforeDict=[];var Mirror=function(){function Mirror(obj){this.observers=[];this.obj=obj;}
return Mirror;}();var ObserverInfo=function(){function ObserverInfo(callback,observer){this.callback=callback;this.observer=observer;}
return ObserverInfo;}();function getMirror(obj){for(var i=0,ilen=beforeDict.length;i<ilen;i++){if(beforeDict[i].obj===obj){return beforeDict[i];}}}
function getObserverFromMirror(mirror,callback){for(var j=0,jlen=mirror.observers.length;j<jlen;j++){if(mirror.observers[j].callback===callback){return mirror.observers[j].observer;}}}
function removeObserverFromMirror(mirror,observer){for(var j=0,jlen=mirror.observers.length;j<jlen;j++){if(mirror.observers[j].observer===observer){mirror.observers.splice(j,1);return;}}}
function unobserve(root,observer){observer.unobserve();}
jsonpatch.unobserve=unobserve;function deepClone(obj){if(_typeof(obj)==="object"){return JSON.parse(JSON.stringify(obj));}else{return obj;}}
function observe(obj,callback){var patches=[];var root=obj;var observer;var mirror=getMirror(obj);if(!mirror){mirror=new Mirror(obj);beforeDict.push(mirror);}else{observer=getObserverFromMirror(mirror,callback);}
if(observer){return observer;}
observer={};mirror.value=deepClone(obj);if(callback){observer.callback=callback;observer.next=null;var intervals=this.intervals||[100,1000,10000,60000];if(intervals.push===void 0){throw new OriginalError("jsonpatch.intervals must be an array");}
var currentInterval=0;var dirtyCheck=function dirtyCheck(){generate(observer);};var fastCheck=function fastCheck(){clearTimeout(observer.next);observer.next=setTimeout(function(){dirtyCheck();currentInterval=0;observer.next=setTimeout(slowCheck,intervals[currentInterval++]);},0);};var slowCheck=function slowCheck(){dirtyCheck();if(currentInterval==intervals.length)currentInterval=intervals.length-1;observer.next=setTimeout(slowCheck,intervals[currentInterval++]);};if(typeof window!=='undefined'){if(window.addEventListener){window.addEventListener('mousedown',fastCheck);window.addEventListener('mouseup',fastCheck);window.addEventListener('keydown',fastCheck);}else{document.documentElement.attachEvent('onmousedown',fastCheck);document.documentElement.attachEvent('onmouseup',fastCheck);document.documentElement.attachEvent('onkeydown',fastCheck);}}
observer.next=setTimeout(slowCheck,intervals[currentInterval++]);}
observer.patches=patches;observer.object=obj;observer.unobserve=function(){generate(observer);clearTimeout(observer.next);removeObserverFromMirror(mirror,observer);if(mirror.observers.length===0){beforeDict.splice(beforeDict.indexOf(mirror),1);}
if(typeof window!=='undefined'){if(window.removeEventListener){window.removeEventListener('mousedown',fastCheck);window.removeEventListener('mouseup',fastCheck);window.removeEventListener('keydown',fastCheck);}else{document.documentElement.detachEvent('onmousedown',fastCheck);document.documentElement.detachEvent('onmouseup',fastCheck);document.documentElement.detachEvent('onkeydown',fastCheck);}}};mirror.observers.push(new ObserverInfo(callback,observer));return observer;}
jsonpatch.observe=observe;function generate(observer){var mirror;for(var i=0,ilen=beforeDict.length;i<ilen;i++){if(beforeDict[i].obj===observer.object){mirror=beforeDict[i];break;}}
_generate(mirror.value,observer.object,observer.patches,"");if(observer.patches.length){apply(mirror.value,observer.patches);}
var temp=observer.patches;if(temp.length>0){observer.patches=[];if(observer.callback){observer.callback(temp);}}
return temp;}
jsonpatch.generate=generate;function _generate(mirror,obj,patches,path){var newKeys=_objectKeys(obj);var oldKeys=_objectKeys(mirror);var changed=false;var deleted=false;for(var t=oldKeys.length-1;t>=0;t--){var key=oldKeys[t];var oldVal=mirror[key];if(obj.hasOwnProperty(key)){var newVal=obj[key];if(_typeof(oldVal)=="object"&&oldVal!=null&&_typeof(newVal)=="object"&&newVal!=null){_generate(oldVal,newVal,patches,path+"/"+escapePathComponent(key));}else{if(oldVal!=newVal){changed=true;patches.push({op:"replace",path:path+"/"+escapePathComponent(key),value:deepClone(newVal)});}}}else{patches.push({op:"remove",path:path+"/"+escapePathComponent(key)});deleted=true;}}
if(!deleted&&newKeys.length==oldKeys.length){return;}
for(var t=0;t<newKeys.length;t++){var key=newKeys[t];if(!mirror.hasOwnProperty(key)){patches.push({op:"add",path:path+"/"+escapePathComponent(key),value:deepClone(obj[key])});}}}
var _isArray;if(Array.isArray){_isArray=Array.isArray;}else{_isArray=function _isArray(obj){return obj.push&&typeof obj.length==='number';};}
function isInteger(str){var i=0;var len=str.length;var charCode;while(i<len){charCode=str.charCodeAt(i);if(charCode>=48&&charCode<=57){i++;continue;}
return false;}
return true;}
function apply(tree,patches,validate){var result=false,p=0,plen=patches.length,patch,key;while(p<plen){patch=patches[p];p++;var path=patch.path||"";var keys=path.split('/');var obj=tree;var t=1;var len=keys.length;var existingPathFragment=undefined;while(true){key=keys[t];if(validate){if(existingPathFragment===undefined){if(obj[key]===undefined){existingPathFragment=keys.slice(0,t).join('/');}else if(t==len-1){existingPathFragment=patch.path;}
if(existingPathFragment!==undefined){this.validator(patch,p-1,tree,existingPathFragment);}}}
t++;if(key===undefined){if(t>=len){result=rootOps[patch.op].call(patch,obj,key,tree);break;}}
if(_isArray(obj)){if(key==='-'){key=obj.length;}else{if(validate&&!isInteger(key)){throw new JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",p-1,patch.path,patch);}
key=parseInt(key,10);}
if(t>=len){if(validate&&patch.op==="add"&&key>obj.length){throw new JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",p-1,patch.path,patch);}
result=arrOps[patch.op].call(patch,obj,key,tree);break;}}else{if(key&&key.indexOf('~')!=-1)key=key.replace(/~1/g,'/').replace(/~0/g,'~');if(t>=len){result=objOps[patch.op].call(patch,obj,key,tree);break;}}
obj=obj[key];}}
return result;}
jsonpatch.apply=apply;function compare(tree1,tree2){var patches=[];_generate(tree1,tree2,patches,'');return patches;}
jsonpatch.compare=compare;var JsonPatchError=function(_super){__extends(JsonPatchError,_super);function JsonPatchError(message,name,index,operation,tree){_super.call(this,message);this.message=message;this.name=name;this.index=index;this.operation=operation;this.tree=tree;}
return JsonPatchError;}(OriginalError);jsonpatch.JsonPatchError=JsonPatchError;jsonpatch.Error=JsonPatchError;function hasUndefined(obj){if(obj===undefined){return true;}
if(typeof obj=="array"||_typeof(obj)=="object"){for(var i in obj){if(hasUndefined(obj[i])){return true;}}}
return false;}
function validator(operation,index,tree,existingPathFragment){if(_typeof(operation)!=='object'||operation===null||_isArray(operation)){throw new JsonPatchError('Operation is not an object','OPERATION_NOT_AN_OBJECT',index,operation,tree);}else if(!objOps[operation.op]){throw new JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902','OPERATION_OP_INVALID',index,operation,tree);}else if(typeof operation.path!=='string'){throw new JsonPatchError('Operation `path` property is not a string','OPERATION_PATH_INVALID',index,operation,tree);}else if((operation.op==='move'||operation.op==='copy')&&typeof operation.from!=='string'){throw new JsonPatchError('Operation `from` property is not present (applicable in `move` and `copy` operations)','OPERATION_FROM_REQUIRED',index,operation,tree);}else if((operation.op==='add'||operation.op==='replace'||operation.op==='test')&&operation.value===undefined){throw new JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)','OPERATION_VALUE_REQUIRED',index,operation,tree);}else if((operation.op==='add'||operation.op==='replace'||operation.op==='test')&&hasUndefined(operation.value)){throw new JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)','OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED',index,operation,tree);}else if(tree){if(operation.op=="add"){var pathLen=operation.path.split("/").length;var existingPathLen=existingPathFragment.split("/").length;if(pathLen!==existingPathLen+1&&pathLen!==existingPathLen){throw new JsonPatchError('Cannot perform an `add` operation at the desired path','OPERATION_PATH_CANNOT_ADD',index,operation,tree);}}else if(operation.op==='replace'||operation.op==='remove'||operation.op==='_get'){if(operation.path!==existingPathFragment){throw new JsonPatchError('Cannot perform the operation at a path that does not exist','OPERATION_PATH_UNRESOLVABLE',index,operation,tree);}}else if(operation.op==='move'||operation.op==='copy'){var existingValue={op:"_get",path:operation.from,value:undefined};var error=jsonpatch.validate([existingValue],tree);if(error&&error.name==='OPERATION_PATH_UNRESOLVABLE'){throw new JsonPatchError('Cannot perform the operation from a path that does not exist','OPERATION_FROM_UNRESOLVABLE',index,operation,tree);}}}}
jsonpatch.validator=validator;function validate(sequence,tree){try{if(!_isArray(sequence)){throw new JsonPatchError('Patch sequence must be an array','SEQUENCE_NOT_AN_ARRAY');}
if(tree){tree=JSON.parse(JSON.stringify(tree));apply.call(this,tree,sequence,true);}else{for(var i=0;i<sequence.length;i++){this.validator(sequence[i],i);}}}catch(e){if(e instanceof JsonPatchError){return e;}else{throw e;}}}
jsonpatch.validate=validate;})(jsonpatch||(jsonpatch={}));if(true){exports.apply=jsonpatch.apply;exports.observe=jsonpatch.observe;exports.unobserve=jsonpatch.unobserve;exports.generate=jsonpatch.generate;exports.compare=jsonpatch.compare;exports.validate=jsonpatch.validate;exports.validator=jsonpatch.validator;exports.JsonPatchError=jsonpatch.JsonPatchError;exports.Error=jsonpatch.Error;}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.cleanPatches=cleanPatches;exports.parsePath=parsePath;var _array=__webpack_require__(3);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest();}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}
function cleanPatches(patches){var newOrRemovedColumns=[];var cleanedPatches=(0,_array.arrayFilter)(patches,function(patch){if(/[/]length/ig.test(patch.path)){return false;}
if(!parsePath(patch.path)){return false;}
return true;});cleanedPatches=(0,_array.arrayMap)(cleanedPatches,function(patch){var coords=parsePath(patch.path);patch.row=coords.row;patch.col=coords.col;return patch;});cleanedPatches=(0,_array.arrayFilter)(cleanedPatches,function(patch){if(['add','remove'].indexOf(patch.op)!==-1&&!isNaN(patch.col)){if(newOrRemovedColumns.indexOf(patch.col)!==-1){return false;}
newOrRemovedColumns.push(patch.col);}
return true;});newOrRemovedColumns.length=0;return cleanedPatches;}
function parsePath(path){var match=path.match(/^\/(\d+)\/?(.*)?$/);if(!match){return null;}
var _match=_slicedToArray(match,3),row=_match[1],column=_match[2];return{row:parseInt(row,10),col:/^\d*$/.test(column)?parseInt(column,10):column};}}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _base=_interopRequireDefault(__webpack_require__(15));var _plugins=__webpack_require__(13);var _object=__webpack_require__(2);var _number=__webpack_require__(9);var _mixed=__webpack_require__(14);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread();}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance");}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter);}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var DEFAULT_SEARCH_RESULT_CLASS='htSearchResult';var DEFAULT_CALLBACK=function DEFAULT_CALLBACK(instance,row,col,data,testResult){instance.getCellMeta(row,col).isSearchResult=testResult;};var DEFAULT_QUERY_METHOD=function DEFAULT_QUERY_METHOD(query,value){if((0,_mixed.isUndefined)(query)||query===null||!query.toLowerCase||query.length===0){return false;}
if((0,_mixed.isUndefined)(value)||value===null){return false;}
return value.toString().toLowerCase().indexOf(query.toLowerCase())!==-1;};var Search=function(_BasePlugin){_inherits(Search,_BasePlugin);function Search(hotInstance){var _this;_classCallCheck(this,Search);_this=_possibleConstructorReturn(this,_getPrototypeOf(Search).call(this,hotInstance));_this.callback=DEFAULT_CALLBACK;_this.queryMethod=DEFAULT_QUERY_METHOD;_this.searchResultClass=DEFAULT_SEARCH_RESULT_CLASS;return _this;}
_createClass(Search,[{key:"isEnabled",value:function isEnabled(){return this.hot.getSettings().search;}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
var searchSettings=this.hot.getSettings().search;this.updatePluginSettings(searchSettings);this.addHook('beforeRenderer',function(){return _this2.onBeforeRenderer.apply(_this2,arguments);});_get(_getPrototypeOf(Search.prototype),"enablePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){var _this3=this;var beforeRendererCallback=function beforeRendererCallback(){return _this3.onBeforeRenderer.apply(_this3,arguments);};this.hot.addHook('beforeRenderer',beforeRendererCallback);this.hot.addHookOnce('afterRender',function(){_this3.hot.removeHook('beforeRenderer',beforeRendererCallback);});_get(_getPrototypeOf(Search.prototype),"disablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.disablePlugin();this.enablePlugin();_get(_getPrototypeOf(Search.prototype),"updatePlugin",this).call(this);}},{key:"query",value:function query(queryStr){var _this4=this;var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.getCallback();var queryMethod=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.getQueryMethod();var rowCount=this.hot.countRows();var colCount=this.hot.countCols();var queryResult=[];var instance=this.hot;(0,_number.rangeEach)(0,rowCount-1,function(rowIndex){(0,_number.rangeEach)(0,colCount-1,function(colIndex){var cellData=_this4.hot.getDataAtCell(rowIndex,colIndex);var cellProperties=_this4.hot.getCellMeta(rowIndex,colIndex);var cellCallback=cellProperties.search.callback||callback;var cellQueryMethod=cellProperties.search.queryMethod||queryMethod;var testResult=cellQueryMethod(queryStr,cellData);if(testResult){var singleResult={row:rowIndex,col:colIndex,data:cellData};queryResult.push(singleResult);}
if(cellCallback){cellCallback(instance,rowIndex,colIndex,cellData,testResult);}});});return queryResult;}},{key:"getCallback",value:function getCallback(){return this.callback;}},{key:"setCallback",value:function setCallback(newCallback){this.callback=newCallback;}},{key:"getQueryMethod",value:function getQueryMethod(){return this.queryMethod;}},{key:"setQueryMethod",value:function setQueryMethod(newQueryMethod){this.queryMethod=newQueryMethod;}},{key:"getSearchResultClass",value:function getSearchResultClass(){return this.searchResultClass;}},{key:"setSearchResultClass",value:function setSearchResultClass(newElementClass){this.searchResultClass=newElementClass;}},{key:"updatePluginSettings",value:function updatePluginSettings(searchSettings){if((0,_object.isObject)(searchSettings)){if(searchSettings.searchResultClass){this.setSearchResultClass(searchSettings.searchResultClass);}
if(searchSettings.queryMethod){this.setQueryMethod(searchSettings.queryMethod);}
if(searchSettings.callback){this.setCallback(searchSettings.callback);}}}},{key:"onBeforeRenderer",value:function onBeforeRenderer(TD,row,col,prop,value,cellProperties){var className=cellProperties.className||[];var classArray=[];if(typeof className==='string'){classArray=className.split(' ');}else{var _classArray;(_classArray=classArray).push.apply(_classArray,_toConsumableArray(className));}
if(this.isEnabled()&&cellProperties.isSearchResult){if(!classArray.includes(this.searchResultClass)){classArray.push("".concat(this.searchResultClass));}}else if(classArray.includes(this.searchResultClass)){classArray.splice(classArray.indexOf(this.searchResultClass),1);}
cellProperties.className=classArray.join(' ');}},{key:"destroy",value:function destroy(){_get(_getPrototypeOf(Search.prototype),"destroy",this).call(this);}}]);return Search;}(_base.default);(0,_plugins.registerPlugin)('search',Search);var _default=Search;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _element=__webpack_require__(1);var _array=__webpack_require__(3);var _base=_interopRequireDefault(__webpack_require__(15));var _plugins=__webpack_require__(13);var _feature=__webpack_require__(47);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get;}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver);}return desc.value;};}return _get(target,property,receiver||target);}
function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
var TouchScroll=function(_BasePlugin){_inherits(TouchScroll,_BasePlugin);function TouchScroll(hotInstance){var _this;_classCallCheck(this,TouchScroll);_this=_possibleConstructorReturn(this,_getPrototypeOf(TouchScroll).call(this,hotInstance));_this.scrollbars=[];_this.clones=[];_this.lockedCollection=false;_this.freezeOverlays=false;return _this;}
_createClass(TouchScroll,[{key:"isEnabled",value:function isEnabled(){return(0,_feature.isTouchSupported)();}},{key:"enablePlugin",value:function enablePlugin(){var _this2=this;if(this.enabled){return;}
this.addHook('afterRender',function(){return _this2.onAfterRender();});this.registerEvents();_get(_getPrototypeOf(TouchScroll.prototype),"enablePlugin",this).call(this);}},{key:"updatePlugin",value:function updatePlugin(){this.lockedCollection=false;_get(_getPrototypeOf(TouchScroll.prototype),"updatePlugin",this).call(this);}},{key:"disablePlugin",value:function disablePlugin(){_get(_getPrototypeOf(TouchScroll.prototype),"disablePlugin",this).call(this);}},{key:"registerEvents",value:function registerEvents(){var _this3=this;this.addHook('beforeTouchScroll',function(){return _this3.onBeforeTouchScroll();});this.addHook('afterMomentumScroll',function(){return _this3.onAfterMomentumScroll();});}},{key:"onAfterRender",value:function onAfterRender(){if(this.lockedCollection){return;}
var _this$hot$view$wt$wtO=this.hot.view.wt.wtOverlays,topOverlay=_this$hot$view$wt$wtO.topOverlay,bottomOverlay=_this$hot$view$wt$wtO.bottomOverlay,leftOverlay=_this$hot$view$wt$wtO.leftOverlay,topLeftCornerOverlay=_this$hot$view$wt$wtO.topLeftCornerOverlay,bottomLeftCornerOverlay=_this$hot$view$wt$wtO.bottomLeftCornerOverlay;this.lockedCollection=true;this.scrollbars.length=0;this.scrollbars.push(topOverlay);if(bottomOverlay.clone){this.scrollbars.push(bottomOverlay);}
this.scrollbars.push(leftOverlay);if(topLeftCornerOverlay){this.scrollbars.push(topLeftCornerOverlay);}
if(bottomLeftCornerOverlay&&bottomLeftCornerOverlay.clone){this.scrollbars.push(bottomLeftCornerOverlay);}
this.clones.length=0;if(topOverlay.needFullRender){this.clones.push(topOverlay.clone.wtTable.holder.parentNode);}
if(bottomOverlay.needFullRender){this.clones.push(bottomOverlay.clone.wtTable.holder.parentNode);}
if(leftOverlay.needFullRender){this.clones.push(leftOverlay.clone.wtTable.holder.parentNode);}
if(topLeftCornerOverlay){this.clones.push(topLeftCornerOverlay.clone.wtTable.holder.parentNode);}
if(bottomLeftCornerOverlay&&bottomLeftCornerOverlay.clone){this.clones.push(bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);}}},{key:"onBeforeTouchScroll",value:function onBeforeTouchScroll(){this.freezeOverlays=true;(0,_array.arrayEach)(this.clones,function(clone){(0,_element.addClass)(clone,'hide-tween');});}},{key:"onAfterMomentumScroll",value:function onAfterMomentumScroll(){var _this4=this;this.freezeOverlays=false;(0,_array.arrayEach)(this.clones,function(clone){(0,_element.removeClass)(clone,'hide-tween');(0,_element.addClass)(clone,'show-tween');});setTimeout(function(){(0,_array.arrayEach)(_this4.clones,function(clone){(0,_element.removeClass)(clone,'show-tween');});},400);(0,_array.arrayEach)(this.scrollbars,function(scrollbar){scrollbar.refresh();scrollbar.resetFixedPosition();});this.hot.view.wt.wtOverlays.syncScrollWithMaster();}}]);return TouchScroll;}(_base.default);(0,_plugins.registerPlugin)('touchScroll',TouchScroll);var _default=TouchScroll;exports.default=_default;}),(function(module,exports,__webpack_require__){"use strict";exports.__esModule=true;exports.default=void 0;var _pluginHooks=_interopRequireDefault(__webpack_require__(22));var _array=__webpack_require__(3);var _number=__webpack_require__(9);var _object=__webpack_require__(2);var _event=__webpack_require__(18);var _utils=__webpack_require__(30);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}
function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}return _assertThisInitialized(self);}
function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}
function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}
function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}
function UndoRedo(instance){var plugin=this;this.instance=instance;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=false;instance.addHook('afterChange',function(changes,source){if(changes&&source!=='UndoRedo.undo'&&source!=='UndoRedo.redo'&&source!=='MergeCells'){plugin.done(new UndoRedo.ChangeAction(changes));}});instance.addHook('afterCreateRow',function(index,amount,source){if(source==='UndoRedo.undo'||source==='UndoRedo.undo'||source==='auto'){return;}
var action=new UndoRedo.CreateRowAction(index,amount);plugin.done(action);});instance.addHook('beforeRemoveRow',function(index,amount,logicRows,source){if(source==='UndoRedo.undo'||source==='UndoRedo.redo'||source==='auto'){return;}
var originalData=plugin.instance.getSourceDataArray();var rowIndex=(originalData.length+index)%originalData.length;var physicalRowIndex=instance.toPhysicalRow(rowIndex);var removedData=(0,_object.deepClone)(originalData.slice(physicalRowIndex,physicalRowIndex+amount));plugin.done(new UndoRedo.RemoveRowAction(rowIndex,removedData));});instance.addHook('afterCreateCol',function(index,amount,source){if(source==='UndoRedo.undo'||source==='UndoRedo.redo'||source==='auto'){return;}
plugin.done(new UndoRedo.CreateColumnAction(index,amount));});instance.addHook('beforeRemoveCol',function(index,amount,logicColumns,source){if(source==='UndoRedo.undo'||source==='UndoRedo.redo'||source==='auto'){return;}
var originalData=plugin.instance.getSourceDataArray();var columnIndex=(plugin.instance.countCols()+index)%plugin.instance.countCols();var removedData=[];var headers=[];var indexes=[];(0,_number.rangeEach)(originalData.length-1,function(i){var column=[];var origRow=originalData[i];(0,_number.rangeEach)(columnIndex,columnIndex+(amount-1),function(j){column.push(origRow[instance.runHooks('modifyCol',j)]);});removedData.push(column);});(0,_number.rangeEach)(amount-1,function(i){indexes.push(instance.runHooks('modifyCol',columnIndex+i));});if(Array.isArray(instance.getSettings().colHeaders)){(0,_number.rangeEach)(amount-1,function(i){headers.push(instance.getSettings().colHeaders[instance.runHooks('modifyCol',columnIndex+i)]||null);});}
var manualColumnMovePlugin=plugin.instance.getPlugin('manualColumnMove');var columnsMap=manualColumnMovePlugin.isEnabled()?manualColumnMovePlugin.columnsMapper.__arrayMap:[];var action=new UndoRedo.RemoveColumnAction(columnIndex,indexes,removedData,headers,columnsMap);plugin.done(action);});instance.addHook('beforeCellAlignment',function(stateBefore,range,type,alignment){var action=new UndoRedo.CellAlignmentAction(stateBefore,range,type,alignment);plugin.done(action);});instance.addHook('beforeFilter',function(conditionsStack){plugin.done(new UndoRedo.FiltersAction(conditionsStack));});instance.addHook('beforeRowMove',function(movedRows,target){if(movedRows===false){return;}
plugin.done(new UndoRedo.RowMoveAction(movedRows,target));});instance.addHook('beforeMergeCells',function(cellRange,auto){if(auto){return;}
plugin.done(new UndoRedo.MergeCellsAction(instance,cellRange));});instance.addHook('afterUnmergeCells',function(cellRange,auto){if(auto){return;}
plugin.done(new UndoRedo.UnmergeCellsAction(instance,cellRange));});}
UndoRedo.prototype.done=function(action){if(!this.ignoreNewActions){this.doneActions.push(action);this.undoneActions.length=0;}};UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var action=this.doneActions.pop();var actionClone=(0,_object.deepClone)(action);var instance=this.instance;var continueAction=instance.runHooks('beforeUndo',actionClone);if(continueAction===false){return;}
this.ignoreNewActions=true;var that=this;action.undo(this.instance,function(){that.ignoreNewActions=false;that.undoneActions.push(action);});instance.runHooks('afterUndo',actionClone);}};UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var action=this.undoneActions.pop();var actionClone=(0,_object.deepClone)(action);var instance=this.instance;var continueAction=instance.runHooks('beforeRedo',actionClone);if(continueAction===false){return;}
this.ignoreNewActions=true;var that=this;action.redo(this.instance,function(){that.ignoreNewActions=false;that.doneActions.push(action);});instance.runHooks('afterRedo',actionClone);}};UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0;};UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0;};UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0;};UndoRedo.Action=function(){};UndoRedo.Action.prototype.undo=function(){};UndoRedo.Action.prototype.redo=function(){};UndoRedo.ChangeAction=function(changes){this.changes=changes;this.actionType='change';};(0,_object.inherit)(UndoRedo.ChangeAction,UndoRedo.Action);UndoRedo.ChangeAction.prototype.undo=function(instance,undoneCallback){var data=(0,_object.deepClone)(this.changes);var emptyRowsAtTheEnd=instance.countEmptyRows(true);var emptyColsAtTheEnd=instance.countEmptyCols(true);for(var i=0,len=data.length;i<len;i++){data[i].splice(3,1);}
instance.addHookOnce('afterChange',undoneCallback);instance.setDataAtRowProp(data,null,null,'UndoRedo.undo');for(var _i=0,_len=data.length;_i<_len;_i++){if(instance.getSettings().minSpareRows&&data[_i][0]+1+instance.getSettings().minSpareRows===instance.countRows()&&emptyRowsAtTheEnd===instance.getSettings().minSpareRows){instance.alter('remove_row',parseInt(data[_i][0]+1,10),instance.getSettings().minSpareRows);instance.undoRedo.doneActions.pop();}
if(instance.getSettings().minSpareCols&&data[_i][1]+1+instance.getSettings().minSpareCols===instance.countCols()&&emptyColsAtTheEnd===instance.getSettings().minSpareCols){instance.alter('remove_col',parseInt(data[_i][1]+1,10),instance.getSettings().minSpareCols);instance.undoRedo.doneActions.pop();}}};UndoRedo.ChangeAction.prototype.redo=function(instance,onFinishCallback){var data=(0,_object.deepClone)(this.changes);for(var i=0,len=data.length;i<len;i++){data[i].splice(2,1);}
instance.addHookOnce('afterChange',onFinishCallback);instance.setDataAtRowProp(data,null,null,'UndoRedo.redo');};UndoRedo.CreateRowAction=function(index,amount){this.index=index;this.amount=amount;this.actionType='insert_row';};(0,_object.inherit)(UndoRedo.CreateRowAction,UndoRedo.Action);UndoRedo.CreateRowAction.prototype.undo=function(instance,undoneCallback){var rowCount=instance.countRows();var minSpareRows=instance.getSettings().minSpareRows;if(this.index>=rowCount&&this.index-minSpareRows<rowCount){this.index-=minSpareRows;}
instance.addHookOnce('afterRemoveRow',undoneCallback);instance.alter('remove_row',this.index,this.amount,'UndoRedo.undo');};UndoRedo.CreateRowAction.prototype.redo=function(instance,redoneCallback){instance.addHookOnce('afterCreateRow',redoneCallback);instance.alter('insert_row',this.index,this.amount,'UndoRedo.redo');};UndoRedo.RemoveRowAction=function(index,data){this.index=index;this.data=data;this.actionType='remove_row';};(0,_object.inherit)(UndoRedo.RemoveRowAction,UndoRedo.Action);UndoRedo.RemoveRowAction.prototype.undo=function(instance,undoneCallback){instance.alter('insert_row',this.index,this.data.length,'UndoRedo.undo');instance.addHookOnce('afterRender',undoneCallback);instance.populateFromArray(this.index,0,this.data,void 0,void 0,'UndoRedo.undo');};UndoRedo.RemoveRowAction.prototype.redo=function(instance,redoneCallback){instance.addHookOnce('afterRemoveRow',redoneCallback);instance.alter('remove_row',this.index,this.data.length,'UndoRedo.redo');};UndoRedo.CreateColumnAction=function(index,amount){this.index=index;this.amount=amount;this.actionType='insert_col';};(0,_object.inherit)(UndoRedo.CreateColumnAction,UndoRedo.Action);UndoRedo.CreateColumnAction.prototype.undo=function(instance,undoneCallback){instance.addHookOnce('afterRemoveCol',undoneCallback);instance.alter('remove_col',this.index,this.amount,'UndoRedo.undo');};UndoRedo.CreateColumnAction.prototype.redo=function(instance,redoneCallback){instance.addHookOnce('afterCreateCol',redoneCallback);instance.alter('insert_col',this.index,this.amount,'UndoRedo.redo');};UndoRedo.RemoveColumnAction=function(index,indexes,data,headers,columnPositions){this.index=index;this.indexes=indexes;this.data=data;this.amount=this.data[0].length;this.headers=headers;this.columnPositions=columnPositions.slice(0);this.actionType='remove_col';};(0,_object.inherit)(UndoRedo.RemoveColumnAction,UndoRedo.Action);UndoRedo.RemoveColumnAction.prototype.undo=function(instance,undoneCallback){var _this=this;var row;var ascendingIndexes=this.indexes.slice(0).sort();var sortByIndexes=function sortByIndexes(elem,j,arr){return arr[_this.indexes.indexOf(ascendingIndexes[j])];};var sortedData=[];(0,_number.rangeEach)(this.data.length-1,function(i){sortedData[i]=(0,_array.arrayMap)(_this.data[i],sortByIndexes);});var sortedHeaders=[];sortedHeaders=(0,_array.arrayMap)(this.headers,sortByIndexes);var changes=[];instance.runHooks('beforeCreateCol',this.indexes[0],this.indexes.length,'UndoRedo.undo');(0,_number.rangeEach)(this.data.length-1,function(i){row=instance.getSourceDataAtRow(i);(0,_number.rangeEach)(ascendingIndexes.length-1,function(j){row.splice(ascendingIndexes[j],0,sortedData[i][j]);changes.push([i,ascendingIndexes[j],null,sortedData[i][j]]);});});if(instance.getPlugin('formulas')){instance.getPlugin('formulas').onAfterSetDataAtCell(changes);}
if(typeof this.headers!=='undefined'){(0,_number.rangeEach)(sortedHeaders.length-1,function(j){instance.getSettings().colHeaders.splice(ascendingIndexes[j],0,sortedHeaders[j]);});}
if(instance.getPlugin('manualColumnMove')){instance.getPlugin('manualColumnMove').columnsMapper.__arrayMap=this.columnPositions;}
instance.addHookOnce('afterRender',undoneCallback);instance.runHooks('afterCreateCol',this.indexes[0],this.indexes.length,'UndoRedo.undo');if(instance.getPlugin('formulas')){instance.getPlugin('formulas').recalculateFull();}
instance.render();};UndoRedo.RemoveColumnAction.prototype.redo=function(instance,redoneCallback){instance.addHookOnce('afterRemoveCol',redoneCallback);instance.alter('remove_col',this.index,this.amount,'UndoRedo.redo');};UndoRedo.CellAlignmentAction=function(stateBefore,range,type,alignment){this.stateBefore=stateBefore;this.range=range;this.type=type;this.alignment=alignment;};UndoRedo.CellAlignmentAction.prototype.undo=function(instance,undoneCallback){var _this2=this;(0,_array.arrayEach)(this.range,function(_ref){var from=_ref.from,to=_ref.to;for(var row=from.row;row<=to.row;row+=1){for(var col=from.col;col<=to.col;col+=1){instance.setCellMeta(row,col,'className',_this2.stateBefore[row][col]||' htLeft');}}});instance.addHookOnce('afterRender',undoneCallback);instance.render();};UndoRedo.CellAlignmentAction.prototype.redo=function(instance,undoneCallback){(0,_utils.align)(this.range,this.type,this.alignment,function(row,col){return instance.getCellMeta(row,col);},function(row,col,key,value){return instance.setCellMeta(row,col,key,value);});instance.addHookOnce('afterRender',undoneCallback);instance.render();};UndoRedo.FiltersAction=function(conditionsStack){this.conditionsStack=conditionsStack;this.actionType='filter';};(0,_object.inherit)(UndoRedo.FiltersAction,UndoRedo.Action);UndoRedo.FiltersAction.prototype.undo=function(instance,undoneCallback){var filters=instance.getPlugin('filters');instance.addHookOnce('afterRender',undoneCallback);filters.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1));filters.filter();};UndoRedo.FiltersAction.prototype.redo=function(instance,redoneCallback){var filters=instance.getPlugin('filters');instance.addHookOnce('afterRender',redoneCallback);filters.conditionCollection.importAllConditions(this.conditionsStack);filters.filter();};var MergeCellsAction=function(_UndoRedo$Action){_inherits(MergeCellsAction,_UndoRedo$Action);function MergeCellsAction(instance,cellRange){var _this3;_classCallCheck(this,MergeCellsAction);_this3=_possibleConstructorReturn(this,_getPrototypeOf(MergeCellsAction).call(this));_this3.cellRange=cellRange;_this3.rangeData=instance.getData(cellRange.from.row,cellRange.from.col,cellRange.to.row,cellRange.to.col);return _this3;}
_createClass(MergeCellsAction,[{key:"undo",value:function undo(instance,undoneCallback){var mergeCellsPlugin=instance.getPlugin('mergeCells');instance.addHookOnce('afterRender',undoneCallback);mergeCellsPlugin.unmergeRange(this.cellRange,true);instance.populateFromArray(this.cellRange.from.row,this.cellRange.from.col,this.rangeData,void 0,void 0,'MergeCells');}},{key:"redo",value:function redo(instance,redoneCallback){var mergeCellsPlugin=instance.getPlugin('mergeCells');instance.addHookOnce('afterRender',redoneCallback);mergeCellsPlugin.mergeRange(this.cellRange);}}]);return MergeCellsAction;}(UndoRedo.Action);UndoRedo.MergeCellsAction=MergeCellsAction;var UnmergeCellsAction=function(_UndoRedo$Action2){_inherits(UnmergeCellsAction,_UndoRedo$Action2);function UnmergeCellsAction(instance,cellRange){var _this4;_classCallCheck(this,UnmergeCellsAction);_this4=_possibleConstructorReturn(this,_getPrototypeOf(UnmergeCellsAction).call(this));_this4.cellRange=cellRange;return _this4;}
_createClass(UnmergeCellsAction,[{key:"undo",value:function undo(instance,undoneCallback){var mergeCellsPlugin=instance.getPlugin('mergeCells');instance.addHookOnce('afterRender',undoneCallback);mergeCellsPlugin.mergeRange(this.cellRange,true);}},{key:"redo",value:function redo(instance,redoneCallback){var mergeCellsPlugin=instance.getPlugin('mergeCells');instance.addHookOnce('afterRender',redoneCallback);mergeCellsPlugin.unmergeRange(this.cellRange,true);instance.render();}}]);return UnmergeCellsAction;}(UndoRedo.Action);UndoRedo.UnmergeCellsAction=UnmergeCellsAction;UndoRedo.RowMoveAction=function(movedRows,target){this.rows=movedRows.slice();this.target=target;};(0,_object.inherit)(UndoRedo.RowMoveAction,UndoRedo.Action);UndoRedo.RowMoveAction.prototype.undo=function(instance,undoneCallback){var manualRowMove=instance.getPlugin('manualRowMove');instance.addHookOnce('afterRender',undoneCallback);var mod=this.rows[0]<this.target?-1*this.rows.length:0;var newTarget=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0];var newRows=[];var rowsLen=this.rows.length+mod;for(var i=mod;i<rowsLen;i+=1){newRows.push(this.target+i);}
manualRowMove.moveRows(newRows.slice(),newTarget);instance.render();instance.selectCell(this.rows[0],0,this.rows[this.rows.length-1],instance.countCols()-1,false,false);};UndoRedo.RowMoveAction.prototype.redo=function(instance,redoneCallback){var manualRowMove=instance.getPlugin('manualRowMove');instance.addHookOnce('afterRender',redoneCallback);manualRowMove.moveRows(this.rows.slice(),this.target);instance.render();var startSelection=this.rows[0]<this.target?this.target-this.rows.length:this.target;instance.selectCell(startSelection,0,startSelection+this.rows.length-1,instance.countCols()-1,false,false);};function init(){var instance=this;var pluginEnabled=typeof instance.getSettings().undo==='undefined'||instance.getSettings().undo;if(pluginEnabled){if(!instance.undoRedo){instance.undoRedo=new UndoRedo(instance);exposeUndoRedoMethods(instance);instance.addHook('beforeKeyDown',onBeforeKeyDown);instance.addHook('afterChange',onAfterChange);}}else if(instance.undoRedo){delete instance.undoRedo;removeExposedUndoRedoMethods(instance);instance.removeHook('beforeKeyDown',onBeforeKeyDown);instance.removeHook('afterChange',onAfterChange);}}
function onBeforeKeyDown(event){var instance=this;var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(ctrlDown){if(event.keyCode===89||event.shiftKey&&event.keyCode===90){instance.undoRedo.redo();(0,_event.stopImmediatePropagation)(event);}else if(event.keyCode===90){instance.undoRedo.undo();(0,_event.stopImmediatePropagation)(event);}}}
function onAfterChange(changes,source){var instance=this;if(source==='loadData'){return instance.undoRedo.clear();}}
function exposeUndoRedoMethods(instance){instance.undo=function(){return instance.undoRedo.undo();};instance.redo=function(){return instance.undoRedo.redo();};instance.isUndoAvailable=function(){return instance.undoRedo.isUndoAvailable();};instance.isRedoAvailable=function(){return instance.undoRedo.isRedoAvailable();};instance.clearUndo=function(){return instance.undoRedo.clear();};}
function removeExposedUndoRedoMethods(instance){delete instance.undo;delete instance.redo;delete instance.isUndoAvailable;delete instance.isRedoAvailable;delete instance.clearUndo;}
var hook=_pluginHooks.default.getSingleton();hook.add('afterInit',init);hook.add('afterUpdateSettings',init);hook.register('beforeUndo');hook.register('afterUndo');hook.register('beforeRedo');hook.register('afterRedo');var _default=UndoRedo;exports.default=_default;})])["default"];});

(function(){"use strict";var a={langLocaleCode:"cs-CZ",cultureCode:"cs-CZ",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tis.",million:"mil.",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"Kč",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}).call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"da-DK",cultureCode:"da-DK",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mio",billion:"mia",trillion:"b"},ordinal:function(){return"."},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"de-CH",cultureCode:"de-CH",delimiters:{thousands:"'",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"CHF",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"de-DE",cultureCode:"de-DE",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"€",position:"postfix",spaceSeparated:!0},defaults:{currencyFormat:",4"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"en-AU",cultureCode:"en-AU",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"en-GB",cultureCode:"en-GB",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"£",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"en-NZ",cultureCode:"en-NZ",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"en-ZA",cultureCode:"en-ZA",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"R",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"es-AR",cultureCode:"es-AR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mm",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===b||3===b?"er":2===b?"do":7===b||0===b?"mo":8===b?"vo":9===b?"no":"to"},currency:{symbol:"$",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"es-ES",cultureCode:"es-ES",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mm",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===b||3===b?"er":2===b?"do":7===b||0===b?"mo":8===b?"vo":9===b?"no":"to"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"et-EE",cultureCode:"et-EE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:" tuh",million:" mln",billion:" mld",trillion:" trl"},ordinal:function(){return"."},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"fa-IR",cultureCode:"fa-IR",delimiters:{thousands:"،",decimal:"."},abbreviations:{thousand:"هزار",million:"میلیون",billion:"میلیارد",trillion:"تریلیون"},ordinal:function(){return"ام"},currency:{symbol:"﷼"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"fi-FI",cultureCode:"fi-FI",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"M",billion:"G",trillion:"T"},ordinal:function(){return"."},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"fil-PH",cultureCode:"fil-PH",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"₱"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"fr-CA",cultureCode:"fr-CA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"M",billion:"G",trillion:"T"},ordinal:function(a){return 1===a?"er":"ème"},currency:{symbol:"$",position:"postfix",spaceSeparated:!0},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"fr-CH",cultureCode:"fr-CH",delimiters:{thousands:"'",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){return 1===a?"er":"ème"},currency:{symbol:"CHF",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"fr-FR",cultureCode:"fr-FR",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){return 1===a?"er":"ème"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"he-IL",cultureCode:"he-IL",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"אלף",million:"מליון",billion:"בליון",trillion:"טריליון"},currency:{symbol:"₪",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"₪ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"₪ ,0"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"hu-HU",cultureCode:"hu-HU",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"E",million:"M",billion:"Mrd",trillion:"T"},ordinal:function(){return"."},currency:{symbol:" Ft",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"it-IT",cultureCode:"it-IT",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"mila",million:"mil",billion:"b",trillion:"t"},ordinal:function(){return"º"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"ja-JP",cultureCode:"ja-JP",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"千",million:"百万",billion:"十億",trillion:"兆"},ordinal:function(){return"."},currency:{symbol:"¥",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"ko-KR",cultureCode:"ko-KR",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"천",million:"백만",billion:"십억",trillion:"일조"},ordinal:function(){return"."},currency:{symbol:"₩"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"lv-LV",cultureCode:"lv-LV",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:" tūkst.",million:" milj.",billion:" mljrd.",trillion:" trilj."},ordinal:function(){return"."},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"nb-NO",cultureCode:"nb-NO",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"t",million:"M",billion:"md",trillion:"t"},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"nl-BE",cultureCode:"nl-BE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"mln",billion:"mld",trillion:"bln"},ordinal:function(a){var b=a%100;return 0!==a&&1>=b||8===b||b>=20?"ste":"de"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"nl-NL",cultureCode:"nl-NL",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"k",million:"mln",billion:"mrd",trillion:"bln"},ordinal:function(a){var b=a%100;return 0!==a&&1>=b||8===b||b>=20?"ste":"de"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"pl-PL",cultureCode:"pl-PL",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tys.",million:"mln",billion:"mld",trillion:"bln"},ordinal:function(){return"."},currency:{symbol:" zł",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"pt-BR",cultureCode:"pt-BR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"mil",million:"milhões",billion:"b",trillion:"t"},ordinal:function(){return"º"},currency:{symbol:"R$",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"pt-PT",cultureCode:"pt-PT",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(){return"º"},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"ru-RU",cultureCode:"ru-RU",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"тыс.",million:"млн",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"руб.",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"ru-UA",cultureCode:"ru-UA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"тыс.",million:"млн",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"₴",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"sk-SK",cultureCode:"sk-SK",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"tis.",million:"mil.",billion:"b",trillion:"t"},ordinal:function(){return"."},currency:{symbol:"€",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"sv-SE",cultureCode:"sv-SE",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"t",million:"M",billion:"md",trillion:"tmd"},currency:{symbol:"kr",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"th-TH",cultureCode:"th-TH",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"พัน",million:"ล้าน",billion:"พันล้าน",trillion:"ล้านล้าน"},ordinal:function(){return"."},currency:{symbol:"฿",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'üncü",4:"'üncü",100:"'üncü",6:"'ncı",9:"'uncu",10:"'uncu",30:"'uncu",60:"'ıncı",90:"'ıncı"},b={langLocaleCode:"tr-TR",cultureCode:"tr-TR",delimiters:{thousands:".",decimal:","},abbreviations:{thousand:"bin",million:"milyon",billion:"milyar",trillion:"trilyon"},ordinal:function(b){if(0===b)
return"'ıncı";var c=b%10,d=b%100-c,e=b>=100?100:null;return a[c]||a[d]||a[e]},currency:{symbol:"₺",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=b),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(b.cultureCode,b)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"uk-UA",cultureCode:"uk-UA",delimiters:{thousands:" ",decimal:","},abbreviations:{thousand:"тис.",million:"млн",billion:"млрд",trillion:"блн"},ordinal:function(){return""},currency:{symbol:"₴",position:"postfix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:",0.00 $",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:",0 $"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"zh-CN",cultureCode:"zh-CN",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"千",million:"百万",billion:"十亿",trillion:"兆"},ordinal:function(){return"."},currency:{symbol:"¥",position:"prefix"},defaults:{currencyFormat:",4 a"},formats:{fourDigits:"4 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00",fullWithNoDecimals:"$ ,0"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window),function(){"use strict";var a={langLocaleCode:"zh-TW",cultureCode:"zh-TW",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"千",million:"百萬",billion:"十億",trillion:"兆"},ordinal:function(){return"第"},currency:{symbol:"NT$"}};"undefined"!=typeof module&&module.exports&&(module.exports=a),"undefined"!=typeof window&&window.numbro&&window.numbro.culture&&window.numbro.culture(a.cultureCode,a)}.call("undefined"==typeof window?this:window);

(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==='object'&&typeof module==='object')
module.exports=factory();else if(typeof define==='function'&&define.amd)
define([],factory);else if(typeof exports==='object')
exports["formulaParser"]=factory();else
root["formulaParser"]=factory();})(this,function(){return(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])
return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports;}
__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0);})
([function(module,exports,__webpack_require__){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.rowLabelToIndex=exports.rowIndexToLabel=exports.columnLabelToIndex=exports.columnIndexToLabel=exports.toLabel=exports.extractLabel=exports.error=exports.Parser=exports.ERROR_VALUE=exports.ERROR_REF=exports.ERROR_NUM=exports.ERROR_NULL=exports.ERROR_NOT_AVAILABLE=exports.ERROR_NAME=exports.ERROR_DIV_ZERO=exports.ERROR=exports.SUPPORTED_FORMULAS=undefined;var _parser=__webpack_require__(1);var _error=__webpack_require__(7);var _error2=_interopRequireDefault(_error);var _cell=__webpack_require__(43);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
exports.SUPPORTED_FORMULAS=_parser.SUPPORTED_FORMULAS;exports.ERROR=_error.ERROR;exports.ERROR_DIV_ZERO=_error.ERROR_DIV_ZERO;exports.ERROR_NAME=_error.ERROR_NAME;exports.ERROR_NOT_AVAILABLE=_error.ERROR_NOT_AVAILABLE;exports.ERROR_NULL=_error.ERROR_NULL;exports.ERROR_NUM=_error.ERROR_NUM;exports.ERROR_REF=_error.ERROR_REF;exports.ERROR_VALUE=_error.ERROR_VALUE;exports.Parser=_parser.Parser;exports.error=_error2.default;exports.extractLabel=_cell.extractLabel;exports.toLabel=_cell.toLabel;exports.columnIndexToLabel=_cell.columnIndexToLabel;exports.columnLabelToIndex=_cell.columnLabelToIndex;exports.rowIndexToLabel=_cell.rowIndexToLabel;exports.rowLabelToIndex=_cell.rowLabelToIndex;},function(module,exports,__webpack_require__){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.Parser=exports.SUPPORTED_FORMULAS=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"])_i["return"]();}finally{if(_d)throw _e;}}return _arr;}return function(arr,i){if(Array.isArray(arr)){return arr;}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i);}else{throw new TypeError("Invalid attempt to destructure non-iterable instance");}};}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _supportedFormulas=__webpack_require__(2);Object.defineProperty(exports,'SUPPORTED_FORMULAS',{enumerable:true,get:function get(){return _interopRequireDefault(_supportedFormulas).default;}});var _tinyEmitter=__webpack_require__(3);var _tinyEmitter2=_interopRequireDefault(_tinyEmitter);var _evaluateByOperator=__webpack_require__(4);var _evaluateByOperator2=_interopRequireDefault(_evaluateByOperator);var _grammarParser=__webpack_require__(40);var _string=__webpack_require__(42);var _number=__webpack_require__(6);var _error=__webpack_require__(7);var _error2=_interopRequireDefault(_error);var _cell=__webpack_require__(43);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
var Parser=function(_Emitter){_inherits(Parser,_Emitter);function Parser(){_classCallCheck(this,Parser);var _this=_possibleConstructorReturn(this,(Parser.__proto__||Object.getPrototypeOf(Parser)).call(this));_this.parser=new _grammarParser.Parser();_this.parser.yy={toNumber:_number.toNumber,trimEdges:_string.trimEdges,invertNumber:_number.invertNumber,throwError:function throwError(errorName){return _this._throwError(errorName);},callVariable:function callVariable(variable){return _this._callVariable(variable);},evaluateByOperator:_evaluateByOperator2.default,callFunction:_evaluateByOperator2.default,cellValue:function cellValue(value){return _this._callCellValue(value);},rangeValue:function rangeValue(start,end){return _this._callRangeValue(start,end);}};_this.variables=Object.create(null);_this.setVariable('TRUE',true).setVariable('FALSE',false).setVariable('NULL',null);return _this;}
_createClass(Parser,[{key:'parse',value:function parse(expression){var result=null;var error=null;try{if(expression===''){result='';}else{result=this.parser.parse(expression);}}catch(ex){var message=(0,_error2.default)(ex.message);if(message){error=message;}else{error=(0,_error2.default)(_error.ERROR);}}
if(result instanceof Error){error=(0,_error2.default)(result.message)||(0,_error2.default)(_error.ERROR);result=null;}
return{error:error,result:result};}},{key:'setVariable',value:function setVariable(name,value){this.variables[name]=value;return this;}},{key:'getVariable',value:function getVariable(name){return this.variables[name];}},{key:'_callVariable',value:function _callVariable(name){var value=this.getVariable(name);this.emit('callVariable',name,function(newValue){if(newValue!==void 0){value=newValue;}});if(value===void 0){throw Error(_error.ERROR_NAME);}
return value;}},{key:'_callCellValue',value:function _callCellValue(label){label=label.toUpperCase();var _extractLabel=(0,_cell.extractLabel)(label),_extractLabel2=_slicedToArray(_extractLabel,2),row=_extractLabel2[0],column=_extractLabel2[1];var value=void 0;this.emit('callCellValue',{label:label,row:row,column:column},function(_value){value=_value;});return value;}},{key:'_callRangeValue',value:function _callRangeValue(startLabel,endLabel){startLabel=startLabel.toUpperCase();endLabel=endLabel.toUpperCase();var _extractLabel3=(0,_cell.extractLabel)(startLabel),_extractLabel4=_slicedToArray(_extractLabel3,2),startRow=_extractLabel4[0],startColumn=_extractLabel4[1];var _extractLabel5=(0,_cell.extractLabel)(endLabel),_extractLabel6=_slicedToArray(_extractLabel5,2),endRow=_extractLabel6[0],endColumn=_extractLabel6[1];var startCell={};var endCell={};if(startRow.index<=endRow.index){startCell.row=startRow;endCell.row=endRow;}else{startCell.row=endRow;endCell.row=startRow;}
if(startColumn.index<=endColumn.index){startCell.column=startColumn;endCell.column=endColumn;}else{startCell.column=endColumn;endCell.column=startColumn;}
startCell.label=(0,_cell.toLabel)(startCell.row,startCell.column);endCell.label=(0,_cell.toLabel)(endCell.row,endCell.column);var value=[];this.emit('callRangeValue',startCell,endCell,function(){var _value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];value=_value;});return value;}},{key:'_throwError',value:function _throwError(errorName){if((0,_error.isValidStrict)(errorName)){throw Error(errorName);}
throw Error(_error.ERROR);}}]);return Parser;}(_tinyEmitter2.default);exports.Parser=Parser;},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});var SUPPORTED_FORMULAS=['ABS','ACCRINT','ACOS','ACOSH','ACOT','ACOTH','ADD','AGGREGATE','AND','ARABIC','ARGS2ARRAY','ASIN','ASINH','ATAN','ATAN2','ATANH','AVEDEV','AVERAGE','AVERAGEA','AVERAGEIF','AVERAGEIFS','BASE','BESSELI','BESSELJ','BESSELK','BESSELY','BETA.DIST','BETA.INV','BETADIST','BETAINV','BIN2DEC','BIN2HEX','BIN2OCT','BINOM.DIST','BINOM.DIST.RANGE','BINOM.INV','BINOMDIST','BITAND','BITLSHIFT','BITOR','BITRSHIFT','BITXOR','CEILING','CEILINGMATH','CEILINGPRECISE','CHAR','CHISQ.DIST','CHISQ.DIST.RT','CHISQ.INV','CHISQ.INV.RT','CHOOSE','CHOOSE','CLEAN','CODE','COLUMN','COLUMNS','COMBIN','COMBINA','COMPLEX','CONCATENATE','CONFIDENCE','CONFIDENCE.NORM','CONFIDENCE.T','CONVERT','CORREL','COS','COSH','COT','COTH','COUNT','COUNTA','COUNTBLANK','COUNTIF','COUNTIFS','COUNTIN','COUNTUNIQUE','COVARIANCE.P','COVARIANCE.S','CSC','CSCH','CUMIPMT','CUMPRINC','DATE','DATEVALUE','DAY','DAYS','DAYS360','DB','DDB','DEC2BIN','DEC2HEX','DEC2OCT','DECIMAL','DEGREES','DELTA','DEVSQ','DIVIDE','DOLLAR','DOLLARDE','DOLLARFR','E','EDATE','EFFECT','EOMONTH','EQ','ERF','ERFC','EVEN','EXACT','EXPON.DIST','EXPONDIST','F.DIST','F.DIST.RT','F.INV','F.INV.RT','FACT','FACTDOUBLE','FALSE','FDIST','FDISTRT','FIND','FINV','FINVRT','FISHER','FISHERINV','FIXED','FLATTEN','FLOOR','FORECAST','FREQUENCY','FV','FVSCHEDULE','GAMMA','GAMMA.DIST','GAMMA.INV','GAMMADIST','GAMMAINV','GAMMALN','GAMMALN.PRECISE','GAUSS','GCD','GEOMEAN','GESTEP','GROWTH','GTE','HARMEAN','HEX2BIN','HEX2DEC','HEX2OCT','HOUR','HTML2TEXT','HYPGEOM.DIST','HYPGEOMDIST','IF','IMABS','IMAGINARY','IMARGUMENT','IMCONJUGATE','IMCOS','IMCOSH','IMCOT','IMCSC','IMCSCH','IMDIV','IMEXP','IMLN','IMLOG10','IMLOG2','IMPOWER','IMPRODUCT','IMREAL','IMSEC','IMSECH','IMSIN','IMSINH','IMSQRT','IMSUB','IMSUM','IMTAN','INT','INTERCEPT','INTERVAL','IPMT','IRR','ISBINARY','ISBLANK','ISEVEN','ISLOGICAL','ISNONTEXT','ISNUMBER','ISODD','ISODD','ISOWEEKNUM','ISPMT','ISTEXT','JOIN','KURT','LARGE','LCM','LEFT','LEN','LINEST','LN','LOG','LOG10','LOGEST','LOGNORM.DIST','LOGNORM.INV','LOGNORMDIST','LOGNORMINV','LOWER','LT','LTE','MATCH','MAX','MAXA','MEDIAN','MID','MIN','MINA','MINUS','MINUTE','MIRR','MOD','MODE.MULT','MODE.SNGL','MODEMULT','MODESNGL','MONTH','MROUND','MULTINOMIAL','MULTIPLY','NE','NEGBINOM.DIST','NEGBINOMDIST','NETWORKDAYS','NOMINAL','NORM.DIST','NORM.INV','NORM.S.DIST','NORM.S.INV','NORMDIST','NORMINV','NORMSDIST','NORMSINV','NOT','NOW','NPER','NPV','NUMBERS','NUMERAL','OCT2BIN','OCT2DEC','OCT2HEX','ODD','OR','PDURATION','PEARSON','PERCENTILEEXC','PERCENTILEINC','PERCENTRANKEXC','PERCENTRANKINC','PERMUT','PERMUTATIONA','PHI','PI','PMT','POISSON.DIST','POISSONDIST','POW','POWER','PPMT','PROB','PRODUCT','PROPER','PV','QUARTILE.EXC','QUARTILE.INC','QUARTILEEXC','QUARTILEINC','QUOTIENT','RADIANS','RAND','RANDBETWEEN','RANK.AVG','RANK.EQ','RANKAVG','RANKEQ','RATE','REFERENCE','REGEXEXTRACT','REGEXMATCH','REGEXREPLACE','REPLACE','REPT','RIGHT','ROMAN','ROUND','ROUNDDOWN','ROUNDUP','ROW','ROWS','RRI','RSQ','SEARCH','SEC','SECH','SECOND','SERIESSUM','SIGN','SIN','SINH','SKEW','SKEW.P','SKEWP','SLN','SLOPE','SMALL','SPLIT','SPLIT','SQRT','SQRTPI','STANDARDIZE','STDEV.P','STDEV.S','STDEVA','STDEVP','STDEVPA','STDEVS','STEYX','SUBSTITUTE','SUBTOTAL','SUM','SUMIF','SUMIFS','SUMPRODUCT','SUMSQ','SUMX2MY2','SUMX2PY2','SUMXMY2','SWITCH','SYD','T','T.DIST','T.DIST.2T','T.DIST.RT','T.INV','T.INV.2T','TAN','TANH','TBILLEQ','TBILLPRICE','TBILLYIELD','TDIST','TDIST2T','TDISTRT','TEXT','TIME','TIMEVALUE','TINV','TINV2T','TODAY','TRANSPOSE','TREND','TRIM','TRIMMEAN','TRUE','TRUNC','UNICHAR','UNICODE','UNIQUE','UPPER','VALUE','VAR.P','VAR.S','VARA','VARP','VARPA','VARS','WEEKDAY','WEEKNUM','WEIBULL.DIST','WEIBULLDIST','WORKDAY','XIRR','XNPV','XOR','YEAR','YEARFRAC','FORMDATA'];exports.default=SUPPORTED_FORMULAS;},function(module,exports){function E(){}
E.prototype={on:function(name,callback,ctx){var e=this.e||(this.e={});(e[name]||(e[name]=[])).push({fn:callback,ctx:ctx});return this;},once:function(name,callback,ctx){var self=this;function listener(){self.off(name,listener);callback.apply(ctx,arguments);};listener._=callback
return this.on(name,listener,ctx);},emit:function(name){var data=[].slice.call(arguments,1);var evtArr=((this.e||(this.e={}))[name]||[]).slice();var i=0;var len=evtArr.length;for(i;i<len;i++){evtArr[i].fn.apply(evtArr[i].ctx,data);}
return this;},off:function(name,callback){var e=this.e||(this.e={});var evts=e[name];var liveEvents=[];if(evts&&callback){for(var i=0,len=evts.length;i<len;i++){if(evts[i].fn!==callback&&evts[i].fn._!==callback)
liveEvents.push(evts[i]);}}
(liveEvents.length)?e[name]=liveEvents:delete e[name];return this;}};module.exports=E;},function(module,exports,__webpack_require__){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.default=evaluateByOperator;exports.registerOperation=registerOperation;var _add=__webpack_require__(5);var _add2=_interopRequireDefault(_add);var _ampersand=__webpack_require__(8);var _ampersand2=_interopRequireDefault(_ampersand);var _divide=__webpack_require__(9);var _divide2=_interopRequireDefault(_divide);var _equal=__webpack_require__(10);var _equal2=_interopRequireDefault(_equal);var _formulaFunction=__webpack_require__(11);var _formulaFunction2=_interopRequireDefault(_formulaFunction);var _greaterThan=__webpack_require__(32);var _greaterThan2=_interopRequireDefault(_greaterThan);var _greaterThanOrEqual=__webpack_require__(33);var _greaterThanOrEqual2=_interopRequireDefault(_greaterThanOrEqual);var _lessThan=__webpack_require__(34);var _lessThan2=_interopRequireDefault(_lessThan);var _lessThanOrEqual=__webpack_require__(35);var _lessThanOrEqual2=_interopRequireDefault(_lessThanOrEqual);var _minus=__webpack_require__(36);var _minus2=_interopRequireDefault(_minus);var _multiply=__webpack_require__(37);var _multiply2=_interopRequireDefault(_multiply);var _notEqual=__webpack_require__(38);var _notEqual2=_interopRequireDefault(_notEqual);var _power=__webpack_require__(39);var _power2=_interopRequireDefault(_power);var _error=__webpack_require__(7);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}
var availableOperators=Object.create(null);registerOperation(_add2.default.SYMBOL,_add2.default);registerOperation(_ampersand2.default.SYMBOL,_ampersand2.default);registerOperation(_divide2.default.SYMBOL,_divide2.default);registerOperation(_equal2.default.SYMBOL,_equal2.default);registerOperation(_power2.default.SYMBOL,_power2.default);registerOperation(_formulaFunction2.default.SYMBOL,_formulaFunction2.default);registerOperation(_greaterThan2.default.SYMBOL,_greaterThan2.default);registerOperation(_greaterThanOrEqual2.default.SYMBOL,_greaterThanOrEqual2.default);registerOperation(_lessThan2.default.SYMBOL,_lessThan2.default);registerOperation(_lessThanOrEqual2.default.SYMBOL,_lessThanOrEqual2.default);registerOperation(_multiply2.default.SYMBOL,_multiply2.default);registerOperation(_notEqual2.default.SYMBOL,_notEqual2.default);registerOperation(_minus2.default.SYMBOL,_minus2.default);function getJsFunction(name){try{if($.isFunction(name)){return name;}
var parts=name.split(".");var func=null;if(parts[0]!==undefined&&parts[0]!==""){func=window[parts[0]];}
if(parts.length>1){for(var i=1;i<parts.length;i++){func=func[parts[i]];}}
return func;}catch(err){};return null;}
function evaluateByOperator(operator){var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var tempoperator=operator.toUpperCase();if(!availableOperators[tempoperator]){try{var jsFunc=getJsFunction(operator);return jsFunc.apply(null,_toConsumableArray(params));}catch(err){throw Error(_error.ERROR_NAME);}}
return availableOperators[tempoperator].apply(availableOperators,_toConsumableArray(params));}
function registerOperation(symbol,func){if(!Array.isArray(symbol)){symbol=[symbol.toUpperCase()];}
symbol.forEach(function(s){if(func.isFactory){availableOperators[s]=func(s);}else{availableOperators[s]=func;}});}},function(module,exports,__webpack_require__){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.SYMBOL=undefined;exports.default=func;var _number=__webpack_require__(6);var _error=__webpack_require__(7);var SYMBOL=exports.SYMBOL='+';function func(first){for(var _len=arguments.length,rest=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){rest[_key-1]=arguments[_key];}
var result=rest.reduce(function(acc,value){return acc+(0,_number.toNumber)(value);},(0,_number.toNumber)(first));if(isNaN(result)){throw Error(_error.ERROR_VALUE);}
return result;};func.SYMBOL=SYMBOL;},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.toNumber=toNumber;exports.invertNumber=invertNumber;function toNumber(number){var result=void 0;if(typeof number==='number'){result=number;}else if(typeof number==='string'){result=number.indexOf('.')>-1?parseFloat(number):parseInt(number,10);}
return result;}
function invertNumber(number){return-1*toNumber(number);}},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _errors;exports.default=error;exports.isValidStrict=isValidStrict;function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}
var ERROR=exports.ERROR='ERROR';var ERROR_DIV_ZERO=exports.ERROR_DIV_ZERO='DIV/0';var ERROR_NAME=exports.ERROR_NAME='NAME';var ERROR_NOT_AVAILABLE=exports.ERROR_NOT_AVAILABLE='N/A';var ERROR_NULL=exports.ERROR_NULL='NULL';var ERROR_NUM=exports.ERROR_NUM='NUM';var ERROR_REF=exports.ERROR_REF='REF';var ERROR_VALUE=exports.ERROR_VALUE='VALUE';var errors=(_errors={},_defineProperty(_errors,ERROR,'#ERROR!'),_defineProperty(_errors,ERROR_DIV_ZERO,'#DIV/0!'),_defineProperty(_errors,ERROR_NAME,'#NAME?'),_defineProperty(_errors,ERROR_NOT_AVAILABLE,'#N/A'),_defineProperty(_errors,ERROR_NULL,'#NULL!'),_defineProperty(_errors,ERROR_NUM,'#NUM!'),_defineProperty(_errors,ERROR_REF,'#REF!'),_defineProperty(_errors,ERROR_VALUE,'#VALUE!'),_errors);function error(type){var error=void 0;type=(type+'').replace(/#|!|\?/g,'');if(errors[type]){error=errors[type];}
return error?error:null;}
function isValidStrict(type){var valid=false;for(var i in errors){if(errors.hasOwnProperty(i)&&errors[i]===type){valid=true;break;}}
return valid;}},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.default=func;var SYMBOL=exports.SYMBOL='&';function func(){for(var _len=arguments.length,params=Array(_len),_key=0;_key<_len;_key++){params[_key]=arguments[_key];}
return params.reduce(function(acc,value){return acc+value.toString();},'');};func.SYMBOL=SYMBOL;},function(module,exports,__webpack_require__){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.SYMBOL=undefined;exports.default=func;var _number=__webpack_require__(6);var _error=__webpack_require__(7);var SYMBOL=exports.SYMBOL='/';function func(first){for(var _len=arguments.length,rest=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){rest[_key-1]=arguments[_key];}
var result=rest.reduce(function(acc,value){return acc/(0,_number.toNumber)(value);},(0,_number.toNumber)(first));if(result===Infinity){throw Error(_error.ERROR_DIV_ZERO);}
if(isNaN(result)){throw Error(_error.ERROR_VALUE);}
return result;};func.SYMBOL=SYMBOL;},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.default=func;var SYMBOL=exports.SYMBOL='=';function func(exp1,exp2){return exp1===exp2;};func.SYMBOL=SYMBOL;},function(module,exports,__webpack_require__){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.SYMBOL=undefined;exports.default=func;var _supportedFormulas=__webpack_require__(2);var _supportedFormulas2=_interopRequireDefault(_supportedFormulas);var _error=__webpack_require__(7);var _formulajs=__webpack_require__(12);var formulajs=_interopRequireWildcard(_formulajs);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj.default=obj;return newObj;}}
function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var SYMBOL=exports.SYMBOL=_supportedFormulas2.default;function func(symbol){return function(){symbol=symbol.toUpperCase();var symbolParts=symbol.split('.');var foundFormula=false;var result=void 0;if(symbolParts.length===1){if(formulajs[symbolParts[0]]){foundFormula=true;result=formulajs[symbolParts[0]].apply(formulajs,arguments);}}else{var length=symbolParts.length;var index=0;var nestedFormula=formulajs;while(index<length){nestedFormula=nestedFormula[symbolParts[index]];index++;if(!nestedFormula){nestedFormula=null;break;}}
if(nestedFormula){foundFormula=true;result=nestedFormula.apply(undefined,arguments);}}
if(!foundFormula){throw Error(_error.ERROR_NAME);}
return result;};};func.isFactory=true;func.SYMBOL=SYMBOL;},function(module,exports,__webpack_require__){var categories=[__webpack_require__(13),__webpack_require__(28),__webpack_require__(25),__webpack_require__(29),__webpack_require__(14),__webpack_require__(18),__webpack_require__(27),__webpack_require__(30),__webpack_require__(24),__webpack_require__(31),__webpack_require__(17),__webpack_require__(23)];for(var c in categories){var category=categories[c];for(var f in category){exports[f]=exports[f]||category[f];}}},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(14);var statistical=__webpack_require__(17);var engineering=__webpack_require__(25);var dateTime=__webpack_require__(27);function set(fn,root){if(root){for(var i in root){fn[i]=root[i];}}
return fn;}
exports.BETADIST=statistical.BETA.DIST;exports.BETAINV=statistical.BETA.INV;exports.BINOMDIST=statistical.BINOM.DIST;exports.CEILING=exports.ISOCEILING=set(mathTrig.CEILING.MATH,mathTrig.CEILING);exports.CEILINGMATH=mathTrig.CEILING.MATH;exports.CEILINGPRECISE=mathTrig.CEILING.PRECISE;exports.CHIDIST=statistical.CHISQ.DIST;exports.CHIDISTRT=statistical.CHISQ.DIST.RT;exports.CHIINV=statistical.CHISQ.INV;exports.CHIINVRT=statistical.CHISQ.INV.RT;exports.CHITEST=statistical.CHISQ.TEST;exports.CONFIDENCE=set(statistical.CONFIDENCE.NORM,statistical.CONFIDENCE);exports.COVAR=statistical.COVARIANCE.P;exports.COVARIANCEP=statistical.COVARIANCE.P;exports.COVARIANCES=statistical.COVARIANCE.S;exports.CRITBINOM=statistical.BINOM.INV;exports.EXPONDIST=statistical.EXPON.DIST;exports.ERFCPRECISE=engineering.ERFC.PRECISE;exports.ERFPRECISE=engineering.ERF.PRECISE;exports.FDIST=statistical.F.DIST;exports.FDISTRT=statistical.F.DIST.RT;exports.FINVRT=statistical.F.INV.RT;exports.FINV=statistical.F.INV;exports.FLOOR=set(mathTrig.FLOOR.MATH,mathTrig.FLOOR);exports.FLOORMATH=mathTrig.FLOOR.MATH;exports.FLOORPRECISE=mathTrig.FLOOR.PRECISE;exports.FTEST=statistical.F.TEST;exports.GAMMADIST=statistical.GAMMA.DIST;exports.GAMMAINV=statistical.GAMMA.INV;exports.GAMMALNPRECISE=statistical.GAMMALN.PRECISE;exports.HYPGEOMDIST=statistical.HYPGEOM.DIST;exports.LOGINV=statistical.LOGNORM.INV;exports.LOGNORMINV=statistical.LOGNORM.INV;exports.LOGNORMDIST=statistical.LOGNORM.DIST;exports.MODE=set(statistical.MODE.SNGL,statistical.MODE);exports.MODEMULT=statistical.MODE.MULT;exports.MODESNGL=statistical.MODE.SNGL;exports.NEGBINOMDIST=statistical.NEGBINOM.DIST;exports.NETWORKDAYSINTL=dateTime.NETWORKDAYS.INTL;exports.NORMDIST=statistical.NORM.DIST;exports.NORMINV=statistical.NORM.INV;exports.NORMSDIST=statistical.NORM.S.DIST;exports.NORMSINV=statistical.NORM.S.INV;exports.PERCENTILE=set(statistical.PERCENTILE.EXC,statistical.PERCENTILE);exports.PERCENTILEEXC=statistical.PERCENTILE.EXC;exports.PERCENTILEINC=statistical.PERCENTILE.INC;exports.PERCENTRANK=set(statistical.PERCENTRANK.INC,statistical.PERCENTRANK);exports.PERCENTRANKEXC=statistical.PERCENTRANK.EXC;exports.PERCENTRANKINC=statistical.PERCENTRANK.INC;exports.POISSON=set(statistical.POISSON.DIST,statistical.POISSON);exports.POISSONDIST=statistical.POISSON.DIST;exports.QUARTILE=set(statistical.QUARTILE.INC,statistical.QUARTILE);exports.QUARTILEEXC=statistical.QUARTILE.EXC;exports.QUARTILEINC=statistical.QUARTILE.INC;exports.RANK=set(statistical.RANK.EQ,statistical.RANK);exports.RANKAVG=statistical.RANK.AVG;exports.RANKEQ=statistical.RANK.EQ;exports.SKEWP=statistical.SKEW.P;exports.STDEV=set(statistical.STDEV.S,statistical.STDEV);exports.STDEVP=statistical.STDEV.P;exports.STDEVS=statistical.STDEV.S;exports.TDIST=statistical.T.DIST;exports.TDISTRT=statistical.T.DIST.RT;exports.TINV=statistical.T.INV;exports.TTEST=statistical.T.TEST;exports.VAR=set(statistical.VAR.S,statistical.VAR);exports.VARP=statistical.VAR.P;exports.VARS=statistical.VAR.S;exports.WEIBULL=set(statistical.WEIBULL.DIST,statistical.WEIBULL);exports.WEIBULLDIST=statistical.WEIBULL.DIST;exports.WORKDAYINTL=dateTime.WORKDAY.INTL;exports.ZTEST=statistical.Z.TEST;},function(module,exports,__webpack_require__){var utils=__webpack_require__(15);var error=__webpack_require__(16);var statistical=__webpack_require__(17);var information=__webpack_require__(24);exports.ABS=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var result=Math.abs(number);return result;};exports.ACOS=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var result=Math.acos(number);if(isNaN(result)){result=error.num;}
return result;};exports.ACOSH=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var result=Math.log(number+Math.sqrt(number*number-1));if(isNaN(result)){result=error.num;}
return result;};exports.ACOT=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var result=Math.atan(1/number);return result;};exports.ACOTH=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var result=0.5*Math.log((number+1)/(number-1));if(isNaN(result)){result=error.num;}
return result;};exports.AGGREGATE=function(function_num,options,ref1,ref2){function_num=utils.parseNumber(function_num);options=utils.parseNumber(function_num);if(utils.anyIsError(function_num,options)){return error.value;}
switch(function_num){case 1:return statistical.AVERAGE(ref1);case 2:return statistical.COUNT(ref1);case 3:return statistical.COUNTA(ref1);case 4:return statistical.MAX(ref1);case 5:return statistical.MIN(ref1);case 6:return exports.PRODUCT(ref1);case 7:return statistical.STDEV.S(ref1);case 8:return statistical.STDEV.P(ref1);case 9:return exports.SUM(ref1);case 10:return statistical.VAR.S(ref1);case 11:return statistical.VAR.P(ref1);case 12:return statistical.MEDIAN(ref1);case 13:return statistical.MODE.SNGL(ref1);case 14:return statistical.LARGE(ref1,ref2);case 15:return statistical.SMALL(ref1,ref2);case 16:return statistical.PERCENTILE.INC(ref1,ref2);case 17:return statistical.QUARTILE.INC(ref1,ref2);case 18:return statistical.PERCENTILE.EXC(ref1,ref2);case 19:return statistical.QUARTILE.EXC(ref1,ref2);}};exports.ARABIC=function(text){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)){return error.value;}
var r=0;text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(i){r+={M:1000,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[i];});return r;};exports.ASIN=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var result=Math.asin(number);if(isNaN(result)){result=error.num;}
return result;};exports.ASINH=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return Math.log(number+Math.sqrt(number*number+1));};exports.ATAN=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return Math.atan(number);};exports.ATAN2=function(number_x,number_y){number_x=utils.parseNumber(number_x);number_y=utils.parseNumber(number_y);if(utils.anyIsError(number_x,number_y)){return error.value;}
return Math.atan2(number_x,number_y);};exports.ATANH=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var result=Math.log((1+number)/(1-number))/2;if(isNaN(result)){result=error.num;}
return result;};exports.BASE=function(number,radix,min_length){min_length=min_length||0;number=utils.parseNumber(number);radix=utils.parseNumber(radix);min_length=utils.parseNumber(min_length);if(utils.anyIsError(number,radix,min_length)){return error.value;}
min_length=(min_length===undefined)?0:min_length;var result=number.toString(radix);return new Array(Math.max(min_length+1-result.length,0)).join('0')+result;};exports.CEILING=function(number,significance,mode){significance=(significance===undefined)?1:Math.abs(significance);mode=mode||0;number=utils.parseNumber(number);significance=utils.parseNumber(significance);mode=utils.parseNumber(mode);if(utils.anyIsError(number,significance,mode)){return error.value;}
if(significance===0){return 0;}
var precision=-Math.floor(Math.log(significance)/Math.log(10));if(number>=0){return exports.ROUND(Math.ceil(number/significance)*significance,precision);}else{if(mode===0){return-exports.ROUND(Math.floor(Math.abs(number)/significance)*significance,precision);}else{return-exports.ROUND(Math.ceil(Math.abs(number)/significance)*significance,precision);}}};exports.CEILING.MATH=exports.CEILING;exports.CEILING.PRECISE=exports.CEILING;exports.COMBIN=function(number,number_chosen){number=utils.parseNumber(number);number_chosen=utils.parseNumber(number_chosen);if(utils.anyIsError(number,number_chosen)){return error.value;}
return exports.FACT(number)/(exports.FACT(number_chosen)*exports.FACT(number-number_chosen));};exports.COMBINA=function(number,number_chosen){number=utils.parseNumber(number);number_chosen=utils.parseNumber(number_chosen);if(utils.anyIsError(number,number_chosen)){return error.value;}
return(number===0&&number_chosen===0)?1:exports.COMBIN(number+number_chosen-1,number-1);};exports.COS=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return Math.cos(number);};exports.COSH=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return(Math.exp(number)+Math.exp(-number))/2;};exports.COT=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return 1/Math.tan(number);};exports.COTH=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var e2=Math.exp(2*number);return(e2+1)/(e2-1);};exports.CSC=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return 1/Math.sin(number);};exports.CSCH=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return 2/(Math.exp(number)-Math.exp(-number));};exports.DECIMAL=function(number,radix){if(arguments.length<1){return error.value;}
return parseInt(number,radix);};exports.DEGREES=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return number*180/Math.PI;};exports.EVEN=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return exports.CEILING(number,-2,-1);};exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var n=Math.floor(number);if(n===0||n===1){return 1;}else if(MEMOIZED_FACT[n]>0){return MEMOIZED_FACT[n];}else{MEMOIZED_FACT[n]=exports.FACT(n-1)*n;return MEMOIZED_FACT[n];}};exports.FACTDOUBLE=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var n=Math.floor(number);if(n<=0){return 1;}else{return n*exports.FACTDOUBLE(n-2);}};exports.FLOOR=function(number,significance){number=utils.parseNumber(number);significance=utils.parseNumber(significance);if(utils.anyIsError(number,significance)){return error.value;}
if(significance===0){return 0;}
if(!(number>0&&significance>0)&&!(number<0&&significance<0)){return error.num;}
significance=Math.abs(significance);var precision=-Math.floor(Math.log(significance)/Math.log(10));if(number>=0){return exports.ROUND(Math.floor(number/significance)*significance,precision);}else{return-exports.ROUND(Math.ceil(Math.abs(number)/significance),precision);}};exports.FLOOR.MATH=function(number,significance,mode){significance=(significance===undefined)?1:significance;mode=(mode===undefined)?0:mode;number=utils.parseNumber(number);significance=utils.parseNumber(significance);mode=utils.parseNumber(mode);if(utils.anyIsError(number,significance,mode)){return error.value;}
if(significance===0){return 0;}
significance=significance?Math.abs(significance):1;var precision=-Math.floor(Math.log(significance)/Math.log(10));if(number>=0){return exports.ROUND(Math.floor(number/significance)*significance,precision);}else if(mode===0||mode===undefined){return-exports.ROUND(Math.ceil(Math.abs(number)/significance)*significance,precision);}
return-exports.ROUND(Math.floor(Math.abs(number)/significance)*significance,precision);};exports.FLOOR.PRECISE=exports.FLOOR.MATH;exports.GCD=function(){var range=utils.parseNumberArray(utils.flatten(arguments));if(range instanceof Error){return range;}
var n=range.length;var r0=range[0];var x=r0<0?-r0:r0;for(var i=1;i<n;i++){var ri=range[i];var y=ri<0?-ri:ri;while(x&&y){if(x>y){x%=y;}else{y%=x;}}
x+=y;}
return x;};exports.INT=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return Math.floor(number);};exports.ISO={CEILING:exports.CEILING};exports.LCM=function(){var o=utils.parseNumberArray(utils.flatten(arguments));if(o instanceof Error){return o;}
for(var i,j,n,d,r=1;(n=o.pop())!==undefined;){while(n>1){if(n%2){for(i=3,j=Math.floor(Math.sqrt(n));i<=j&&n%i;i+=2){}
d=(i<=j)?i:n;}else{d=2;}
for(n/=d,r*=d,i=o.length;i;(o[--i]%d)===0&&(o[i]/=d)===1&&o.splice(i,1)){}}}
return r;};exports.LN=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return Math.log(number);};exports.LN10=function(){return Math.log(10);};exports.LN2=function(){return Math.log(2);};exports.LOG10E=function(){return Math.LOG10E;};exports.LOG2E=function(){return Math.LOG2E;};exports.LOG=function(number,base){number=utils.parseNumber(number);base=utils.parseNumber(base);if(utils.anyIsError(number,base)){return error.value;}
base=(base===undefined)?10:base;return Math.log(number)/Math.log(base);};exports.LOG10=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return Math.log(number)/Math.log(10);};exports.MOD=function(dividend,divisor){dividend=utils.parseNumber(dividend);divisor=utils.parseNumber(divisor);if(utils.anyIsError(dividend,divisor)){return error.value;}
if(divisor===0){return error.div0;}
var modulus=Math.abs(dividend%divisor);return(divisor>0)?modulus:-modulus;};exports.MROUND=function(number,multiple){number=utils.parseNumber(number);multiple=utils.parseNumber(multiple);if(utils.anyIsError(number,multiple)){return error.value;}
if(number*multiple<0){return error.num;}
return Math.round(number/multiple)*multiple;};exports.MULTINOMIAL=function(){var args=utils.parseNumberArray(utils.flatten(arguments));if(args instanceof Error){return args;}
var sum=0;var divisor=1;for(var i=0;i<args.length;i++){sum+=args[i];divisor*=exports.FACT(args[i]);}
return exports.FACT(sum)/divisor;};exports.ODD=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var temp=Math.ceil(Math.abs(number));temp=(temp&1)?temp:temp+1;return(number>0)?temp:-temp;};exports.PI=function(){return Math.PI;};exports.E=function(){return Math.E;};exports.POWER=function(number,power){number=utils.parseNumber(number);power=utils.parseNumber(power);if(utils.anyIsError(number,power)){return error.value;}
var result=Math.pow(number,power);if(isNaN(result)){return error.num;}
return result;};exports.PRODUCT=function(){var args=utils.parseNumberArray(utils.flatten(arguments));if(args instanceof Error){return args;}
var result=1;for(var i=0;i<args.length;i++){result*=args[i];}
return result;};exports.QUOTIENT=function(numerator,denominator){numerator=utils.parseNumber(numerator);denominator=utils.parseNumber(denominator);if(utils.anyIsError(numerator,denominator)){return error.value;}
return parseInt(numerator/denominator,10);};exports.RADIANS=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return number*Math.PI/180;};exports.RAND=function(){return Math.random();};exports.RANDBETWEEN=function(bottom,top){bottom=utils.parseNumber(bottom);top=utils.parseNumber(top);if(utils.anyIsError(bottom,top)){return error.value;}
return bottom+Math.ceil((top-bottom+1)*Math.random())-1;};exports.ROMAN=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var digits=String(number).split('');var key=['','C','CC','CCC','CD','D','DC','DCC','DCCC','CM','','X','XX','XXX','XL','L','LX','LXX','LXXX','XC','','I','II','III','IV','V','VI','VII','VIII','IX'];var roman='';var i=3;while(i--){roman=(key[+digits.pop()+(i*10)]||'')+roman;}
return new Array(+digits.join('')+1).join('M')+roman;};exports.ROUND=function(number,digits){number=utils.parseNumber(number);digits=utils.parseNumber(digits);if(utils.anyIsError(number,digits)){return error.value;}
return Math.round(number*Math.pow(10,digits))/Math.pow(10,digits);};exports.ROUNDDOWN=function(number,digits){number=utils.parseNumber(number);digits=utils.parseNumber(digits);if(utils.anyIsError(number,digits)){return error.value;}
var sign=(number>0)?1:-1;return sign*(Math.floor(Math.abs(number)*Math.pow(10,digits)))/Math.pow(10,digits);};exports.ROUNDUP=function(number,digits){number=utils.parseNumber(number);digits=utils.parseNumber(digits);if(utils.anyIsError(number,digits)){return error.value;}
var sign=(number>0)?1:-1;return sign*(Math.ceil(Math.abs(number)*Math.pow(10,digits)))/Math.pow(10,digits);};exports.SEC=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return 1/Math.cos(number);};exports.SECH=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return 2/(Math.exp(number)+Math.exp(-number));};exports.SERIESSUM=function(x,n,m,coefficients){x=utils.parseNumber(x);n=utils.parseNumber(n);m=utils.parseNumber(m);coefficients=utils.parseNumberArray(coefficients);if(utils.anyIsError(x,n,m,coefficients)){return error.value;}
var result=coefficients[0]*Math.pow(x,n);for(var i=1;i<coefficients.length;i++){result+=coefficients[i]*Math.pow(x,n+i*m);}
return result;};exports.SIGN=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
if(number<0){return-1;}else if(number===0){return 0;}else{return 1;}};exports.SIN=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return Math.sin(number);};exports.SINH=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return(Math.exp(number)-Math.exp(-number))/2;};exports.SQRT=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
if(number<0){return error.num;}
return Math.sqrt(number);};exports.SQRTPI=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return Math.sqrt(number*Math.PI);};exports.SQRT1_2=function(){return 1/Math.sqrt(2);};exports.SQRT2=function(){return Math.sqrt(2);};exports.SUBTOTAL=function(function_code,ref1){function_code=utils.parseNumber(function_code);if(function_code instanceof Error){return function_code;}
switch(function_code){case 1:return statistical.AVERAGE(ref1);case 2:return statistical.COUNT(ref1);case 3:return statistical.COUNTA(ref1);case 4:return statistical.MAX(ref1);case 5:return statistical.MIN(ref1);case 6:return exports.PRODUCT(ref1);case 7:return statistical.STDEV.S(ref1);case 8:return statistical.STDEV.P(ref1);case 9:return exports.SUM(ref1);case 10:return statistical.VAR.S(ref1);case 11:return statistical.VAR.P(ref1);case 101:return statistical.AVERAGE(ref1);case 102:return statistical.COUNT(ref1);case 103:return statistical.COUNTA(ref1);case 104:return statistical.MAX(ref1);case 105:return statistical.MIN(ref1);case 106:return exports.PRODUCT(ref1);case 107:return statistical.STDEV.S(ref1);case 108:return statistical.STDEV.P(ref1);case 109:return exports.SUM(ref1);case 110:return statistical.VAR.S(ref1);case 111:return statistical.VAR.P(ref1);}};exports.ADD=function(num1,num2){if(arguments.length!==2){return error.na;}
num1=utils.parseNumber(num1);num2=utils.parseNumber(num2);if(utils.anyIsError(num1,num2)){return error.value;}
return num1+num2;};exports.MINUS=function(num1,num2){if(arguments.length!==2){return error.na;}
num1=utils.parseNumber(num1);num2=utils.parseNumber(num2);if(utils.anyIsError(num1,num2)){return error.value;}
return num1-num2;};exports.DIVIDE=function(dividend,divisor){if(arguments.length!==2){return error.na;}
dividend=utils.parseNumber(dividend);divisor=utils.parseNumber(divisor);if(utils.anyIsError(dividend,divisor)){return error.value;}
if(divisor===0){return error.div0;}
return dividend/divisor;};exports.MULTIPLY=function(factor1,factor2){if(arguments.length!==2){return error.na;}
factor1=utils.parseNumber(factor1);factor2=utils.parseNumber(factor2);if(utils.anyIsError(factor1,factor2)){return error.value;}
return factor1*factor2;};exports.GTE=function(num1,num2){if(arguments.length!==2){return error.na;}
num1=utils.parseNumber(num1);num2=utils.parseNumber(num2);if(utils.anyIsError(num1,num2)){return error.error;}
return num1>=num2;};exports.LT=function(num1,num2){if(arguments.length!==2){return error.na;}
num1=utils.parseNumber(num1);num2=utils.parseNumber(num2);if(utils.anyIsError(num1,num2)){return error.error;}
return num1<num2;};exports.LTE=function(num1,num2){if(arguments.length!==2){return error.na;}
num1=utils.parseNumber(num1);num2=utils.parseNumber(num2);if(utils.anyIsError(num1,num2)){return error.error;}
return num1<=num2;};exports.EQ=function(value1,value2){if(arguments.length!==2){return error.na;}
return value1===value2;};exports.NE=function(value1,value2){if(arguments.length!==2){return error.na;}
return value1!==value2;};exports.POW=function(base,exponent){if(arguments.length!==2){return error.na;}
base=utils.parseNumber(base);exponent=utils.parseNumber(exponent);if(utils.anyIsError(base,exponent)){return error.error;}
return exports.POWER(base,exponent);};exports.SUM=function(){var result=0;utils.arrayEach(utils.argsToArray(arguments),function(value){if(typeof value==='number'){result+=value;}else if(typeof value==='string'){var parsed=parseFloat(value);!isNaN(parsed)&&(result+=parsed);}else if(Array.isArray(value)){result+=exports.SUM.apply(null,value);}});return result;};exports.SUMIF=function(range,criteria){range=utils.parseNumberArray(utils.flatten(range));if(range instanceof Error){return range;}
var result=0;for(var i=0;i<range.length;i++){result+=(eval(range[i]+criteria))?range[i]:0;}
return result;};exports.SUMIFS=function(){var args=utils.argsToArray(arguments);var range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error){return range;}
var criteria=args;var n_range_elements=range.length;var n_criterias=criteria.length;var result=0;for(var i=0;i<n_range_elements;i++){var el=range[i];var condition='';for(var c=0;c<n_criterias;c++){condition+=el+criteria[c];if(c!==n_criterias-1){condition+='&&';}}
if(eval(condition)){result+=el;}}
return result;};exports.SUMPRODUCT=function(){if(!arguments||arguments.length===0){return error.value;}
var arrays=arguments.length+1;var result=0;var product;var k;var _i;var _ij;for(var i=0;i<arguments[0].length;i++){if(!(arguments[0][i]instanceof Array)){product=1;for(k=1;k<arrays;k++){_i=utils.parseNumber(arguments[k-1][i]);if(_i instanceof Error){return _i;}
product*=_i;}
result+=product;}else{for(var j=0;j<arguments[0][i].length;j++){product=1;for(k=1;k<arrays;k++){_ij=utils.parseNumber(arguments[k-1][i][j]);if(_ij instanceof Error){return _ij;}
product*=_ij;}
result+=product;}}}
return result;};exports.SUMSQ=function(){var numbers=utils.parseNumberArray(utils.flatten(arguments));if(numbers instanceof Error){return numbers;}
var result=0;var length=numbers.length;for(var i=0;i<length;i++){result+=(information.ISNUMBER(numbers[i]))?numbers[i]*numbers[i]:0;}
return result;};exports.SUMX2MY2=function(array_x,array_y){array_x=utils.parseNumberArray(utils.flatten(array_x));array_y=utils.parseNumberArray(utils.flatten(array_y));if(utils.anyIsError(array_x,array_y)){return error.value;}
var result=0;for(var i=0;i<array_x.length;i++){result+=array_x[i]*array_x[i]-array_y[i]*array_y[i];}
return result;};exports.SUMX2PY2=function(array_x,array_y){array_x=utils.parseNumberArray(utils.flatten(array_x));array_y=utils.parseNumberArray(utils.flatten(array_y));if(utils.anyIsError(array_x,array_y)){return error.value;}
var result=0;array_x=utils.parseNumberArray(utils.flatten(array_x));array_y=utils.parseNumberArray(utils.flatten(array_y));for(var i=0;i<array_x.length;i++){result+=array_x[i]*array_x[i]+array_y[i]*array_y[i];}
return result;};exports.SUMXMY2=function(array_x,array_y){array_x=utils.parseNumberArray(utils.flatten(array_x));array_y=utils.parseNumberArray(utils.flatten(array_y));if(utils.anyIsError(array_x,array_y)){return error.value;}
var result=0;array_x=utils.flatten(array_x);array_y=utils.flatten(array_y);for(var i=0;i<array_x.length;i++){result+=Math.pow(array_x[i]-array_y[i],2);}
return result;};exports.TAN=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return Math.tan(number);};exports.TANH=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var e2=Math.exp(2*number);return(e2-1)/(e2+1);};exports.TRUNC=function(number,digits){digits=(digits===undefined)?0:digits;number=utils.parseNumber(number);digits=utils.parseNumber(digits);if(utils.anyIsError(number,digits)){return error.value;}
var sign=(number>0)?1:-1;return sign*(Math.floor(Math.abs(number)*Math.pow(10,digits)))/Math.pow(10,digits);};},function(module,exports,__webpack_require__){var error=__webpack_require__(16);exports.flattenShallow=function(array){if(!array||!array.reduce){return array;}
return array.reduce(function(a,b){var aIsArray=Array.isArray(a);var bIsArray=Array.isArray(b);if(aIsArray&&bIsArray){return a.concat(b);}
if(aIsArray){a.push(b);return a;}
if(bIsArray){return[a].concat(b);}
return[a,b];});};exports.isFlat=function(array){if(!array){return false;}
for(var i=0;i<array.length;++i){if(Array.isArray(array[i])){return false;}}
return true;};exports.flatten=function(){var result=exports.argsToArray.apply(null,arguments);while(!exports.isFlat(result)){result=exports.flattenShallow(result);}
return result;};exports.argsToArray=function(args){var result=[];exports.arrayEach(args,function(value){result.push(value);});return result;};exports.numbers=function(){var possibleNumbers=this.flatten.apply(null,arguments);return possibleNumbers.filter(function(el){return typeof el==='number';});};exports.cleanFloat=function(number){var power=1e14;return Math.round(number*power)/power;};exports.parseBool=function(bool){if(typeof bool==='boolean'){return bool;}
if(bool instanceof Error){return bool;}
if(typeof bool==='number'){return bool!==0;}
if(typeof bool==='string'){var up=bool.toUpperCase();if(up==='TRUE'){return true;}
if(up==='FALSE'){return false;}}
if(bool instanceof Date&&!isNaN(bool)){return true;}
return error.value;};exports.parseNumber=function(string){if(string===undefined||string===''){return error.value;}
if(!isNaN(string)){return parseFloat(string);}
return error.value;};exports.parseNumberArray=function(arr){var len;if(!arr||(len=arr.length)===0){return error.value;}
var parsed;while(len--){parsed=exports.parseNumber(arr[len]);if(parsed===error.value){return parsed;}
arr[len]=parsed;}
return arr;};exports.parseMatrix=function(matrix){var n;if(!matrix||(n=matrix.length)===0){return error.value;}
var pnarr;for(var i=0;i<matrix.length;i++){pnarr=exports.parseNumberArray(matrix[i]);matrix[i]=pnarr;if(pnarr instanceof Error){return pnarr;}}
return matrix;};var d1900=new Date(1900,0,1);exports.parseDate=function(date){if(!isNaN(date)){if(date instanceof Date){return new Date(date);}
var d=parseInt(date,10);if(d<0){return error.num;}
if(d<=60){return new Date(d1900.getTime()+(d-1)*86400000);}
return new Date(d1900.getTime()+(d-2)*86400000);}
if(typeof date==='string'){date=new Date(date);if(!isNaN(date)){return date;}}
return error.value;};exports.parseDateArray=function(arr){var len=arr.length;var parsed;while(len--){parsed=this.parseDate(arr[len]);if(parsed===error.value){return parsed;}
arr[len]=parsed;}
return arr;};exports.anyIsError=function(){var n=arguments.length;while(n--){if(arguments[n]instanceof Error){return true;}}
return false;};exports.arrayValuesToNumbers=function(arr){var n=arr.length;var el;while(n--){el=arr[n];if(typeof el==='number'){continue;}
if(el===true){arr[n]=1;continue;}
if(el===false){arr[n]=0;continue;}
if(typeof el==='string'){var number=this.parseNumber(el);if(number instanceof Error){arr[n]=0;}else{arr[n]=number;}}}
return arr;};exports.rest=function(array,idx){idx=idx||1;if(!array||typeof array.slice!=='function'){return array;}
return array.slice(idx);};exports.initial=function(array,idx){idx=idx||1;if(!array||typeof array.slice!=='function'){return array;}
return array.slice(0,array.length-idx);};exports.arrayEach=function(array,iteratee){var index=-1,length=array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break;}}
return array;};},function(module,exports){exports.nil=new Error('#NULL!');exports.div0=new Error('#DIV/0!');exports.value=new Error('#VALUE!');exports.ref=new Error('#REF!');exports.name=new Error('#NAME?');exports.num=new Error('#NUM!');exports.na=new Error('#N/A');exports.error=new Error('#ERROR!');exports.data=new Error('#GETTING_DATA');},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(14);var text=__webpack_require__(18);var jStat=__webpack_require__(22).jStat;var utils=__webpack_require__(15);var error=__webpack_require__(16);var misc=__webpack_require__(23);var SQRT2PI=2.5066282746310002;exports.AVEDEV=function(){var range=utils.parseNumberArray(utils.flatten(arguments));if(range instanceof Error){return range;}
return jStat.sum(jStat(range).subtract(jStat.mean(range)).abs()[0])/range.length;};exports.AVERAGE=function(){var range=utils.numbers(utils.flatten(arguments));var n=range.length;var sum=0;var count=0;var result;for(var i=0;i<n;i++){sum+=range[i];count+=1;}
result=sum/count;if(isNaN(result)){result=error.num;}
return result;};exports.AVERAGEA=function(){var range=utils.flatten(arguments);var n=range.length;var sum=0;var count=0;var result;for(var i=0;i<n;i++){var el=range[i];if(typeof el==='number'){sum+=el;}
if(el===true){sum++;}
if(el!==null){count++;}}
result=sum/count;if(isNaN(result)){result=error.num;}
return result;};exports.AVERAGEIF=function(range,criteria,average_range){if(arguments.length<=1){return error.na;}
average_range=average_range||range;range=utils.flatten(range);average_range=utils.parseNumberArray(utils.flatten(average_range));if(average_range instanceof Error){return average_range;}
var average_count=0;var result=0;for(var i=0;i<range.length;i++){if(eval(range[i]+criteria)){result+=average_range[i];average_count++;}}
return result/average_count;};exports.AVERAGEIFS=function(){var args=utils.argsToArray(arguments);var criteria=(args.length-1)/2;var range=utils.flatten(args[0]);var count=0;var result=0;for(var i=0;i<range.length;i++){var condition='';for(var j=0;j<criteria;j++){condition+=args[2*j+1][i]+args[2*j+2];if(j!==criteria-1){condition+='&&';}}
if(eval(condition)){result+=range[i];count++;}}
var average=result/count;if(isNaN(average)){return 0;}else{return average;}};exports.BETA={};exports.BETA.DIST=function(x,alpha,beta,cumulative,A,B){if(arguments.length<4){return error.value;}
A=(A===undefined)?0:A;B=(B===undefined)?1:B;x=utils.parseNumber(x);alpha=utils.parseNumber(alpha);beta=utils.parseNumber(beta);A=utils.parseNumber(A);B=utils.parseNumber(B);if(utils.anyIsError(x,alpha,beta,A,B)){return error.value;}
x=(x-A)/(B-A);return(cumulative)?jStat.beta.cdf(x,alpha,beta):jStat.beta.pdf(x,alpha,beta);};exports.BETA.INV=function(probability,alpha,beta,A,B){A=(A===undefined)?0:A;B=(B===undefined)?1:B;probability=utils.parseNumber(probability);alpha=utils.parseNumber(alpha);beta=utils.parseNumber(beta);A=utils.parseNumber(A);B=utils.parseNumber(B);if(utils.anyIsError(probability,alpha,beta,A,B)){return error.value;}
return jStat.beta.inv(probability,alpha,beta)*(B-A)+A;};exports.BINOM={};exports.BINOM.DIST=function(successes,trials,probability,cumulative){successes=utils.parseNumber(successes);trials=utils.parseNumber(trials);probability=utils.parseNumber(probability);cumulative=utils.parseNumber(cumulative);if(utils.anyIsError(successes,trials,probability,cumulative)){return error.value;}
return(cumulative)?jStat.binomial.cdf(successes,trials,probability):jStat.binomial.pdf(successes,trials,probability);};exports.BINOM.DIST.RANGE=function(trials,probability,successes,successes2){successes2=(successes2===undefined)?successes:successes2;trials=utils.parseNumber(trials);probability=utils.parseNumber(probability);successes=utils.parseNumber(successes);successes2=utils.parseNumber(successes2);if(utils.anyIsError(trials,probability,successes,successes2)){return error.value;}
var result=0;for(var i=successes;i<=successes2;i++){result+=mathTrig.COMBIN(trials,i)*Math.pow(probability,i)*Math.pow(1-probability,trials-i);}
return result;};exports.BINOM.INV=function(trials,probability,alpha){trials=utils.parseNumber(trials);probability=utils.parseNumber(probability);alpha=utils.parseNumber(alpha);if(utils.anyIsError(trials,probability,alpha)){return error.value;}
var x=0;while(x<=trials){if(jStat.binomial.cdf(x,trials,probability)>=alpha){return x;}
x++;}};exports.CHISQ={};exports.CHISQ.DIST=function(x,k,cumulative){x=utils.parseNumber(x);k=utils.parseNumber(k);if(utils.anyIsError(x,k)){return error.value;}
return(cumulative)?jStat.chisquare.cdf(x,k):jStat.chisquare.pdf(x,k);};exports.CHISQ.DIST.RT=function(x,k){if(!x|!k){return error.na;}
if(x<1||k>Math.pow(10,10)){return error.num;}
if((typeof x!=='number')||(typeof k!=='number')){return error.value;}
return 1-jStat.chisquare.cdf(x,k);};exports.CHISQ.INV=function(probability,k){probability=utils.parseNumber(probability);k=utils.parseNumber(k);if(utils.anyIsError(probability,k)){return error.value;}
return jStat.chisquare.inv(probability,k);};exports.CHISQ.INV.RT=function(p,k){if(!p|!k){return error.na;}
if(p<0||p>1||k<1||k>Math.pow(10,10)){return error.num;}
if((typeof p!=='number')||(typeof k!=='number')){return error.value;}
return jStat.chisquare.inv(1.0-p,k);};exports.CHISQ.TEST=function(observed,expected){if(arguments.length!==2){return error.na;}
if((!(observed instanceof Array))||(!(expected instanceof Array))){return error.value;}
if(observed.length!==expected.length){return error.value;}
if(observed[0]&&expected[0]&&observed[0].length!==expected[0].length){return error.value;}
var row=observed.length;var tmp,i,j;for(i=0;i<row;i++){if(!(observed[i]instanceof Array)){tmp=observed[i];observed[i]=[];observed[i].push(tmp);}
if(!(expected[i]instanceof Array)){tmp=expected[i];expected[i]=[];expected[i].push(tmp);}}
var col=observed[0].length;var dof=(col===1)?row-1:(row-1)*(col-1);var xsqr=0;var Pi=Math.PI;for(i=0;i<row;i++){for(j=0;j<col;j++){xsqr+=Math.pow((observed[i][j]-expected[i][j]),2)/expected[i][j];}}
function ChiSq(xsqr,dof){var p=Math.exp(-0.5*xsqr);if((dof%2)===1){p=p*Math.sqrt(2*xsqr/Pi);}
var k=dof;while(k>=2){p=p*xsqr/k;k=k-2;}
var t=p;var a=dof;while(t>0.0000000001*p){a=a+2;t=t*xsqr/a;p=p+t;}
return 1-p;}
return Math.round(ChiSq(xsqr,dof)*1000000)/1000000;};exports.COLUMN=function(matrix,index){if(arguments.length!==2){return error.na;}
if(index<0){return error.num;}
if(!(matrix instanceof Array)||(typeof index!=='number')){return error.value;}
if(matrix.length===0){return undefined;}
return jStat.col(matrix,index);};exports.COLUMNS=function(matrix){if(arguments.length!==1){return error.na;}
if(!(matrix instanceof Array)){return error.value;}
if(matrix.length===0){return 0;}
return jStat.cols(matrix);};exports.CONFIDENCE={};exports.CONFIDENCE.NORM=function(alpha,sd,n){alpha=utils.parseNumber(alpha);sd=utils.parseNumber(sd);n=utils.parseNumber(n);if(utils.anyIsError(alpha,sd,n)){return error.value;}
return jStat.normalci(1,alpha,sd,n)[1]-1;};exports.CONFIDENCE.T=function(alpha,sd,n){alpha=utils.parseNumber(alpha);sd=utils.parseNumber(sd);n=utils.parseNumber(n);if(utils.anyIsError(alpha,sd,n)){return error.value;}
return jStat.tci(1,alpha,sd,n)[1]-1;};exports.CORREL=function(array1,array2){array1=utils.parseNumberArray(utils.flatten(array1));array2=utils.parseNumberArray(utils.flatten(array2));if(utils.anyIsError(array1,array2)){return error.value;}
return jStat.corrcoeff(array1,array2);};exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length;};exports.COUNTA=function(){var range=utils.flatten(arguments);return range.length-exports.COUNTBLANK(range);};exports.COUNTIN=function(range,value){var result=0;range=utils.flatten(range);for(var i=0;i<range.length;i++){if(range[i]===value){result++;}}
return result;};exports.COUNTBLANK=function(){var range=utils.flatten(arguments);var blanks=0;var element;for(var i=0;i<range.length;i++){element=range[i];if(element===null||element===''){blanks++;}}
return blanks;};exports.COUNTIF=function(range,criteria){range=utils.flatten(range);if(!/[<>=!]/.test(criteria)){criteria='=="'+criteria+'"';}
var matches=0;for(var i=0;i<range.length;i++){if(typeof range[i]!=='string'){if(eval(range[i]+criteria)){matches++;}}else{if(eval('"'+range[i]+'"'+criteria)){matches++;}}}
return matches;};exports.COUNTIFS=function(){var args=utils.argsToArray(arguments);var results=new Array(utils.flatten(args[0]).length);for(var i=0;i<results.length;i++){results[i]=true;}
for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]);var criteria=args[i+1];if(!/[<>=!]/.test(criteria)){criteria='=="'+criteria+'"';}
for(var j=0;j<range.length;j++){if(typeof range[j]!=='string'){results[j]=results[j]&&eval(range[j]+criteria);}else{results[j]=results[j]&&eval('"'+range[j]+'"'+criteria);}}}
var result=0;for(i=0;i<results.length;i++){if(results[i]){result++;}}
return result;};exports.COUNTUNIQUE=function(){return misc.UNIQUE.apply(null,utils.flatten(arguments)).length;};exports.COVARIANCE={};exports.COVARIANCE.P=function(array1,array2){array1=utils.parseNumberArray(utils.flatten(array1));array2=utils.parseNumberArray(utils.flatten(array2));if(utils.anyIsError(array1,array2)){return error.value;}
var mean1=jStat.mean(array1);var mean2=jStat.mean(array2);var result=0;var n=array1.length;for(var i=0;i<n;i++){result+=(array1[i]-mean1)*(array2[i]-mean2);}
return result/n;};exports.COVARIANCE.S=function(array1,array2){array1=utils.parseNumberArray(utils.flatten(array1));array2=utils.parseNumberArray(utils.flatten(array2));if(utils.anyIsError(array1,array2)){return error.value;}
return jStat.covariance(array1,array2);};exports.DEVSQ=function(){var range=utils.parseNumberArray(utils.flatten(arguments));if(range instanceof Error){return range;}
var mean=jStat.mean(range);var result=0;for(var i=0;i<range.length;i++){result+=Math.pow((range[i]-mean),2);}
return result;};exports.EXPON={};exports.EXPON.DIST=function(x,lambda,cumulative){x=utils.parseNumber(x);lambda=utils.parseNumber(lambda);if(utils.anyIsError(x,lambda)){return error.value;}
return(cumulative)?jStat.exponential.cdf(x,lambda):jStat.exponential.pdf(x,lambda);};exports.F={};exports.F.DIST=function(x,d1,d2,cumulative){x=utils.parseNumber(x);d1=utils.parseNumber(d1);d2=utils.parseNumber(d2);if(utils.anyIsError(x,d1,d2)){return error.value;}
return(cumulative)?jStat.centralF.cdf(x,d1,d2):jStat.centralF.pdf(x,d1,d2);};exports.F.DIST.RT=function(x,d1,d2){if(arguments.length!==3){return error.na;}
if(x<0||d1<1||d2<1){return error.num;}
if((typeof x!=='number')||(typeof d1!=='number')||(typeof d2!=='number')){return error.value;}
return 1-jStat.centralF.cdf(x,d1,d2);};exports.F.INV=function(probability,d1,d2){probability=utils.parseNumber(probability);d1=utils.parseNumber(d1);d2=utils.parseNumber(d2);if(utils.anyIsError(probability,d1,d2)){return error.value;}
if(probability<=0.0||probability>1.0){return error.num;}
return jStat.centralF.inv(probability,d1,d2);};exports.F.INV.RT=function(p,d1,d2){if(arguments.length!==3){return error.na;}
if(p<0||p>1||d1<1||d1>Math.pow(10,10)||d2<1||d2>Math.pow(10,10)){return error.num;}
if((typeof p!=='number')||(typeof d1!=='number')||(typeof d2!=='number')){return error.value;}
return jStat.centralF.inv(1.0-p,d1,d2);};exports.F.TEST=function(array1,array2){if(!array1||!array2){return error.na;}
if(!(array1 instanceof Array)||!(array2 instanceof Array)){return error.na;}
if(array1.length<2||array2.length<2){return error.div0;}
var sumOfSquares=function(values,x1){var sum=0;for(var i=0;i<values.length;i++){sum+=Math.pow((values[i]-x1),2);}
return sum;};var x1=mathTrig.SUM(array1)/array1.length;var x2=mathTrig.SUM(array2)/array2.length;var sum1=sumOfSquares(array1,x1)/(array1.length-1);var sum2=sumOfSquares(array2,x2)/(array2.length-1);return sum1/sum2;};exports.FISHER=function(x){x=utils.parseNumber(x);if(x instanceof Error){return x;}
return Math.log((1+x)/(1-x))/2;};exports.FISHERINV=function(y){y=utils.parseNumber(y);if(y instanceof Error){return y;}
var e2y=Math.exp(2*y);return(e2y-1)/(e2y+1);};exports.FORECAST=function(x,data_y,data_x){x=utils.parseNumber(x);data_y=utils.parseNumberArray(utils.flatten(data_y));data_x=utils.parseNumberArray(utils.flatten(data_x));if(utils.anyIsError(x,data_y,data_x)){return error.value;}
var xmean=jStat.mean(data_x);var ymean=jStat.mean(data_y);var n=data_x.length;var num=0;var den=0;for(var i=0;i<n;i++){num+=(data_x[i]-xmean)*(data_y[i]-ymean);den+=Math.pow(data_x[i]-xmean,2);}
var b=num/den;var a=ymean-b*xmean;return a+b*x;};exports.FREQUENCY=function(data,bins){data=utils.parseNumberArray(utils.flatten(data));bins=utils.parseNumberArray(utils.flatten(bins));if(utils.anyIsError(data,bins)){return error.value;}
var n=data.length;var b=bins.length;var r=[];for(var i=0;i<=b;i++){r[i]=0;for(var j=0;j<n;j++){if(i===0){if(data[j]<=bins[0]){r[0]+=1;}}else if(i<b){if(data[j]>bins[i-1]&&data[j]<=bins[i]){r[i]+=1;}}else if(i===b){if(data[j]>bins[b-1]){r[b]+=1;}}}}
return r;};exports.GAMMA=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
if(number===0){return error.num;}
if(parseInt(number,10)===number&&number<0){return error.num;}
return jStat.gammafn(number);};exports.GAMMA.DIST=function(value,alpha,beta,cumulative){if(arguments.length!==4){return error.na;}
if(value<0||alpha<=0||beta<=0){return error.value;}
if((typeof value!=='number')||(typeof alpha!=='number')||(typeof beta!=='number')){return error.value;}
return cumulative?jStat.gamma.cdf(value,alpha,beta,true):jStat.gamma.pdf(value,alpha,beta,false);};exports.GAMMA.INV=function(probability,alpha,beta){if(arguments.length!==3){return error.na;}
if(probability<0||probability>1||alpha<=0||beta<=0){return error.num;}
if((typeof probability!=='number')||(typeof alpha!=='number')||(typeof beta!=='number')){return error.value;}
return jStat.gamma.inv(probability,alpha,beta);};exports.GAMMALN=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return jStat.gammaln(number);};exports.GAMMALN.PRECISE=function(x){if(arguments.length!==1){return error.na;}
if(x<=0){return error.num;}
if(typeof x!=='number'){return error.value;}
return jStat.gammaln(x);};exports.GAUSS=function(z){z=utils.parseNumber(z);if(z instanceof Error){return z;}
return jStat.normal.cdf(z,0,1)-0.5;};exports.GEOMEAN=function(){var args=utils.parseNumberArray(utils.flatten(arguments));if(args instanceof Error){return args;}
return jStat.geomean(args);};exports.GROWTH=function(known_y,known_x,new_x,use_const){known_y=utils.parseNumberArray(known_y);if(known_y instanceof Error){return known_y;}
var i;if(known_x===undefined){known_x=[];for(i=1;i<=known_y.length;i++){known_x.push(i);}}
if(new_x===undefined){new_x=[];for(i=1;i<=known_y.length;i++){new_x.push(i);}}
known_x=utils.parseNumberArray(known_x);new_x=utils.parseNumberArray(new_x);if(utils.anyIsError(known_x,new_x)){return error.value;}
if(use_const===undefined){use_const=true;}
var n=known_y.length;var avg_x=0;var avg_y=0;var avg_xy=0;var avg_xx=0;for(i=0;i<n;i++){var x=known_x[i];var y=Math.log(known_y[i]);avg_x+=x;avg_y+=y;avg_xy+=x*y;avg_xx+=x*x;}
avg_x/=n;avg_y/=n;avg_xy/=n;avg_xx/=n;var beta;var alpha;if(use_const){beta=(avg_xy-avg_x*avg_y)/(avg_xx-avg_x*avg_x);alpha=avg_y-beta*avg_x;}else{beta=avg_xy/avg_xx;alpha=0;}
var new_y=[];for(i=0;i<new_x.length;i++){new_y.push(Math.exp(alpha+beta*new_x[i]));}
return new_y;};exports.HARMEAN=function(){var range=utils.parseNumberArray(utils.flatten(arguments));if(range instanceof Error){return range;}
var n=range.length;var den=0;for(var i=0;i<n;i++){den+=1/range[i];}
return n/den;};exports.HYPGEOM={};exports.HYPGEOM.DIST=function(x,n,M,N,cumulative){x=utils.parseNumber(x);n=utils.parseNumber(n);M=utils.parseNumber(M);N=utils.parseNumber(N);if(utils.anyIsError(x,n,M,N)){return error.value;}
function pdf(x,n,M,N){return mathTrig.COMBIN(M,x)*mathTrig.COMBIN(N-M,n-x)/mathTrig.COMBIN(N,n);}
function cdf(x,n,M,N){var result=0;for(var i=0;i<=x;i++){result+=pdf(i,n,M,N);}
return result;}
return(cumulative)?cdf(x,n,M,N):pdf(x,n,M,N);};exports.INTERCEPT=function(known_y,known_x){known_y=utils.parseNumberArray(known_y);known_x=utils.parseNumberArray(known_x);if(utils.anyIsError(known_y,known_x)){return error.value;}
if(known_y.length!==known_x.length){return error.na;}
return exports.FORECAST(0,known_y,known_x);};exports.KURT=function(){var range=utils.parseNumberArray(utils.flatten(arguments));if(range instanceof Error){return range;}
var mean=jStat.mean(range);var n=range.length;var sigma=0;for(var i=0;i<n;i++){sigma+=Math.pow(range[i]-mean,4);}
sigma=sigma/Math.pow(jStat.stdev(range,true),4);return((n*(n+1))/((n-1)*(n-2)*(n-3)))*sigma-3*(n-1)*(n-1)/((n-2)*(n-3));};exports.LARGE=function(range,k){range=utils.parseNumberArray(utils.flatten(range));k=utils.parseNumber(k);if(utils.anyIsError(range,k)){return range;}
return range.sort(function(a,b){return b-a;})[k-1];};exports.LINEST=function(data_y,data_x){data_y=utils.parseNumberArray(utils.flatten(data_y));data_x=utils.parseNumberArray(utils.flatten(data_x));if(utils.anyIsError(data_y,data_x)){return error.value;}
var ymean=jStat.mean(data_y);var xmean=jStat.mean(data_x);var n=data_x.length;var num=0;var den=0;for(var i=0;i<n;i++){num+=(data_x[i]-xmean)*(data_y[i]-ymean);den+=Math.pow(data_x[i]-xmean,2);}
var m=num/den;var b=ymean-m*xmean;return[m,b];};exports.LOGEST=function(data_y,data_x){data_y=utils.parseNumberArray(utils.flatten(data_y));data_x=utils.parseNumberArray(utils.flatten(data_x));if(utils.anyIsError(data_y,data_x)){return error.value;}
for(var i=0;i<data_y.length;i++){data_y[i]=Math.log(data_y[i]);}
var result=exports.LINEST(data_y,data_x);result[0]=Math.round(Math.exp(result[0])*1000000)/1000000;result[1]=Math.round(Math.exp(result[1])*1000000)/1000000;return result;};exports.LOGNORM={};exports.LOGNORM.DIST=function(x,mean,sd,cumulative){x=utils.parseNumber(x);mean=utils.parseNumber(mean);sd=utils.parseNumber(sd);if(utils.anyIsError(x,mean,sd)){return error.value;}
return(cumulative)?jStat.lognormal.cdf(x,mean,sd):jStat.lognormal.pdf(x,mean,sd);};exports.LOGNORM.INV=function(probability,mean,sd){probability=utils.parseNumber(probability);mean=utils.parseNumber(mean);sd=utils.parseNumber(sd);if(utils.anyIsError(probability,mean,sd)){return error.value;}
return jStat.lognormal.inv(probability,mean,sd);};exports.MAX=function(){var range=utils.numbers(utils.flatten(arguments));return(range.length===0)?0:Math.max.apply(Math,range);};exports.MAXA=function(){var range=utils.arrayValuesToNumbers(utils.flatten(arguments));return(range.length===0)?0:Math.max.apply(Math,range);};exports.MEDIAN=function(){var range=utils.arrayValuesToNumbers(utils.flatten(arguments));var result=jStat.median(range);if(isNaN(result)){result=error.num;}
return result;};exports.MIN=function(){var range=utils.numbers(utils.flatten(arguments));return(range.length===0)?0:Math.min.apply(Math,range);};exports.MINA=function(){var range=utils.arrayValuesToNumbers(utils.flatten(arguments));return(range.length===0)?0:Math.min.apply(Math,range);};exports.MODE={};exports.MODE.MULT=function(){var range=utils.parseNumberArray(utils.flatten(arguments));if(range instanceof Error){return range;}
var n=range.length;var count={};var maxItems=[];var max=0;var currentItem;for(var i=0;i<n;i++){currentItem=range[i];count[currentItem]=count[currentItem]?count[currentItem]+1:1;if(count[currentItem]>max){max=count[currentItem];maxItems=[];}
if(count[currentItem]===max){maxItems[maxItems.length]=currentItem;}}
return maxItems;};exports.MODE.SNGL=function(){var range=utils.parseNumberArray(utils.flatten(arguments));if(range instanceof Error){return range;}
return exports.MODE.MULT(range).sort(function(a,b){return a-b;})[0];};exports.NEGBINOM={};exports.NEGBINOM.DIST=function(k,r,p,cumulative){k=utils.parseNumber(k);r=utils.parseNumber(r);p=utils.parseNumber(p);if(utils.anyIsError(k,r,p)){return error.value;}
return(cumulative)?jStat.negbin.cdf(k,r,p):jStat.negbin.pdf(k,r,p);};exports.NORM={};exports.NORM.DIST=function(x,mean,sd,cumulative){x=utils.parseNumber(x);mean=utils.parseNumber(mean);sd=utils.parseNumber(sd);if(utils.anyIsError(x,mean,sd)){return error.value;}
if(sd<=0){return error.num;}
return(cumulative)?jStat.normal.cdf(x,mean,sd):jStat.normal.pdf(x,mean,sd);};exports.NORM.INV=function(probability,mean,sd){probability=utils.parseNumber(probability);mean=utils.parseNumber(mean);sd=utils.parseNumber(sd);if(utils.anyIsError(probability,mean,sd)){return error.value;}
return jStat.normal.inv(probability,mean,sd);};exports.NORM.S={};exports.NORM.S.DIST=function(z,cumulative){z=utils.parseNumber(z);if(z instanceof Error){return error.value;}
return(cumulative)?jStat.normal.cdf(z,0,1):jStat.normal.pdf(z,0,1);};exports.NORM.S.INV=function(probability){probability=utils.parseNumber(probability);if(probability instanceof Error){return error.value;}
return jStat.normal.inv(probability,0,1);};exports.PEARSON=function(data_x,data_y){data_y=utils.parseNumberArray(utils.flatten(data_y));data_x=utils.parseNumberArray(utils.flatten(data_x));if(utils.anyIsError(data_y,data_x)){return error.value;}
var xmean=jStat.mean(data_x);var ymean=jStat.mean(data_y);var n=data_x.length;var num=0;var den1=0;var den2=0;for(var i=0;i<n;i++){num+=(data_x[i]-xmean)*(data_y[i]-ymean);den1+=Math.pow(data_x[i]-xmean,2);den2+=Math.pow(data_y[i]-ymean,2);}
return num/Math.sqrt(den1*den2);};exports.PERCENTILE={};exports.PERCENTILE.EXC=function(array,k){array=utils.parseNumberArray(utils.flatten(array));k=utils.parseNumber(k);if(utils.anyIsError(array,k)){return error.value;}
array=array.sort(function(a,b){{return a-b;}});var n=array.length;if(k<1/(n+1)||k>1-1/(n+1)){return error.num;}
var l=k*(n+1)-1;var fl=Math.floor(l);return utils.cleanFloat((l===fl)?array[l]:array[fl]+(l-fl)*(array[fl+1]-array[fl]));};exports.PERCENTILE.INC=function(array,k){array=utils.parseNumberArray(utils.flatten(array));k=utils.parseNumber(k);if(utils.anyIsError(array,k)){return error.value;}
array=array.sort(function(a,b){return a-b;});var n=array.length;var l=k*(n-1);var fl=Math.floor(l);return utils.cleanFloat((l===fl)?array[l]:array[fl]+(l-fl)*(array[fl+1]-array[fl]));};exports.PERCENTRANK={};exports.PERCENTRANK.EXC=function(array,x,significance){significance=(significance===undefined)?3:significance;array=utils.parseNumberArray(utils.flatten(array));x=utils.parseNumber(x);significance=utils.parseNumber(significance);if(utils.anyIsError(array,x,significance)){return error.value;}
array=array.sort(function(a,b){return a-b;});var uniques=misc.UNIQUE.apply(null,array);var n=array.length;var m=uniques.length;var power=Math.pow(10,significance);var result=0;var match=false;var i=0;while(!match&&i<m){if(x===uniques[i]){result=(array.indexOf(uniques[i])+1)/(n+1);match=true;}else if(x>=uniques[i]&&(x<uniques[i+1]||i===m-1)){result=(array.indexOf(uniques[i])+1+(x-uniques[i])/(uniques[i+1]-uniques[i]))/(n+1);match=true;}
i++;}
return Math.floor(result*power)/power;};exports.PERCENTRANK.INC=function(array,x,significance){significance=(significance===undefined)?3:significance;array=utils.parseNumberArray(utils.flatten(array));x=utils.parseNumber(x);significance=utils.parseNumber(significance);if(utils.anyIsError(array,x,significance)){return error.value;}
array=array.sort(function(a,b){return a-b;});var uniques=misc.UNIQUE.apply(null,array);var n=array.length;var m=uniques.length;var power=Math.pow(10,significance);var result=0;var match=false;var i=0;while(!match&&i<m){if(x===uniques[i]){result=array.indexOf(uniques[i])/(n-1);match=true;}else if(x>=uniques[i]&&(x<uniques[i+1]||i===m-1)){result=(array.indexOf(uniques[i])+(x-uniques[i])/(uniques[i+1]-uniques[i]))/(n-1);match=true;}
i++;}
return Math.floor(result*power)/power;};exports.PERMUT=function(number,number_chosen){number=utils.parseNumber(number);number_chosen=utils.parseNumber(number_chosen);if(utils.anyIsError(number,number_chosen)){return error.value;}
return mathTrig.FACT(number)/mathTrig.FACT(number-number_chosen);};exports.PERMUTATIONA=function(number,number_chosen){number=utils.parseNumber(number);number_chosen=utils.parseNumber(number_chosen);if(utils.anyIsError(number,number_chosen)){return error.value;}
return Math.pow(number,number_chosen);};exports.PHI=function(x){x=utils.parseNumber(x);if(x instanceof Error){return error.value;}
return Math.exp(-0.5*x*x)/SQRT2PI;};exports.POISSON={};exports.POISSON.DIST=function(x,mean,cumulative){x=utils.parseNumber(x);mean=utils.parseNumber(mean);if(utils.anyIsError(x,mean)){return error.value;}
return(cumulative)?jStat.poisson.cdf(x,mean):jStat.poisson.pdf(x,mean);};exports.PROB=function(range,probability,lower,upper){if(lower===undefined){return 0;}
upper=(upper===undefined)?lower:upper;range=utils.parseNumberArray(utils.flatten(range));probability=utils.parseNumberArray(utils.flatten(probability));lower=utils.parseNumber(lower);upper=utils.parseNumber(upper);if(utils.anyIsError(range,probability,lower,upper)){return error.value;}
if(lower===upper){return(range.indexOf(lower)>=0)?probability[range.indexOf(lower)]:0;}
var sorted=range.sort(function(a,b){return a-b;});var n=sorted.length;var result=0;for(var i=0;i<n;i++){if(sorted[i]>=lower&&sorted[i]<=upper){result+=probability[range.indexOf(sorted[i])];}}
return result;};exports.QUARTILE={};exports.QUARTILE.EXC=function(range,quart){range=utils.parseNumberArray(utils.flatten(range));quart=utils.parseNumber(quart);if(utils.anyIsError(range,quart)){return error.value;}
switch(quart){case 1:return exports.PERCENTILE.EXC(range,0.25);case 2:return exports.PERCENTILE.EXC(range,0.5);case 3:return exports.PERCENTILE.EXC(range,0.75);default:return error.num;}};exports.QUARTILE.INC=function(range,quart){range=utils.parseNumberArray(utils.flatten(range));quart=utils.parseNumber(quart);if(utils.anyIsError(range,quart)){return error.value;}
switch(quart){case 1:return exports.PERCENTILE.INC(range,0.25);case 2:return exports.PERCENTILE.INC(range,0.5);case 3:return exports.PERCENTILE.INC(range,0.75);default:return error.num;}};exports.RANK={};exports.RANK.AVG=function(number,range,order){number=utils.parseNumber(number);range=utils.parseNumberArray(utils.flatten(range));if(utils.anyIsError(number,range)){return error.value;}
range=utils.flatten(range);order=order||false;var sort=(order)?function(a,b){return a-b;}:function(a,b){return b-a;};range=range.sort(sort);var length=range.length;var count=0;for(var i=0;i<length;i++){if(range[i]===number){count++;}}
return(count>1)?(2*range.indexOf(number)+count+1)/2:range.indexOf(number)+1;};exports.RANK.EQ=function(number,range,order){number=utils.parseNumber(number);range=utils.parseNumberArray(utils.flatten(range));if(utils.anyIsError(number,range)){return error.value;}
order=order||false;var sort=(order)?function(a,b){return a-b;}:function(a,b){return b-a;};range=range.sort(sort);return range.indexOf(number)+1;};exports.ROW=function(matrix,index){if(arguments.length!==2){return error.na;}
if(index<0){return error.num;}
if(!(matrix instanceof Array)||(typeof index!=='number')){return error.value;}
if(matrix.length===0){return undefined;}
return jStat.row(matrix,index);};exports.ROWS=function(matrix){if(arguments.length!==1){return error.na;}
if(!(matrix instanceof Array)){return error.value;}
if(matrix.length===0){return 0;}
return jStat.rows(matrix);};exports.RSQ=function(data_x,data_y){data_x=utils.parseNumberArray(utils.flatten(data_x));data_y=utils.parseNumberArray(utils.flatten(data_y));if(utils.anyIsError(data_x,data_y)){return error.value;}
return Math.pow(exports.PEARSON(data_x,data_y),2);};exports.SKEW=function(){var range=utils.parseNumberArray(utils.flatten(arguments));if(range instanceof Error){return range;}
var mean=jStat.mean(range);var n=range.length;var sigma=0;for(var i=0;i<n;i++){sigma+=Math.pow(range[i]-mean,3);}
return n*sigma/((n-1)*(n-2)*Math.pow(jStat.stdev(range,true),3));};exports.SKEW.P=function(){var range=utils.parseNumberArray(utils.flatten(arguments));if(range instanceof Error){return range;}
var mean=jStat.mean(range);var n=range.length;var m2=0;var m3=0;for(var i=0;i<n;i++){m3+=Math.pow(range[i]-mean,3);m2+=Math.pow(range[i]-mean,2);}
m3=m3/n;m2=m2/n;return m3/Math.pow(m2,3/2);};exports.SLOPE=function(data_y,data_x){data_y=utils.parseNumberArray(utils.flatten(data_y));data_x=utils.parseNumberArray(utils.flatten(data_x));if(utils.anyIsError(data_y,data_x)){return error.value;}
var xmean=jStat.mean(data_x);var ymean=jStat.mean(data_y);var n=data_x.length;var num=0;var den=0;for(var i=0;i<n;i++){num+=(data_x[i]-xmean)*(data_y[i]-ymean);den+=Math.pow(data_x[i]-xmean,2);}
return num/den;};exports.SMALL=function(range,k){range=utils.parseNumberArray(utils.flatten(range));k=utils.parseNumber(k);if(utils.anyIsError(range,k)){return range;}
return range.sort(function(a,b){return a-b;})[k-1];};exports.STANDARDIZE=function(x,mean,sd){x=utils.parseNumber(x);mean=utils.parseNumber(mean);sd=utils.parseNumber(sd);if(utils.anyIsError(x,mean,sd)){return error.value;}
return(x-mean)/sd;};exports.STDEV={};exports.STDEV.P=function(){var v=exports.VAR.P.apply(this,arguments);var result=Math.sqrt(v);if(isNaN(result)){result=error.num;}
return result;};exports.STDEV.S=function(){var v=exports.VAR.S.apply(this,arguments);var result=Math.sqrt(v);return result;};exports.STDEVA=function(){var v=exports.VARA.apply(this,arguments);var result=Math.sqrt(v);return result;};exports.STDEVPA=function(){var v=exports.VARPA.apply(this,arguments);var result=Math.sqrt(v);if(isNaN(result)){result=error.num;}
return result;};exports.STEYX=function(data_y,data_x){data_y=utils.parseNumberArray(utils.flatten(data_y));data_x=utils.parseNumberArray(utils.flatten(data_x));if(utils.anyIsError(data_y,data_x)){return error.value;}
var xmean=jStat.mean(data_x);var ymean=jStat.mean(data_y);var n=data_x.length;var lft=0;var num=0;var den=0;for(var i=0;i<n;i++){lft+=Math.pow(data_y[i]-ymean,2);num+=(data_x[i]-xmean)*(data_y[i]-ymean);den+=Math.pow(data_x[i]-xmean,2);}
return Math.sqrt((lft-num*num/den)/(n-2));};exports.TRANSPOSE=function(matrix){if(!matrix){return error.na;}
return jStat.transpose(matrix);};exports.T=text.T;exports.T.DIST=function(x,df,cumulative){x=utils.parseNumber(x);df=utils.parseNumber(df);if(utils.anyIsError(x,df)){return error.value;}
return(cumulative)?jStat.studentt.cdf(x,df):jStat.studentt.pdf(x,df);};exports.T.DIST['2T']=function(x,df){if(arguments.length!==2){return error.na;}
if(x<0||df<1){return error.num;}
if((typeof x!=='number')||(typeof df!=='number')){return error.value;}
return(1-jStat.studentt.cdf(x,df))*2;};exports.T.DIST.RT=function(x,df){if(arguments.length!==2){return error.na;}
if(x<0||df<1){return error.num;}
if((typeof x!=='number')||(typeof df!=='number')){return error.value;}
return 1-jStat.studentt.cdf(x,df);};exports.T.INV=function(probability,df){probability=utils.parseNumber(probability);df=utils.parseNumber(df);if(utils.anyIsError(probability,df)){return error.value;}
return jStat.studentt.inv(probability,df);};exports.T.INV['2T']=function(probability,df){probability=utils.parseNumber(probability);df=utils.parseNumber(df);if(probability<=0||probability>1||df<1){return error.num;}
if(utils.anyIsError(probability,df)){return error.value;}
return Math.abs(jStat.studentt.inv(probability/2,df));};exports.T.TEST=function(data_x,data_y){data_x=utils.parseNumberArray(utils.flatten(data_x));data_y=utils.parseNumberArray(utils.flatten(data_y));if(utils.anyIsError(data_x,data_y)){return error.value;}
var mean_x=jStat.mean(data_x);var mean_y=jStat.mean(data_y);var s_x=0;var s_y=0;var i;for(i=0;i<data_x.length;i++){s_x+=Math.pow(data_x[i]-mean_x,2);}
for(i=0;i<data_y.length;i++){s_y+=Math.pow(data_y[i]-mean_y,2);}
s_x=s_x/(data_x.length-1);s_y=s_y/(data_y.length-1);var t=Math.abs(mean_x-mean_y)/Math.sqrt(s_x/data_x.length+s_y/data_y.length);return exports.T.DIST['2T'](t,data_x.length+data_y.length-2);};exports.TREND=function(data_y,data_x,new_data_x){data_y=utils.parseNumberArray(utils.flatten(data_y));data_x=utils.parseNumberArray(utils.flatten(data_x));new_data_x=utils.parseNumberArray(utils.flatten(new_data_x));if(utils.anyIsError(data_y,data_x,new_data_x)){return error.value;}
var linest=exports.LINEST(data_y,data_x);var m=linest[0];var b=linest[1];var result=[];new_data_x.forEach(function(x){result.push(m*x+b);});return result;};exports.TRIMMEAN=function(range,percent){range=utils.parseNumberArray(utils.flatten(range));percent=utils.parseNumber(percent);if(utils.anyIsError(range,percent)){return error.value;}
var trim=mathTrig.FLOOR(range.length*percent,2)/2;return jStat.mean(utils.initial(utils.rest(range.sort(function(a,b){return a-b;}),trim),trim));};exports.VAR={};exports.VAR.P=function(){var range=utils.numbers(utils.flatten(arguments));var n=range.length;var sigma=0;var mean=exports.AVERAGE(range);var result;for(var i=0;i<n;i++){sigma+=Math.pow(range[i]-mean,2);}
result=sigma/n;if(isNaN(result)){result=error.num;}
return result;};exports.VAR.S=function(){var range=utils.numbers(utils.flatten(arguments));var n=range.length;var sigma=0;var mean=exports.AVERAGE(range);for(var i=0;i<n;i++){sigma+=Math.pow(range[i]-mean,2);}
return sigma/(n-1);};exports.VARA=function(){var range=utils.flatten(arguments);var n=range.length;var sigma=0;var count=0;var mean=exports.AVERAGEA(range);for(var i=0;i<n;i++){var el=range[i];if(typeof el==='number'){sigma+=Math.pow(el-mean,2);}else if(el===true){sigma+=Math.pow(1-mean,2);}else{sigma+=Math.pow(0-mean,2);}
if(el!==null){count++;}}
return sigma/(count-1);};exports.VARPA=function(){var range=utils.flatten(arguments);var n=range.length;var sigma=0;var count=0;var mean=exports.AVERAGEA(range);var result;for(var i=0;i<n;i++){var el=range[i];if(typeof el==='number'){sigma+=Math.pow(el-mean,2);}else if(el===true){sigma+=Math.pow(1-mean,2);}else{sigma+=Math.pow(0-mean,2);}
if(el!==null){count++;}}
result=sigma/count;;if(isNaN(result)){result=error.num;}
return result;};exports.WEIBULL={};exports.WEIBULL.DIST=function(x,alpha,beta,cumulative){x=utils.parseNumber(x);alpha=utils.parseNumber(alpha);beta=utils.parseNumber(beta);if(utils.anyIsError(x,alpha,beta)){return error.value;}
return(cumulative)?1-Math.exp(-Math.pow(x/beta,alpha)):Math.pow(x,alpha-1)*Math.exp(-Math.pow(x/beta,alpha))*alpha/Math.pow(beta,alpha);};exports.Z={};exports.Z.TEST=function(range,x,sd){range=utils.parseNumberArray(utils.flatten(range));x=utils.parseNumber(x);if(utils.anyIsError(range,x)){return error.value;}
sd=sd||exports.STDEV.S(range);var n=range.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(range)-x)/(sd/Math.sqrt(n)),true);};},function(module,exports,__webpack_require__){var utils=__webpack_require__(15);var error=__webpack_require__(16);var numbro=__webpack_require__(19);exports.ASC=function(){throw new Error('ASC is not implemented');};exports.BAHTTEXT=function(){throw new Error('BAHTTEXT is not implemented');};exports.CHAR=function(number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return String.fromCharCode(number);};exports.CLEAN=function(text){text=text||'';var re=/[\0-\x1F]/g;return text.replace(re,"");};exports.CODE=function(text){text=text||'';var result=text.charCodeAt(0);if(isNaN(result)){result=error.na;}
return result;};exports.CONCATENATE=function(){var args=utils.flatten(arguments);var trueFound=0;while((trueFound=args.indexOf(true))>-1){args[trueFound]='TRUE';}
var falseFound=0;while((falseFound=args.indexOf(false))>-1){args[falseFound]='FALSE';}
return args.join('');};exports.DBCS=function(){throw new Error('DBCS is not implemented');};exports.DOLLAR=function(number,decimals){decimals=(decimals===undefined)?2:decimals;number=utils.parseNumber(number);decimals=utils.parseNumber(decimals);if(utils.anyIsError(number,decimals)){return error.value;}
var format='';if(decimals<=0){number=Math.round(number*Math.pow(10,decimals))/Math.pow(10,decimals);format='($0,0)';}else if(decimals>0){format='($0,0.'+new Array(decimals+1).join('0')+')';}
return numbro(number).format(format);};exports.EXACT=function(text1,text2){if(arguments.length!==2){return error.na;}
return text1===text2;};exports.FIND=function(find_text,within_text,position){if(arguments.length<2){return error.na;}
position=(position===undefined)?0:position;return within_text?within_text.indexOf(find_text,position-1)+1:null;};exports.FIXED=function(number,decimals,no_commas){decimals=(decimals===undefined)?2:decimals;no_commas=(no_commas===undefined)?false:no_commas;number=utils.parseNumber(number);decimals=utils.parseNumber(decimals);if(utils.anyIsError(number,decimals)){return error.value;}
var format=no_commas?'0':'0,0';if(decimals<=0){number=Math.round(number*Math.pow(10,decimals))/Math.pow(10,decimals);}else if(decimals>0){format+='.'+new Array(decimals+1).join('0');}
return numbro(number).format(format);};exports.HTML2TEXT=function(value){var result='';if(value){if(value instanceof Array){value.forEach(function(line){if(result!==''){result+='\n';}
result+=(line.replace(/<(?:.|\n)*?>/gm,''));});}else{result=value.replace(/<(?:.|\n)*?>/gm,'');}}
return result;};exports.LEFT=function(text,number){number=(number===undefined)?1:number;number=utils.parseNumber(number);if(number instanceof Error||typeof text!=='string'){return error.value;}
return text?text.substring(0,number):null;};exports.LEN=function(text){if(arguments.length===0){return error.error;}
if(typeof text==='string'){return text?text.length:0;}
if(text.length){return text.length;}
return error.value;};exports.LOWER=function(text){if(typeof text!=='string'){return error.value;}
return text?text.toLowerCase():text;};exports.MID=function(text,start,number){start=utils.parseNumber(start);number=utils.parseNumber(number);if(utils.anyIsError(start,number)||typeof text!=='string'){return number;}
var begin=start-1;var end=begin+number;return text.substring(begin,end);};exports.NUMBERVALUE=function(text,decimal_separator,group_separator){decimal_separator=(typeof decimal_separator==='undefined')?'.':decimal_separator;group_separator=(typeof group_separator==='undefined')?',':group_separator;return Number(text.replace(decimal_separator,'.').replace(group_separator,''));};exports.PRONETIC=function(){throw new Error('PRONETIC is not implemented');};exports.PROPER=function(text){if(text===undefined||text.length===0){return error.value;}
if(text===true){text='TRUE';}
if(text===false){text='FALSE';}
if(isNaN(text)&&typeof text==='number'){return error.value;}
if(typeof text==='number'){text=''+text;}
return text.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase();});};exports.REGEXEXTRACT=function(text,regular_expression){if(arguments.length<2){return error.na;}
var match=text.match(new RegExp(regular_expression));return match?(match[match.length>1?match.length-1:0]):null;};exports.REGEXMATCH=function(text,regular_expression,full){if(arguments.length<2){return error.na;}
var match=text.match(new RegExp(regular_expression));return full?match:!!match;};exports.REGEXREPLACE=function(text,regular_expression,replacement){if(arguments.length<3){return error.na;}
return text.replace(new RegExp(regular_expression),replacement);};exports.REPLACE=function(text,position,length,new_text){position=utils.parseNumber(position);length=utils.parseNumber(length);if(utils.anyIsError(position,length)||typeof text!=='string'||typeof new_text!=='string'){return error.value;}
return text.substr(0,position-1)+new_text+text.substr(position-1+length);};exports.REPT=function(text,number){number=utils.parseNumber(number);if(number instanceof Error){return number;}
return new Array(number+1).join(text);};exports.RIGHT=function(text,number){number=(number===undefined)?1:number;number=utils.parseNumber(number);if(number instanceof Error){return number;}
return text?text.substring(text.length-number):error.na;};exports.SEARCH=function(find_text,within_text,position){var foundAt;if(typeof find_text!=='string'||typeof within_text!=='string'){return error.value;}
position=(position===undefined)?0:position;foundAt=within_text.toLowerCase().indexOf(find_text.toLowerCase(),position-1)+1;return(foundAt===0)?error.value:foundAt;};exports.SPLIT=function(text,separator){return text.split(separator);};exports.SUBSTITUTE=function(text,old_text,new_text,occurrence){if(arguments.length<2){return error.na;}
if(!text||!old_text||!new_text){return text;}else if(occurrence===undefined){return text.replace(new RegExp(old_text,'g'),new_text);}else{var index=0;var i=0;while(text.indexOf(old_text,index)>0){index=text.indexOf(old_text,index+1);i++;if(i===occurrence){return text.substring(0,index)+new_text+text.substring(index+old_text.length);}}}};exports.T=function(value){return(typeof value==="string")?value:'';};exports.TEXT=function(value,format){value=utils.parseNumber(value);if(utils.anyIsError(value)){return error.na;}
return numbro(value).format(format);};exports.TRIM=function(text){if(typeof text!=='string'){return error.value;}
return text.replace(/ +/g,' ').trim();};exports.UNICHAR=exports.CHAR;exports.UNICODE=exports.CODE;exports.UPPER=function(text){if(typeof text!=='string'){return error.value;}
return text.toUpperCase();};exports.VALUE=function(text){if(typeof text!=='string'){return error.value;}
var result=numbro().unformat(text);return result===void 0?0:result;};},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(process){(function(){'use strict';var numbro,VERSION='1.9.3',binarySuffixes=['B','KiB','MiB','GiB','TiB','PiB','EiB','ZiB','YiB'],decimalSuffixes=['B','KB','MB','GB','TB','PB','EB','ZB','YB'],bytes={general:{scale:1024,suffixes:decimalSuffixes,marker:'bd'},binary:{scale:1024,suffixes:binarySuffixes,marker:'b'},decimal:{scale:1000,suffixes:decimalSuffixes,marker:'d'}},byteFormatOrder=[bytes.general,bytes.binary,bytes.decimal],cultures={},languages=cultures,currentCulture='en-US',zeroFormat=null,defaultFormat='0,0',defaultCurrencyFormat='0$',hasModule=(typeof module!=='undefined'&&module.exports),enUS={delimiters:{thousands:',',decimal:'.'},abbreviations:{thousand:'k',million:'m',billion:'b',trillion:'t'},ordinal:function(number){var b=number%10;return(~~(number%100/10)===1)?'th':(b===1)?'st':(b===2)?'nd':(b===3)?'rd':'th';},currency:{symbol:'$',position:'prefix'},defaults:{currencyFormat:',0000 a'},formats:{fourDigits:'0000 a',fullWithTwoDecimals:'$ ,0.00',fullWithTwoDecimalsNoCurrency:',0.00'}};function Numbro(number){this._value=number;}
function zeroes(count){var i,ret='';for(i=0;i<count;i++){ret+='0';}
return ret;}
function toFixedLargeSmall(value,precision){var mantissa,beforeDec,afterDec,exponent,prefix,endStr,zerosStr,str;str=value.toString();mantissa=str.split('e')[0];exponent=str.split('e')[1];beforeDec=mantissa.split('.')[0];afterDec=mantissa.split('.')[1]||'';if(+exponent>0){str=beforeDec+afterDec+zeroes(exponent-afterDec.length);}else{if(+beforeDec<0){prefix='-0';}else{prefix='0';}
if(precision>0){prefix+='.';}
zerosStr=zeroes((-1*exponent)-1);endStr=(zerosStr+Math.abs(beforeDec)+afterDec).substr(0,precision);str=prefix+endStr;}
if(+exponent>0&&precision>0){str+='.'+zeroes(precision);}
return str;}
function toFixed(value,precision,roundingFunction,optionals){var power=Math.pow(10,precision),optionalsRegExp,output;if(value.toString().indexOf('e')>-1){output=toFixedLargeSmall(value,precision);if(output.charAt(0)==='-'&&+output>=0){output=output.substr(1);}}
else{output=(roundingFunction(value+'e+'+precision)/power).toFixed(precision);}
if(optionals){optionalsRegExp=new RegExp('0{1,'+optionals+'}$');output=output.replace(optionalsRegExp,'');}
return output;}
function formatNumbro(n,format,roundingFunction){var output,escapedFormat=format.replace(/\{[^\{\}]*\}/g,'');if(escapedFormat.indexOf('$')>-1){output=formatCurrency(n,cultures[currentCulture].currency.symbol,format,roundingFunction);}else if(escapedFormat.indexOf('%')>-1){output=formatPercentage(n,format,roundingFunction);}else if(escapedFormat.indexOf(':')>-1){output=formatTime(n,format);}else{output=formatNumber(n._value,format,roundingFunction);}
return output;}
function unformatNumbro(n,string){var stringOriginal=string,thousandRegExp,millionRegExp,billionRegExp,trillionRegExp,bytesMultiplier=false,power;if(string.indexOf(':')>-1){n._value=unformatTime(string);}else{if(string===zeroFormat){n._value=0;}else{if(cultures[currentCulture].delimiters.decimal!=='.'){string=string.replace(/\./g,'').replace(cultures[currentCulture].delimiters.decimal,'.');}
thousandRegExp=new RegExp('[^a-zA-Z]'+cultures[currentCulture].abbreviations.thousand+'(?:\\)|(\\'+cultures[currentCulture].currency.symbol+')?(?:\\))?)?$');millionRegExp=new RegExp('[^a-zA-Z]'+cultures[currentCulture].abbreviations.million+'(?:\\)|(\\'+cultures[currentCulture].currency.symbol+')?(?:\\))?)?$');billionRegExp=new RegExp('[^a-zA-Z]'+cultures[currentCulture].abbreviations.billion+'(?:\\)|(\\'+cultures[currentCulture].currency.symbol+')?(?:\\))?)?$');trillionRegExp=new RegExp('[^a-zA-Z]'+cultures[currentCulture].abbreviations.trillion+'(?:\\)|(\\'+cultures[currentCulture].currency.symbol+')?(?:\\))?)?$');for(power=1;power<binarySuffixes.length&&!bytesMultiplier;++power){if(string.indexOf(binarySuffixes[power])>-1){bytesMultiplier=Math.pow(1024,power);}else if(string.indexOf(decimalSuffixes[power])>-1){bytesMultiplier=Math.pow(1000,power);}}
var str=string.replace(/[^0-9\.]+/g,'');if(str===''){n._value=NaN;}else{n._value=((bytesMultiplier)?bytesMultiplier:1)*((stringOriginal.match(thousandRegExp))?Math.pow(10,3):1)*((stringOriginal.match(millionRegExp))?Math.pow(10,6):1)*((stringOriginal.match(billionRegExp))?Math.pow(10,9):1)*((stringOriginal.match(trillionRegExp))?Math.pow(10,12):1)*((string.indexOf('%')>-1)?0.01:1)*(((string.split('-').length+
Math.min(string.split('(').length-1,string.split(')').length-1))%2)?1:-1)*Number(str);n._value=(bytesMultiplier)?Math.ceil(n._value):n._value;}}}
return n._value;}
function formatCurrency(n,currencySymbol,originalFormat,roundingFunction){var format=originalFormat,symbolIndex=format.indexOf('$'),openParenIndex=format.indexOf('('),plusSignIndex=format.indexOf('+'),minusSignIndex=format.indexOf('-'),space='',decimalSeparator='',spliceIndex,output;if(format.indexOf('$')===-1){if(cultures[currentCulture].currency.position==='infix'){decimalSeparator=currencySymbol;if(cultures[currentCulture].currency.spaceSeparated){decimalSeparator=' '+decimalSeparator+' ';}}else if(cultures[currentCulture].currency.spaceSeparated){space=' ';}}else{if(format.indexOf(' $')>-1){space=' ';format=format.replace(' $','');}else if(format.indexOf('$ ')>-1){space=' ';format=format.replace('$ ','');}else{format=format.replace('$','');}}
output=formatNumber(n._value,format,roundingFunction,decimalSeparator);if(originalFormat.indexOf('$')===-1){switch(cultures[currentCulture].currency.position){case'postfix':if(output.indexOf(')')>-1){output=output.split('');output.splice(-1,0,space+currencySymbol);output=output.join('');}else{output=output+space+currencySymbol;}
break;case'infix':break;case'prefix':if(output.indexOf('(')>-1||output.indexOf('-')>-1){output=output.split('');spliceIndex=Math.max(openParenIndex,minusSignIndex)+1;output.splice(spliceIndex,0,currencySymbol+space);output=output.join('');}else{output=currencySymbol+space+output;}
break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]');}}else{if(symbolIndex<=1){if(output.indexOf('(')>-1||output.indexOf('+')>-1||output.indexOf('-')>-1){output=output.split('');spliceIndex=1;if(symbolIndex<openParenIndex||symbolIndex<plusSignIndex||symbolIndex<minusSignIndex){spliceIndex=0;}
output.splice(spliceIndex,0,currencySymbol+space);output=output.join('');}else{output=currencySymbol+space+output;}}else{if(output.indexOf(')')>-1){output=output.split('');output.splice(-1,0,space+currencySymbol);output=output.join('');}else{output=output+space+currencySymbol;}}}
return output;}
function formatForeignCurrency(n,foreignCurrencySymbol,originalFormat,roundingFunction){return formatCurrency(n,foreignCurrencySymbol,originalFormat,roundingFunction);}
function formatPercentage(n,format,roundingFunction){var space='',output,value=n._value*100;if(format.indexOf(' %')>-1){space=' ';format=format.replace(' %','');}else{format=format.replace('%','');}
output=formatNumber(value,format,roundingFunction);if(output.indexOf(')')>-1){output=output.split('');output.splice(-1,0,space+'%');output=output.join('');}else{output=output+space+'%';}
return output;}
function formatTime(n){var hours=Math.floor(n._value/60/60),minutes=Math.floor((n._value-(hours*60*60))/60),seconds=Math.round(n._value-(hours*60*60)-(minutes*60));return hours+':'+
((minutes<10)?'0'+minutes:minutes)+':'+
((seconds<10)?'0'+seconds:seconds);}
function unformatTime(string){var timeArray=string.split(':'),seconds=0;if(timeArray.length===3){seconds=seconds+(Number(timeArray[0])*60*60);seconds=seconds+(Number(timeArray[1])*60);seconds=seconds+Number(timeArray[2]);}else if(timeArray.length===2){seconds=seconds+(Number(timeArray[0])*60);seconds=seconds+Number(timeArray[1]);}
return Number(seconds);}
function formatByteUnits(value,suffixes,scale){var suffix=suffixes[0],power,min,max,abs=Math.abs(value);if(abs>=scale){for(power=1;power<suffixes.length;++power){min=Math.pow(scale,power);max=Math.pow(scale,power+1);if(abs>=min&&abs<max){suffix=suffixes[power];value=value/min;break;}}
if(suffix===suffixes[0]){value=value/Math.pow(scale,suffixes.length-1);suffix=suffixes[suffixes.length-1];}}
return{value:value,suffix:suffix};}
function formatNumber(value,format,roundingFunction,sep){var negP=false,signed=false,optDec=false,abbr='',abbrK=false,abbrM=false,abbrB=false,abbrT=false,abbrForce=false,bytes='',byteFormat,units,ord='',abs=Math.abs(value),totalLength,length,minimumPrecision,pow,w,intPrecision,precision,prefix,postfix,thousands,d='',forcedNeg=false,neg=false,indexOpenP,size,indexMinus,paren='',minlen,i;if(value===0&&zeroFormat!==null){return zeroFormat;}
if(!isFinite(value)){return''+value;}
if(format.indexOf('{')===0){var end=format.indexOf('}');if(end===-1){throw Error('Format should also contain a "}"');}
prefix=format.slice(1,end);format=format.slice(end+1);}else{prefix='';}
if(format.indexOf('}')===format.length-1){var start=format.indexOf('{');if(start===-1){throw Error('Format should also contain a "{"');}
postfix=format.slice(start+1,-1);format=format.slice(0,start+1);}else{postfix='';}
var info;if(format.indexOf('.')===-1){info=format.match(/([0-9]+).*/);}else{info=format.match(/([0-9]+)\..*/);}
minlen=info===null?-1:info[1].length;if(format.indexOf('-')!==-1){forcedNeg=true;}
if(format.indexOf('(')>-1){negP=true;format=format.slice(1,-1);}else if(format.indexOf('+')>-1){signed=true;format=format.replace(/\+/g,'');}
if(format.indexOf('a')>-1){intPrecision=format.split('.')[0].match(/[0-9]+/g)||['0'];intPrecision=parseInt(intPrecision[0],10);abbrK=format.indexOf('aK')>=0;abbrM=format.indexOf('aM')>=0;abbrB=format.indexOf('aB')>=0;abbrT=format.indexOf('aT')>=0;abbrForce=abbrK||abbrM||abbrB||abbrT;if(format.indexOf(' a')>-1){abbr=' ';format=format.replace(' a','');}else{format=format.replace('a','');}
totalLength=Math.floor(Math.log(abs)/Math.LN10)+1;minimumPrecision=totalLength%3;minimumPrecision=minimumPrecision===0?3:minimumPrecision;if(intPrecision&&abs!==0){length=Math.floor(Math.log(abs)/Math.LN10)+1-intPrecision;pow=3*~~((Math.min(intPrecision,totalLength)-minimumPrecision)/3);abs=abs/Math.pow(10,pow);if(format.indexOf('.')===-1&&intPrecision>3){format+='[.]';size=length===0?0:3*~~(length/3)-length;size=size<0?size+3:size;format+=zeroes(size);}}
if(Math.floor(Math.log(Math.abs(value))/Math.LN10)+1!==intPrecision){if(abs>=Math.pow(10,12)&&!abbrForce||abbrT){abbr=abbr+cultures[currentCulture].abbreviations.trillion;value=value/Math.pow(10,12);}else if(abs<Math.pow(10,12)&&abs>=Math.pow(10,9)&&!abbrForce||abbrB){abbr=abbr+cultures[currentCulture].abbreviations.billion;value=value/Math.pow(10,9);}else if(abs<Math.pow(10,9)&&abs>=Math.pow(10,6)&&!abbrForce||abbrM){abbr=abbr+cultures[currentCulture].abbreviations.million;value=value/Math.pow(10,6);}else if(abs<Math.pow(10,6)&&abs>=Math.pow(10,3)&&!abbrForce||abbrK){abbr=abbr+cultures[currentCulture].abbreviations.thousand;value=value/Math.pow(10,3);}}}
for(i=0;i<byteFormatOrder.length;++i){byteFormat=byteFormatOrder[i];if(format.indexOf(byteFormat.marker)>-1){if(format.indexOf(' '+byteFormat.marker)>-1){bytes=' ';}
format=format.replace(bytes+byteFormat.marker,'');units=formatByteUnits(value,byteFormat.suffixes,byteFormat.scale);value=units.value;bytes=bytes+units.suffix;break;}}
if(format.indexOf('o')>-1){if(format.indexOf(' o')>-1){ord=' ';format=format.replace(' o','');}else{format=format.replace('o','');}
if(cultures[currentCulture].ordinal){ord=ord+cultures[currentCulture].ordinal(value);}}
if(format.indexOf('[.]')>-1){optDec=true;format=format.replace('[.]','.');}
w=value.toString().split('.')[0];precision=format.split('.')[1];thousands=format.indexOf(',');if(precision){if(precision.indexOf('*')!==-1){d=toFixed(value,value.toString().split('.')[1].length,roundingFunction);}else{if(precision.indexOf('[')>-1){precision=precision.replace(']','');precision=precision.split('[');d=toFixed(value,(precision[0].length+precision[1].length),roundingFunction,precision[1].length);}else{d=toFixed(value,precision.length,roundingFunction);}}
w=d.split('.')[0];if(d.split('.')[1].length){var p=sep?abbr+sep:cultures[currentCulture].delimiters.decimal;d=p+d.split('.')[1];}else{d='';}
if(optDec&&Number(d.slice(1))===0){d='';}}else{w=toFixed(value,0,roundingFunction);}
if(w.indexOf('-')>-1){w=w.slice(1);neg=true;}
if(w.length<minlen){w=zeroes(minlen-w.length)+w;}
if(thousands>-1){w=w.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,'$1'+
cultures[currentCulture].delimiters.thousands);}
if(format.indexOf('.')===0){w='';}
indexOpenP=format.indexOf('(');indexMinus=format.indexOf('-');if(indexOpenP<indexMinus){paren=((negP&&neg)?'(':'')+(((forcedNeg&&neg)||(!negP&&neg))?'-':'');}else{paren=(((forcedNeg&&neg)||(!negP&&neg))?'-':'')+((negP&&neg)?'(':'');}
return prefix+
paren+((!neg&&signed&&value!==0)?'+':'')+
w+d+
((ord)?ord:'')+
((abbr&&!sep)?abbr:'')+
((bytes)?bytes:'')+
((negP&&neg)?')':'')+
postfix;}
numbro=function(input){if(numbro.isNumbro(input)){input=input.value();}else if(input===0||typeof input==='undefined'){input=0;}else if(!Number(input)){input=numbro.fn.unformat(input);}
return new Numbro(Number(input));};numbro.version=VERSION;numbro.isNumbro=function(obj){return obj instanceof Numbro;};numbro.setLanguage=function(newLanguage,fallbackLanguage){console.warn('`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead');var key=newLanguage,prefix=newLanguage.split('-')[0],matchingLanguage=null;if(!languages[key]){Object.keys(languages).forEach(function(language){if(!matchingLanguage&&language.split('-')[0]===prefix){matchingLanguage=language;}});key=matchingLanguage||fallbackLanguage||'en-US';}
chooseCulture(key);};numbro.setCulture=function(newCulture,fallbackCulture){var key=newCulture,suffix=newCulture.split('-')[1],matchingCulture=null;if(!cultures[key]){if(suffix){Object.keys(cultures).forEach(function(language){if(!matchingCulture&&language.split('-')[1]===suffix){matchingCulture=language;}});}
key=matchingCulture||fallbackCulture||'en-US';}
chooseCulture(key);};numbro.language=function(key,values){console.warn('`language` is deprecated since version 1.6.0. Use `culture` instead');if(!key){return currentCulture;}
if(key&&!values){if(!languages[key]){throw new Error('Unknown language : '+key);}
chooseCulture(key);}
if(values||!languages[key]){setCulture(key,values);}
return numbro;};numbro.culture=function(code,values){if(!code){return currentCulture;}
if(code&&!values){if(!cultures[code]){throw new Error('Unknown culture : '+code);}
chooseCulture(code);}
if(values||!cultures[code]){setCulture(code,values);}
return numbro;};numbro.languageData=function(key){console.warn('`languageData` is deprecated since version 1.6.0. Use `cultureData` instead');if(!key){return languages[currentCulture];}
if(!languages[key]){throw new Error('Unknown language : '+key);}
return languages[key];};numbro.cultureData=function(code){if(!code){return cultures[currentCulture];}
if(!cultures[code]){throw new Error('Unknown culture : '+code);}
return cultures[code];};numbro.culture('en-US',enUS);numbro.languages=function(){console.warn('`languages` is deprecated since version 1.6.0. Use `cultures` instead');return languages;};numbro.cultures=function(){return cultures;};numbro.zeroFormat=function(format){zeroFormat=typeof(format)==='string'?format:null;};numbro.defaultFormat=function(format){defaultFormat=typeof(format)==='string'?format:'0.0';};numbro.defaultCurrencyFormat=function(format){defaultCurrencyFormat=typeof(format)==='string'?format:'0$';};numbro.validate=function(val,culture){var _decimalSep,_thousandSep,_currSymbol,_valArray,_abbrObj,_thousandRegEx,cultureData,temp;if(typeof val!=='string'){val+='';if(console.warn){console.warn('Numbro.js: Value is not string. It has been co-erced to: ',val);}}
val=val.trim();val=val.replace(/^[+-]?/,'');if(!!val.match(/^\d+$/)){return true;}
if(val===''){return false;}
try{cultureData=numbro.cultureData(culture);}catch(e){cultureData=numbro.cultureData(numbro.culture());}
_currSymbol=cultureData.currency.symbol;_abbrObj=cultureData.abbreviations;_decimalSep=cultureData.delimiters.decimal;if(cultureData.delimiters.thousands==='.'){_thousandSep='\\.';}else{_thousandSep=cultureData.delimiters.thousands;}
temp=val.match(/^[^\d\.\,]+/);if(temp!==null){val=val.substr(1);if(temp[0]!==_currSymbol){return false;}}
temp=val.match(/[^\d]+$/);if(temp!==null){val=val.slice(0,-1);if(temp[0]!==_abbrObj.thousand&&temp[0]!==_abbrObj.million&&temp[0]!==_abbrObj.billion&&temp[0]!==_abbrObj.trillion){return false;}}
_thousandRegEx=new RegExp(_thousandSep+'{2}');if(!val.match(/[^\d.,]/g)){_valArray=val.split(_decimalSep);if(_valArray.length>2){return false;}else{if(_valArray.length<2){return(!!_valArray[0].match(/^\d+.*\d$/)&&!_valArray[0].match(_thousandRegEx));}else{if(_valArray[0]===''){return(!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/));}else if(_valArray[0].length===1){return(!!_valArray[0].match(/^\d+$/)&&!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/));}else{return(!!_valArray[0].match(/^\d+.*\d$/)&&!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/));}}}}
return false;};numbro.loadLanguagesInNode=function(){console.warn('`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead');numbro.loadCulturesInNode();};numbro.loadCulturesInNode=function(){var cultures=__webpack_require__(21);for(var langLocaleCode in cultures){if(langLocaleCode){numbro.culture(langLocaleCode,cultures[langLocaleCode]);}}};function setCulture(code,values){cultures[code]=values;}
function chooseCulture(code){currentCulture=code;var defaults=cultures[code].defaults;if(defaults&&defaults.format){numbro.defaultFormat(defaults.format);}
if(defaults&&defaults.currencyFormat){numbro.defaultCurrencyFormat(defaults.currencyFormat);}}
function inNodejsRuntime(){return(typeof process!=='undefined')&&(process.browser===undefined)&&process.title&&(process.title.indexOf('node')===0||process.title.indexOf('meteor-tool')>0||process.title==='grunt'||process.title==='gulp')&&("function"!=='undefined');}
if('function'!==typeof Array.prototype.reduce){Array.prototype.reduce=function(callback,optInitialValue){if(null===this||'undefined'===typeof this){throw new TypeError('Array.prototype.reduce called on null or undefined');}
if('function'!==typeof callback){throw new TypeError(callback+' is not a function');}
var index,value,length=this.length>>>0,isValueSet=false;if(1<arguments.length){value=optInitialValue;isValueSet=true;}
for(index=0;length>index;++index){if(this.hasOwnProperty(index)){if(isValueSet){value=callback(value,this[index],index,this);}else{value=this[index];isValueSet=true;}}}
if(!isValueSet){throw new TypeError('Reduce of empty array with no initial value');}
return value;};}
function multiplier(x){var parts=x.toString().split('.');if(parts.length<2){return 1;}
return Math.pow(10,parts[1].length);}
function correctionFactor(){var args=Array.prototype.slice.call(arguments);return args.reduce(function(prev,next){var mp=multiplier(prev),mn=multiplier(next);return mp>mn?mp:mn;},-Infinity);}
numbro.fn=Numbro.prototype={clone:function(){return numbro(this);},format:function(inputString,roundingFunction){return formatNumbro(this,inputString?inputString:defaultFormat,(roundingFunction!==undefined)?roundingFunction:Math.round);},formatCurrency:function(inputString,roundingFunction){return formatCurrency(this,cultures[currentCulture].currency.symbol,inputString?inputString:defaultCurrencyFormat,(roundingFunction!==undefined)?roundingFunction:Math.round);},formatForeignCurrency:function(currencySymbol,inputString,roundingFunction){return formatForeignCurrency(this,currencySymbol,inputString?inputString:defaultCurrencyFormat,(roundingFunction!==undefined)?roundingFunction:Math.round);},unformat:function(inputString){if(typeof inputString==='number'){return inputString;}else if(typeof inputString==='string'){var result=unformatNumbro(this,inputString);return isNaN(result)?undefined:result;}else{return undefined;}},binaryByteUnits:function(){return formatByteUnits(this._value,bytes.binary.suffixes,bytes.binary.scale).suffix;},byteUnits:function(){return formatByteUnits(this._value,bytes.general.suffixes,bytes.general.scale).suffix;},decimalByteUnits:function(){return formatByteUnits(this._value,bytes.decimal.suffixes,bytes.decimal.scale).suffix;},value:function(){return this._value;},valueOf:function(){return this._value;},set:function(value){this._value=Number(value);return this;},add:function(value){var corrFactor=correctionFactor.call(null,this._value,value);function cback(accum,curr){return accum+corrFactor*curr;}
this._value=[this._value,value].reduce(cback,0)/corrFactor;return this;},subtract:function(value){var corrFactor=correctionFactor.call(null,this._value,value);function cback(accum,curr){return accum-corrFactor*curr;}
this._value=[value].reduce(cback,this._value*corrFactor)/corrFactor;return this;},multiply:function(value){function cback(accum,curr){var corrFactor=correctionFactor(accum,curr),result=accum*corrFactor;result*=curr*corrFactor;result/=corrFactor*corrFactor;return result;}
this._value=[this._value,value].reduce(cback,1);return this;},divide:function(value){function cback(accum,curr){var corrFactor=correctionFactor(accum,curr);return(accum*corrFactor)/(curr*corrFactor);}
this._value=[this._value,value].reduce(cback);return this;},difference:function(value){return Math.abs(numbro(this._value).subtract(value).value());}};if(inNodejsRuntime()){numbro.loadCulturesInNode();}
if(hasModule){module.exports=numbro;}else{if(typeof ender==='undefined'){this.numbro=numbro;}
if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return numbro;}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__));}}}.call(typeof window==='undefined'?this:window));}.call(exports,__webpack_require__(20)))},function(module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error('setTimeout has not been defined');}
function defaultClearTimeout(){throw new Error('clearTimeout has not been defined');}
(function(){try{if(typeof setTimeout==='function'){cachedSetTimeout=setTimeout;}else{cachedSetTimeout=defaultSetTimout;}}catch(e){cachedSetTimeout=defaultSetTimout;}
try{if(typeof clearTimeout==='function'){cachedClearTimeout=clearTimeout;}else{cachedClearTimeout=defaultClearTimeout;}}catch(e){cachedClearTimeout=defaultClearTimeout;}}())
function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0);}
if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0);}
try{return cachedSetTimeout(fun,0);}catch(e){try{return cachedSetTimeout.call(null,fun,0);}catch(e){return cachedSetTimeout.call(this,fun,0);}}}
function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker);}
if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker);}
try{return cachedClearTimeout(marker);}catch(e){try{return cachedClearTimeout.call(null,marker);}catch(e){return cachedClearTimeout.call(this,marker);}}}
var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return;}
draining=false;if(currentQueue.length){queue=currentQueue.concat(queue);}else{queueIndex=-1;}
if(queue.length){drainQueue();}}
function drainQueue(){if(draining){return;}
var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run();}}
queueIndex=-1;len=queue.length;}
currentQueue=null;draining=false;runClearTimeout(timeout);}
process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i];}}
queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue);}};function Item(fun,array){this.fun=fun;this.array=array;}
Item.prototype.run=function(){this.fun.apply(null,this.array);};process.title='browser';process.browser=true;process.env={};process.argv=[];process.version='';process.versions={};function noop(){}
process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.binding=function(name){throw new Error('process.binding is not supported');};process.cwd=function(){return'/'};process.chdir=function(dir){throw new Error('process.chdir is not supported');};process.umask=function(){return 0;};},function(module,exports){},function(module,exports){this.j$=this.jStat=(function(Math,undefined){var concat=Array.prototype.concat;var slice=Array.prototype.slice;var toString=Object.prototype.toString;function calcRdx(n,m){var val=n>m?n:m;return Math.pow(10,17-~~(Math.log(((val>0)?val:-val))*Math.LOG10E));}
var isArray=Array.isArray||function isArray(arg){return toString.call(arg)==='[object Array]';};function isFunction(arg){return toString.call(arg)==='[object Function]';}
function isNumber(arg){return typeof arg==='number'&&arg===arg;}
function toVector(arr){return concat.apply([],arr);}
function jStat(){return new jStat._init(arguments);}
jStat.fn=jStat.prototype;jStat._init=function _init(args){var i;if(isArray(args[0])){if(isArray(args[0][0])){if(isFunction(args[1]))
args[0]=jStat.map(args[0],args[1]);for(var i=0;i<args[0].length;i++)
this[i]=args[0][i];this.length=args[0].length;}else{this[0]=isFunction(args[1])?jStat.map(args[0],args[1]):args[0];this.length=1;}}else if(isNumber(args[0])){this[0]=jStat.seq.apply(null,args);this.length=1;}else if(args[0]instanceof jStat){return jStat(args[0].toArray());}else{this[0]=[];this.length=1;}
return this;};jStat._init.prototype=jStat.prototype;jStat._init.constructor=jStat;jStat.utils={calcRdx:calcRdx,isArray:isArray,isFunction:isFunction,isNumber:isNumber,toVector:toVector};jStat.extend=function extend(obj){var i,j;if(arguments.length===1){for(j in obj)
jStat[j]=obj[j];return this;}
for(var i=1;i<arguments.length;i++){for(j in arguments[i])
obj[j]=arguments[i][j];}
return obj;};jStat.rows=function rows(arr){return arr.length||1;};jStat.cols=function cols(arr){return arr[0].length||1;};jStat.dimensions=function dimensions(arr){return{rows:jStat.rows(arr),cols:jStat.cols(arr)};};jStat.row=function row(arr,index){if(isArray(index)){return index.map(function(i){return jStat.row(arr,i);})}
return arr[index];};jStat.rowa=function rowa(arr,i){return jStat.row(arr,i);};jStat.col=function col(arr,index){if(isArray(index)){var submat=jStat.arange(arr.length).map(function(i){return new Array(index.length);});index.forEach(function(ind,i){jStat.arange(arr.length).forEach(function(j){submat[j][i]=arr[j][ind];});});return submat;}
var column=new Array(arr.length);for(var i=0;i<arr.length;i++)
column[i]=[arr[i][index]];return column;};jStat.cola=function cola(arr,i){return jStat.col(arr,i).map(function(a){return a[0]});};jStat.diag=function diag(arr){var nrow=jStat.rows(arr);var res=new Array(nrow);for(var row=0;row<nrow;row++)
res[row]=[arr[row][row]];return res;};jStat.antidiag=function antidiag(arr){var nrow=jStat.rows(arr)-1;var res=new Array(nrow);for(var i=0;nrow>=0;nrow--,i++)
res[i]=[arr[i][nrow]];return res;};jStat.transpose=function transpose(arr){var obj=[];var objArr,rows,cols,j,i;if(!isArray(arr[0]))
arr=[arr];rows=arr.length;cols=arr[0].length;for(var i=0;i<cols;i++){objArr=new Array(rows);for(j=0;j<rows;j++)
objArr[j]=arr[j][i];obj.push(objArr);}
return obj.length===1?obj[0]:obj;};jStat.map=function map(arr,func,toAlter){var row,nrow,ncol,res,col;if(!isArray(arr[0]))
arr=[arr];nrow=arr.length;ncol=arr[0].length;res=toAlter?arr:new Array(nrow);for(row=0;row<nrow;row++){if(!res[row])
res[row]=new Array(ncol);for(col=0;col<ncol;col++)
res[row][col]=func(arr[row][col],row,col);}
return res.length===1?res[0]:res;};jStat.cumreduce=function cumreduce(arr,func,toAlter){var row,nrow,ncol,res,col;if(!isArray(arr[0]))
arr=[arr];nrow=arr.length;ncol=arr[0].length;res=toAlter?arr:new Array(nrow);for(row=0;row<nrow;row++){if(!res[row])
res[row]=new Array(ncol);if(ncol>0)
res[row][0]=arr[row][0];for(col=1;col<ncol;col++)
res[row][col]=func(res[row][col-1],arr[row][col]);}
return res.length===1?res[0]:res;};jStat.alter=function alter(arr,func){return jStat.map(arr,func,true);};jStat.create=function create(rows,cols,func){var res=new Array(rows);var i,j;if(isFunction(cols)){func=cols;cols=rows;}
for(var i=0;i<rows;i++){res[i]=new Array(cols);for(j=0;j<cols;j++)
res[i][j]=func(i,j);}
return res;};function retZero(){return 0;}
jStat.zeros=function zeros(rows,cols){if(!isNumber(cols))
cols=rows;return jStat.create(rows,cols,retZero);};function retOne(){return 1;}
jStat.ones=function ones(rows,cols){if(!isNumber(cols))
cols=rows;return jStat.create(rows,cols,retOne);};jStat.rand=function rand(rows,cols){if(!isNumber(cols))
cols=rows;return jStat.create(rows,cols,Math.random);};function retIdent(i,j){return i===j?1:0;}
jStat.identity=function identity(rows,cols){if(!isNumber(cols))
cols=rows;return jStat.create(rows,cols,retIdent);};jStat.symmetric=function symmetric(arr){var issymmetric=true;var size=arr.length;var row,col;if(arr.length!==arr[0].length)
return false;for(row=0;row<size;row++){for(col=0;col<size;col++)
if(arr[col][row]!==arr[row][col])
return false;}
return true;};jStat.clear=function clear(arr){return jStat.alter(arr,retZero);};jStat.seq=function seq(min,max,length,func){if(!isFunction(func))
func=false;var arr=[];var hival=calcRdx(min,max);var step=(max*hival-min*hival)/((length-1)*hival);var current=min;var cnt;for(cnt=0;current<=max;cnt++,current=(min*hival+step*hival*cnt)/hival){arr.push((func?func(current,cnt):current));}
return arr;};jStat.arange=function arange(start,end,step){var rl=[];step=step||1;if(end===undefined){end=start;start=0;}
if(start===end||step===0){return[];}
if(start<end&&step<0){return[];}
if(start>end&&step>0){return[];}
if(step>0){for(i=start;i<end;i+=step){rl.push(i);}}else{for(i=start;i>end;i+=step){rl.push(i);}}
return rl;};jStat.slice=(function(){function _slice(list,start,end,step){var i;var rl=[];var length=list.length;if(start===undefined&&end===undefined&&step===undefined){return jStat.copy(list);}
start=start||0;end=end||list.length;start=start>=0?start:length+start;end=end>=0?end:length+end;step=step||1;if(start===end||step===0){return[];}
if(start<end&&step<0){return[];}
if(start>end&&step>0){return[];}
if(step>0){for(i=start;i<end;i+=step){rl.push(list[i]);}}else{for(i=start;i>end;i+=step){rl.push(list[i]);}}
return rl;}
function slice(list,rcSlice){rcSlice=rcSlice||{};if(isNumber(rcSlice.row)){if(isNumber(rcSlice.col))
return list[rcSlice.row][rcSlice.col];var row=jStat.rowa(list,rcSlice.row);var colSlice=rcSlice.col||{};return _slice(row,colSlice.start,colSlice.end,colSlice.step);}
if(isNumber(rcSlice.col)){var col=jStat.cola(list,rcSlice.col);var rowSlice=rcSlice.row||{};return _slice(col,rowSlice.start,rowSlice.end,rowSlice.step);}
var rowSlice=rcSlice.row||{};var colSlice=rcSlice.col||{};var rows=_slice(list,rowSlice.start,rowSlice.end,rowSlice.step);return rows.map(function(row){return _slice(row,colSlice.start,colSlice.end,colSlice.step);});}
return slice;}());jStat.sliceAssign=function sliceAssign(A,rcSlice,B){if(isNumber(rcSlice.row)){if(isNumber(rcSlice.col))
return A[rcSlice.row][rcSlice.col]=B;rcSlice.col=rcSlice.col||{};rcSlice.col.start=rcSlice.col.start||0;rcSlice.col.end=rcSlice.col.end||A[0].length;rcSlice.col.step=rcSlice.col.step||1;var nl=jStat.arange(rcSlice.col.start,Math.min(A.length,rcSlice.col.end),rcSlice.col.step);var m=rcSlice.row;nl.forEach(function(n,i){A[m][n]=B[i];});return A;}
if(isNumber(rcSlice.col)){rcSlice.row=rcSlice.row||{};rcSlice.row.start=rcSlice.row.start||0;rcSlice.row.end=rcSlice.row.end||A.length;rcSlice.row.step=rcSlice.row.step||1;var ml=jStat.arange(rcSlice.row.start,Math.min(A[0].length,rcSlice.row.end),rcSlice.row.step);var n=rcSlice.col;ml.forEach(function(m,j){A[m][n]=B[j];});return A;}
if(B[0].length===undefined){B=[B];}
rcSlice.row.start=rcSlice.row.start||0;rcSlice.row.end=rcSlice.row.end||A.length;rcSlice.row.step=rcSlice.row.step||1;rcSlice.col.start=rcSlice.col.start||0;rcSlice.col.end=rcSlice.col.end||A[0].length;rcSlice.col.step=rcSlice.col.step||1;var ml=jStat.arange(rcSlice.row.start,Math.min(A.length,rcSlice.row.end),rcSlice.row.step);var nl=jStat.arange(rcSlice.col.start,Math.min(A[0].length,rcSlice.col.end),rcSlice.col.step);ml.forEach(function(m,i){nl.forEach(function(n,j){A[m][n]=B[i][j];});});return A;};jStat.diagonal=function diagonal(diagArray){var mat=jStat.zeros(diagArray.length,diagArray.length);diagArray.forEach(function(t,i){mat[i][i]=t;});return mat;};jStat.copy=function copy(A){return A.map(function(row){if(isNumber(row))
return row;return row.map(function(t){return t;});});};var jProto=jStat.prototype;jProto.length=0;jProto.push=Array.prototype.push;jProto.sort=Array.prototype.sort;jProto.splice=Array.prototype.splice;jProto.slice=Array.prototype.slice;jProto.toArray=function toArray(){return this.length>1?slice.call(this):slice.call(this)[0];};jProto.map=function map(func,toAlter){return jStat(jStat.map(this,func,toAlter));};jProto.cumreduce=function cumreduce(func,toAlter){return jStat(jStat.cumreduce(this,func,toAlter));};jProto.alter=function alter(func){jStat.alter(this,func);return this;};(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jProto[passfunc]=function(func){var self=this,results;if(func){setTimeout(function(){func.call(self,jProto[passfunc].call(self));});return this;}
results=jStat[passfunc](this);return isArray(results)?jStat(results):results;};})(funcs[i]);})('transpose clear symmetric rows cols dimensions diag antidiag'.split(' '));(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jProto[passfunc]=function(index,func){var self=this;if(func){setTimeout(function(){func.call(self,jProto[passfunc].call(self,index));});return this;}
return jStat(jStat[passfunc](this,index));};})(funcs[i]);})('row col'.split(' '));(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jProto[passfunc]=new Function('return jStat(jStat.'+passfunc+'.apply(null, arguments));');})(funcs[i]);})('create zeros ones rand identity'.split(' '));return jStat;}(Math));(function(jStat,Math){var isFunction=jStat.utils.isFunction;function ascNum(a,b){return a-b;}
function clip(arg,min,max){return Math.max(min,Math.min(arg,max));}
jStat.sum=function sum(arr){var sum=0;var i=arr.length;while(--i>=0)
sum+=arr[i];return sum;};jStat.sumsqrd=function sumsqrd(arr){var sum=0;var i=arr.length;while(--i>=0)
sum+=arr[i]*arr[i];return sum;};jStat.sumsqerr=function sumsqerr(arr){var mean=jStat.mean(arr);var sum=0;var i=arr.length;var tmp;while(--i>=0){tmp=arr[i]-mean;sum+=tmp*tmp;}
return sum;};jStat.sumrow=function sumrow(arr){var sum=0;var i=arr.length;while(--i>=0)
sum+=arr[i];return sum;};jStat.product=function product(arr){var prod=1;var i=arr.length;while(--i>=0)
prod*=arr[i];return prod;};jStat.min=function min(arr){var low=arr[0];var i=0;while(++i<arr.length)
if(arr[i]<low)
low=arr[i];return low;};jStat.max=function max(arr){var high=arr[0];var i=0;while(++i<arr.length)
if(arr[i]>high)
high=arr[i];return high;};jStat.unique=function unique(arr){var hash={},_arr=[];for(var i=0;i<arr.length;i++){if(!hash[arr[i]]){hash[arr[i]]=true;_arr.push(arr[i]);}}
return _arr;};jStat.mean=function mean(arr){return jStat.sum(arr)/arr.length;};jStat.meansqerr=function meansqerr(arr){return jStat.sumsqerr(arr)/arr.length;};jStat.geomean=function geomean(arr){return Math.pow(jStat.product(arr),1/arr.length);};jStat.median=function median(arr){var arrlen=arr.length;var _arr=arr.slice().sort(ascNum);return!(arrlen&1)?(_arr[(arrlen/2)-1]+_arr[(arrlen/2)])/2:_arr[(arrlen/2)|0];};jStat.cumsum=function cumsum(arr){return jStat.cumreduce(arr,function(a,b){return a+b;});};jStat.cumprod=function cumprod(arr){return jStat.cumreduce(arr,function(a,b){return a*b;});};jStat.diff=function diff(arr){var diffs=[];var arrLen=arr.length;var i;for(var i=1;i<arrLen;i++)
diffs.push(arr[i]-arr[i-1]);return diffs;};jStat.rank=function(arr){var arrlen=arr.length;var sorted=arr.slice().sort(ascNum);var ranks=new Array(arrlen);for(var i=0;i<arrlen;i++){var first=sorted.indexOf(arr[i]);var last=sorted.lastIndexOf(arr[i]);if(first===last){var val=first;}else{var val=(first+last)/2;}
ranks[i]=val+1;}
return ranks;};jStat.mode=function mode(arr){var arrLen=arr.length;var _arr=arr.slice().sort(ascNum);var count=1;var maxCount=0;var numMaxCount=0;var mode_arr=[];var i;for(var i=0;i<arrLen;i++){if(_arr[i]===_arr[i+1]){count++;}else{if(count>maxCount){mode_arr=[_arr[i]];maxCount=count;numMaxCount=0;}
else if(count===maxCount){mode_arr.push(_arr[i]);numMaxCount++;}
count=1;}}
return numMaxCount===0?mode_arr[0]:mode_arr;};jStat.range=function range(arr){return jStat.max(arr)-jStat.min(arr);};jStat.variance=function variance(arr,flag){return jStat.sumsqerr(arr)/(arr.length-(flag?1:0));};jStat.deviation=function(arr){var mean=jStat.mean(arr);var arrlen=arr.length;var dev=new Array(arrlen);for(var i=0;i<arrlen;i++){dev[i]=arr[i]-mean;}
return dev;};jStat.stdev=function stdev(arr,flag){return Math.sqrt(jStat.variance(arr,flag));};jStat.meandev=function meandev(arr){var devSum=0;var mean=jStat.mean(arr);var i;for(var i=arr.length-1;i>=0;i--)
devSum+=Math.abs(arr[i]-mean);return devSum/arr.length;};jStat.meddev=function meddev(arr){var devSum=0;var median=jStat.median(arr);var i;for(var i=arr.length-1;i>=0;i--)
devSum+=Math.abs(arr[i]-median);return devSum/arr.length;};jStat.coeffvar=function coeffvar(arr){return jStat.stdev(arr)/jStat.mean(arr);};jStat.quartiles=function quartiles(arr){var arrlen=arr.length;var _arr=arr.slice().sort(ascNum);return[_arr[Math.round((arrlen)/4)-1],_arr[Math.round((arrlen)/2)-1],_arr[Math.round((arrlen)*3/4)-1]];};jStat.quantiles=function quantiles(arr,quantilesArray,alphap,betap){var sortedArray=arr.slice().sort(ascNum);var quantileVals=[quantilesArray.length];var n=arr.length;var i,p,m,aleph,k,gamma;if(typeof alphap==='undefined')
alphap=3/8;if(typeof betap==='undefined')
betap=3/8;for(var i=0;i<quantilesArray.length;i++){p=quantilesArray[i];m=alphap+p*(1-alphap-betap);aleph=n*p+m;k=Math.floor(clip(aleph,1,n-1));gamma=clip(aleph-k,0,1);quantileVals[i]=(1-gamma)*sortedArray[k-1]+gamma*sortedArray[k];}
return quantileVals;};jStat.percentile=function percentile(arr,k){var _arr=arr.slice().sort(ascNum);var realIndex=k*(_arr.length-1);var index=parseInt(realIndex);var frac=realIndex-index;if(index+1<_arr.length){return _arr[index]*(1-frac)+_arr[index+1]*frac;}else{return _arr[index];}}
jStat.percentileOfScore=function percentileOfScore(arr,score,kind){var counter=0;var len=arr.length;var strict=false;var value,i;if(kind==='strict')
strict=true;for(var i=0;i<len;i++){value=arr[i];if((strict&&value<score)||(!strict&&value<=score)){counter++;}}
return counter/len;};jStat.histogram=function histogram(arr,bins){var first=jStat.min(arr);var binCnt=bins||4;var binWidth=(jStat.max(arr)-first)/binCnt;var len=arr.length;var bins=[];var i;for(var i=0;i<binCnt;i++)
bins[i]=0;for(var i=0;i<len;i++)
bins[Math.min(Math.floor(((arr[i]-first)/binWidth)),binCnt-1)]+=1;return bins;};jStat.covariance=function covariance(arr1,arr2){var u=jStat.mean(arr1);var v=jStat.mean(arr2);var arr1Len=arr1.length;var sq_dev=new Array(arr1Len);var i;for(var i=0;i<arr1Len;i++)
sq_dev[i]=(arr1[i]-u)*(arr2[i]-v);return jStat.sum(sq_dev)/(arr1Len-1);};jStat.corrcoeff=function corrcoeff(arr1,arr2){return jStat.covariance(arr1,arr2)/jStat.stdev(arr1,1)/jStat.stdev(arr2,1);};jStat.spearmancoeff=function(arr1,arr2){arr1=jStat.rank(arr1);arr2=jStat.rank(arr2);var arr1dev=jStat.deviation(arr1);var arr2dev=jStat.deviation(arr2);return jStat.sum(arr1dev.map(function(x,i){return x*arr2dev[i];}))/Math.sqrt(jStat.sum(arr1dev.map(function(x){return Math.pow(x,2);}))*jStat.sum(arr2dev.map(function(x){return Math.pow(x,2);})));}
jStat.stanMoment=function stanMoment(arr,n){var mu=jStat.mean(arr);var sigma=jStat.stdev(arr);var len=arr.length;var skewSum=0;for(var i=0;i<len;i++)
skewSum+=Math.pow((arr[i]-mu)/sigma,n);return skewSum/arr.length;};jStat.skewness=function skewness(arr){return jStat.stanMoment(arr,3);};jStat.kurtosis=function kurtosis(arr){return jStat.stanMoment(arr,4)-3;};var jProto=jStat.prototype;(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jProto[passfunc]=function(fullbool,func){var arr=[];var i=0;var tmpthis=this;if(isFunction(fullbool)){func=fullbool;fullbool=false;}
if(func){setTimeout(function(){func.call(tmpthis,jProto[passfunc].call(tmpthis,fullbool));});return this;}
if(this.length>1){tmpthis=fullbool===true?this:this.transpose();for(;i<tmpthis.length;i++)
arr[i]=jStat[passfunc](tmpthis[i]);return arr;}
return jStat[passfunc](this[0],fullbool);};})(funcs[i]);})(('cumsum cumprod').split(' '));(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jProto[passfunc]=function(fullbool,func){var arr=[];var i=0;var tmpthis=this;if(isFunction(fullbool)){func=fullbool;fullbool=false;}
if(func){setTimeout(function(){func.call(tmpthis,jProto[passfunc].call(tmpthis,fullbool));});return this;}
if(this.length>1){if(passfunc!=='sumrow')
tmpthis=fullbool===true?this:this.transpose();for(;i<tmpthis.length;i++)
arr[i]=jStat[passfunc](tmpthis[i]);return fullbool===true?jStat[passfunc](jStat.utils.toVector(arr)):arr;}
return jStat[passfunc](this[0],fullbool);};})(funcs[i]);})(('sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr '+'geomean median diff rank mode range variance deviation stdev meandev '+'meddev coeffvar quartiles histogram skewness kurtosis').split(' '));(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jProto[passfunc]=function(){var arr=[];var i=0;var tmpthis=this;var args=Array.prototype.slice.call(arguments);if(isFunction(args[args.length-1])){var callbackFunction=args[args.length-1];var argsToPass=args.slice(0,args.length-1);setTimeout(function(){callbackFunction.call(tmpthis,jProto[passfunc].apply(tmpthis,argsToPass));});return this;}else{var callbackFunction=undefined;var curriedFunction=function curriedFunction(vector){return jStat[passfunc].apply(tmpthis,[vector].concat(args));}}
if(this.length>1){tmpthis=tmpthis.transpose();for(;i<tmpthis.length;i++)
arr[i]=curriedFunction(tmpthis[i]);return arr;}
return curriedFunction(this[0]);};})(funcs[i]);})('quantiles percentileOfScore'.split(' '));}(this.jStat,Math));(function(jStat,Math){jStat.gammaln=function gammaln(x){var j=0;var cof=[76.18009172947146,-86.50532032941677,24.01409824083091,-1.231739572450155,0.1208650973866179e-2,-0.5395239384953e-5];var ser=1.000000000190015;var xx,y,tmp;tmp=(y=xx=x)+5.5;tmp-=(xx+0.5)*Math.log(tmp);for(;j<6;j++)
ser+=cof[j]/++y;return Math.log(2.5066282746310005*ser/xx)-tmp;};jStat.gammafn=function gammafn(x){var p=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054];var q=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.118420980151,4755.8462775278811,-134659.9598649693,-115132.2596755535];var fact=false;var n=0;var xden=0;var xnum=0;var y=x;var i,z,yi,res,sum,ysq;if(y<=0){res=y%1+3.6e-16;if(res){fact=(!(y&1)?1:-1)*Math.PI/Math.sin(Math.PI*res);y=1-y;}else{return Infinity;}}
yi=y;if(y<1){z=y++;}else{z=(y-=n=(y|0)-1)-1;}
for(var i=0;i<8;++i){xnum=(xnum+p[i])*z;xden=xden*z+q[i];}
res=xnum/xden+1;if(yi<y){res/=yi;}else if(yi>y){for(var i=0;i<n;++i){res*=y;y++;}}
if(fact){res=fact/res;}
return res;};jStat.gammap=function gammap(a,x){return jStat.lowRegGamma(a,x)*jStat.gammafn(a);};jStat.lowRegGamma=function lowRegGamma(a,x){var aln=jStat.gammaln(a);var ap=a;var sum=1/a;var del=sum;var b=x+1-a;var c=1/1.0e-30;var d=1/b;var h=d;var i=1;var ITMAX=-~(Math.log((a>=1)?a:1/a)*8.5+a*0.4+17);var an,endval;if(x<0||a<=0){return NaN;}else if(x<a+1){for(;i<=ITMAX;i++){sum+=del*=x/++ap;}
return(sum*Math.exp(-x+a*Math.log(x)-(aln)));}
for(;i<=ITMAX;i++){an=-i*(i-a);b+=2;d=an*d+b;c=b+an/c;d=1/d;h*=d*c;}
return(1-h*Math.exp(-x+a*Math.log(x)-(aln)));};jStat.factorialln=function factorialln(n){return n<0?NaN:jStat.gammaln(n+1);};jStat.factorial=function factorial(n){return n<0?NaN:jStat.gammafn(n+1);};jStat.combination=function combination(n,m){return(n>170||m>170)?Math.exp(jStat.combinationln(n,m)):(jStat.factorial(n)/jStat.factorial(m))/jStat.factorial(n-m);};jStat.combinationln=function combinationln(n,m){return jStat.factorialln(n)-jStat.factorialln(m)-jStat.factorialln(n-m);};jStat.permutation=function permutation(n,m){return jStat.factorial(n)/jStat.factorial(n-m);};jStat.betafn=function betafn(x,y){if(x<=0||y<=0)
return undefined;return(x+y>170)?Math.exp(jStat.betaln(x,y)):jStat.gammafn(x)*jStat.gammafn(y)/jStat.gammafn(x+y);};jStat.betaln=function betaln(x,y){return jStat.gammaln(x)+jStat.gammaln(y)-jStat.gammaln(x+y);};jStat.betacf=function betacf(x,a,b){var fpmin=1e-30;var m=1;var qab=a+b;var qap=a+1;var qam=a-1;var c=1;var d=1-qab*x/qap;var m2,aa,del,h;if(Math.abs(d)<fpmin)
d=fpmin;d=1/d;h=d;for(;m<=100;m++){m2=2*m;aa=m*(b-m)*x/((qam+m2)*(a+m2));d=1+aa*d;if(Math.abs(d)<fpmin)
d=fpmin;c=1+aa/c;if(Math.abs(c)<fpmin)
c=fpmin;d=1/d;h*=d*c;aa=-(a+m)*(qab+m)*x/((a+m2)*(qap+m2));d=1+aa*d;if(Math.abs(d)<fpmin)
d=fpmin;c=1+aa/c;if(Math.abs(c)<fpmin)
c=fpmin;d=1/d;del=d*c;h*=del;if(Math.abs(del-1.0)<3e-7)
break;}
return h;};jStat.gammapinv=function gammapinv(p,a){var j=0;var a1=a-1;var EPS=1e-8;var gln=jStat.gammaln(a);var x,err,t,u,pp,lna1,afac;if(p>=1)
return Math.max(100,a+100*Math.sqrt(a));if(p<=0)
return 0;if(a>1){lna1=Math.log(a1);afac=Math.exp(a1*(lna1-1)-gln);pp=(p<0.5)?p:1-p;t=Math.sqrt(-2*Math.log(pp));x=(2.30753+t*0.27061)/(1+t*(0.99229+t*0.04481))-t;if(p<0.5)
x=-x;x=Math.max(1e-3,a*Math.pow(1-1/(9*a)-x/(3*Math.sqrt(a)),3));}else{t=1-a*(0.253+a*0.12);if(p<t)
x=Math.pow(p/t,1/a);else
x=1-Math.log(1-(p-t)/(1-t));}
for(;j<12;j++){if(x<=0)
return 0;err=jStat.lowRegGamma(a,x)-p;if(a>1)
t=afac*Math.exp(-(x-a1)+a1*(Math.log(x)-lna1));else
t=Math.exp(-x+a1*Math.log(x)-gln);u=err/t;x-=(t=u/(1-0.5*Math.min(1,u*((a-1)/x-1))));if(x<=0)
x=0.5*(x+t);if(Math.abs(t)<EPS*x)
break;}
return x;};jStat.erf=function erf(x){var cof=[-1.3026537197817094,6.4196979235649026e-1,1.9476473204185836e-2,-9.561514786808631e-3,-9.46595344482036e-4,3.66839497852761e-4,4.2523324806907e-5,-2.0278578112534e-5,-1.624290004647e-6,1.303655835580e-6,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17];var j=cof.length-1;var isneg=false;var d=0;var dd=0;var t,ty,tmp,res;if(x<0){x=-x;isneg=true;}
t=2/(2+x);ty=4*t-2;for(;j>0;j--){tmp=d;d=ty*d-dd+cof[j];dd=tmp;}
res=t*Math.exp(-x*x+0.5*(cof[0]+ty*d)-dd);return isneg?res-1:1-res;};jStat.erfc=function erfc(x){return 1-jStat.erf(x);};jStat.erfcinv=function erfcinv(p){var j=0;var x,err,t,pp;if(p>=2)
return-100;if(p<=0)
return 100;pp=(p<1)?p:2-p;t=Math.sqrt(-2*Math.log(pp/2));x=-0.70711*((2.30753+t*0.27061)/(1+t*(0.99229+t*0.04481))-t);for(;j<2;j++){err=jStat.erfc(x)-pp;x+=err/(1.12837916709551257*Math.exp(-x*x)-x*err);}
return(p<1)?x:-x;};jStat.ibetainv=function ibetainv(p,a,b){var EPS=1e-8;var a1=a-1;var b1=b-1;var j=0;var lna,lnb,pp,t,u,err,x,al,h,w,afac;if(p<=0)
return 0;if(p>=1)
return 1;if(a>=1&&b>=1){pp=(p<0.5)?p:1-p;t=Math.sqrt(-2*Math.log(pp));x=(2.30753+t*0.27061)/(1+t*(0.99229+t*0.04481))-t;if(p<0.5)
x=-x;al=(x*x-3)/6;h=2/(1/(2*a-1)+1/(2*b-1));w=(x*Math.sqrt(al+h)/h)-(1/(2*b-1)-1/(2*a-1))*(al+5/6-2/(3*h));x=a/(a+b*Math.exp(2*w));}else{lna=Math.log(a/(a+b));lnb=Math.log(b/(a+b));t=Math.exp(a*lna)/a;u=Math.exp(b*lnb)/b;w=t+u;if(p<t/w)
x=Math.pow(a*w*p,1/a);else
x=1-Math.pow(b*w*(1-p),1/b);}
afac=-jStat.gammaln(a)-jStat.gammaln(b)+jStat.gammaln(a+b);for(;j<10;j++){if(x===0||x===1)
return x;err=jStat.ibeta(x,a,b)-p;t=Math.exp(a1*Math.log(x)+b1*Math.log(1-x)+afac);u=err/t;x-=(t=u/(1-0.5*Math.min(1,u*(a1/x-b1/(1-x)))));if(x<=0)
x=0.5*(x+t);if(x>=1)
x=0.5*(x+t+1);if(Math.abs(t)<EPS*x&&j>0)
break;}
return x;};jStat.ibeta=function ibeta(x,a,b){var bt=(x===0||x===1)?0:Math.exp(jStat.gammaln(a+b)-jStat.gammaln(a)-
jStat.gammaln(b)+a*Math.log(x)+b*Math.log(1-x));if(x<0||x>1)
return false;if(x<(a+1)/(a+b+2))
return bt*jStat.betacf(x,a,b)/a;return 1-bt*jStat.betacf(1-x,b,a)/b;};jStat.randn=function randn(n,m){var u,v,x,y,q,mat;if(!m)
m=n;if(n)
return jStat.create(n,m,function(){return jStat.randn();});do{u=Math.random();v=1.7156*(Math.random()-0.5);x=u-0.449871;y=Math.abs(v)+0.386595;q=x*x+y*(0.19600*y-0.25472*x);}while(q>0.27597&&(q>0.27846||v*v>-4*Math.log(u)*u*u));return v/u;};jStat.randg=function randg(shape,n,m){var oalph=shape;var a1,a2,u,v,x,mat;if(!m)
m=n;if(!shape)
shape=1;if(n){mat=jStat.zeros(n,m);mat.alter(function(){return jStat.randg(shape);});return mat;}
if(shape<1)
shape+=1;a1=shape-1/3;a2=1/Math.sqrt(9*a1);do{do{x=jStat.randn();v=1+a2*x;}while(v<=0);v=v*v*v;u=Math.random();}while(u>1-0.331*Math.pow(x,4)&&Math.log(u)>0.5*x*x+a1*(1-v+Math.log(v)));if(shape==oalph)
return a1*v;do{u=Math.random();}while(u===0);return Math.pow(u,1/oalph)*a1*v;};(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jStat.fn[passfunc]=function(){return jStat(jStat.map(this,function(value){return jStat[passfunc](value);}));}})(funcs[i]);})('gammaln gammafn factorial factorialln'.split(' '));(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jStat.fn[passfunc]=function(){return jStat(jStat[passfunc].apply(null,arguments));};})(funcs[i]);})('randn'.split(' '));}(this.jStat,Math));(function(jStat,Math){(function(list){for(var i=0;i<list.length;i++)(function(func){jStat[func]=function(a,b,c){if(!(this instanceof arguments.callee))
return new arguments.callee(a,b,c);this._a=a;this._b=b;this._c=c;return this;};jStat.fn[func]=function(a,b,c){var newthis=jStat[func](a,b,c);newthis.data=this;return newthis;};jStat[func].prototype.sample=function(arr){var a=this._a;var b=this._b;var c=this._c;if(arr)
return jStat.alter(arr,function(){return jStat[func].sample(a,b,c);});else
return jStat[func].sample(a,b,c);};(function(vals){for(var i=0;i<vals.length;i++)(function(fnfunc){jStat[func].prototype[fnfunc]=function(x){var a=this._a;var b=this._b;var c=this._c;if(!x&&x!==0)
x=this.data;if(typeof x!=='number'){return jStat.fn.map.call(x,function(x){return jStat[func][fnfunc](x,a,b,c);});}
return jStat[func][fnfunc](x,a,b,c);};})(vals[i]);})('pdf cdf inv'.split(' '));(function(vals){for(var i=0;i<vals.length;i++)(function(fnfunc){jStat[func].prototype[fnfunc]=function(){return jStat[func][fnfunc](this._a,this._b,this._c);};})(vals[i]);})('mean median mode variance'.split(' '));})(list[i]);})(('beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy '+'laplace lognormal noncentralt normal pareto studentt weibull uniform '+'binomial negbin hypgeom poisson triangular').split(' '));jStat.extend(jStat.beta,{pdf:function pdf(x,alpha,beta){if(x>1||x<0)
return 0;if(alpha==1&&beta==1)
return 1;if(alpha<512&&beta<512){return(Math.pow(x,alpha-1)*Math.pow(1-x,beta-1))/jStat.betafn(alpha,beta);}else{return Math.exp((alpha-1)*Math.log(x)+
(beta-1)*Math.log(1-x)-
jStat.betaln(alpha,beta));}},cdf:function cdf(x,alpha,beta){return(x>1||x<0)?(x>1)*1:jStat.ibeta(x,alpha,beta);},inv:function inv(x,alpha,beta){return jStat.ibetainv(x,alpha,beta);},mean:function mean(alpha,beta){return alpha/(alpha+beta);},median:function median(alpha,beta){return jStat.ibetainv(0.5,alpha,beta);},mode:function mode(alpha,beta){return(alpha-1)/(alpha+beta-2);},sample:function sample(alpha,beta){var u=jStat.randg(alpha);return u/(u+jStat.randg(beta));},variance:function variance(alpha,beta){return(alpha*beta)/(Math.pow(alpha+beta,2)*(alpha+beta+1));}});jStat.extend(jStat.centralF,{pdf:function pdf(x,df1,df2){var p,q,f;if(x<0)
return 0;if(df1<=2){if(x===0&&df1<2){return Infinity;}
if(x===0&&df1===2){return 1;}
return Math.sqrt((Math.pow(df1*x,df1)*Math.pow(df2,df2))/(Math.pow(df1*x+df2,df1+df2)))/(x*jStat.betafn(df1/2,df2/2));}
p=(df1*x)/(df2+x*df1);q=df2/(df2+x*df1);f=df1*q/2.0;return f*jStat.binomial.pdf((df1-2)/2,(df1+df2-2)/2,p);},cdf:function cdf(x,df1,df2){if(x<0)
return 0;return jStat.ibeta((df1*x)/(df1*x+df2),df1/2,df2/2);},inv:function inv(x,df1,df2){return df2/(df1*(1/jStat.ibetainv(x,df1/2,df2/2)-1));},mean:function mean(df1,df2){return(df2>2)?df2/(df2-2):undefined;},mode:function mode(df1,df2){return(df1>2)?(df2*(df1-2))/(df1*(df2+2)):undefined;},sample:function sample(df1,df2){var x1=jStat.randg(df1/2)*2;var x2=jStat.randg(df2/2)*2;return(x1/df1)/(x2/df2);},variance:function variance(df1,df2){if(df2<=4)
return undefined;return 2*df2*df2*(df1+df2-2)/(df1*(df2-2)*(df2-2)*(df2-4));}});jStat.extend(jStat.cauchy,{pdf:function pdf(x,local,scale){if(scale<0){return 0;}
return(scale/(Math.pow(x-local,2)+Math.pow(scale,2)))/Math.PI;},cdf:function cdf(x,local,scale){return Math.atan((x-local)/scale)/Math.PI+0.5;},inv:function(p,local,scale){return local+scale*Math.tan(Math.PI*(p-0.5));},median:function median(local,scale){return local;},mode:function mode(local,scale){return local;},sample:function sample(local,scale){return jStat.randn()*Math.sqrt(1/(2*jStat.randg(0.5)))*scale+local;}});jStat.extend(jStat.chisquare,{pdf:function pdf(x,dof){if(x<0)
return 0;return(x===0&&dof===2)?0.5:Math.exp((dof/2-1)*Math.log(x)-x/2-(dof/2)*Math.log(2)-jStat.gammaln(dof/2));},cdf:function cdf(x,dof){if(x<0)
return 0;return jStat.lowRegGamma(dof/2,x/2);},inv:function(p,dof){return 2*jStat.gammapinv(p,0.5*dof);},mean:function(dof){return dof;},median:function median(dof){return dof*Math.pow(1-(2/(9*dof)),3);},mode:function mode(dof){return(dof-2>0)?dof-2:0;},sample:function sample(dof){return jStat.randg(dof/2)*2;},variance:function variance(dof){return 2*dof;}});jStat.extend(jStat.exponential,{pdf:function pdf(x,rate){return x<0?0:rate*Math.exp(-rate*x);},cdf:function cdf(x,rate){return x<0?0:1-Math.exp(-rate*x);},inv:function(p,rate){return-Math.log(1-p)/rate;},mean:function(rate){return 1/rate;},median:function(rate){return(1/rate)*Math.log(2);},mode:function mode(rate){return 0;},sample:function sample(rate){return-1/rate*Math.log(Math.random());},variance:function(rate){return Math.pow(rate,-2);}});jStat.extend(jStat.gamma,{pdf:function pdf(x,shape,scale){if(x<0)
return 0;return(x===0&&shape===1)?1/scale:Math.exp((shape-1)*Math.log(x)-x/scale-
jStat.gammaln(shape)-shape*Math.log(scale));},cdf:function cdf(x,shape,scale){if(x<0)
return 0;return jStat.lowRegGamma(shape,x/scale);},inv:function(p,shape,scale){return jStat.gammapinv(p,shape)*scale;},mean:function(shape,scale){return shape*scale;},mode:function mode(shape,scale){if(shape>1)return(shape-1)*scale;return undefined;},sample:function sample(shape,scale){return jStat.randg(shape)*scale;},variance:function variance(shape,scale){return shape*scale*scale;}});jStat.extend(jStat.invgamma,{pdf:function pdf(x,shape,scale){if(x<=0)
return 0;return Math.exp(-(shape+1)*Math.log(x)-scale/x-
jStat.gammaln(shape)+shape*Math.log(scale));},cdf:function cdf(x,shape,scale){if(x<=0)
return 0;return 1-jStat.lowRegGamma(shape,scale/x);},inv:function(p,shape,scale){return scale/jStat.gammapinv(1-p,shape);},mean:function(shape,scale){return(shape>1)?scale/(shape-1):undefined;},mode:function mode(shape,scale){return scale/(shape+1);},sample:function sample(shape,scale){return scale/jStat.randg(shape);},variance:function variance(shape,scale){if(shape<=2)
return undefined;return scale*scale/((shape-1)*(shape-1)*(shape-2));}});jStat.extend(jStat.kumaraswamy,{pdf:function pdf(x,alpha,beta){if(x===0&&alpha===1)
return beta;else if(x===1&&beta===1)
return alpha;return Math.exp(Math.log(alpha)+Math.log(beta)+(alpha-1)*Math.log(x)+(beta-1)*Math.log(1-Math.pow(x,alpha)));},cdf:function cdf(x,alpha,beta){if(x<0)
return 0;else if(x>1)
return 1;return(1-Math.pow(1-Math.pow(x,alpha),beta));},inv:function inv(p,alpha,beta){return Math.pow(1-Math.pow(1-p,1/beta),1/alpha);},mean:function(alpha,beta){return(beta*jStat.gammafn(1+1/alpha)*jStat.gammafn(beta))/(jStat.gammafn(1+1/alpha+beta));},median:function median(alpha,beta){return Math.pow(1-Math.pow(2,-1/beta),1/alpha);},mode:function mode(alpha,beta){if(!(alpha>=1&&beta>=1&&(alpha!==1&&beta!==1)))
return undefined;return Math.pow((alpha-1)/(alpha*beta-1),1/alpha);},variance:function variance(alpha,beta){throw new Error('variance not yet implemented');}});jStat.extend(jStat.lognormal,{pdf:function pdf(x,mu,sigma){if(x<=0)
return 0;return Math.exp(-Math.log(x)-0.5*Math.log(2*Math.PI)-
Math.log(sigma)-Math.pow(Math.log(x)-mu,2)/(2*sigma*sigma));},cdf:function cdf(x,mu,sigma){if(x<0)
return 0;return 0.5+
(0.5*jStat.erf((Math.log(x)-mu)/Math.sqrt(2*sigma*sigma)));},inv:function(p,mu,sigma){return Math.exp(-1.41421356237309505*sigma*jStat.erfcinv(2*p)+mu);},mean:function mean(mu,sigma){return Math.exp(mu+sigma*sigma/2);},median:function median(mu,sigma){return Math.exp(mu);},mode:function mode(mu,sigma){return Math.exp(mu-sigma*sigma);},sample:function sample(mu,sigma){return Math.exp(jStat.randn()*sigma+mu);},variance:function variance(mu,sigma){return(Math.exp(sigma*sigma)-1)*Math.exp(2*mu+sigma*sigma);}});jStat.extend(jStat.noncentralt,{pdf:function pdf(x,dof,ncp){var tol=1e-14;if(Math.abs(ncp)<tol)
return jStat.studentt.pdf(x,dof)
if(Math.abs(x)<tol){return Math.exp(jStat.gammaln((dof+1)/2)-ncp*ncp/2-
0.5*Math.log(Math.PI*dof)-jStat.gammaln(dof/2));}
return dof/x*(jStat.noncentralt.cdf(x*Math.sqrt(1+2/dof),dof+2,ncp)-
jStat.noncentralt.cdf(x,dof,ncp));},cdf:function cdf(x,dof,ncp){var tol=1e-14;var min_iterations=200;if(Math.abs(ncp)<tol)
return jStat.studentt.cdf(x,dof);var flip=false;if(x<0){flip=true;ncp=-ncp;}
var prob=jStat.normal.cdf(-ncp,0,1);var value=tol+1;var lastvalue=value;var y=x*x/(x*x+dof);var j=0;var p=Math.exp(-ncp*ncp/2);var q=Math.exp(-ncp*ncp/2-0.5*Math.log(2)-
jStat.gammaln(3/2))*ncp;while(j<min_iterations||lastvalue>tol||value>tol){lastvalue=value;if(j>0){p*=(ncp*ncp)/(2*j);q*=(ncp*ncp)/(2*(j+1/2));}
value=p*jStat.beta.cdf(y,j+0.5,dof/2)+
q*jStat.beta.cdf(y,j+1,dof/2);prob+=0.5*value;j++;}
return flip?(1-prob):prob;}});jStat.extend(jStat.normal,{pdf:function pdf(x,mean,std){return Math.exp(-0.5*Math.log(2*Math.PI)-
Math.log(std)-Math.pow(x-mean,2)/(2*std*std));},cdf:function cdf(x,mean,std){return 0.5*(1+jStat.erf((x-mean)/Math.sqrt(2*std*std)));},inv:function(p,mean,std){return-1.41421356237309505*std*jStat.erfcinv(2*p)+mean;},mean:function(mean,std){return mean;},median:function median(mean,std){return mean;},mode:function(mean,std){return mean;},sample:function sample(mean,std){return jStat.randn()*std+mean;},variance:function(mean,std){return std*std;}});jStat.extend(jStat.pareto,{pdf:function pdf(x,scale,shape){if(x<scale)
return 0;return(shape*Math.pow(scale,shape))/Math.pow(x,shape+1);},cdf:function cdf(x,scale,shape){if(x<scale)
return 0;return 1-Math.pow(scale/x,shape);},inv:function inv(p,scale,shape){return scale/Math.pow(1-p,1/shape);},mean:function mean(scale,shape){if(shape<=1)
return undefined;return(shape*Math.pow(scale,shape))/(shape-1);},median:function median(scale,shape){return scale*(shape*Math.SQRT2);},mode:function mode(scale,shape){return scale;},variance:function(scale,shape){if(shape<=2)
return undefined;return(scale*scale*shape)/(Math.pow(shape-1,2)*(shape-2));}});jStat.extend(jStat.studentt,{pdf:function pdf(x,dof){dof=dof>1e100?1e100:dof;return(1/(Math.sqrt(dof)*jStat.betafn(0.5,dof/2)))*Math.pow(1+((x*x)/dof),-((dof+1)/2));},cdf:function cdf(x,dof){var dof2=dof/2;return jStat.ibeta((x+Math.sqrt(x*x+dof))/(2*Math.sqrt(x*x+dof)),dof2,dof2);},inv:function(p,dof){var x=jStat.ibetainv(2*Math.min(p,1-p),0.5*dof,0.5);x=Math.sqrt(dof*(1-x)/x);return(p>0.5)?x:-x;},mean:function mean(dof){return(dof>1)?0:undefined;},median:function median(dof){return 0;},mode:function mode(dof){return 0;},sample:function sample(dof){return jStat.randn()*Math.sqrt(dof/(2*jStat.randg(dof/2)));},variance:function variance(dof){return(dof>2)?dof/(dof-2):(dof>1)?Infinity:undefined;}});jStat.extend(jStat.weibull,{pdf:function pdf(x,scale,shape){if(x<0||scale<0||shape<0)
return 0;return(shape/scale)*Math.pow((x/scale),(shape-1))*Math.exp(-(Math.pow((x/scale),shape)));},cdf:function cdf(x,scale,shape){return x<0?0:1-Math.exp(-Math.pow((x/scale),shape));},inv:function(p,scale,shape){return scale*Math.pow(-Math.log(1-p),1/shape);},mean:function(scale,shape){return scale*jStat.gammafn(1+1/shape);},median:function median(scale,shape){return scale*Math.pow(Math.log(2),1/shape);},mode:function mode(scale,shape){if(shape<=1)
return 0;return scale*Math.pow((shape-1)/shape,1/shape);},sample:function sample(scale,shape){return scale*Math.pow(-Math.log(Math.random()),1/shape);},variance:function variance(scale,shape){return scale*scale*jStat.gammafn(1+2/shape)-
Math.pow(jStat.weibull.mean(scale,shape),2);}});jStat.extend(jStat.uniform,{pdf:function pdf(x,a,b){return(x<a||x>b)?0:1/(b-a);},cdf:function cdf(x,a,b){if(x<a)
return 0;else if(x<b)
return(x-a)/(b-a);return 1;},inv:function(p,a,b){return a+(p*(b-a));},mean:function mean(a,b){return 0.5*(a+b);},median:function median(a,b){return jStat.mean(a,b);},mode:function mode(a,b){throw new Error('mode is not yet implemented');},sample:function sample(a,b){return(a/2+b/2)+(b/2-a/2)*(2*Math.random()-1);},variance:function variance(a,b){return Math.pow(b-a,2)/12;}});jStat.extend(jStat.binomial,{pdf:function pdf(k,n,p){return(p===0||p===1)?((n*p)===k?1:0):jStat.combination(n,k)*Math.pow(p,k)*Math.pow(1-p,n-k);},cdf:function cdf(x,n,p){var binomarr=[],k=0;if(x<0){return 0;}
if(x<n){for(;k<=x;k++){binomarr[k]=jStat.binomial.pdf(k,n,p);}
return jStat.sum(binomarr);}
return 1;}});jStat.extend(jStat.negbin,{pdf:function pdf(k,r,p){if(k!==k>>>0)
return false;if(k<0)
return 0;return jStat.combination(k+r-1,r-1)*Math.pow(1-p,k)*Math.pow(p,r);},cdf:function cdf(x,r,p){var sum=0,k=0;if(x<0)return 0;for(;k<=x;k++){sum+=jStat.negbin.pdf(k,r,p);}
return sum;}});jStat.extend(jStat.hypgeom,{pdf:function pdf(k,N,m,n){if(k!==k|0){return false;}else if(k<0||k<m-(N-n)){return 0;}else if(k>n||k>m){return 0;}else if(m*2>N){if(n*2>N){return jStat.hypgeom.pdf(N-m-n+k,N,N-m,N-n)}else{return jStat.hypgeom.pdf(n-k,N,N-m,n);}}else if(n*2>N){return jStat.hypgeom.pdf(m-k,N,m,N-n);}else if(m<n){return jStat.hypgeom.pdf(k,N,n,m);}else{var scaledPDF=1;var samplesDone=0;for(var i=0;i<k;i++){while(scaledPDF>1&&samplesDone<n){scaledPDF*=1-(m/(N-samplesDone));samplesDone++;}
scaledPDF*=(n-i)*(m-i)/((i+1)*(N-m-n+i+1));}
for(;samplesDone<n;samplesDone++){scaledPDF*=1-(m/(N-samplesDone));}
return Math.min(1,Math.max(0,scaledPDF));}},cdf:function cdf(x,N,m,n){if(x<0||x<m-(N-n)){return 0;}else if(x>=n||x>=m){return 1;}else if(m*2>N){if(n*2>N){return jStat.hypgeom.cdf(N-m-n+x,N,N-m,N-n)}else{return 1-jStat.hypgeom.cdf(n-x-1,N,N-m,n);}}else if(n*2>N){return 1-jStat.hypgeom.cdf(m-x-1,N,m,N-n);}else if(m<n){return jStat.hypgeom.cdf(x,N,n,m);}else{var scaledCDF=1;var scaledPDF=1;var samplesDone=0;for(var i=0;i<x;i++){while(scaledCDF>1&&samplesDone<n){var factor=1-(m/(N-samplesDone));scaledPDF*=factor;scaledCDF*=factor;samplesDone++;}
scaledPDF*=(n-i)*(m-i)/((i+1)*(N-m-n+i+1));scaledCDF+=scaledPDF;}
for(;samplesDone<n;samplesDone++){scaledCDF*=1-(m/(N-samplesDone));}
return Math.min(1,Math.max(0,scaledCDF));}}});jStat.extend(jStat.poisson,{pdf:function pdf(k,l){if(l<0||(k%1)!==0||k<0){return 0;}
return Math.pow(l,k)*Math.exp(-l)/jStat.factorial(k);},cdf:function cdf(x,l){var sumarr=[],k=0;if(x<0)return 0;for(;k<=x;k++){sumarr.push(jStat.poisson.pdf(k,l));}
return jStat.sum(sumarr);},mean:function(l){return l;},variance:function(l){return l;},sample:function sample(l){var p=1,k=0,L=Math.exp(-l);do{k++;p*=Math.random();}while(p>L);return k-1;}});jStat.extend(jStat.triangular,{pdf:function pdf(x,a,b,c){if(b<=a||c<a||c>b){return NaN;}else{if(x<a||x>b){return 0;}else if(x<c){return(2*(x-a))/((b-a)*(c-a));}else if(x===c){return(2/(b-a));}else{return(2*(b-x))/((b-a)*(b-c));}}},cdf:function cdf(x,a,b,c){if(b<=a||c<a||c>b)
return NaN;if(x<=a)
return 0;else if(x>=b)
return 1;if(x<=c)
return Math.pow(x-a,2)/((b-a)*(c-a));else
return 1-Math.pow(b-x,2)/((b-a)*(b-c));},inv:function inv(p,a,b,c){if(b<=a||c<a||c>b){return NaN;}else{if(p<=((c-a)/(b-a))){return a+(b-a)*Math.sqrt(p*((c-a)/(b-a)));}else{return a+(b-a)*(1-Math.sqrt((1-p)*(1-((c-a)/(b-a)))));}}},mean:function mean(a,b,c){return(a+b+c)/3;},median:function median(a,b,c){if(c<=(a+b)/2){return b-Math.sqrt((b-a)*(b-c))/Math.sqrt(2);}else if(c>(a+b)/2){return a+Math.sqrt((b-a)*(c-a))/Math.sqrt(2);}},mode:function mode(a,b,c){return c;},sample:function sample(a,b,c){var u=Math.random();if(u<((c-a)/(b-a)))
return a+Math.sqrt(u*(b-a)*(c-a))
return b-Math.sqrt((1-u)*(b-a)*(b-c));},variance:function variance(a,b,c){return(a*a+b*b+c*c-a*b-a*c-b*c)/18;}});function laplaceSign(x){return x/Math.abs(x);}
jStat.extend(jStat.laplace,{pdf:function pdf(x,mu,b){return(b<=0)?0:(Math.exp(-Math.abs(x-mu)/b))/(2*b);},cdf:function cdf(x,mu,b){if(b<=0){return 0;}
if(x<mu){return 0.5*Math.exp((x-mu)/b);}else{return 1-0.5*Math.exp(-(x-mu)/b);}},mean:function(mu,b){return mu;},median:function(mu,b){return mu;},mode:function(mu,b){return mu;},variance:function(mu,b){return 2*b*b;},sample:function sample(mu,b){var u=Math.random()-0.5;return mu-(b*laplaceSign(u)*Math.log(1-(2*Math.abs(u))));}});}(this.jStat,Math));(function(jStat,Math){var push=Array.prototype.push;var isArray=jStat.utils.isArray;function isUsable(arg){return isArray(arg)||arg instanceof jStat;}
jStat.extend({add:function add(arr,arg){if(isUsable(arg)){if(!isUsable(arg[0]))arg=[arg];return jStat.map(arr,function(value,row,col){return value+arg[row][col];});}
return jStat.map(arr,function(value){return value+arg;});},subtract:function subtract(arr,arg){if(isUsable(arg)){if(!isUsable(arg[0]))arg=[arg];return jStat.map(arr,function(value,row,col){return value-arg[row][col]||0;});}
return jStat.map(arr,function(value){return value-arg;});},divide:function divide(arr,arg){if(isUsable(arg)){if(!isUsable(arg[0]))arg=[arg];return jStat.multiply(arr,jStat.inv(arg));}
return jStat.map(arr,function(value){return value/arg;});},multiply:function multiply(arr,arg){var row,col,nrescols,sum,nrow,ncol,res,rescols;if(arr.length===undefined&&arg.length===undefined){return arr*arg;}
nrow=arr.length,ncol=arr[0].length,res=jStat.zeros(nrow,nrescols=(isUsable(arg))?arg[0].length:ncol),rescols=0;if(isUsable(arg)){for(;rescols<nrescols;rescols++){for(row=0;row<nrow;row++){sum=0;for(col=0;col<ncol;col++)
sum+=arr[row][col]*arg[col][rescols];res[row][rescols]=sum;}}
return(nrow===1&&rescols===1)?res[0][0]:res;}
return jStat.map(arr,function(value){return value*arg;});},outer:function outer(A,B){return jStat.multiply(A.map(function(t){return[t]}),[B]);},dot:function dot(arr,arg){if(!isUsable(arr[0]))arr=[arr];if(!isUsable(arg[0]))arg=[arg];var left=(arr[0].length===1&&arr.length!==1)?jStat.transpose(arr):arr,right=(arg[0].length===1&&arg.length!==1)?jStat.transpose(arg):arg,res=[],row=0,nrow=left.length,ncol=left[0].length,sum,col;for(;row<nrow;row++){res[row]=[];sum=0;for(col=0;col<ncol;col++)
sum+=left[row][col]*right[row][col];res[row]=sum;}
return(res.length===1)?res[0]:res;},pow:function pow(arr,arg){return jStat.map(arr,function(value){return Math.pow(value,arg);});},exp:function exp(arr){return jStat.map(arr,function(value){return Math.exp(value);});},log:function exp(arr){return jStat.map(arr,function(value){return Math.log(value);});},abs:function abs(arr){return jStat.map(arr,function(value){return Math.abs(value);});},norm:function norm(arr,p){var nnorm=0,i=0;if(isNaN(p))p=2;if(isUsable(arr[0]))arr=arr[0];for(;i<arr.length;i++){nnorm+=Math.pow(Math.abs(arr[i]),p);}
return Math.pow(nnorm,1/p);},angle:function angle(arr,arg){return Math.acos(jStat.dot(arr,arg)/(jStat.norm(arr)*jStat.norm(arg)));},aug:function aug(a,b){var newarr=[];for(var i=0;i<a.length;i++){newarr.push(a[i].slice());}
for(var i=0;i<newarr.length;i++){push.apply(newarr[i],b[i]);}
return newarr;},inv:function inv(a){var rows=a.length;var cols=a[0].length;var b=jStat.identity(rows,cols);var c=jStat.gauss_jordan(a,b);var result=[];var i=0;var j;for(;i<rows;i++){result[i]=[];for(j=cols;j<c[0].length;j++)
result[i][j-cols]=c[i][j];}
return result;},det:function det(a){var alen=a.length,alend=alen*2,vals=new Array(alend),rowshift=alen-1,colshift=alend-1,mrow=rowshift-alen+1,mcol=colshift,i=0,result=0,j;if(alen===2){return a[0][0]*a[1][1]-a[0][1]*a[1][0];}
for(;i<alend;i++){vals[i]=1;}
for(var i=0;i<alen;i++){for(j=0;j<alen;j++){vals[(mrow<0)?mrow+alen:mrow]*=a[i][j];vals[(mcol<alen)?mcol+alen:mcol]*=a[i][j];mrow++;mcol--;}
mrow=--rowshift-alen+1;mcol=--colshift;}
for(var i=0;i<alen;i++){result+=vals[i];}
for(;i<alend;i++){result-=vals[i];}
return result;},gauss_elimination:function gauss_elimination(a,b){var i=0,j=0,n=a.length,m=a[0].length,factor=1,sum=0,x=[],maug,pivot,temp,k;a=jStat.aug(a,b);maug=a[0].length;for(var i=0;i<n;i++){pivot=a[i][i];j=i;for(k=i+1;k<m;k++){if(pivot<Math.abs(a[k][i])){pivot=a[k][i];j=k;}}
if(j!=i){for(k=0;k<maug;k++){temp=a[i][k];a[i][k]=a[j][k];a[j][k]=temp;}}
for(j=i+1;j<n;j++){factor=a[j][i]/a[i][i];for(k=i;k<maug;k++){a[j][k]=a[j][k]-factor*a[i][k];}}}
for(var i=n-1;i>=0;i--){sum=0;for(j=i+1;j<=n-1;j++){sum=sum+x[j]*a[i][j];}
x[i]=(a[i][maug-1]-sum)/a[i][i];}
return x;},gauss_jordan:function gauss_jordan(a,b){var m=jStat.aug(a,b),h=m.length,w=m[0].length;for(var y=0;y<h;y++){var maxrow=y;for(var y2=y+1;y2<h;y2++){if(Math.abs(m[y2][y])>Math.abs(m[maxrow][y]))
maxrow=y2;}
var tmp=m[y];m[y]=m[maxrow];m[maxrow]=tmp
for(var y2=y+1;y2<h;y2++){c=m[y2][y]/m[y][y];for(var x=y;x<w;x++){m[y2][x]-=m[y][x]*c;}}}
for(var y=h-1;y>=0;y--){c=m[y][y];for(var y2=0;y2<y;y2++){for(var x=w-1;x>y-1;x--){m[y2][x]-=m[y][x]*m[y2][y]/c;}}
m[y][y]/=c;for(var x=h;x<w;x++){m[y][x]/=c;}}
return m;},triaUpSolve:function triaUpSolve(A,b){var size=A[0].length;var x=jStat.zeros(1,size)[0];var parts;var matrix_mode=false;if(b[0].length!=undefined){b=b.map(function(i){return i[0]});matrix_mode=true;}
jStat.arange(size-1,-1,-1).forEach(function(i){parts=jStat.arange(i+1,size).map(function(j){return x[j]*A[i][j];});x[i]=(b[i]-jStat.sum(parts))/A[i][i];});if(matrix_mode)
return x.map(function(i){return[i]});return x;},triaLowSolve:function triaLowSolve(A,b){var size=A[0].length;var x=jStat.zeros(1,size)[0];var parts;var matrix_mode=false;if(b[0].length!=undefined){b=b.map(function(i){return i[0]});matrix_mode=true;}
jStat.arange(size).forEach(function(i){parts=jStat.arange(i).map(function(j){return A[i][j]*x[j];});x[i]=(b[i]-jStat.sum(parts))/A[i][i];})
if(matrix_mode)
return x.map(function(i){return[i]});return x;},lu:function lu(A){var size=A.length;var L=jStat.identity(size);var R=jStat.zeros(A.length,A[0].length);var parts;jStat.arange(size).forEach(function(t){R[0][t]=A[0][t];});jStat.arange(1,size).forEach(function(l){jStat.arange(l).forEach(function(i){parts=jStat.arange(i).map(function(jj){return L[l][jj]*R[jj][i];});L[l][i]=(A[l][i]-jStat.sum(parts))/R[i][i];});jStat.arange(l,size).forEach(function(j){parts=jStat.arange(l).map(function(jj){return L[l][jj]*R[jj][j];});R[l][j]=A[i][j]-jStat.sum(parts);});});return[L,R];},cholesky:function cholesky(A){var size=A.length;var T=jStat.zeros(A.length,A[0].length);var parts;jStat.arange(size).forEach(function(i){parts=jStat.arange(i).map(function(t){return Math.pow(T[i][t],2);});T[i][i]=Math.sqrt(A[i][i]-jStat.sum(parts));jStat.arange(i+1,size).forEach(function(j){parts=jStat.arange(i).map(function(t){return T[i][t]*T[j][t];});T[j][i]=(A[i][j]-jStat.sum(parts))/T[i][i];});});return T;},gauss_jacobi:function gauss_jacobi(a,b,x,r){var i=0;var j=0;var n=a.length;var l=[];var u=[];var d=[];var xv,c,h,xk;for(;i<n;i++){l[i]=[];u[i]=[];d[i]=[];for(j=0;j<n;j++){if(i>j){l[i][j]=a[i][j];u[i][j]=d[i][j]=0;}else if(i<j){u[i][j]=a[i][j];l[i][j]=d[i][j]=0;}else{d[i][j]=a[i][j];l[i][j]=u[i][j]=0;}}}
h=jStat.multiply(jStat.multiply(jStat.inv(d),jStat.add(l,u)),-1);c=jStat.multiply(jStat.inv(d),b);xv=x;xk=jStat.add(jStat.multiply(h,x),c);i=2;while(Math.abs(jStat.norm(jStat.subtract(xk,xv)))>r){xv=xk;xk=jStat.add(jStat.multiply(h,xv),c);i++;}
return xk;},gauss_seidel:function gauss_seidel(a,b,x,r){var i=0;var n=a.length;var l=[];var u=[];var d=[];var j,xv,c,h,xk;for(;i<n;i++){l[i]=[];u[i]=[];d[i]=[];for(j=0;j<n;j++){if(i>j){l[i][j]=a[i][j];u[i][j]=d[i][j]=0;}else if(i<j){u[i][j]=a[i][j];l[i][j]=d[i][j]=0;}else{d[i][j]=a[i][j];l[i][j]=u[i][j]=0;}}}
h=jStat.multiply(jStat.multiply(jStat.inv(jStat.add(d,l)),u),-1);c=jStat.multiply(jStat.inv(jStat.add(d,l)),b);xv=x;xk=jStat.add(jStat.multiply(h,x),c);i=2;while(Math.abs(jStat.norm(jStat.subtract(xk,xv)))>r){xv=xk;xk=jStat.add(jStat.multiply(h,xv),c);i=i+1;}
return xk;},SOR:function SOR(a,b,x,r,w){var i=0;var n=a.length;var l=[];var u=[];var d=[];var j,xv,c,h,xk;for(;i<n;i++){l[i]=[];u[i]=[];d[i]=[];for(j=0;j<n;j++){if(i>j){l[i][j]=a[i][j];u[i][j]=d[i][j]=0;}else if(i<j){u[i][j]=a[i][j];l[i][j]=d[i][j]=0;}else{d[i][j]=a[i][j];l[i][j]=u[i][j]=0;}}}
h=jStat.multiply(jStat.inv(jStat.add(d,jStat.multiply(l,w))),jStat.subtract(jStat.multiply(d,1-w),jStat.multiply(u,w)));c=jStat.multiply(jStat.multiply(jStat.inv(jStat.add(d,jStat.multiply(l,w))),b),w);xv=x;xk=jStat.add(jStat.multiply(h,x),c);i=2;while(Math.abs(jStat.norm(jStat.subtract(xk,xv)))>r){xv=xk;xk=jStat.add(jStat.multiply(h,xv),c);i++;}
return xk;},householder:function householder(a){var m=a.length;var n=a[0].length;var i=0;var w=[];var p=[];var alpha,r,k,j,factor;for(;i<m-1;i++){alpha=0;for(j=i+1;j<n;j++)
alpha+=(a[j][i]*a[j][i]);factor=(a[i+1][i]>0)?-1:1;alpha=factor*Math.sqrt(alpha);r=Math.sqrt((((alpha*alpha)-a[i+1][i]*alpha)/2));w=jStat.zeros(m,1);w[i+1][0]=(a[i+1][i]-alpha)/(2*r);for(k=i+2;k<m;k++)w[k][0]=a[k][i]/(2*r);p=jStat.subtract(jStat.identity(m,n),jStat.multiply(jStat.multiply(w,jStat.transpose(w)),2));a=jStat.multiply(p,jStat.multiply(a,p));}
return a;},QR:(function(){function get_Q1(x){var size=x.length;var norm_x=jStat.norm(x,2);var e1=jStat.zeros(1,size)[0];e1[0]=1;var u=jStat.add(jStat.multiply(jStat.multiply(e1,norm_x),-1),x);var norm_u=jStat.norm(u,2);var v=jStat.divide(u,norm_u);var Q=jStat.subtract(jStat.identity(size),jStat.multiply(jStat.outer(v,v),2));return Q;}
function qr(A){var size=A[0].length;var QList=[];jStat.arange(size).forEach(function(i){var x=jStat.slice(A,{row:{start:i},col:i});var Q=get_Q1(x);var Qn=jStat.identity(A.length);Qn=jStat.sliceAssign(Qn,{row:{start:i},col:{start:i}},Q);A=jStat.multiply(Qn,A);QList.push(Qn);});var Q=QList.reduce(function(x,y){return jStat.multiply(x,y)});var R=A;return[Q,R];}
return qr;})(),lstsq:(function(A,b){function R_I(A){A=jStat.copy(A);var size=A.length;var I=jStat.identity(size);jStat.arange(size-1,-1,-1).forEach(function(i){jStat.sliceAssign(I,{row:i},jStat.divide(jStat.slice(I,{row:i}),A[i][i]));jStat.sliceAssign(A,{row:i},jStat.divide(jStat.slice(A,{row:i}),A[i][i]));jStat.arange(i).forEach(function(j){var c=jStat.multiply(A[j][i],-1);var Aj=jStat.slice(A,{row:j});var cAi=jStat.multiply(jStat.slice(A,{row:i}),c);jStat.sliceAssign(A,{row:j},jStat.add(Aj,cAi));var Ij=jStat.slice(I,{row:j});var cIi=jStat.multiply(jStat.slice(I,{row:i}),c);jStat.sliceAssign(I,{row:j},jStat.add(Ij,cIi));})});return I;}
function qr_solve(A,b){var array_mode=false;if(b[0].length===undefined){b=b.map(function(x){return[x]});array_mode=true;}
var QR=jStat.QR(A);var Q=QR[0];var R=QR[1];var attrs=A[0].length;var Q1=jStat.slice(Q,{col:{end:attrs}});var R1=jStat.slice(R,{row:{end:attrs}});var RI=R_I(R1);var x=jStat.multiply(jStat.multiply(RI,jStat.transpose(Q1)),b);if(array_mode)
return x.map(function(i){return i[0]});return x;}
return qr_solve;})(),jacobi:function jacobi(a){var condition=1;var count=0;var n=a.length;var e=jStat.identity(n,n);var ev=[];var b,i,j,p,q,maxim,theta,s;while(condition===1){count++;maxim=a[0][1];p=0;q=1;for(var i=0;i<n;i++){for(j=0;j<n;j++){if(i!=j){if(maxim<Math.abs(a[i][j])){maxim=Math.abs(a[i][j]);p=i;q=j;}}}}
if(a[p][p]===a[q][q])
theta=(a[p][q]>0)?Math.PI/4:-Math.PI/4;else
theta=Math.atan(2*a[p][q]/(a[p][p]-a[q][q]))/2;s=jStat.identity(n,n);s[p][p]=Math.cos(theta);s[p][q]=-Math.sin(theta);s[q][p]=Math.sin(theta);s[q][q]=Math.cos(theta);e=jStat.multiply(e,s);b=jStat.multiply(jStat.multiply(jStat.inv(s),a),s);a=b;condition=0;for(var i=1;i<n;i++){for(j=1;j<n;j++){if(i!=j&&Math.abs(a[i][j])>0.001){condition=1;}}}}
for(var i=0;i<n;i++)ev.push(a[i][i]);return[e,ev];},rungekutta:function rungekutta(f,h,p,t_j,u_j,order){var k1,k2,u_j1,k3,k4;if(order===2){while(t_j<=p){k1=h*f(t_j,u_j);k2=h*f(t_j+h,u_j+k1);u_j1=u_j+(k1+k2)/2;u_j=u_j1;t_j=t_j+h;}}
if(order===4){while(t_j<=p){k1=h*f(t_j,u_j);k2=h*f(t_j+h/2,u_j+k1/2);k3=h*f(t_j+h/2,u_j+k2/2);k4=h*f(t_j+h,u_j+k3);u_j1=u_j+(k1+2*k2+2*k3+k4)/6;u_j=u_j1;t_j=t_j+h;}}
return u_j;},romberg:function romberg(f,a,b,order){var i=0;var h=(b-a)/2;var x=[];var h1=[];var g=[];var m,a1,j,k,I,d;while(i<order/2){I=f(a);for(j=a,k=0;j<=b;j=j+h,k++)x[k]=j;m=x.length;for(j=1;j<m-1;j++){I+=(((j%2)!==0)?4:2)*f(x[j]);}
I=(h/3)*(I+f(b));g[i]=I;h/=2;i++;}
a1=g.length;m=1;while(a1!==1){for(j=0;j<a1-1;j++)
h1[j]=((Math.pow(4,m))*g[j+1]-g[j])/(Math.pow(4,m)-1);a1=h1.length;g=h1;h1=[];m++;}
return g;},richardson:function richardson(X,f,x,h){function pos(X,x){var i=0;var n=X.length;var p;for(;i<n;i++)
if(X[i]===x)p=i;return p;}
var n=X.length,h_min=Math.abs(x-X[pos(X,x)+1]),i=0,g=[],h1=[],y1,y2,m,a,j;while(h>=h_min){y1=pos(X,x+h);y2=pos(X,x);g[i]=(f[y1]-2*f[y2]+f[2*y2-y1])/(h*h);h/=2;i++;}
a=g.length;m=1;while(a!=1){for(j=0;j<a-1;j++)
h1[j]=((Math.pow(4,m))*g[j+1]-g[j])/(Math.pow(4,m)-1);a=h1.length;g=h1;h1=[];m++;}
return g;},simpson:function simpson(f,a,b,n){var h=(b-a)/n;var I=f(a);var x=[];var j=a;var k=0;var i=1;var m;for(;j<=b;j=j+h,k++)
x[k]=j;m=x.length;for(;i<m-1;i++){I+=((i%2!==0)?4:2)*f(x[i]);}
return(h/3)*(I+f(b));},hermite:function hermite(X,F,dF,value){var n=X.length;var p=0;var i=0;var l=[];var dl=[];var A=[];var B=[];var j;for(;i<n;i++){l[i]=1;for(j=0;j<n;j++){if(i!=j)l[i]*=(value-X[j])/(X[i]-X[j]);}
dl[i]=0;for(j=0;j<n;j++){if(i!=j)dl[i]+=1/(X[i]-X[j]);}
A[i]=(1-2*(value-X[i])*dl[i])*(l[i]*l[i]);B[i]=(value-X[i])*(l[i]*l[i]);p+=(A[i]*F[i]+B[i]*dF[i]);}
return p;},lagrange:function lagrange(X,F,value){var p=0;var i=0;var j,l;var n=X.length;for(;i<n;i++){l=F[i];for(j=0;j<n;j++){if(i!=j)l*=(value-X[j])/(X[i]-X[j]);}
p+=l;}
return p;},cubic_spline:function cubic_spline(X,F,value){var n=X.length;var i=0,j;var A=[];var B=[];var alpha=[];var c=[];var h=[];var b=[];var d=[];for(;i<n-1;i++)
h[i]=X[i+1]-X[i];alpha[0]=0;for(var i=1;i<n-1;i++){alpha[i]=(3/h[i])*(F[i+1]-F[i])-
(3/h[i-1])*(F[i]-F[i-1]);}
for(var i=1;i<n-1;i++){A[i]=[];B[i]=[];A[i][i-1]=h[i-1];A[i][i]=2*(h[i-1]+h[i]);A[i][i+1]=h[i];B[i][0]=alpha[i];}
c=jStat.multiply(jStat.inv(A),B);for(j=0;j<n-1;j++){b[j]=(F[j+1]-F[j])/h[j]-h[j]*(c[j+1][0]+2*c[j][0])/3;d[j]=(c[j+1][0]-c[j][0])/(3*h[j]);}
for(j=0;j<n;j++){if(X[j]>value)break;}
j-=1;return F[j]+(value-X[j])*b[j]+jStat.sq(value-X[j])*c[j]+(value-X[j])*jStat.sq(value-X[j])*d[j];},gauss_quadrature:function gauss_quadrature(){throw new Error('gauss_quadrature not yet implemented');},PCA:function PCA(X){var m=X.length;var n=X[0].length;var flag=false;var i=0;var j,temp1;var u=[];var D=[];var result=[];var temp2=[];var Y=[];var Bt=[];var B=[];var C=[];var V=[];var Vt=[];for(var i=0;i<m;i++){u[i]=jStat.sum(X[i])/n;}
for(var i=0;i<n;i++){B[i]=[];for(j=0;j<m;j++){B[i][j]=X[j][i]-u[j];}}
B=jStat.transpose(B);for(var i=0;i<m;i++){C[i]=[];for(j=0;j<m;j++){C[i][j]=(jStat.dot([B[i]],[B[j]]))/(n-1);}}
result=jStat.jacobi(C);V=result[0];D=result[1];Vt=jStat.transpose(V);for(var i=0;i<D.length;i++){for(j=i;j<D.length;j++){if(D[i]<D[j]){temp1=D[i];D[i]=D[j];D[j]=temp1;temp2=Vt[i];Vt[i]=Vt[j];Vt[j]=temp2;}}}
Bt=jStat.transpose(B);for(var i=0;i<m;i++){Y[i]=[];for(j=0;j<Bt.length;j++){Y[i][j]=jStat.dot([Vt[i]],[Bt[j]]);}}
return[X,D,Vt,Y];}});(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jStat.fn[passfunc]=function(arg,func){var tmpthis=this;if(func){setTimeout(function(){func.call(tmpthis,jStat.fn[passfunc].call(tmpthis,arg));},15);return this;}
if(typeof jStat[passfunc](this,arg)==='number')
return jStat[passfunc](this,arg);else
return jStat(jStat[passfunc](this,arg));};}(funcs[i]));}('add divide multiply subtract dot pow exp log abs norm angle'.split(' ')));}(this.jStat,Math));(function(jStat,Math){var slice=[].slice;var isNumber=jStat.utils.isNumber;var isArray=jStat.utils.isArray;jStat.extend({zscore:function zscore(){var args=slice.call(arguments);if(isNumber(args[1])){return(args[0]-args[1])/args[2];}
return(args[0]-jStat.mean(args[1]))/jStat.stdev(args[1],args[2]);},ztest:function ztest(){var args=slice.call(arguments);var z;if(isArray(args[1])){z=jStat.zscore(args[0],args[1],args[3]);return(args[2]===1)?(jStat.normal.cdf(-Math.abs(z),0,1)):(jStat.normal.cdf(-Math.abs(z),0,1)*2);}else{if(args.length>2){z=jStat.zscore(args[0],args[1],args[2]);return(args[3]===1)?(jStat.normal.cdf(-Math.abs(z),0,1)):(jStat.normal.cdf(-Math.abs(z),0,1)*2);}else{z=args[0];return(args[1]===1)?(jStat.normal.cdf(-Math.abs(z),0,1)):(jStat.normal.cdf(-Math.abs(z),0,1)*2);}}}});jStat.extend(jStat.fn,{zscore:function zscore(value,flag){return(value-this.mean())/this.stdev(flag);},ztest:function ztest(value,sides,flag){var zscore=Math.abs(this.zscore(value,flag));return(sides===1)?(jStat.normal.cdf(-zscore,0,1)):(jStat.normal.cdf(-zscore,0,1)*2);}});jStat.extend({tscore:function tscore(){var args=slice.call(arguments);return(args.length===4)?((args[0]-args[1])/(args[2]/Math.sqrt(args[3]))):((args[0]-jStat.mean(args[1]))/(jStat.stdev(args[1],true)/Math.sqrt(args[1].length)));},ttest:function ttest(){var args=slice.call(arguments);var tscore;if(args.length===5){tscore=Math.abs(jStat.tscore(args[0],args[1],args[2],args[3]));return(args[4]===1)?(jStat.studentt.cdf(-tscore,args[3]-1)):(jStat.studentt.cdf(-tscore,args[3]-1)*2);}
if(isNumber(args[1])){tscore=Math.abs(args[0])
return(args[2]==1)?(jStat.studentt.cdf(-tscore,args[1]-1)):(jStat.studentt.cdf(-tscore,args[1]-1)*2);}
tscore=Math.abs(jStat.tscore(args[0],args[1]))
return(args[2]==1)?(jStat.studentt.cdf(-tscore,args[1].length-1)):(jStat.studentt.cdf(-tscore,args[1].length-1)*2);}});jStat.extend(jStat.fn,{tscore:function tscore(value){return(value-this.mean())/(this.stdev(true)/Math.sqrt(this.cols()));},ttest:function ttest(value,sides){return(sides===1)?(1-jStat.studentt.cdf(Math.abs(this.tscore(value)),this.cols()-1)):(jStat.studentt.cdf(-Math.abs(this.tscore(value)),this.cols()-1)*2);}});jStat.extend({anovafscore:function anovafscore(){var args=slice.call(arguments),expVar,sample,sampMean,sampSampMean,tmpargs,unexpVar,i,j;if(args.length===1){tmpargs=new Array(args[0].length);for(var i=0;i<args[0].length;i++){tmpargs[i]=args[0][i];}
args=tmpargs;}
if(args.length===2){return jStat.variance(args[0])/jStat.variance(args[1]);}
sample=new Array();for(var i=0;i<args.length;i++){sample=sample.concat(args[i]);}
sampMean=jStat.mean(sample);expVar=0;for(var i=0;i<args.length;i++){expVar=expVar+args[i].length*Math.pow(jStat.mean(args[i])-sampMean,2);}
expVar/=(args.length-1);unexpVar=0;for(var i=0;i<args.length;i++){sampSampMean=jStat.mean(args[i]);for(j=0;j<args[i].length;j++){unexpVar+=Math.pow(args[i][j]-sampSampMean,2);}}
unexpVar/=(sample.length-args.length);return expVar/unexpVar;},anovaftest:function anovaftest(){var args=slice.call(arguments),df1,df2,n,i;if(isNumber(args[0])){return 1-jStat.centralF.cdf(args[0],args[1],args[2]);}
anovafscore=jStat.anovafscore(args);df1=args.length-1;n=0;for(var i=0;i<args.length;i++){n=n+args[i].length;}
df2=n-df1-1;return 1-jStat.centralF.cdf(anovafscore,df1,df2);},ftest:function ftest(fscore,df1,df2){return 1-jStat.centralF.cdf(fscore,df1,df2);}});jStat.extend(jStat.fn,{anovafscore:function anovafscore(){return jStat.anovafscore(this.toArray());},anovaftes:function anovaftes(){var n=0;var i;for(var i=0;i<this.length;i++){n=n+this[i].length;}
return jStat.ftest(this.anovafscore(),this.length-1,n-this.length);}});jStat.extend({normalci:function normalci(){var args=slice.call(arguments),ans=new Array(2),change;if(args.length===4){change=Math.abs(jStat.normal.inv(args[1]/2,0,1)*args[2]/Math.sqrt(args[3]));}else{change=Math.abs(jStat.normal.inv(args[1]/2,0,1)*jStat.stdev(args[2])/Math.sqrt(args[2].length));}
ans[0]=args[0]-change;ans[1]=args[0]+change;return ans;},tci:function tci(){var args=slice.call(arguments),ans=new Array(2),change;if(args.length===4){change=Math.abs(jStat.studentt.inv(args[1]/2,args[3]-1)*args[2]/Math.sqrt(args[3]));}else{change=Math.abs(jStat.studentt.inv(args[1]/2,args[2].length-1)*jStat.stdev(args[2],true)/Math.sqrt(args[2].length));}
ans[0]=args[0]-change;ans[1]=args[0]+change;return ans;},significant:function significant(pvalue,alpha){return pvalue<alpha;}});jStat.extend(jStat.fn,{normalci:function normalci(value,alpha){return jStat.normalci(value,alpha,this.toArray());},tci:function tci(value,alpha){return jStat.tci(value,alpha,this.toArray());}});function differenceOfProportions(p1,n1,p2,n2){if(p1>1||p2>1||p1<=0||p2<=0){throw new Error("Proportions should be greater than 0 and less than 1")}
var pooled=(p1*n1+p2*n2)/(n1+n2);var se=Math.sqrt(pooled*(1-pooled)*((1/n1)+(1/n2)));return(p1-p2)/se;}
jStat.extend(jStat.fn,{oneSidedDifferenceOfProportions:function oneSidedDifferenceOfProportions(p1,n1,p2,n2){var z=differenceOfProportions(p1,n1,p2,n2);return jStat.ztest(z,1);},twoSidedDifferenceOfProportions:function twoSidedDifferenceOfProportions(p1,n1,p2,n2){var z=differenceOfProportions(p1,n1,p2,n2);return jStat.ztest(z,2);}});}(this.jStat,Math));this.jStat.models=(function(){function sub_regress(endog,exog){return ols(endog,exog);}
function sub_regress(exog){var var_count=exog[0].length;var modelList=jStat.arange(var_count).map(function(endog_index){var exog_index=jStat.arange(var_count).filter(function(i){return i!==endog_index});return ols(jStat.col(exog,endog_index).map(function(x){return x[0]}),jStat.col(exog,exog_index))});return modelList;}
function ols(endog,exog){var nobs=endog.length;var df_model=exog[0].length-1;var df_resid=nobs-df_model-1;var coef=jStat.lstsq(exog,endog);var predict=jStat.multiply(exog,coef.map(function(x){return[x]})).map(function(p){return p[0]});var resid=jStat.subtract(endog,predict);var ybar=jStat.mean(endog);var SSE=jStat.sum(predict.map(function(f){return Math.pow(f-ybar,2);}));var SSR=jStat.sum(endog.map(function(y,i){return Math.pow(y-predict[i],2);}));var SST=SSE+SSR;var R2=(SSE/SST);return{exog:exog,endog:endog,nobs:nobs,df_model:df_model,df_resid:df_resid,coef:coef,predict:predict,resid:resid,ybar:ybar,SST:SST,SSE:SSE,SSR:SSR,R2:R2};}
function t_test(model){var subModelList=sub_regress(model.exog);var sigmaHat=Math.sqrt(model.SSR/(model.df_resid));var seBetaHat=subModelList.map(function(mod){var SST=mod.SST;var R2=mod.R2;return sigmaHat/Math.sqrt(SST*(1-R2));});var tStatistic=model.coef.map(function(coef,i){return(coef-0)/seBetaHat[i];});var pValue=tStatistic.map(function(t){var leftppf=jStat.studentt.cdf(t,model.df_resid);return(leftppf>0.5?1-leftppf:leftppf)*2;});var c=jStat.studentt.inv(0.975,model.df_resid);var interval95=model.coef.map(function(coef,i){var d=c*seBetaHat[i];return[coef-d,coef+d];})
return{se:seBetaHat,t:tStatistic,p:pValue,sigmaHat:sigmaHat,interval95:interval95};}
function F_test(model){var F_statistic=(model.R2/model.df_model)/((1-model.R2)/model.df_resid);var fcdf=function(x,n1,n2){return jStat.beta.cdf(x/(n2/n1+x),n1/2,n2/2)}
var pvalue=1-fcdf(F_statistic,model.df_model,model.df_resid);return{F_statistic:F_statistic,pvalue:pvalue};}
function ols_wrap(endog,exog){var model=ols(endog,exog);var ttest=t_test(model);var ftest=F_test(model);var adjust_R2=1-(1-model.rsquared)*((model.nobs-1)/(model.df_resid));model.t=ttest;model.f=ftest;model.adjust_R2=adjust_R2;return model;}
return{ols:ols_wrap};})();},function(module,exports,__webpack_require__){var utils=__webpack_require__(15);var numbro=__webpack_require__(19);var error=__webpack_require__(16);exports.UNIQUE=function(){var result=[];for(var i=0;i<arguments.length;++i){var hasElement=false;var element=arguments[i];for(var j=0;j<result.length;++j){hasElement=result[j]===element;if(hasElement){break;}}
if(!hasElement){result.push(element);}}
return result;};exports.FLATTEN=utils.flatten;exports.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0);};exports.REFERENCE=function(context,reference){if(!arguments.length){return error.error;}
try{var path=reference.split('.');var result=context;for(var i=0;i<path.length;++i){var step=path[i];if(step[step.length-1]===']'){var opening=step.indexOf('[');var index=step.substring(opening+1,step.length-1);result=result[step.substring(0,opening)][index];}else{result=result[step];}}
return result;}catch(error){}};exports.JOIN=function(array,separator){return array.join(separator);};exports.NUMBERS=function(){var possibleNumbers=utils.flatten(arguments);return possibleNumbers.filter(function(el){return typeof el==='number';});};exports.NUMERAL=function(number,format){return numbro(number).format(format);};},function(module,exports,__webpack_require__){var error=__webpack_require__(16);exports.CELL=function(){throw new Error('CELL is not implemented');};exports.ERROR={};exports.ERROR.TYPE=function(error_val){switch(error_val){case error.nil:return 1;case error.div0:return 2;case error.value:return 3;case error.ref:return 4;case error.name:return 5;case error.num:return 6;case error.na:return 7;case error.data:return 8;}
return error.na;};exports.INFO=function(){throw new Error('INFO is not implemented');};exports.ISBLANK=function(value){return value===null;};exports.ISBINARY=function(number){return(/^[01]{1,10}$/).test(number);};exports.ISERR=function(value){return([error.value,error.ref,error.div0,error.num,error.name,error.nil]).indexOf(value)>=0||(typeof value==='number'&&(isNaN(value)||!isFinite(value)));};exports.ISERROR=function(value){return exports.ISERR(value)||value===error.na;};exports.ISEVEN=function(number){return(Math.floor(Math.abs(number))&1)?false:true;};exports.ISFORMULA=function(){throw new Error('ISFORMULA is not implemented');};exports.ISLOGICAL=function(value){return value===true||value===false;};exports.ISNA=function(value){return value===error.na;};exports.ISNONTEXT=function(value){return typeof(value)!=='string';};exports.ISNUMBER=function(value){return typeof(value)==='number'&&!isNaN(value)&&isFinite(value);};exports.ISODD=function(number){return(Math.floor(Math.abs(number))&1)?true:false;};exports.ISREF=function(){throw new Error('ISREF is not implemented');};exports.ISTEXT=function(value){return typeof(value)==='string';};exports.N=function(value){if(this.ISNUMBER(value)){return value;}
if(value instanceof Date){return value.getTime();}
if(value===true){return 1;}
if(value===false){return 0;}
if(this.ISERROR(value)){return value;}
return 0;};exports.NA=function(){return error.na;};exports.SHEET=function(){throw new Error('SHEET is not implemented');};exports.SHEETS=function(){throw new Error('SHEETS is not implemented');};exports.TYPE=function(value){if(this.ISNUMBER(value)){return 1;}
if(this.ISTEXT(value)){return 2;}
if(this.ISLOGICAL(value)){return 4;}
if(this.ISERROR(value)){return 16;}
if(Array.isArray(value)){return 64;}};},function(module,exports,__webpack_require__){var error=__webpack_require__(16);var jStat=__webpack_require__(22).jStat;var text=__webpack_require__(18);var utils=__webpack_require__(15);var bessel=__webpack_require__(26);function isValidBinaryNumber(number){return(/^[01]{1,10}$/).test(number);}
exports.BESSELI=function(x,n){x=utils.parseNumber(x);n=utils.parseNumber(n);if(utils.anyIsError(x,n)){return error.value;}
return bessel.besseli(x,n);};exports.BESSELJ=function(x,n){x=utils.parseNumber(x);n=utils.parseNumber(n);if(utils.anyIsError(x,n)){return error.value;}
return bessel.besselj(x,n);};exports.BESSELK=function(x,n){x=utils.parseNumber(x);n=utils.parseNumber(n);if(utils.anyIsError(x,n)){return error.value;}
return bessel.besselk(x,n);};exports.BESSELY=function(x,n){x=utils.parseNumber(x);n=utils.parseNumber(n);if(utils.anyIsError(x,n)){return error.value;}
return bessel.bessely(x,n);};exports.BIN2DEC=function(number){if(!isValidBinaryNumber(number)){return error.num;}
var result=parseInt(number,2);var stringified=number.toString();if(stringified.length===10&&stringified.substring(0,1)==='1'){return parseInt(stringified.substring(1),2)-512;}else{return result;}};exports.BIN2HEX=function(number,places){if(!isValidBinaryNumber(number)){return error.num;}
var stringified=number.toString();if(stringified.length===10&&stringified.substring(0,1)==='1'){return(1099511627264+parseInt(stringified.substring(1),2)).toString(16);}
var result=parseInt(number,2).toString(16);if(places===undefined){return result;}else{if(isNaN(places)){return error.value;}
if(places<0){return error.num;}
places=Math.floor(places);return(places>=result.length)?text.REPT('0',places-result.length)+result:error.num;}};exports.BIN2OCT=function(number,places){if(!isValidBinaryNumber(number)){return error.num;}
var stringified=number.toString();if(stringified.length===10&&stringified.substring(0,1)==='1'){return(1073741312+parseInt(stringified.substring(1),2)).toString(8);}
var result=parseInt(number,2).toString(8);if(places===undefined){return result;}else{if(isNaN(places)){return error.value;}
if(places<0){return error.num;}
places=Math.floor(places);return(places>=result.length)?text.REPT('0',places-result.length)+result:error.num;}};exports.BITAND=function(number1,number2){number1=utils.parseNumber(number1);number2=utils.parseNumber(number2);if(utils.anyIsError(number1,number2)){return error.value;}
if(number1<0||number2<0){return error.num;}
if(Math.floor(number1)!==number1||Math.floor(number2)!==number2){return error.num;}
if(number1>281474976710655||number2>281474976710655){return error.num;}
return number1&number2;};exports.BITLSHIFT=function(number,shift){number=utils.parseNumber(number);shift=utils.parseNumber(shift);if(utils.anyIsError(number,shift)){return error.value;}
if(number<0){return error.num;}
if(Math.floor(number)!==number){return error.num;}
if(number>281474976710655){return error.num;}
if(Math.abs(shift)>53){return error.num;}
return(shift>=0)?number<<shift:number>>-shift;};exports.BITOR=function(number1,number2){number1=utils.parseNumber(number1);number2=utils.parseNumber(number2);if(utils.anyIsError(number1,number2)){return error.value;}
if(number1<0||number2<0){return error.num;}
if(Math.floor(number1)!==number1||Math.floor(number2)!==number2){return error.num;}
if(number1>281474976710655||number2>281474976710655){return error.num;}
return number1|number2;};exports.BITRSHIFT=function(number,shift){number=utils.parseNumber(number);shift=utils.parseNumber(shift);if(utils.anyIsError(number,shift)){return error.value;}
if(number<0){return error.num;}
if(Math.floor(number)!==number){return error.num;}
if(number>281474976710655){return error.num;}
if(Math.abs(shift)>53){return error.num;}
return(shift>=0)?number>>shift:number<<-shift;};exports.BITXOR=function(number1,number2){number1=utils.parseNumber(number1);number2=utils.parseNumber(number2);if(utils.anyIsError(number1,number2)){return error.value;}
if(number1<0||number2<0){return error.num;}
if(Math.floor(number1)!==number1||Math.floor(number2)!==number2){return error.num;}
if(number1>281474976710655||number2>281474976710655){return error.num;}
return number1^number2;};exports.COMPLEX=function(real,imaginary,suffix){real=utils.parseNumber(real);imaginary=utils.parseNumber(imaginary);if(utils.anyIsError(real,imaginary)){return real;}
suffix=(suffix===undefined)?'i':suffix;if(suffix!=='i'&&suffix!=='j'){return error.value;}
if(real===0&&imaginary===0){return 0;}else if(real===0){return(imaginary===1)?suffix:imaginary.toString()+suffix;}else if(imaginary===0){return real.toString();}else{var sign=(imaginary>0)?'+':'';return real.toString()+sign+((imaginary===1)?suffix:imaginary.toString()+suffix);}};exports.CONVERT=function(number,from_unit,to_unit){number=utils.parseNumber(number);if(number instanceof Error){return number;}
var units=[["a.u. of action","?",null,"action",false,false,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",false,false,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",false,false,4.35974417757576e-18],["a.u. of length","a?",null,"length",false,false,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",false,false,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",false,false,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",false,true,0.514773333],["ampere","A",null,"electric_current",true,false,1],["ampere per meter","A/m",null,"magnetic_field_intensity",true,false,1],["ångström","Å",["ang"],"length",false,true,1e-10],["are","ar",null,"area",false,true,100],["astronomical unit","ua",null,"length",false,false,1.49597870691667e-11],["bar","bar",null,"pressure",false,false,100000],["barn","b",null,"area",false,false,1e-28],["becquerel","Bq",null,"radioactivity",true,false,1],["bit","bit",["b"],"information",false,true,1],["btu","BTU",["btu"],"energy",false,true,1055.05585262],["byte","byte",null,"information",false,true,8],["candela","cd",null,"luminous_intensity",true,false,1],["candela per square metre","cd/m?",null,"luminance",true,false,1],["coulomb","C",null,"electric_charge",true,false,1],["cubic ångström","ang3",["ang^3"],"volume",false,true,1e-30],["cubic foot","ft3",["ft^3"],"volume",false,true,0.028316846592],["cubic inch","in3",["in^3"],"volume",false,true,0.000016387064],["cubic light-year","ly3",["ly^3"],"volume",false,true,8.46786664623715e-47],["cubic metre","m?",null,"volume",true,true,1],["cubic mile","mi3",["mi^3"],"volume",false,true,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",false,true,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",false,true,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",false,true,0.764554857984],["cup","cup",null,"volume",false,true,0.0002365882365],["dalton","Da",["u"],"mass",false,false,1.66053886282828e-27],["day","d",["day"],"time",false,true,86400],["degree","°",null,"angle",false,false,0.0174532925199433],["degrees Rankine","Rank",null,"temperature",false,true,0.555555555555556],["dyne","dyn",["dy"],"force",false,true,0.00001],["electronvolt","eV",["ev"],"energy",false,true,1.60217656514141],["ell","ell",null,"length",false,true,1.143],["erg","erg",["e"],"energy",false,true,1e-7],["farad","F",null,"electric_capacitance",true,false,1],["fluid ounce","oz",null,"volume",false,true,0.0000295735295625],["foot","ft",null,"length",false,true,0.3048],["foot-pound","flb",null,"energy",false,true,1.3558179483314],["gal","Gal",null,"acceleration",false,false,0.01],["gallon","gal",null,"volume",false,true,0.003785411784],["gauss","G",["ga"],"magnetic_flux_density",false,true,1],["grain","grain",null,"mass",false,true,0.0000647989],["gram","g",null,"mass",false,true,0.001],["gray","Gy",null,"absorbed_dose",true,false,1],["gross registered ton","GRT",["regton"],"volume",false,true,2.8316846592],["hectare","ha",null,"area",false,true,10000],["henry","H",null,"inductance",true,false,1],["hertz","Hz",null,"frequency",true,false,1],["horsepower","HP",["h"],"power",false,true,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",false,true,2684519.538],["hour","h",["hr"],"time",false,true,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",false,true,0.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",false,true,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",false,true,0.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",false,true,1016.046909],["inch","in",null,"length",false,true,0.0254],["international acre","uk_acre",null,"area",false,true,4046.8564224],["IT calorie","cal",null,"energy",false,true,4.1868],["joule","J",null,"energy",true,true,1],["katal","kat",null,"catalytic_activity",true,false,1],["kelvin","K",["kel"],"temperature",true,true,1],["kilogram","kg",null,"mass",true,true,1],["knot","kn",null,"speed",false,true,0.514444444444444],["light-year","ly",null,"length",false,true,9460730472580800],["litre","L",["l","lt"],"volume",false,true,0.001],["lumen","lm",null,"luminous_flux",true,false,1],["lux","lx",null,"illuminance",true,false,1],["maxwell","Mx",null,"magnetic_flux",false,false,1e-18],["measurement ton","MTON",null,"volume",false,true,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",false,true,0.00027777777777778],["meter per second","m/s",["m/sec"],"speed",true,true,1],["meter per second squared","m?s??",null,"acceleration",true,false,1],["parsec","pc",["parsec"],"length",false,true,30856775814671900],["meter squared per second","m?/s",null,"kinematic_viscosity",true,false,1],["metre","m",null,"length",true,true,1],["miles per hour","mph",null,"speed",false,true,0.44704],["millimetre of mercury","mmHg",null,"pressure",false,false,133.322],["minute","?",null,"angle",false,false,0.000290888208665722],["minute","min",["mn"],"time",false,true,60],["modern teaspoon","tspm",null,"volume",false,true,0.000005],["mole","mol",null,"amount_of_substance",true,false,1],["morgen","Morgen",null,"area",false,true,2500],["n.u. of action","?",null,"action",false,false,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",false,false,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",false,false,299792458],["n.u. of time","?/(me?c??)",null,"time",false,false,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",false,true,1852],["newton","N",null,"force",true,true,1],["œrsted","Oe ",null,"magnetic_field_intensity",false,false,79.5774715459477],["ohm","Ω",null,"electric_resistance",true,false,1],["ounce mass","ozm",null,"mass",false,true,0.028349523125],["pascal","Pa",null,"pressure",true,false,1],["pascal second","Pa?s",null,"dynamic_viscosity",true,false,1],["pferdestärke","PS",null,"power",false,true,735.49875],["phot","ph",null,"illuminance",false,false,0.0001],["pica (1/6 inch)","pica",null,"length",false,true,0.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",false,true,0.00423333333333333],["poise","P",null,"dynamic_viscosity",false,false,0.1],["pond","pond",null,"force",false,true,0.00980665],["pound force","lbf",null,"force",false,true,4.4482216152605],["pound mass","lbm",null,"mass",false,true,0.45359237],["quart","qt",null,"volume",false,true,0.000946352946],["radian","rad",null,"angle",true,false,1],["second","?",null,"angle",false,false,0.00000484813681109536],["second","s",["sec"],"time",true,true,1],["short hundredweight","cwt",["shweight"],"mass",false,true,45.359237],["siemens","S",null,"electrical_conductance",true,false,1],["sievert","Sv",null,"equivalent_dose",true,false,1],["slug","sg",null,"mass",false,true,14.59390294],["square ångström","ang2",["ang^2"],"area",false,true,1e-20],["square foot","ft2",["ft^2"],"area",false,true,0.09290304],["square inch","in2",["in^2"],"area",false,true,0.00064516],["square light-year","ly2",["ly^2"],"area",false,true,8.95054210748189e+31],["square meter","m?",null,"area",true,true,1],["square mile","mi2",["mi^2"],"area",false,true,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",false,true,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",false,true,0.00001792111111111],["square yard","yd2",["yd^2"],"area",false,true,0.83612736],["statute mile","mi",null,"length",false,true,1609.344],["steradian","sr",null,"solid_angle",true,false,1],["stilb","sb",null,"luminance",false,false,0.0001],["stokes","St",null,"kinematic_viscosity",false,false,0.0001],["stone","stone",null,"mass",false,true,6.35029318],["tablespoon","tbs",null,"volume",false,true,0.0000147868],["teaspoon","tsp",null,"volume",false,true,0.00000492892],["tesla","T",null,"magnetic_flux_density",true,true,1],["thermodynamic calorie","c",null,"energy",false,true,4.184],["ton","ton",null,"mass",false,true,907.18474],["tonne","t",null,"mass",false,false,1000],["U.K. pint","uk_pt",null,"volume",false,true,0.00056826125],["U.S. bushel","bushel",null,"volume",false,true,0.03523907],["U.S. oil barrel","barrel",null,"volume",false,true,0.158987295],["U.S. pint","pt",["us_pt"],"volume",false,true,0.000473176473],["U.S. survey mile","survey_mi",null,"length",false,true,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",false,true,4046.87261],["volt","V",null,"voltage",true,false,1],["watt","W",null,"power",true,true,1],["watt-hour","Wh",["wh"],"energy",false,true,3600],["weber","Wb",null,"magnetic_flux",true,false,1],["yard","yd",null,"length",false,true,0.9144],["year","yr",null,"time",false,true,31557600]];var binary_prefixes={Yi:["yobi",80,1208925819614629174706176,"Yi","yotta"],Zi:["zebi",70,1180591620717411303424,"Zi","zetta"],Ei:["exbi",60,1152921504606846976,"Ei","exa"],Pi:["pebi",50,1125899906842624,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]};var unit_prefixes={Y:["yotta",1e+24,"Y"],Z:["zetta",1e+21,"Z"],E:["exa",1e+18,"E"],P:["peta",1e+15,"P"],T:["tera",1e+12,"T"],G:["giga",1e+09,"G"],M:["mega",1e+06,"M"],k:["kilo",1e+03,"k"],h:["hecto",1e+02,"h"],e:["dekao",1e+01,"e"],d:["deci",1e-01,"d"],c:["centi",1e-02,"c"],m:["milli",1e-03,"m"],u:["micro",1e-06,"u"],n:["nano",1e-09,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};var from=null;var to=null;var base_from_unit=from_unit;var base_to_unit=to_unit;var from_multiplier=1;var to_multiplier=1;var alt;for(var i=0;i<units.length;i++){alt=(units[i][2]===null)?[]:units[i][2];if(units[i][1]===base_from_unit||alt.indexOf(base_from_unit)>=0){from=units[i];}
if(units[i][1]===base_to_unit||alt.indexOf(base_to_unit)>=0){to=units[i];}}
if(from===null){var from_binary_prefix=binary_prefixes[from_unit.substring(0,2)];var from_unit_prefix=unit_prefixes[from_unit.substring(0,1)];if(from_unit.substring(0,2)==='da'){from_unit_prefix=["dekao",1e+01,"da"];}
if(from_binary_prefix){from_multiplier=from_binary_prefix[2];base_from_unit=from_unit.substring(2);}else if(from_unit_prefix){from_multiplier=from_unit_prefix[1];base_from_unit=from_unit.substring(from_unit_prefix[2].length);}
for(var j=0;j<units.length;j++){alt=(units[j][2]===null)?[]:units[j][2];if(units[j][1]===base_from_unit||alt.indexOf(base_from_unit)>=0){from=units[j];}}}
if(to===null){var to_binary_prefix=binary_prefixes[to_unit.substring(0,2)];var to_unit_prefix=unit_prefixes[to_unit.substring(0,1)];if(to_unit.substring(0,2)==='da'){to_unit_prefix=["dekao",1e+01,"da"];}
if(to_binary_prefix){to_multiplier=to_binary_prefix[2];base_to_unit=to_unit.substring(2);}else if(to_unit_prefix){to_multiplier=to_unit_prefix[1];base_to_unit=to_unit.substring(to_unit_prefix[2].length);}
for(var k=0;k<units.length;k++){alt=(units[k][2]===null)?[]:units[k][2];if(units[k][1]===base_to_unit||alt.indexOf(base_to_unit)>=0){to=units[k];}}}
if(from===null||to===null){return error.na;}
if(from[3]!==to[3]){return error.na;}
return number*from[6]*from_multiplier/(to[6]*to_multiplier);};exports.DEC2BIN=function(number,places){number=utils.parseNumber(number);if(number instanceof Error){return number;}
if(!/^-?[0-9]{1,3}$/.test(number)||number<-512||number>511){return error.num;}
if(number<0){return'1'+text.REPT('0',9-(512+number).toString(2).length)+(512+number).toString(2);}
var result=parseInt(number,10).toString(2);if(typeof places==='undefined'){return result;}else{if(isNaN(places)){return error.value;}
if(places<0){return error.num;}
places=Math.floor(places);return(places>=result.length)?text.REPT('0',places-result.length)+result:error.num;}};exports.DEC2HEX=function(number,places){number=utils.parseNumber(number);if(number instanceof Error){return number;}
if(!/^-?[0-9]{1,12}$/.test(number)||number<-549755813888||number>549755813887){return error.num;}
if(number<0){return(1099511627776+number).toString(16);}
var result=parseInt(number,10).toString(16);if(typeof places==='undefined'){return result;}else{if(isNaN(places)){return error.value;}
if(places<0){return error.num;}
places=Math.floor(places);return(places>=result.length)?text.REPT('0',places-result.length)+result:error.num;}};exports.DEC2OCT=function(number,places){number=utils.parseNumber(number);if(number instanceof Error){return number;}
if(!/^-?[0-9]{1,9}$/.test(number)||number<-536870912||number>536870911){return error.num;}
if(number<0){return(1073741824+number).toString(8);}
var result=parseInt(number,10).toString(8);if(typeof places==='undefined'){return result;}else{if(isNaN(places)){return error.value;}
if(places<0){return error.num;}
places=Math.floor(places);return(places>=result.length)?text.REPT('0',places-result.length)+result:error.num;}};exports.DELTA=function(number1,number2){number2=(number2===undefined)?0:number2;number1=utils.parseNumber(number1);number2=utils.parseNumber(number2);if(utils.anyIsError(number1,number2)){return error.value;}
return(number1===number2)?1:0;};exports.ERF=function(lower_bound,upper_bound){upper_bound=(upper_bound===undefined)?0:upper_bound;lower_bound=utils.parseNumber(lower_bound);upper_bound=utils.parseNumber(upper_bound);if(utils.anyIsError(lower_bound,upper_bound)){return error.value;}
return jStat.erf(lower_bound);};exports.ERF.PRECISE=function(){throw new Error('ERF.PRECISE is not implemented');};exports.ERFC=function(x){if(isNaN(x)){return error.value;}
return jStat.erfc(x);};exports.ERFC.PRECISE=function(){throw new Error('ERFC.PRECISE is not implemented');};exports.GESTEP=function(number,step){step=step||0;number=utils.parseNumber(number);if(utils.anyIsError(step,number)){return number;}
return(number>=step)?1:0;};exports.HEX2BIN=function(number,places){if(!/^[0-9A-Fa-f]{1,10}$/.test(number)){return error.num;}
var negative=(number.length===10&&number.substring(0,1).toLowerCase()==='f')?true:false;var decimal=(negative)?parseInt(number,16)-1099511627776:parseInt(number,16);if(decimal<-512||decimal>511){return error.num;}
if(negative){return'1'+text.REPT('0',9-(512+decimal).toString(2).length)+(512+decimal).toString(2);}
var result=decimal.toString(2);if(places===undefined){return result;}else{if(isNaN(places)){return error.value;}
if(places<0){return error.num;}
places=Math.floor(places);return(places>=result.length)?text.REPT('0',places-result.length)+result:error.num;}};exports.HEX2DEC=function(number){if(!/^[0-9A-Fa-f]{1,10}$/.test(number)){return error.num;}
var decimal=parseInt(number,16);return(decimal>=549755813888)?decimal-1099511627776:decimal;};exports.HEX2OCT=function(number,places){if(!/^[0-9A-Fa-f]{1,10}$/.test(number)){return error.num;}
var decimal=parseInt(number,16);if(decimal>536870911&&decimal<1098974756864){return error.num;}
if(decimal>=1098974756864){return(decimal-1098437885952).toString(8);}
var result=decimal.toString(8);if(places===undefined){return result;}else{if(isNaN(places)){return error.value;}
if(places<0){return error.num;}
places=Math.floor(places);return(places>=result.length)?text.REPT('0',places-result.length)+result:error.num;}};exports.IMABS=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
return Math.sqrt(Math.pow(x,2)+Math.pow(y,2));};exports.IMAGINARY=function(inumber){if(inumber===undefined||inumber===true||inumber===false){return error.value;}
if(inumber===0||inumber==='0'){return 0;}
if(['i','j'].indexOf(inumber)>=0){return 1;}
inumber=inumber.replace('+i','+1i').replace('-i','-1i').replace('+j','+1j').replace('-j','-1j');var plus=inumber.indexOf('+');var minus=inumber.indexOf('-');if(plus===0){plus=inumber.indexOf('+',1);}
if(minus===0){minus=inumber.indexOf('-',1);}
var last=inumber.substring(inumber.length-1,inumber.length);var unit=(last==='i'||last==='j');if(plus>=0||minus>=0){if(!unit){return error.num;}
if(plus>=0){return(isNaN(inumber.substring(0,plus))||isNaN(inumber.substring(plus+1,inumber.length-1)))?error.num:Number(inumber.substring(plus+1,inumber.length-1));}else{return(isNaN(inumber.substring(0,minus))||isNaN(inumber.substring(minus+1,inumber.length-1)))?error.num:-Number(inumber.substring(minus+1,inumber.length-1));}}else{if(unit){return(isNaN(inumber.substring(0,inumber.length-1)))?error.num:inumber.substring(0,inumber.length-1);}else{return(isNaN(inumber))?error.num:0;}}};exports.IMARGUMENT=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
if(x===0&&y===0){return error.div0;}
if(x===0&&y>0){return Math.PI/2;}
if(x===0&&y<0){return-Math.PI/2;}
if(y===0&&x>0){return 0;}
if(y===0&&x<0){return-Math.PI;}
if(x>0){return Math.atan(y/x);}else if(x<0&&y>=0){return Math.atan(y/x)+Math.PI;}else{return Math.atan(y/x)-Math.PI;}};exports.IMCONJUGATE=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';return(y!==0)?exports.COMPLEX(x,-y,unit):inumber;};exports.IMCOS=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';return exports.COMPLEX(Math.cos(x)*(Math.exp(y)+Math.exp(-y))/2,-Math.sin(x)*(Math.exp(y)-Math.exp(-y))/2,unit);};exports.IMCOSH=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';return exports.COMPLEX(Math.cos(y)*(Math.exp(x)+Math.exp(-x))/2,Math.sin(y)*(Math.exp(x)-Math.exp(-x))/2,unit);};exports.IMCOT=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
return exports.IMDIV(exports.IMCOS(inumber),exports.IMSIN(inumber));};exports.IMDIV=function(inumber1,inumber2){var a=exports.IMREAL(inumber1);var b=exports.IMAGINARY(inumber1);var c=exports.IMREAL(inumber2);var d=exports.IMAGINARY(inumber2);if(utils.anyIsError(a,b,c,d)){return error.value;}
var unit1=inumber1.substring(inumber1.length-1);var unit2=inumber2.substring(inumber2.length-1);var unit='i';if(unit1==='j'){unit='j';}else if(unit2==='j'){unit='j';}
if(c===0&&d===0){return error.num;}
var den=c*c+d*d;return exports.COMPLEX((a*c+b*d)/den,(b*c-a*d)/den,unit);};exports.IMEXP=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';var e=Math.exp(x);return exports.COMPLEX(e*Math.cos(y),e*Math.sin(y),unit);};exports.IMLN=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';return exports.COMPLEX(Math.log(Math.sqrt(x*x+y*y)),Math.atan(y/x),unit);};exports.IMLOG10=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';return exports.COMPLEX(Math.log(Math.sqrt(x*x+y*y))/Math.log(10),Math.atan(y/x)/Math.log(10),unit);};exports.IMLOG2=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';return exports.COMPLEX(Math.log(Math.sqrt(x*x+y*y))/Math.log(2),Math.atan(y/x)/Math.log(2),unit);};exports.IMPOWER=function(inumber,number){number=utils.parseNumber(number);var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(number,x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';var p=Math.pow(exports.IMABS(inumber),number);var t=exports.IMARGUMENT(inumber);return exports.COMPLEX(p*Math.cos(number*t),p*Math.sin(number*t),unit);};exports.IMPRODUCT=function(){var result=arguments[0];if(!arguments.length){return error.value;}
for(var i=1;i<arguments.length;i++){var a=exports.IMREAL(result);var b=exports.IMAGINARY(result);var c=exports.IMREAL(arguments[i]);var d=exports.IMAGINARY(arguments[i]);if(utils.anyIsError(a,b,c,d)){return error.value;}
result=exports.COMPLEX(a*c-b*d,a*d+b*c);}
return result;};exports.IMREAL=function(inumber){if(inumber===undefined||inumber===true||inumber===false){return error.value;}
if(inumber===0||inumber==='0'){return 0;}
if(['i','+i','1i','+1i','-i','-1i','j','+j','1j','+1j','-j','-1j'].indexOf(inumber)>=0){return 0;}
var plus=inumber.indexOf('+');var minus=inumber.indexOf('-');if(plus===0){plus=inumber.indexOf('+',1);}
if(minus===0){minus=inumber.indexOf('-',1);}
var last=inumber.substring(inumber.length-1,inumber.length);var unit=(last==='i'||last==='j');if(plus>=0||minus>=0){if(!unit){return error.num;}
if(plus>=0){return(isNaN(inumber.substring(0,plus))||isNaN(inumber.substring(plus+1,inumber.length-1)))?error.num:Number(inumber.substring(0,plus));}else{return(isNaN(inumber.substring(0,minus))||isNaN(inumber.substring(minus+1,inumber.length-1)))?error.num:Number(inumber.substring(0,minus));}}else{if(unit){return(isNaN(inumber.substring(0,inumber.length-1)))?error.num:0;}else{return(isNaN(inumber))?error.num:inumber;}}};exports.IMSEC=function(inumber){if(inumber===true||inumber===false){return error.value;}
var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
return exports.IMDIV('1',exports.IMCOS(inumber));};exports.IMSECH=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
return exports.IMDIV('1',exports.IMCOSH(inumber));};exports.IMSIN=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';return exports.COMPLEX(Math.sin(x)*(Math.exp(y)+Math.exp(-y))/2,Math.cos(x)*(Math.exp(y)-Math.exp(-y))/2,unit);};exports.IMSINH=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';return exports.COMPLEX(Math.cos(y)*(Math.exp(x)-Math.exp(-x))/2,Math.sin(y)*(Math.exp(x)+Math.exp(-x))/2,unit);};exports.IMSQRT=function(inumber){var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
var unit=inumber.substring(inumber.length-1);unit=(unit==='i'||unit==='j')?unit:'i';var s=Math.sqrt(exports.IMABS(inumber));var t=exports.IMARGUMENT(inumber);return exports.COMPLEX(s*Math.cos(t/2),s*Math.sin(t/2),unit);};exports.IMCSC=function(inumber){if(inumber===true||inumber===false){return error.value;}
var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.num;}
return exports.IMDIV('1',exports.IMSIN(inumber));};exports.IMCSCH=function(inumber){if(inumber===true||inumber===false){return error.value;}
var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.num;}
return exports.IMDIV('1',exports.IMSINH(inumber));};exports.IMSUB=function(inumber1,inumber2){var a=this.IMREAL(inumber1);var b=this.IMAGINARY(inumber1);var c=this.IMREAL(inumber2);var d=this.IMAGINARY(inumber2);if(utils.anyIsError(a,b,c,d)){return error.value;}
var unit1=inumber1.substring(inumber1.length-1);var unit2=inumber2.substring(inumber2.length-1);var unit='i';if(unit1==='j'){unit='j';}else if(unit2==='j'){unit='j';}
return this.COMPLEX(a-c,b-d,unit);};exports.IMSUM=function(){if(!arguments.length){return error.value;}
var args=utils.flatten(arguments);var result=args[0];for(var i=1;i<args.length;i++){var a=this.IMREAL(result);var b=this.IMAGINARY(result);var c=this.IMREAL(args[i]);var d=this.IMAGINARY(args[i]);if(utils.anyIsError(a,b,c,d)){return error.value;}
result=this.COMPLEX(a+c,b+d);}
return result;};exports.IMTAN=function(inumber){if(inumber===true||inumber===false){return error.value;}
var x=exports.IMREAL(inumber);var y=exports.IMAGINARY(inumber);if(utils.anyIsError(x,y)){return error.value;}
return this.IMDIV(this.IMSIN(inumber),this.IMCOS(inumber));};exports.OCT2BIN=function(number,places){if(!/^[0-7]{1,10}$/.test(number)){return error.num;}
var negative=(number.length===10&&number.substring(0,1)==='7')?true:false;var decimal=(negative)?parseInt(number,8)-1073741824:parseInt(number,8);if(decimal<-512||decimal>511){return error.num;}
if(negative){return'1'+text.REPT('0',9-(512+decimal).toString(2).length)+(512+decimal).toString(2);}
var result=decimal.toString(2);if(typeof places==='undefined'){return result;}else{if(isNaN(places)){return error.value;}
if(places<0){return error.num;}
places=Math.floor(places);return(places>=result.length)?text.REPT('0',places-result.length)+result:error.num;}};exports.OCT2DEC=function(number){if(!/^[0-7]{1,10}$/.test(number)){return error.num;}
var decimal=parseInt(number,8);return(decimal>=536870912)?decimal-1073741824:decimal;};exports.OCT2HEX=function(number,places){if(!/^[0-7]{1,10}$/.test(number)){return error.num;}
var decimal=parseInt(number,8);if(decimal>=536870912){return'ff'+(decimal+3221225472).toString(16);}
var result=decimal.toString(16);if(places===undefined){return result;}else{if(isNaN(places)){return error.value;}
if(places<0){return error.num;}
places=Math.floor(places);return(places>=result.length)?text.REPT('0',places-result.length)+result:error.num;}};},function(module,exports,__webpack_require__){var M=Math;function _horner(arr,v){return arr.reduce(function(z,w){return v*z+w;},0);};function _bessel_iter(x,n,f0,f1,sign){if(!sign)sign=-1;var tdx=2/x,f2;if(n===0)return f0;if(n===1)return f1;for(var o=1;o!=n;++o){f2=f1*o*tdx+sign*f0;f0=f1;f1=f2;}
return f1;}
function _bessel_wrap(bessel0,bessel1,name,nonzero,sign){return function bessel(x,n){if(n===0)return bessel0(x);if(n===1)return bessel1(x);if(n<0)throw name+': Order ('+n+') must be nonnegative';if(nonzero==1&&x===0)throw name+': Undefined when x == 0';if(nonzero==2&&x<=0)throw name+': Undefined when x <= 0';var b0=bessel0(x),b1=bessel1(x);return _bessel_iter(x,n,b0,b1,sign);};}
var besselj=(function(){var b0_a1a=[57568490574.0,-13362590354.0,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse();var b0_a2a=[57568490411.0,1029532985.0,9494680.718,59272.64853,267.8532712,1.0].reverse();var b0_a1b=[1.0,-0.1098628627e-2,0.2734510407e-4,-0.2073370639e-5,0.2093887211e-6].reverse();var b0_a2b=[-0.1562499995e-1,0.1430488765e-3,-0.6911147651e-5,0.7621095161e-6,-0.934935152e-7].reverse();var W=0.636619772;function bessel0(x){var a,a1,a2,y=x*x,xx=M.abs(x)-0.785398164;if(M.abs(x)<8){a1=_horner(b0_a1a,y);a2=_horner(b0_a2a,y);a=a1/a2;}
else{y=64/y;a1=_horner(b0_a1b,y);a2=_horner(b0_a2b,y);a=M.sqrt(W/M.abs(x))*(M.cos(xx)*a1-M.sin(xx)*a2*8/M.abs(x));}
return a;}
var b1_a1a=[72362614232.0,-7895059235.0,242396853.1,-2972611.439,15704.48260,-30.16036606].reverse();var b1_a2a=[144725228442.0,2300535178.0,18583304.74,99447.43394,376.9991397,1.0].reverse();var b1_a1b=[1.0,0.183105e-2,-0.3516396496e-4,0.2457520174e-5,-0.240337019e-6].reverse();var b1_a2b=[0.04687499995,-0.2002690873e-3,0.8449199096e-5,-0.88228987e-6,0.105787412e-6].reverse();function bessel1(x){var a,a1,a2,y=x*x,xx=M.abs(x)-2.356194491;if(Math.abs(x)<8){a1=x*_horner(b1_a1a,y);a2=_horner(b1_a2a,y);a=a1/a2;}else{y=64/y;a1=_horner(b1_a1b,y);a2=_horner(b1_a2b,y);a=M.sqrt(W/M.abs(x))*(M.cos(xx)*a1-M.sin(xx)*a2*8/M.abs(x));if(x<0)a=-a;}
return a;}
return function besselj(x,n){n=Math.round(n);if(n===0)return bessel0(M.abs(x));if(n===1)return bessel1(M.abs(x));if(n<0)throw'BESSELJ: Order ('+n+') must be nonnegative';if(M.abs(x)===0)return 0;var ret,j,tox=2/M.abs(x),m,jsum,sum,bjp,bj,bjm;if(M.abs(x)>n){ret=_bessel_iter(x,n,bessel0(M.abs(x)),bessel1(M.abs(x)),-1);}else{m=2*M.floor((n+M.floor(M.sqrt(40*n)))/2);jsum=0;bjp=ret=sum=0.0;bj=1.0;for(j=m;j>0;j--){bjm=j*tox*bj-bjp;bjp=bj;bj=bjm;if(M.abs(bj)>1E10){bj*=1E-10;bjp*=1E-10;ret*=1E-10;sum*=1E-10;}
if(jsum)sum+=bj;jsum=!jsum;if(j==n)ret=bjp;}
sum=2.0*sum-bj;ret/=sum;}
return x<0&&(n%2)?-ret:ret;};})();var bessely=(function(){var b0_a1a=[-2957821389.0,7062834065.0,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse();var b0_a2a=[40076544269.0,745249964.8,7189466.438,47447.26470,226.1030244,1.0].reverse();var b0_a1b=[1.0,-0.1098628627e-2,0.2734510407e-4,-0.2073370639e-5,0.2093887211e-6].reverse();var b0_a2b=[-0.1562499995e-1,0.1430488765e-3,-0.6911147651e-5,0.7621095161e-6,-0.934945152e-7].reverse();var W=0.636619772;function bessel0(x){var a,a1,a2,y=x*x,xx=x-0.785398164;if(x<8){a1=_horner(b0_a1a,y);a2=_horner(b0_a2a,y);a=a1/a2+W*besselj(x,0)*M.log(x);}else{y=64/y;a1=_horner(b0_a1b,y);a2=_horner(b0_a2b,y);a=M.sqrt(W/x)*(M.sin(xx)*a1+M.cos(xx)*a2*8/x);}
return a;}
var b1_a1a=[-0.4900604943e13,0.1275274390e13,-0.5153438139e11,0.7349264551e9,-0.4237922726e7,0.8511937935e4].reverse();var b1_a2a=[0.2499580570e14,0.4244419664e12,0.3733650367e10,0.2245904002e8,0.1020426050e6,0.3549632885e3,1].reverse();var b1_a1b=[1.0,0.183105e-2,-0.3516396496e-4,0.2457520174e-5,-0.240337019e-6].reverse();var b1_a2b=[0.04687499995,-0.2002690873e-3,0.8449199096e-5,-0.88228987e-6,0.105787412e-6].reverse();function bessel1(x){var a,a1,a2,y=x*x,xx=x-2.356194491;if(x<8){a1=x*_horner(b1_a1a,y);a2=_horner(b1_a2a,y);a=a1/a2+W*(besselj(x,1)*M.log(x)-1/x);}else{y=64/y;a1=_horner(b1_a1b,y);a2=_horner(b1_a2b,y);a=M.sqrt(W/x)*(M.sin(xx)*a1+M.cos(xx)*a2*8/x);}
return a;}
return _bessel_wrap(bessel0,bessel1,'BESSELY',1,-1);})();var besseli=(function(){var b0_a=[1.0,3.5156229,3.0899424,1.2067492,0.2659732,0.360768e-1,0.45813e-2].reverse();var b0_b=[0.39894228,0.1328592e-1,0.225319e-2,-0.157565e-2,0.916281e-2,-0.2057706e-1,0.2635537e-1,-0.1647633e-1,0.392377e-2].reverse();function bessel0(x){if(x<=3.75)return _horner(b0_a,x*x/(3.75*3.75));return M.exp(M.abs(x))/M.sqrt(M.abs(x))*_horner(b0_b,3.75/M.abs(x));}
var b1_a=[0.5,0.87890594,0.51498869,0.15084934,0.2658733e-1,0.301532e-2,0.32411e-3].reverse();var b1_b=[0.39894228,-0.3988024e-1,-0.362018e-2,0.163801e-2,-0.1031555e-1,0.2282967e-1,-0.2895312e-1,0.1787654e-1,-0.420059e-2].reverse();function bessel1(x){if(x<3.75)return x*_horner(b1_a,x*x/(3.75*3.75));return(x<0?-1:1)*M.exp(M.abs(x))/M.sqrt(M.abs(x))*_horner(b1_b,3.75/M.abs(x));}
return function besseli(x,n){n=Math.round(n);if(n===0)return bessel0(x);if(n==1)return bessel1(x);if(n<0)throw'BESSELI Order ('+n+') must be nonnegative';if(M.abs(x)===0)return 0;var ret,j,tox=2/M.abs(x),m,bip,bi,bim;m=2*M.round((n+M.round(M.sqrt(40*n)))/2);bip=ret=0.0;bi=1.0;for(j=m;j>0;j--){bim=j*tox*bi+bip;bip=bi;bi=bim;if(M.abs(bi)>1E10){bi*=1E-10;bip*=1E-10;ret*=1E-10;}
if(j==n)ret=bip;}
ret*=besseli(x,0)/bi;return x<0&&(n%2)?-ret:ret;};})();var besselk=(function(){var b0_a=[-0.57721566,0.42278420,0.23069756,0.3488590e-1,0.262698e-2,0.10750e-3,0.74e-5].reverse();var b0_b=[1.25331414,-0.7832358e-1,0.2189568e-1,-0.1062446e-1,0.587872e-2,-0.251540e-2,0.53208e-3].reverse();function bessel0(x){if(x<=2)return-M.log(x/2)*besseli(x,0)+_horner(b0_a,x*x/4);return M.exp(-x)/M.sqrt(x)*_horner(b0_b,2/x);}
var b1_a=[1.0,0.15443144,-0.67278579,-0.18156897,-0.1919402e-1,-0.110404e-2,-0.4686e-4].reverse();var b1_b=[1.25331414,0.23498619,-0.3655620e-1,0.1504268e-1,-0.780353e-2,0.325614e-2,-0.68245e-3].reverse();function bessel1(x){if(x<=2)return M.log(x/2)*besseli(x,1)+(1/x)*_horner(b1_a,x*x/4);return M.exp(-x)/M.sqrt(x)*_horner(b1_b,2/x);}
return _bessel_wrap(bessel0,bessel1,'BESSELK',2,1);})();if(true){exports.besselj=besselj;exports.bessely=bessely;exports.besseli=besseli;exports.besselk=besselk;}},function(module,exports,__webpack_require__){var error=__webpack_require__(16);var utils=__webpack_require__(15);var d1900=new Date(1900,0,1);var WEEK_STARTS=[undefined,0,1,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,1,2,3,4,5,6,0];var WEEK_TYPES=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];var WEEKEND_TYPES=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],undefined,undefined,undefined,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];exports.DATE=function(year,month,day){var result;year=utils.parseNumber(year);month=utils.parseNumber(month);day=utils.parseNumber(day);if(utils.anyIsError(year,month,day)){result=error.value;}else if(year<0||month<0||day<0){result=error.num;}else{result=new Date(year,month-1,day);}
return result;};exports.DATEVALUE=function(date_text){if(typeof date_text!=='string'){return error.value;}
var date=Date.parse(date_text);if(isNaN(date)){return error.value;}
if(date<=-2203891200000){return(date-d1900)/86400000+1;}
return(date-d1900)/86400000+2;};exports.DAY=function(serial_number){var date=utils.parseDate(serial_number);if(date instanceof Error){return date;}
return date.getDate();};exports.DAYS=function(end_date,start_date){end_date=utils.parseDate(end_date);start_date=utils.parseDate(start_date);if(end_date instanceof Error){return end_date;}
if(start_date instanceof Error){return start_date;}
return serial(end_date)-serial(start_date);};exports.DAYS360=function(start_date,end_date,method){method=utils.parseBool(method);start_date=utils.parseDate(start_date);end_date=utils.parseDate(end_date);if(start_date instanceof Error){return start_date;}
if(end_date instanceof Error){return end_date;}
if(method instanceof Error){return method;}
var sm=start_date.getMonth();var em=end_date.getMonth();var sd,ed;if(method){sd=start_date.getDate()===31?30:start_date.getDate();ed=end_date.getDate()===31?30:end_date.getDate();}else{var smd=new Date(start_date.getFullYear(),sm+1,0).getDate();var emd=new Date(end_date.getFullYear(),em+1,0).getDate();sd=start_date.getDate()===smd?30:start_date.getDate();if(end_date.getDate()===emd){if(sd<30){em++;ed=1;}else{ed=30;}}else{ed=end_date.getDate();}}
return 360*(end_date.getFullYear()-start_date.getFullYear())+
30*(em-sm)+(ed-sd);};exports.EDATE=function(start_date,months){start_date=utils.parseDate(start_date);if(start_date instanceof Error){return start_date;}
if(isNaN(months)){return error.value;}
months=parseInt(months,10);start_date.setMonth(start_date.getMonth()+months);return serial(start_date);};exports.EOMONTH=function(start_date,months){start_date=utils.parseDate(start_date);if(start_date instanceof Error){return start_date;}
if(isNaN(months)){return error.value;}
months=parseInt(months,10);return serial(new Date(start_date.getFullYear(),start_date.getMonth()+months+1,0));};exports.HOUR=function(serial_number){serial_number=utils.parseDate(serial_number);if(serial_number instanceof Error){return serial_number;}
return serial_number.getHours();};exports.INTERVAL=function(second){if(typeof second!=='number'&&typeof second!=='string'){return error.value;}else{second=parseInt(second,10);}
var year=Math.floor(second/946080000);second=second%946080000;var month=Math.floor(second/2592000);second=second%2592000;var day=Math.floor(second/86400);second=second%86400;var hour=Math.floor(second/3600);second=second%3600;var min=Math.floor(second/60);second=second%60;var sec=second;year=(year>0)?year+'Y':'';month=(month>0)?month+'M':'';day=(day>0)?day+'D':'';hour=(hour>0)?hour+'H':'';min=(min>0)?min+'M':'';sec=(sec>0)?sec+'S':'';return'P'+year+month+day+'T'+hour+min+sec;};exports.ISOWEEKNUM=function(date){date=utils.parseDate(date);if(date instanceof Error){return date;}
date.setHours(0,0,0);date.setDate(date.getDate()+4-(date.getDay()||7));var yearStart=new Date(date.getFullYear(),0,1);return Math.ceil((((date-yearStart)/86400000)+1)/7);};exports.MINUTE=function(serial_number){serial_number=utils.parseDate(serial_number);if(serial_number instanceof Error){return serial_number;}
return serial_number.getMinutes();};exports.MONTH=function(serial_number){serial_number=utils.parseDate(serial_number);if(serial_number instanceof Error){return serial_number;}
return serial_number.getMonth()+1;};exports.NETWORKDAYS=function(start_date,end_date,holidays){return this.NETWORKDAYS.INTL(start_date,end_date,1,holidays);};exports.NETWORKDAYS.INTL=function(start_date,end_date,weekend,holidays){start_date=utils.parseDate(start_date);if(start_date instanceof Error){return start_date;}
end_date=utils.parseDate(end_date);if(end_date instanceof Error){return end_date;}
if(weekend===undefined){weekend=WEEKEND_TYPES[1];}else{weekend=WEEKEND_TYPES[weekend];}
if(!(weekend instanceof Array)){return error.value;}
if(holidays===undefined){holidays=[];}else if(!(holidays instanceof Array)){holidays=[holidays];}
for(var i=0;i<holidays.length;i++){var h=utils.parseDate(holidays[i]);if(h instanceof Error){return h;}
holidays[i]=h;}
var days=(end_date-start_date)/(1000*60*60*24)+1;var total=days;var day=start_date;for(i=0;i<days;i++){var d=(new Date().getTimezoneOffset()>0)?day.getUTCDay():day.getDay();var dec=false;if(d===weekend[0]||d===weekend[1]){dec=true;}
for(var j=0;j<holidays.length;j++){var holiday=holidays[j];if(holiday.getDate()===day.getDate()&&holiday.getMonth()===day.getMonth()&&holiday.getFullYear()===day.getFullYear()){dec=true;break;}}
if(dec){total--;}
day.setDate(day.getDate()+1);}
return total;};exports.NOW=function(){return new Date();};exports.SECOND=function(serial_number){serial_number=utils.parseDate(serial_number);if(serial_number instanceof Error){return serial_number;}
return serial_number.getSeconds();};exports.TIME=function(hour,minute,second){hour=utils.parseNumber(hour);minute=utils.parseNumber(minute);second=utils.parseNumber(second);if(utils.anyIsError(hour,minute,second)){return error.value;}
if(hour<0||minute<0||second<0){return error.num;}
return(3600*hour+60*minute+second)/86400;};exports.TIMEVALUE=function(time_text){time_text=utils.parseDate(time_text);if(time_text instanceof Error){return time_text;}
return(3600*time_text.getHours()+60*time_text.getMinutes()+time_text.getSeconds())/86400;};exports.TODAY=function(){return new Date();};exports.WEEKDAY=function(serial_number,return_type){serial_number=utils.parseDate(serial_number);if(serial_number instanceof Error){return serial_number;}
if(return_type===undefined){return_type=1;}
var day=serial_number.getDay();return WEEK_TYPES[return_type][day];};exports.WEEKNUM=function(serial_number,return_type){serial_number=utils.parseDate(serial_number);if(serial_number instanceof Error){return serial_number;}
if(return_type===undefined){return_type=1;}
if(return_type===21){return this.ISOWEEKNUM(serial_number);}
var week_start=WEEK_STARTS[return_type];var jan=new Date(serial_number.getFullYear(),0,1);var inc=jan.getDay()<week_start?1:0;jan-=Math.abs(jan.getDay()-week_start)*24*60*60*1000;return Math.floor(((serial_number-jan)/(1000*60*60*24))/7+1)+inc;};exports.WORKDAY=function(start_date,days,holidays){return this.WORKDAY.INTL(start_date,days,1,holidays);};exports.WORKDAY.INTL=function(start_date,days,weekend,holidays){start_date=utils.parseDate(start_date);if(start_date instanceof Error){return start_date;}
days=utils.parseNumber(days);if(days instanceof Error){return days;}
if(days<0){return error.num;}
if(weekend===undefined){weekend=WEEKEND_TYPES[1];}else{weekend=WEEKEND_TYPES[weekend];}
if(!(weekend instanceof Array)){return error.value;}
if(holidays===undefined){holidays=[];}else if(!(holidays instanceof Array)){holidays=[holidays];}
for(var i=0;i<holidays.length;i++){var h=utils.parseDate(holidays[i]);if(h instanceof Error){return h;}
holidays[i]=h;}
var d=0;while(d<days){start_date.setDate(start_date.getDate()+1);var day=start_date.getDay();if(day===weekend[0]||day===weekend[1]){continue;}
for(var j=0;j<holidays.length;j++){var holiday=holidays[j];if(holiday.getDate()===start_date.getDate()&&holiday.getMonth()===start_date.getMonth()&&holiday.getFullYear()===start_date.getFullYear()){d--;break;}}
d++;}
return start_date;};exports.YEAR=function(serial_number){serial_number=utils.parseDate(serial_number);if(serial_number instanceof Error){return serial_number;}
return serial_number.getFullYear();};function isLeapYear(year){return new Date(year,1,29).getMonth()===1;}
function daysBetween(start_date,end_date){return Math.ceil((end_date-start_date)/1000/60/60/24);}
exports.YEARFRAC=function(start_date,end_date,basis){start_date=utils.parseDate(start_date);if(start_date instanceof Error){return start_date;}
end_date=utils.parseDate(end_date);if(end_date instanceof Error){return end_date;}
basis=basis||0;var sd=start_date.getDate();var sm=start_date.getMonth()+1;var sy=start_date.getFullYear();var ed=end_date.getDate();var em=end_date.getMonth()+1;var ey=end_date.getFullYear();switch(basis){case 0:if(sd===31&&ed===31){sd=30;ed=30;}else if(sd===31){sd=30;}else if(sd===30&&ed===31){ed=30;}
return((ed+em*30+ey*360)-(sd+sm*30+sy*360))/360;case 1:var feb29Between=function(date1,date2){var year1=date1.getFullYear();var mar1year1=new Date(year1,2,1);if(isLeapYear(year1)&&date1<mar1year1&&date2>=mar1year1){return true;}
var year2=date2.getFullYear();var mar1year2=new Date(year2,2,1);return(isLeapYear(year2)&&date2>=mar1year2&&date1<mar1year2);};var ylength=365;if(sy===ey||((sy+1)===ey)&&((sm>em)||((sm===em)&&(sd>=ed)))){if((sy===ey&&isLeapYear(sy))||feb29Between(start_date,end_date)||(em===1&&ed===29)){ylength=366;}
return daysBetween(start_date,end_date)/ylength;}
var years=(ey-sy)+1;var days=(new Date(ey+1,0,1)-new Date(sy,0,1))/1000/60/60/24;var average=days/years;return daysBetween(start_date,end_date)/average;case 2:return daysBetween(start_date,end_date)/360;case 3:return daysBetween(start_date,end_date)/365;case 4:return((ed+em*30+ey*360)-(sd+sm*30+sy*360))/360;}};function serial(date){var addOn=(date>-2203891200000)?2:1;return(date-d1900)/86400000+addOn;}},function(module,exports,__webpack_require__){var error=__webpack_require__(16);var stats=__webpack_require__(17);var maths=__webpack_require__(14);var utils=__webpack_require__(15);function compact(array){var result=[];utils.arrayEach(array,function(value){if(value){result.push(value);}});return result;}
exports.FINDFIELD=function(database,title){var index=null;utils.arrayEach(database,function(value,i){if(value[0]===title){index=i;return false;}});if(index==null){return error.value;}
return index;};function findResultIndex(database,criterias){var matches={};for(var i=1;i<database[0].length;++i){matches[i]=true;}
var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i){if(criterias[i].length>maxCriteriaLength){maxCriteriaLength=criterias[i].length;}}
for(var k=1;k<database.length;++k){for(var l=1;l<database[k].length;++l){var currentCriteriaResult=false;var hasMatchingCriteria=false;for(var j=0;j<criterias.length;++j){var criteria=criterias[j];if(criteria.length<maxCriteriaLength){continue;}
var criteriaField=criteria[0];if(database[k][0]!==criteriaField){continue;}
hasMatchingCriteria=true;for(var p=1;p<criteria.length;++p){currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p]);}}
if(hasMatchingCriteria){matches[l]=matches[l]&&currentCriteriaResult;}}}
var result=[];for(var n=0;n<database[0].length;++n){if(matches[n]){result.push(n-1);}}
return result;}
exports.DAVERAGE=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var sum=0;utils.arrayEach(resultIndexes,function(value){sum+=targetFields[value];});return resultIndexes.length===0?error.div0:sum/resultIndexes.length;};exports.DCOUNT=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var targetValues=[];utils.arrayEach(resultIndexes,function(value){targetValues.push(targetFields[value]);});return stats.COUNT(targetValues);};exports.DCOUNTA=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var targetValues=[];utils.arrayEach(resultIndexes,function(value){targetValues.push(targetFields[value]);});return stats.COUNTA(targetValues);};exports.DGET=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
if(resultIndexes.length===0){return error.value;}
if(resultIndexes.length>1){return error.num;}
return targetFields[resultIndexes[0]];};exports.DMAX=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var maxValue=targetFields[resultIndexes[0]];utils.arrayEach(resultIndexes,function(value){if(maxValue<targetFields[value]){maxValue=targetFields[value];}});return maxValue;};exports.DMIN=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var minValue=targetFields[resultIndexes[0]];utils.arrayEach(resultIndexes,function(value){if(minValue>targetFields[value]){minValue=targetFields[value];}});return minValue;};exports.DPRODUCT=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var targetValues=[];utils.arrayEach(resultIndexes,function(value){targetValues.push(targetFields[value]);});targetValues=compact(targetValues);var result=1;utils.arrayEach(targetValues,function(value){result*=value;});return result;};exports.DSTDEV=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var targetValues=[];utils.arrayEach(resultIndexes,function(value){targetValues.push(targetFields[value]);});targetValues=compact(targetValues);return stats.STDEV.S(targetValues);};exports.DSTDEVP=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var targetValues=[];utils.arrayEach(resultIndexes,function(value){targetValues.push(targetFields[value]);});targetValues=compact(targetValues);return stats.STDEV.P(targetValues);};exports.DSUM=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var targetValues=[];utils.arrayEach(resultIndexes,function(value){targetValues.push(targetFields[value]);});return maths.SUM(targetValues);};exports.DVAR=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var targetValues=[];utils.arrayEach(resultIndexes,function(value){targetValues.push(targetFields[value]);});return stats.VAR.S(targetValues);};exports.DVARP=function(database,field,criteria){if(isNaN(field)&&(typeof field!=="string")){return error.value;}
var resultIndexes=findResultIndex(database,criteria);var targetFields=[];if(typeof field==="string"){var index=exports.FINDFIELD(database,field);targetFields=utils.rest(database[index]);}else{targetFields=utils.rest(database[field]);}
var targetValues=[];utils.arrayEach(resultIndexes,function(value){targetValues.push(targetFields[value]);});return stats.VAR.P(targetValues);};},function(module,exports,__webpack_require__){var error=__webpack_require__(16);var utils=__webpack_require__(15);var information=__webpack_require__(24);exports.AND=function(){var args=utils.flatten(arguments);var result=true;for(var i=0;i<args.length;i++){if(!args[i]){result=false;}}
return result;};exports.CHOOSE=function(){if(arguments.length<2){return error.na;}
var index=arguments[0];if(index<1||index>254){return error.value;}
if(arguments.length<index+1){return error.value;}
return arguments[index];};exports.FALSE=function(){return false;};exports.IF=function(test,then_value,otherwise_value){return test?then_value:otherwise_value;};exports.IFERROR=function(value,valueIfError){if(information.ISERROR(value)){return valueIfError;}
return value;};exports.IFNA=function(value,value_if_na){return value===error.na?value_if_na:value;};exports.NOT=function(logical){return!logical;};exports.OR=function(){var args=utils.flatten(arguments);var result=false;for(var i=0;i<args.length;i++){if(args[i]){result=true;}}
return result;};exports.TRUE=function(){return true;};exports.XOR=function(){var args=utils.flatten(arguments);var result=0;for(var i=0;i<args.length;i++){if(args[i]){result++;}}
return(Math.floor(Math.abs(result))&1)?true:false;};exports.SWITCH=function(){var result;if(arguments.length>0){var targetValue=arguments[0];var argc=arguments.length-1;var switchCount=Math.floor(argc/2);var switchSatisfied=false;var hasDefaultClause=argc%2!==0;var defaultClause=argc%2===0?null:arguments[arguments.length-1];if(switchCount){for(var index=0;index<switchCount;index++){if(targetValue===arguments[index*2+1]){result=arguments[index*2+2];switchSatisfied=true;break;}}}
if(!switchSatisfied){result=hasDefaultClause?defaultClause:error.na;}}else{result=error.value;}
return result;};},function(module,exports,__webpack_require__){var error=__webpack_require__(16);var dateTime=__webpack_require__(27);var utils=__webpack_require__(15);function validDate(d){return d&&d.getTime&&!isNaN(d.getTime());}
function ensureDate(d){return(d instanceof Date)?d:new Date(d);}
exports.ACCRINT=function(issue,first,settlement,rate,par,frequency,basis){issue=ensureDate(issue);first=ensureDate(first);settlement=ensureDate(settlement);if(!validDate(issue)||!validDate(first)||!validDate(settlement)){return error.value;}
if(rate<=0||par<=0){return error.num}
if([1,2,4].indexOf(frequency)===-1){return error.num;}
if([0,1,2,3,4].indexOf(basis)===-1){return error.num;}
if(settlement<=issue){return error.num;}
par=par||0;basis=basis||0;return par*rate*dateTime.YEARFRAC(issue,settlement,basis);};exports.ACCRINTM=function(){throw new Error('ACCRINTM is not implemented');};exports.AMORDEGRC=function(){throw new Error('AMORDEGRC is not implemented');};exports.AMORLINC=function(){throw new Error('AMORLINC is not implemented');};exports.COUPDAYBS=function(){throw new Error('COUPDAYBS is not implemented');};exports.COUPDAYS=function(){throw new Error('COUPDAYS is not implemented');};exports.COUPDAYSNC=function(){throw new Error('COUPDAYSNC is not implemented');};exports.COUPNCD=function(){throw new Error('COUPNCD is not implemented');};exports.COUPNUM=function(){throw new Error('COUPNUM is not implemented');};exports.COUPPCD=function(){throw new Error('COUPPCD is not implemented');};exports.CUMIPMT=function(rate,periods,value,start,end,type){rate=utils.parseNumber(rate);periods=utils.parseNumber(periods);value=utils.parseNumber(value);if(utils.anyIsError(rate,periods,value)){return error.value;}
if(rate<=0||periods<=0||value<=0){return error.num;}
if(start<1||end<1||start>end){return error.num;}
if(type!==0&&type!==1){return error.num;}
var payment=exports.PMT(rate,periods,value,0,type);var interest=0;if(start===1){if(type===0){interest=-value;start++;}}
for(var i=start;i<=end;i++){if(type===1){interest+=exports.FV(rate,i-2,payment,value,1)-payment;}else{interest+=exports.FV(rate,i-1,payment,value,0);}}
interest*=rate;return interest;};exports.CUMPRINC=function(rate,periods,value,start,end,type){rate=utils.parseNumber(rate);periods=utils.parseNumber(periods);value=utils.parseNumber(value);if(utils.anyIsError(rate,periods,value)){return error.value;}
if(rate<=0||periods<=0||value<=0){return error.num;}
if(start<1||end<1||start>end){return error.num;}
if(type!==0&&type!==1){return error.num;}
var payment=exports.PMT(rate,periods,value,0,type);var principal=0;if(start===1){if(type===0){principal=payment+value*rate;}else{principal=payment;}
start++;}
for(var i=start;i<=end;i++){if(type>0){principal+=payment-(exports.FV(rate,i-2,payment,value,1)-payment)*rate;}else{principal+=payment-exports.FV(rate,i-1,payment,value,0)*rate;}}
return principal;};exports.DB=function(cost,salvage,life,period,month){month=(month===undefined)?12:month;cost=utils.parseNumber(cost);salvage=utils.parseNumber(salvage);life=utils.parseNumber(life);period=utils.parseNumber(period);month=utils.parseNumber(month);if(utils.anyIsError(cost,salvage,life,period,month)){return error.value;}
if(cost<0||salvage<0||life<0||period<0){return error.num;}
if([1,2,3,4,5,6,7,8,9,10,11,12].indexOf(month)===-1){return error.num;}
if(period>life){return error.num;}
if(salvage>=cost){return 0;}
var rate=(1-Math.pow(salvage/cost,1/life)).toFixed(3);var initial=cost*rate*month/12;var total=initial;var current=0;var ceiling=(period===life)?life-1:period;for(var i=2;i<=ceiling;i++){current=(cost-total)*rate;total+=current;}
if(period===1){return initial;}else if(period===life){return(cost-total)*rate;}else{return current;}};exports.DDB=function(cost,salvage,life,period,factor){factor=(factor===undefined)?2:factor;cost=utils.parseNumber(cost);salvage=utils.parseNumber(salvage);life=utils.parseNumber(life);period=utils.parseNumber(period);factor=utils.parseNumber(factor);if(utils.anyIsError(cost,salvage,life,period,factor)){return error.value;}
if(cost<0||salvage<0||life<0||period<0||factor<=0){return error.num;}
if(period>life){return error.num;}
if(salvage>=cost){return 0;}
var total=0;var current=0;for(var i=1;i<=period;i++){current=Math.min((cost-total)*(factor/life),(cost-salvage-total));total+=current;}
return current;};exports.DISC=function(){throw new Error('DISC is not implemented');};exports.DOLLARDE=function(dollar,fraction){dollar=utils.parseNumber(dollar);fraction=utils.parseNumber(fraction);if(utils.anyIsError(dollar,fraction)){return error.value;}
if(fraction<0){return error.num;}
if(fraction>=0&&fraction<1){return error.div0;}
fraction=parseInt(fraction,10);var result=parseInt(dollar,10);result+=(dollar%1)*Math.pow(10,Math.ceil(Math.log(fraction)/Math.LN10))/fraction;var power=Math.pow(10,Math.ceil(Math.log(fraction)/Math.LN2)+1);result=Math.round(result*power)/power;return result;};exports.DOLLARFR=function(dollar,fraction){dollar=utils.parseNumber(dollar);fraction=utils.parseNumber(fraction);if(utils.anyIsError(dollar,fraction)){return error.value;}
if(fraction<0){return error.num;}
if(fraction>=0&&fraction<1){return error.div0;}
fraction=parseInt(fraction,10);var result=parseInt(dollar,10);result+=(dollar%1)*Math.pow(10,-Math.ceil(Math.log(fraction)/Math.LN10))*fraction;return result;};exports.DURATION=function(){throw new Error('DURATION is not implemented');};exports.EFFECT=function(rate,periods){rate=utils.parseNumber(rate);periods=utils.parseNumber(periods);if(utils.anyIsError(rate,periods)){return error.value;}
if(rate<=0||periods<1){return error.num;}
periods=parseInt(periods,10);return Math.pow(1+rate/periods,periods)-1;};exports.FV=function(rate,periods,payment,value,type){value=value||0;type=type||0;rate=utils.parseNumber(rate);periods=utils.parseNumber(periods);payment=utils.parseNumber(payment);value=utils.parseNumber(value);type=utils.parseNumber(type);if(utils.anyIsError(rate,periods,payment,value,type)){return error.value;}
var result;if(rate===0){result=value+payment*periods;}else{var term=Math.pow(1+rate,periods);if(type===1){result=value*term+payment*(1+rate)*(term-1)/rate;}else{result=value*term+payment*(term-1)/rate;}}
return-result;};exports.FVSCHEDULE=function(principal,schedule){principal=utils.parseNumber(principal);schedule=utils.parseNumberArray(utils.flatten(schedule));if(utils.anyIsError(principal,schedule)){return error.value;}
var n=schedule.length;var future=principal;for(var i=0;i<n;i++){future*=1+schedule[i];}
return future;};exports.INTRATE=function(){throw new Error('INTRATE is not implemented');};exports.IPMT=function(rate,period,periods,present,future,type){future=future||0;type=type||0;rate=utils.parseNumber(rate);period=utils.parseNumber(period);periods=utils.parseNumber(periods);present=utils.parseNumber(present);future=utils.parseNumber(future);type=utils.parseNumber(type);if(utils.anyIsError(rate,period,periods,present,future,type)){return error.value;}
var payment=exports.PMT(rate,periods,present,future,type);var interest;if(period===1){if(type===1){interest=0;}else{interest=-present;}}else{if(type===1){interest=exports.FV(rate,period-2,payment,present,1)-payment;}else{interest=exports.FV(rate,period-1,payment,present,0);}}
return interest*rate;};exports.IRR=function(values,guess){guess=guess||0;values=utils.parseNumberArray(utils.flatten(values));guess=utils.parseNumber(guess);if(utils.anyIsError(values,guess)){return error.value;}
var irrResult=function(values,dates,rate){var r=rate+1;var result=values[0];for(var i=1;i<values.length;i++){result+=values[i]/Math.pow(r,(dates[i]-dates[0])/365);}
return result;};var irrResultDeriv=function(values,dates,rate){var r=rate+1;var result=0;for(var i=1;i<values.length;i++){var frac=(dates[i]-dates[0])/365;result-=frac*values[i]/Math.pow(r,frac+1);}
return result;};var dates=[];var positive=false;var negative=false;for(var i=0;i<values.length;i++){dates[i]=(i===0)?0:dates[i-1]+365;if(values[i]>0){positive=true;}
if(values[i]<0){negative=true;}}
if(!positive||!negative){return error.num;}
guess=(guess===undefined)?0.1:guess;var resultRate=guess;var epsMax=1e-10;var newRate,epsRate,resultValue;var contLoop=true;do{resultValue=irrResult(values,dates,resultRate);newRate=resultRate-resultValue/irrResultDeriv(values,dates,resultRate);epsRate=Math.abs(newRate-resultRate);resultRate=newRate;contLoop=(epsRate>epsMax)&&(Math.abs(resultValue)>epsMax);}while(contLoop);return resultRate;};exports.ISPMT=function(rate,period,periods,value){rate=utils.parseNumber(rate);period=utils.parseNumber(period);periods=utils.parseNumber(periods);value=utils.parseNumber(value);if(utils.anyIsError(rate,period,periods,value)){return error.value;}
return value*rate*(period/periods-1);};exports.MDURATION=function(){throw new Error('MDURATION is not implemented');};exports.MIRR=function(values,finance_rate,reinvest_rate){values=utils.parseNumberArray(utils.flatten(values));finance_rate=utils.parseNumber(finance_rate);reinvest_rate=utils.parseNumber(reinvest_rate);if(utils.anyIsError(values,finance_rate,reinvest_rate)){return error.value;}
var n=values.length;var payments=[];var incomes=[];for(var i=0;i<n;i++){if(values[i]<0){payments.push(values[i]);}else{incomes.push(values[i]);}}
var num=-exports.NPV(reinvest_rate,incomes)*Math.pow(1+reinvest_rate,n-1);var den=exports.NPV(finance_rate,payments)*(1+finance_rate);return Math.pow(num/den,1/(n-1))-1;};exports.NOMINAL=function(rate,periods){rate=utils.parseNumber(rate);periods=utils.parseNumber(periods);if(utils.anyIsError(rate,periods)){return error.value;}
if(rate<=0||periods<1){return error.num;}
periods=parseInt(periods,10);return(Math.pow(rate+1,1/periods)-1)*periods;};exports.NPER=function(rate,payment,present,future,type){type=(type===undefined)?0:type;future=(future===undefined)?0:future;rate=utils.parseNumber(rate);payment=utils.parseNumber(payment);present=utils.parseNumber(present);future=utils.parseNumber(future);type=utils.parseNumber(type);if(utils.anyIsError(rate,payment,present,future,type)){return error.value;}
var num=payment*(1+rate*type)-future*rate;var den=(present*rate+payment*(1+rate*type));return Math.log(num/den)/Math.log(1+rate);};exports.NPV=function(){var args=utils.parseNumberArray(utils.flatten(arguments));if(args instanceof Error){return args;}
var rate=args[0];var value=0;for(var j=1;j<args.length;j++){value+=args[j]/Math.pow(1+rate,j);}
return value;};exports.ODDFPRICE=function(){throw new Error('ODDFPRICE is not implemented');};exports.ODDFYIELD=function(){throw new Error('ODDFYIELD is not implemented');};exports.ODDLPRICE=function(){throw new Error('ODDLPRICE is not implemented');};exports.ODDLYIELD=function(){throw new Error('ODDLYIELD is not implemented');};exports.PDURATION=function(rate,present,future){rate=utils.parseNumber(rate);present=utils.parseNumber(present);future=utils.parseNumber(future);if(utils.anyIsError(rate,present,future)){return error.value;}
if(rate<=0){return error.num;}
return(Math.log(future)-Math.log(present))/Math.log(1+rate);};exports.PMT=function(rate,periods,present,future,type){future=future||0;type=type||0;rate=utils.parseNumber(rate);periods=utils.parseNumber(periods);present=utils.parseNumber(present);future=utils.parseNumber(future);type=utils.parseNumber(type);if(utils.anyIsError(rate,periods,present,future,type)){return error.value;}
var result;if(rate===0){result=(present+future)/periods;}else{var term=Math.pow(1+rate,periods);if(type===1){result=(future*rate/(term-1)+present*rate/(1-1/term))/(1+rate);}else{result=future*rate/(term-1)+present*rate/(1-1/term);}}
return-result;};exports.PPMT=function(rate,period,periods,present,future,type){future=future||0;type=type||0;rate=utils.parseNumber(rate);periods=utils.parseNumber(periods);present=utils.parseNumber(present);future=utils.parseNumber(future);type=utils.parseNumber(type);if(utils.anyIsError(rate,periods,present,future,type)){return error.value;}
return exports.PMT(rate,periods,present,future,type)-exports.IPMT(rate,period,periods,present,future,type);};exports.PRICE=function(){throw new Error('PRICE is not implemented');};exports.PRICEDISC=function(){throw new Error('PRICEDISC is not implemented');};exports.PRICEMAT=function(){throw new Error('PRICEMAT is not implemented');};exports.PV=function(rate,periods,payment,future,type){future=future||0;type=type||0;rate=utils.parseNumber(rate);periods=utils.parseNumber(periods);payment=utils.parseNumber(payment);future=utils.parseNumber(future);type=utils.parseNumber(type);if(utils.anyIsError(rate,periods,payment,future,type)){return error.value;}
if(rate===0){return-payment*periods-future;}else{return(((1-Math.pow(1+rate,periods))/rate)*payment*(1+rate*type)-future)/Math.pow(1+rate,periods);}};exports.RATE=function(periods,payment,present,future,type,guess){guess=(guess===undefined)?0.01:guess;future=(future===undefined)?0:future;type=(type===undefined)?0:type;periods=utils.parseNumber(periods);payment=utils.parseNumber(payment);present=utils.parseNumber(present);future=utils.parseNumber(future);type=utils.parseNumber(type);guess=utils.parseNumber(guess);if(utils.anyIsError(periods,payment,present,future,type,guess)){return error.value;}
var epsMax=1e-10;var iterMax=50;var y,y0,y1,x0,x1=0,f=0,i=0;var rate=guess;if(Math.abs(rate)<epsMax){y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future;}else{f=Math.exp(periods*Math.log(1+rate));y=present*f+payment*(1/rate+type)*(f-1)+future;}
y0=present+payment*periods+future;y1=present*f+payment*(1/rate+type)*(f-1)+future;i=x0=0;x1=rate;while((Math.abs(y0-y1)>epsMax)&&(i<iterMax)){rate=(y1*x0-y0*x1)/(y1-y0);x0=x1;x1=rate;if(Math.abs(rate)<epsMax){y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future;}else{f=Math.exp(periods*Math.log(1+rate));y=present*f+payment*(1/rate+type)*(f-1)+future;}
y0=y1;y1=y;++i;}
return rate;};exports.RECEIVED=function(){throw new Error('RECEIVED is not implemented');};exports.RRI=function(periods,present,future){periods=utils.parseNumber(periods);present=utils.parseNumber(present);future=utils.parseNumber(future);if(utils.anyIsError(periods,present,future)){return error.value;}
if(periods===0||present===0){return error.num;}
return Math.pow(future/present,1/periods)-1;};exports.SLN=function(cost,salvage,life){cost=utils.parseNumber(cost);salvage=utils.parseNumber(salvage);life=utils.parseNumber(life);if(utils.anyIsError(cost,salvage,life)){return error.value;}
if(life===0){return error.num;}
return(cost-salvage)/life;};exports.SYD=function(cost,salvage,life,period){cost=utils.parseNumber(cost);salvage=utils.parseNumber(salvage);life=utils.parseNumber(life);period=utils.parseNumber(period);if(utils.anyIsError(cost,salvage,life,period)){return error.value;}
if(life===0){return error.num;}
if(period<1||period>life){return error.num;}
period=parseInt(period,10);return((cost-salvage)*(life-period+1)*2)/(life*(life+1));};exports.TBILLEQ=function(settlement,maturity,discount){settlement=utils.parseDate(settlement);maturity=utils.parseDate(maturity);discount=utils.parseNumber(discount);if(utils.anyIsError(settlement,maturity,discount)){return error.value;}
if(discount<=0){return error.num;}
if(settlement>maturity){return error.num;}
if(maturity-settlement>365*24*60*60*1000){return error.num;}
return(365*discount)/(360-discount*dateTime.DAYS360(settlement,maturity,false));};exports.TBILLPRICE=function(settlement,maturity,discount){settlement=utils.parseDate(settlement);maturity=utils.parseDate(maturity);discount=utils.parseNumber(discount);if(utils.anyIsError(settlement,maturity,discount)){return error.value;}
if(discount<=0){return error.num;}
if(settlement>maturity){return error.num;}
if(maturity-settlement>365*24*60*60*1000){return error.num;}
return 100*(1-discount*dateTime.DAYS360(settlement,maturity,false)/360);};exports.TBILLYIELD=function(settlement,maturity,price){settlement=utils.parseDate(settlement);maturity=utils.parseDate(maturity);price=utils.parseNumber(price);if(utils.anyIsError(settlement,maturity,price)){return error.value;}
if(price<=0){return error.num;}
if(settlement>maturity){return error.num;}
if(maturity-settlement>365*24*60*60*1000){return error.num;}
return(100-price)*360/(price*dateTime.DAYS360(settlement,maturity,false));};exports.VDB=function(){throw new Error('VDB is not implemented');};exports.XNPV=function(rate,values,dates){rate=utils.parseNumber(rate);values=utils.parseNumberArray(utils.flatten(values));dates=utils.parseDateArray(utils.flatten(dates));if(utils.anyIsError(rate,values,dates)){return error.value;}
var result=0;for(var i=0;i<values.length;i++){result+=values[i]/Math.pow(1+rate,dateTime.DAYS(dates[i],dates[0])/365);}
return result;};exports.YIELD=function(){throw new Error('YIELD is not implemented');};exports.YIELDDISC=function(){throw new Error('YIELDDISC is not implemented');};exports.YIELDMAT=function(){throw new Error('YIELDMAT is not implemented');};exports.FORMDATA=function(formDefId,primaryKey,fieldName){return JSpreadShetFormDataLoader.load(formDefId,primaryKey,fieldName);};},function(module,exports,__webpack_require__){var error=__webpack_require__(16);exports.MATCH=function(lookupValue,lookupArray,matchType){if(!lookupValue&&!lookupArray){return error.na;}
if(arguments.length===2){matchType=1;}
if(!(lookupArray instanceof Array)){return error.na;}
if(matchType!==-1&&matchType!==0&&matchType!==1){return error.na;}
var index;var indexValue;for(var idx=0;idx<lookupArray.length;idx++){if(matchType===1){if(lookupArray[idx]===lookupValue){return idx+1;}else if(lookupArray[idx]<lookupValue){if(!indexValue){index=idx+1;indexValue=lookupArray[idx];}else if(lookupArray[idx]>indexValue){index=idx+1;indexValue=lookupArray[idx];}}}else if(matchType===0){if(typeof lookupValue==='string'){lookupValue=lookupValue.replace(/\?/g,'.');if(lookupArray[idx].toLowerCase().match(lookupValue.toLowerCase())){return idx+1;}}else{if(lookupArray[idx]===lookupValue){return idx+1;}}}else if(matchType===-1){if(lookupArray[idx]===lookupValue){return idx+1;}else if(lookupArray[idx]>lookupValue){if(!indexValue){index=idx+1;indexValue=lookupArray[idx];}else if(lookupArray[idx]<indexValue){index=idx+1;indexValue=lookupArray[idx];}}}}
return index?index:error.na;};},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.default=func;var SYMBOL=exports.SYMBOL='>';function func(exp1,exp2){return exp1>exp2;};func.SYMBOL=SYMBOL;},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.default=func;var SYMBOL=exports.SYMBOL='>=';function func(exp1,exp2){return exp1>=exp2;};func.SYMBOL=SYMBOL;},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.default=func;var SYMBOL=exports.SYMBOL='<';function func(exp1,exp2){return exp1<exp2;};func.SYMBOL=SYMBOL;},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.default=func;var SYMBOL=exports.SYMBOL='<=';function func(exp1,exp2){return exp1<=exp2;};func.SYMBOL=SYMBOL;},function(module,exports,__webpack_require__){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.SYMBOL=undefined;exports.default=func;var _number=__webpack_require__(6);var _error=__webpack_require__(7);var SYMBOL=exports.SYMBOL='-';function func(first){for(var _len=arguments.length,rest=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){rest[_key-1]=arguments[_key];}
var result=rest.reduce(function(acc,value){return acc-(0,_number.toNumber)(value);},(0,_number.toNumber)(first));if(isNaN(result)){throw Error(_error.ERROR_VALUE);}
return result;};func.SYMBOL=SYMBOL;},function(module,exports,__webpack_require__){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.SYMBOL=undefined;exports.default=func;var _number=__webpack_require__(6);var _error=__webpack_require__(7);var SYMBOL=exports.SYMBOL='*';function func(first){for(var _len=arguments.length,rest=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){rest[_key-1]=arguments[_key];}
var result=rest.reduce(function(acc,value){return acc*(0,_number.toNumber)(value);},(0,_number.toNumber)(first));if(isNaN(result)){throw Error(_error.ERROR_VALUE);}
return result;};func.SYMBOL=SYMBOL;},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.default=func;var SYMBOL=exports.SYMBOL='<>';function func(exp1,exp2){return exp1!==exp2;};func.SYMBOL=SYMBOL;},function(module,exports,__webpack_require__){'use strict';Object.defineProperty(exports,"__esModule",{value:true});exports.SYMBOL=undefined;exports.default=func;var _number=__webpack_require__(6);var _error=__webpack_require__(7);var SYMBOL=exports.SYMBOL='^';function func(exp1,exp2){var result=Math.pow((0,_number.toNumber)(exp1),(0,_number.toNumber)(exp2));if(isNaN(result)){throw Error(_error.ERROR_VALUE);}
return result;};func.SYMBOL=SYMBOL;},function(module,exports,__webpack_require__){(function(module,process){"use strict";var parser=function(){var o=function o(k,v,_o,l){for(_o=_o||{},l=k.length;l--;_o[k[l]]=v){}return _o;},$V0=[1,5],$V1=[1,8],$V2=[1,6],$V3=[1,7],$V4=[1,9],$V5=[1,14],$V6=[1,15],$V7=[1,16],$V8=[1,12],$V9=[1,13],$Va=[1,17],$Vb=[1,19],$Vc=[1,20],$Vd=[1,21],$Ve=[1,22],$Vf=[1,23],$Vg=[1,24],$Vh=[1,25],$Vi=[1,26],$Vj=[1,27],$Vk=[1,28],$Vl=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],$Vm=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],$Vn=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],$Vo=[5,10,11,13,14,15,16,17,29,30],$Vp=[5,10,13,14,15,16,29,30],$Vq=[5,10,11,13,14,15,16,17,18,19,29,30],$Vr=[13,29,30];var parser={trace:function trace(){},yy:{},symbols_:{"error":2,"expressions":3,"expression":4,"EOF":5,"variableSequence":6,"number":7,"STRING":8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,"NOT":16,"-":17,"*":18,"/":19,"^":20,"FUNCTION":21,"expseq":22,"cell":23,"ABSOLUTE_CELL":24,"RELATIVE_CELL":25,"MIXED_CELL":26,":":27,"ARRAY":28,";":29,",":30,"VARIABLE":31,"DECIMAL":32,"NUMBER":33,"%":34,"ERROR":35,"$accept":0,"$end":1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];break;case 2:this.$=yy.callVariable($$[$0][0]);break;case 3:this.$=yy.toNumber($$[$0]);break;case 4:this.$=yy.trimEdges($$[$0]);break;case 5:this.$=yy.evaluateByOperator('&',[$$[$0-2],$$[$0]]);break;case 6:this.$=yy.evaluateByOperator('=',[$$[$0-2],$$[$0]]);break;case 7:this.$=yy.evaluateByOperator('+',[$$[$0-2],$$[$0]]);break;case 8:this.$=$$[$0-1];break;case 9:this.$=yy.evaluateByOperator('<=',[$$[$0-3],$$[$0]]);break;case 10:this.$=yy.evaluateByOperator('>=',[$$[$0-3],$$[$0]]);break;case 11:this.$=yy.evaluateByOperator('<>',[$$[$0-3],$$[$0]]);break;case 12:this.$=yy.evaluateByOperator('NOT',[$$[$0-2],$$[$0]]);break;case 13:this.$=yy.evaluateByOperator('>',[$$[$0-2],$$[$0]]);break;case 14:this.$=yy.evaluateByOperator('<',[$$[$0-2],$$[$0]]);break;case 15:this.$=yy.evaluateByOperator('-',[$$[$0-2],$$[$0]]);break;case 16:this.$=yy.evaluateByOperator('*',[$$[$0-2],$$[$0]]);break;case 17:this.$=yy.evaluateByOperator('/',[$$[$0-2],$$[$0]]);break;case 18:this.$=yy.evaluateByOperator('^',[$$[$0-2],$$[$0]]);break;case 19:var n1=yy.invertNumber($$[$0]);this.$=n1;if(isNaN(this.$)){this.$=0;}
break;case 20:var n1=yy.toNumber($$[$0]);this.$=n1;if(isNaN(this.$)){this.$=0;}
break;case 21:this.$=yy.callFunction($$[$0-2]);break;case 22:this.$=yy.callFunction($$[$0-3],$$[$0-1]);break;case 26:case 27:case 28:this.$=yy.cellValue($$[$0]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=yy.rangeValue($$[$0-2],$$[$0]);break;case 38:case 42:this.$=[$$[$0]];break;case 39:var result=[];var arr=eval("["+yytext+"]");arr.forEach(function(item){result.push(item);});this.$=result;break;case 40:case 41:$$[$0-2].push($$[$0]);this.$=$$[$0-2];break;case 43:this.$=Array.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]];this.$.push($$[$0]);break;case 44:this.$=$$[$0];break;case 45:this.$=($$[$0-2]+'.'+$$[$0])*1;break;case 46:this.$=$$[$0-1]*0.01;break;case 47:this.$=yy.throwError($$[$0]);break;}},table:[{2:11,3:1,4:2,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{1:[3]},{5:[1,18],9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vl,[2,2],{32:[1,29]}),o($Vl,[2,3],{34:[1,30]}),o($Vl,[2,4]),{2:11,4:31,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:32,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:33,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{12:[1,34]},o($Vl,[2,23]),o($Vl,[2,24],{2:35,35:$Va}),o($Vm,[2,42]),o($Vn,[2,44],{32:[1,36]}),o($Vl,[2,26],{27:[1,37]}),o($Vl,[2,27],{27:[1,38]}),o($Vl,[2,28],{27:[1,39]}),o([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:41,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:42,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:45,6:3,7:4,8:$V0,10:[1,43],11:$V1,12:$V2,15:[1,44],17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:47,6:3,7:4,8:$V0,10:[1,46],11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:48,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:49,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:50,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:51,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:52,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{31:[1,53]},o($Vn,[2,46]),{9:$Vb,10:$Vc,11:$Vd,13:[1,54],14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vo,[2,19],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,20],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:57,6:3,7:4,8:$V0,11:$V1,12:$V2,13:[1,55],17:$V3,21:$V4,22:56,23:10,24:$V5,25:$V6,26:$V7,28:[1,58],31:$V8,33:$V9,35:$Va},o($Vl,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},o($Vl,[2,5]),o([5,10,13,29,30],[2,6],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,7],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:69,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:70,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,14],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:71,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,13],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o([5,10,13,16,29,30],[2,12],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,15],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vq,[2,16],{9:$Vb,20:$Vk}),o($Vq,[2,17],{9:$Vb,20:$Vk}),o([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:$Vb}),o($Vm,[2,43]),o($Vl,[2,8]),o($Vl,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},o($Vr,[2,38],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,39]),o($Vn,[2,45]),o($Vl,[2,29]),o($Vl,[2,30]),o($Vl,[2,31]),o($Vl,[2,32]),o($Vl,[2,33]),o($Vl,[2,34]),o($Vl,[2,35]),o($Vl,[2,36]),o($Vl,[2,37]),o($Vp,[2,9],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,11],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,10],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vl,[2,22]),{2:11,4:75,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:76,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vr,[2,40],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,41],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk})],defaultActions:{18:[2,1]},parseError:function parseError(str,hash){if(hash.recoverable){this.trace(str);}else{var _parseError=function _parseError(msg,hash){this.message=msg;this.hash=hash;};_parseError.prototype=Error;throw new _parseError(str,hash);}},parse:function parse(input){var self=this,stack=[0],tstack=[],vstack=[null],lstack=[],table=this.table,yytext='',yylineno=0,yyleng=0,recovering=0,TERROR=2,EOF=1;var args=lstack.slice.call(arguments,1);var lexer=Object.create(this.lexer);var sharedState={yy:{}};for(var k in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,k)){sharedState.yy[k]=this.yy[k];}}
lexer.setInput(input,sharedState.yy);sharedState.yy.lexer=lexer;sharedState.yy.parser=this;if(typeof lexer.yylloc=='undefined'){lexer.yylloc={};}
var yyloc=lexer.yylloc;lstack.push(yyloc);var ranges=lexer.options&&lexer.options.ranges;if(typeof sharedState.yy.parseError==='function'){this.parseError=sharedState.yy.parseError;}else{this.parseError=Object.getPrototypeOf(this).parseError;}
function popStack(n){stack.length=stack.length-2*n;vstack.length=vstack.length-n;lstack.length=lstack.length-n;}
_token_stack:var lex=function lex(){var token;token=lexer.lex()||EOF;if(typeof token!=='number'){token=self.symbols_[token]||token;}
return token;};var symbol,preErrorSymbol,state,action,a,r,yyval={},p,len,newState,expected;while(true){state=stack[stack.length-1];if(this.defaultActions[state]){action=this.defaultActions[state];}else{if(symbol===null||typeof symbol=='undefined'){symbol=lex();}
action=table[state]&&table[state][symbol];}
_handle_error:if(typeof action==='undefined'||!action.length||!action[0]){var locateNearestErrorRecoveryRule=function locateNearestErrorRecoveryRule(state){var stack_probe=stack.length-1;var depth=0;for(;;){if(TERROR.toString()in table[state]){return depth;}
if(state===0||stack_probe<2){return false;}
stack_probe-=2;state=stack[stack_probe];++depth;}};var error_rule_depth;var errStr='';if(!recovering){error_rule_depth=locateNearestErrorRecoveryRule(state);expected=[];for(p in table[state]){if(this.terminals_[p]&&p>TERROR){expected.push("'"+this.terminals_[p]+"'");}}
if(lexer.showPosition){errStr='Parse error on line '+(yylineno+1)+":\n"+lexer.showPosition()+"\nExpecting "+expected.join(', ')+", got '"+(this.terminals_[symbol]||symbol)+"'";}else{errStr='Parse error on line '+(yylineno+1)+": Unexpected "+(symbol==EOF?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'");}
this.parseError(errStr,{text:lexer.match,token:this.terminals_[symbol]||symbol,line:lexer.yylineno,loc:yyloc,expected:expected,recoverable:error_rule_depth!==false});}else if(preErrorSymbol!==EOF){error_rule_depth=locateNearestErrorRecoveryRule(state);}
if(recovering==3){if(symbol===EOF||preErrorSymbol===EOF){throw new Error(errStr||'Parsing halted while starting to recover from another error.');}
yyleng=lexer.yyleng;yytext=lexer.yytext;yylineno=lexer.yylineno;yyloc=lexer.yylloc;symbol=lex();}
if(error_rule_depth===false){throw new Error(errStr||'Parsing halted. No suitable error recovery rule available.');}
popStack(error_rule_depth);preErrorSymbol=symbol==TERROR?null:symbol;symbol=TERROR;state=stack[stack.length-1];action=table[state]&&table[state][TERROR];recovering=3;}
if(action[0]instanceof Array&&action.length>1){throw new Error('Parse Error: multiple actions possible at state: '+state+', token: '+symbol);}
switch(action[0]){case 1:stack.push(symbol);vstack.push(lexer.yytext);lstack.push(lexer.yylloc);stack.push(action[1]);symbol=null;if(!preErrorSymbol){yyleng=lexer.yyleng;yytext=lexer.yytext;yylineno=lexer.yylineno;yyloc=lexer.yylloc;if(recovering>0){recovering--;}}else{symbol=preErrorSymbol;preErrorSymbol=null;}
break;case 2:len=this.productions_[action[1]][1];yyval.$=vstack[vstack.length-len];yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column};if(ranges){yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]];}
try{r=this.performAction.apply(yyval,[yytext,yyleng,yylineno,sharedState.yy,action[1],vstack,lstack].concat(args));}catch(err){if(vstack.length-1===len){throw err;}}
if(typeof r!=='undefined'){return r;}
if(len){stack=stack.slice(0,-1*len*2);vstack=vstack.slice(0,-1*len);lstack=lstack.slice(0,-1*len);}
stack.push(this.productions_[action[1]][0]);vstack.push(yyval.$);lstack.push(yyval._$);newState=table[stack[stack.length-2]][stack[stack.length-1]];stack.push(newState);break;case 3:return true;}}
return true;}};var lexer=function(){var lexer={EOF:1,parseError:function parseError(str,hash){if(this.yy.parser){this.yy.parser.parseError(str,hash);}else{throw new Error(str);}},setInput:function setInput(input,yy){this.yy=yy||this.yy||{};this._input=input;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match='';this.conditionStack=['INITIAL'];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0];}
this.offset=0;return this;},input:function input(){var ch=this._input[0];this.yytext+=ch;this.yyleng++;this.offset++;this.match+=ch;this.matched+=ch;var lines=ch.match(/(?:\r\n?|\n).*/g);if(lines){this.yylineno++;this.yylloc.last_line++;}else{this.yylloc.last_column++;}
if(this.options.ranges){this.yylloc.range[1]++;}
this._input=this._input.slice(1);return ch;},unput:function unput(ch){var len=ch.length;var lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-len);this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(lines.length-1){this.yylineno-=lines.length-1;}
var r=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len};if(this.options.ranges){this.yylloc.range=[r[0],r[0]+this.yyleng-len];}
this.yyleng=this.yytext.length;return this;},more:function more(){this._more=true;return this;},reject:function reject(){if(this.options.backtrack_lexer){this._backtrack=true;}else{return this.parseError('Lexical error on line '+(this.yylineno+1)+'. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n'+this.showPosition(),{text:"",token:null,line:this.yylineno});}
return this;},less:function less(n){this.unput(this.match.slice(n));},pastInput:function pastInput(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?'...':'')+past.substr(-20).replace(/\n/g,"");},upcomingInput:function upcomingInput(){var next=this.match;if(next.length<20){next+=this._input.substr(0,20-next.length);}
return(next.substr(0,20)+(next.length>20?'...':'')).replace(/\n/g,"");},showPosition:function showPosition(){var pre=this.pastInput();var c=new Array(pre.length+1).join("-");return pre+this.upcomingInput()+"\n"+c+"^";},test_match:function test_match(match,indexed_rule){var token,lines,backup;if(this.options.backtrack_lexer){backup={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){backup.yylloc.range=this.yylloc.range.slice(0);}}
lines=match[0].match(/(?:\r\n?|\n).*/g);if(lines){this.yylineno+=lines.length;}
this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length};this.yytext+=match[0];this.match+=match[0];this.matches=match;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng];}
this._more=false;this._backtrack=false;this._input=this._input.slice(match[0].length);this.matched+=match[0];token=this.performAction.call(this,this.yy,this,indexed_rule,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false;}
if(token){return token;}else if(this._backtrack){for(var k in backup){this[k]=backup[k];}
return false;}
return false;},next:function next(){if(this.done){return this.EOF;}
if(!this._input){this.done=true;}
var token,match,tempMatch,index;if(!this._more){this.yytext='';this.match='';}
var rules=this._currentRules();for(var i=0;i<rules.length;i++){tempMatch=this._input.match(this.rules[rules[i]]);if(tempMatch&&(!match||tempMatch[0].length>match[0].length)){match=tempMatch;index=i;if(this.options.backtrack_lexer){token=this.test_match(tempMatch,rules[i]);if(token!==false){return token;}else if(this._backtrack){match=false;continue;}else{return false;}}else if(!this.options.flex){break;}}}
if(match){token=this.test_match(match,rules[index]);if(token!==false){return token;}
return false;}
if(this._input===""){return this.EOF;}else{return this.parseError('Lexical error on line '+(this.yylineno+1)+'. Unrecognized text.\n'+this.showPosition(),{text:"",token:null,line:this.yylineno});}},lex:function lex(){var r=this.next();if(r){return r;}else{return this.lex();}},begin:function begin(condition){this.conditionStack.push(condition);},popState:function popState(){var n=this.conditionStack.length-1;if(n>0){return this.conditionStack.pop();}else{return this.conditionStack[0];}},_currentRules:function _currentRules(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules;}else{return this.conditions["INITIAL"].rules;}},topState:function topState(n){n=this.conditionStack.length-1-Math.abs(n||0);if(n>=0){return this.conditionStack[n];}else{return"INITIAL";}},pushState:function pushState(condition){this.begin(condition);},stateStackSize:function stateStackSize(){return this.conditionStack.length;},options:{},performAction:function anonymous(yy,yy_,$avoiding_name_collisions,YY_START){var YYSTATE=YY_START;switch($avoiding_name_collisions){case 0:break;case 1:return 8;break;case 2:return 8;break;case 3:return 21;break;case 4:return 35;break;case 5:return 24;break;case 6:return 26;break;case 7:return 26;break;case 8:return 25;break;case 9:return 21;break;case 10:return 31;break;case 11:return 31;break;case 12:return 33;break;case 13:return 28;break;case 14:return 9;break;case 15:return' ';break;case 16:return 32;break;case 17:return 27;break;case 18:return 29;break;case 19:return 30;break;case 20:return 18;break;case 21:return 19;break;case 22:return 17;break;case 23:return 11;break;case 24:return 20;break;case 25:return 12;break;case 26:return 13;break;case 27:return 15;break;case 28:return 14;break;case 29:return 16;break;case 30:return'"';break;case 31:return"'";break;case 32:return"!";break;case 33:return 10;break;case 34:return 34;break;case 35:return'#';break;case 36:return 5;break;}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{"INITIAL":{"rules":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"inclusive":true}}};return lexer;}();parser.lexer=lexer;function Parser(){this.yy={};}
Parser.prototype=parser;parser.Parser=Parser;return new Parser();}();if(true){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments);};if(typeof module!=='undefined'&&__webpack_require__.c[0]===module){exports.main(process.argv.slice(1));}}}.call(exports,__webpack_require__(41)(module),__webpack_require__(20)))},function(module,exports){module.exports=function(module){if(!module.webpackPolyfill){module.deprecate=function(){};module.paths=[];module.children=[];module.webpackPolyfill=1;}
return module;}},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.trimEdges=trimEdges;function trimEdges(string){var margin=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;string=string.substring(margin,string.length-margin);return string;}},function(module,exports){'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"])_i["return"]();}finally{if(_d)throw _e;}}return _arr;}return function(arr,i){if(Array.isArray(arr)){return arr;}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i);}else{throw new TypeError("Invalid attempt to destructure non-iterable instance");}};}();exports.extractLabel=extractLabel;exports.toLabel=toLabel;exports.columnLabelToIndex=columnLabelToIndex;exports.columnIndexToLabel=columnIndexToLabel;exports.rowLabelToIndex=rowLabelToIndex;exports.rowIndexToLabel=rowIndexToLabel;var LABEL_EXTRACT_REGEXP=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/;function extractLabel(label){if(typeof label!=='string'||!LABEL_EXTRACT_REGEXP.test(label)){return[];}
var _label$toUpperCase$ma=label.toUpperCase().match(LABEL_EXTRACT_REGEXP),_label$toUpperCase$ma2=_slicedToArray(_label$toUpperCase$ma,5),columnAbs=_label$toUpperCase$ma2[1],column=_label$toUpperCase$ma2[2],rowAbs=_label$toUpperCase$ma2[3],row=_label$toUpperCase$ma2[4];return[{index:rowLabelToIndex(row),label:row,isAbsolute:rowAbs==='$'},{index:columnLabelToIndex(column),label:column,isAbsolute:columnAbs==='$'}];}
function toLabel(row,column){var rowLabel=(row.isAbsolute?'$':'')+rowIndexToLabel(row.index);var columnLabel=(column.isAbsolute?'$':'')+columnIndexToLabel(column.index);return columnLabel+rowLabel;}
var COLUMN_LABEL_BASE='ABCDEFGHIJKLMNOPQRSTUVWXYZ';var COLUMN_LABEL_BASE_LENGTH=COLUMN_LABEL_BASE.length;function columnLabelToIndex(label){var result=0;if(typeof label==='string'){label=label.toUpperCase();for(var i=0,j=label.length-1;i<label.length;i+=1,j-=1){result+=Math.pow(COLUMN_LABEL_BASE_LENGTH,j)*(COLUMN_LABEL_BASE.indexOf(label[i])+1);}}
--result;return result;}
function columnIndexToLabel(column){var result='';while(column>=0){result=String.fromCharCode(column%COLUMN_LABEL_BASE_LENGTH+97)+result;column=Math.floor(column/COLUMN_LABEL_BASE_LENGTH)-1;}
return result.toUpperCase();}
function rowLabelToIndex(label){var result=parseInt(label,10);if(isNaN(result)){result=-1;}else{result=Math.max(result-1,-1);}
return result;}
function rowIndexToLabel(row){var result='';if(row>=0){result=''+(row+1);}
return result;}}])});;

var MONTH_NAMES=new Array('January','February','March','April','May','June','July','August','September','October','November','December','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec');var DAY_NAMES=new Array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sun','Mon','Tue','Wed','Thu','Fri','Sat');function LZ(x){return(x<0||x>9?"":"0")+x}
function isDate(val,format){var date=getDateFromFormat(val,format);if(date==0){return false;}return true;}
function compareDates(date1,dateformat1,date2,dateformat2){var d1=getDateFromFormat(date1,dateformat1);var d2=getDateFromFormat(date2,dateformat2);if(d1==0||d2==0){return-1;}else if(d1>d2){return 1;}return 0;}
function formatDate(date,format){format=format+"";var result="";var i_format=0;var c="";var token="";var y=date.getYear()+"";var M=date.getMonth()+1;var d=date.getDate();var E=date.getDay();var H=date.getHours();var m=date.getMinutes();var s=date.getSeconds();var yyyy,yy,MMM,MM,dd,hh,h,mm,ss,ampm,HH,H,KK,K,kk,k;var value=new Object();if(y.length<4){y=""+(y-0+1900);}value["y"]=""+y;value["yyyy"]=y;value["yy"]=y.substring(2,4);value["M"]=M;value["MM"]=LZ(M);value["MMM"]=MONTH_NAMES[M-1];value["NNN"]=MONTH_NAMES[M+11];value["d"]=d;value["dd"]=LZ(d);value["E"]=DAY_NAMES[E+7];value["EE"]=DAY_NAMES[E];value["H"]=H;value["HH"]=LZ(H);if(H==0){value["h"]=12;}else if(H>12){value["h"]=H-12;}else{value["h"]=H;}value["hh"]=LZ(value["h"]);if(H>11){value["K"]=H-12;}else{value["K"]=H;}value["k"]=H+1;value["KK"]=LZ(value["K"]);value["kk"]=LZ(value["k"]);if(H>11){value["a"]="PM";}else{value["a"]="AM";}value["m"]=m;value["mm"]=LZ(m);value["s"]=s;value["ss"]=LZ(s);while(i_format<format.length){c=format.charAt(i_format);token="";while((format.charAt(i_format)==c)&&(i_format<format.length)){token+=format.charAt(i_format++);}if(value[token]!=null){result=result+value[token];}else{result=result+token;}}return result;}
function _isInteger(val){var digits="1234567890";for(var i=0;i<val.length;i++){if(digits.indexOf(val.charAt(i))==-1){return false;}}return true;}
function _getInt(str,i,minlength,maxlength){for(var x=maxlength;x>=minlength;x--){var token=str.substring(i,i+x);if(token.length<minlength){return null;}if(_isInteger(token)){return token;}}return null;}
function getDateFromFormat(val,format){val=val+"";format=format+"";var i_val=0;var i_format=0;var c="";var token="";var token2="";var x,y;var now=new Date();var year=now.getYear();var month=now.getMonth()+1;var date=1;var hh=now.getHours();var mm=now.getMinutes();var ss=now.getSeconds();var ampm="";while(i_format<format.length){c=format.charAt(i_format);token="";while((format.charAt(i_format)==c)&&(i_format<format.length)){token+=format.charAt(i_format++);}if(token=="yyyy"||token=="yy"||token=="y"){if(token=="yyyy"){x=4;y=4;}if(token=="yy"){x=2;y=2;}if(token=="y"){x=2;y=4;}year=_getInt(val,i_val,x,y);if(year==null){return 0;}i_val+=year.length;if(year.length==2){if(year>70){year=1900+(year-0);}else{year=2000+(year-0);}}}else if(token=="MMM"||token=="NNN"){month=0;for(var i=0;i<MONTH_NAMES.length;i++){var month_name=MONTH_NAMES[i];if(val.substring(i_val,i_val+month_name.length).toLowerCase()==month_name.toLowerCase()){if(token=="MMM"||(token=="NNN"&&i>11)){month=i+1;if(month>12){month-=12;}i_val+=month_name.length;break;}}}if((month<1)||(month>12)){return 0;}}else if(token=="EE"||token=="E"){for(var i=0;i<DAY_NAMES.length;i++){var day_name=DAY_NAMES[i];if(val.substring(i_val,i_val+day_name.length).toLowerCase()==day_name.toLowerCase()){i_val+=day_name.length;break;}}}else if(token=="MM"||token=="M"){month=_getInt(val,i_val,token.length,2);if(month==null||(month<1)||(month>12)){return 0;}i_val+=month.length;}else if(token=="dd"||token=="d"){date=_getInt(val,i_val,token.length,2);if(date==null||(date<1)||(date>31)){return 0;}i_val+=date.length;}else if(token=="hh"||token=="h"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<1)||(hh>12)){return 0;}i_val+=hh.length;}else if(token=="HH"||token=="H"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<0)||(hh>23)){return 0;}i_val+=hh.length;}else if(token=="KK"||token=="K"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<0)||(hh>11)){return 0;}i_val+=hh.length;}else if(token=="kk"||token=="k"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<1)||(hh>24)){return 0;}i_val+=hh.length;hh--;}else if(token=="mm"||token=="m"){mm=_getInt(val,i_val,token.length,2);if(mm==null||(mm<0)||(mm>59)){return 0;}i_val+=mm.length;}else if(token=="ss"||token=="s"){ss=_getInt(val,i_val,token.length,2);if(ss==null||(ss<0)||(ss>59)){return 0;}i_val+=ss.length;}else if(token=="a"){if(val.substring(i_val,i_val+2).toLowerCase()=="am"){ampm="AM";}else if(val.substring(i_val,i_val+2).toLowerCase()=="pm"){ampm="PM";}else{return 0;}i_val+=2;}else{if(val.substring(i_val,i_val+token.length)!=token){return 0;}else{i_val+=token.length;}}}if(i_val!=val.length){return 0;}if(month==2){if(((year%4==0)&&(year%100!=0))||(year%400==0)){if(date>29){return 0;}}else{if(date>28){return 0;}}}if((month==4)||(month==6)||(month==9)||(month==11)){if(date>30){return 0;}}if(hh<12&&ampm=="PM"){hh=hh-0+12;}else if(hh>11&&ampm=="AM"){hh-=12;}var newdate=new Date(year,month-1,date,hh,mm,ss);return newdate.getTime();}
function parseDate(val){var preferEuro=(arguments.length==2)?arguments[1]:false;generalFormats=new Array('y-M-d','MMM d, y','MMM d,y','y-MMM-d','d-MMM-y','MMM d');monthFirst=new Array('M/d/y','M-d-y','M.d.y','MMM-d','M/d','M-d');dateFirst=new Array('d/M/y','d-M-y','d.M.y','d-MMM','d/M','d-M');var checkList=new Array('generalFormats',preferEuro?'dateFirst':'monthFirst',preferEuro?'monthFirst':'dateFirst');var d=null;for(var i=0;i<checkList.length;i++){var l=window[checkList[i]];for(var j=0;j<l.length;j++){d=getDateFromFormat(val,l[j]);if(d!=0){return new Date(d);}}}return null;};

JSpreadShetFormDataLoader={url:'',cache:{},load:function(formDefId,primaryKey,field){if(JSpreadShetFormDataLoader.cache[formDefId+"::"+primaryKey]!==undefined){var value=JSpreadShetFormDataLoader.cache[formDefId+"::"+primaryKey][field];if(value===null||value===undefined){value="";}
return value;}else{var value="";$.ajax({type:"POST",data:{"_a":"loadFormData","_formDefId":formDefId,"_primaryKey":primaryKey},url:JSpreadShetFormDataLoader.url,async:false,dataType:"json",success:function(result){JSpreadShetFormDataLoader.cache[formDefId+"::"+primaryKey]=result;value=result[field];}});if(value===null||value===undefined){value="";}
return value;}}};(function(Handsontable){var uploadId="fileUploadInput";var FileUploadEditor=Handsontable.editors.TextEditor.prototype.extend();var typemap={"ez":"application/andrew-inset","aw":"application/applixware","atom":"application/atom+xml","atomcat":"application/atomcat+xml","atomsvc":"application/atomsvc+xml","bdoc":"application/bdoc","ccxml":"application/ccxml+xml","cdmia":"application/cdmi-capability","cdmic":"application/cdmi-container","cdmid":"application/cdmi-domain","cdmio":"application/cdmi-object","cdmiq":"application/cdmi-queue","cu":"application/cu-seeme","mpd":"application/dash+xml","davmount":"application/davmount+xml","dbk":"application/docbook+xml","dssc":"application/dssc+der","xdssc":"application/dssc+xml","ecma":"application/ecmascript","emma":"application/emma+xml","epub":"application/epub+zip","exi":"application/exi","pfr":"application/font-tdpfr","woff":"application/font-woff","woff2":"application/font-woff2","geojson":"application/geo+json","gml":"application/gml+xml","gpx":"application/gpx+xml","gxf":"application/gxf","gz":"application/gzip","hjson":"application/hjson","stk":"application/hyperstudio","ink":"application/inkml+xml","inkml":"application/inkml+xml","ipfix":"application/ipfix","jar":"application/java-archive","war":"application/java-archive","ear":"application/java-archive","ser":"application/java-serialized-object","class":"application/java-vm","js":"application/javascript","mjs":"application/javascript","json":"application/json","map":"application/json","json5":"application/json5","jsonml":"application/jsonml+json","jsonld":"application/ld+json","lostxml":"application/lost+xml","hqx":"application/mac-binhex40","cpt":"application/mac-compactpro","mads":"application/mads+xml","webmanifest":"application/manifest+json","mrc":"application/marc","mrcx":"application/marcxml+xml","ma":"application/mathematica","nb":"application/mathematica","mb":"application/mathematica","mathml":"application/mathml+xml","mbox":"application/mbox","mscml":"application/mediaservercontrol+xml","metalink":"application/metalink+xml","meta4":"application/metalink4+xml","mets":"application/mets+xml","mods":"application/mods+xml","m21":"application/mp21","mp21":"application/mp21","mp4s":"application/mp4","m4p":"application/mp4","doc":"application/msword","dot":"application/msword","mxf":"application/mxf","bin":"application/octet-stream","dms":"application/octet-stream","lrf":"application/octet-stream","mar":"application/octet-stream","so":"application/octet-stream","dist":"application/octet-stream","distz":"application/octet-stream","pkg":"application/octet-stream","bpk":"application/octet-stream","dump":"application/octet-stream","elc":"application/octet-stream","deploy":"application/octet-stream","exe":"application/octet-stream","dll":"application/octet-stream","deb":"application/octet-stream","dmg":"application/octet-stream","iso":"application/octet-stream","img":"application/octet-stream","msi":"application/octet-stream","msp":"application/octet-stream","msm":"application/octet-stream","buffer":"application/octet-stream","oda":"application/oda","opf":"application/oebps-package+xml","ogx":"application/ogg","omdoc":"application/omdoc+xml","onetoc":"application/onenote","onetoc2":"application/onenote","onetmp":"application/onenote","onepkg":"application/onenote","oxps":"application/oxps","xer":"application/patch-ops-error+xml","pdf":"application/pdf","pgp":"application/pgp-encrypted","asc":"application/pgp-signature","sig":"application/pgp-signature","prf":"application/pics-rules","p10":"application/pkcs10","p7m":"application/pkcs7-mime","p7c":"application/pkcs7-mime","p7s":"application/pkcs7-signature","p8":"application/pkcs8","ac":"application/pkix-attr-cert","cer":"application/pkix-cert","crl":"application/pkix-crl","pkipath":"application/pkix-pkipath","pki":"application/pkixcmp","pls":"application/pls+xml","ai":"application/postscript","eps":"application/postscript","ps":"application/postscript","pskcxml":"application/pskc+xml","raml":"application/raml+yaml","rdf":"application/rdf+xml","rif":"application/reginfo+xml","rnc":"application/relax-ng-compact-syntax","rl":"application/resource-lists+xml","rld":"application/resource-lists-diff+xml","rs":"application/rls-services+xml","gbr":"application/rpki-ghostbusters","mft":"application/rpki-manifest","roa":"application/rpki-roa","rsd":"application/rsd+xml","rss":"application/rss+xml","rtf":"application/rtf","sbml":"application/sbml+xml","scq":"application/scvp-cv-request","scs":"application/scvp-cv-response","spq":"application/scvp-vp-request","spp":"application/scvp-vp-response","sdp":"application/sdp","setpay":"application/set-payment-initiation","setreg":"application/set-registration-initiation","shf":"application/shf+xml","smi":"application/smil+xml","smil":"application/smil+xml","rq":"application/sparql-query","srx":"application/sparql-results+xml","gram":"application/srgs","grxml":"application/srgs+xml","sru":"application/sru+xml","ssdl":"application/ssdl+xml","ssml":"application/ssml+xml","tei":"application/tei+xml","teicorpus":"application/tei+xml","tfi":"application/thraud+xml","tsd":"application/timestamped-data","vxml":"application/voicexml+xml","wasm":"application/wasm","wgt":"application/widget","hlp":"application/winhlp","wsdl":"application/wsdl+xml","wspolicy":"application/wspolicy+xml","xaml":"application/xaml+xml","xdf":"application/xcap-diff+xml","xenc":"application/xenc+xml","xhtml":"application/xhtml+xml","xht":"application/xhtml+xml","xml":"application/xml","xsl":"application/xml","xsd":"application/xml","rng":"application/xml","dtd":"application/xml-dtd","xop":"application/xop+xml","xpl":"application/xproc+xml","xslt":"application/xslt+xml","xspf":"application/xspf+xml","mxml":"application/xv+xml","xhvml":"application/xv+xml","xvml":"application/xv+xml","xvm":"application/xv+xml","yang":"application/yang","yin":"application/yin+xml","zip":"application/zip","3gpp":"audio/3gpp","adp":"audio/adpcm","au":"audio/basic","snd":"audio/basic","mid":"audio/midi","midi":"audio/midi","kar":"audio/midi","rmi":"audio/midi","mp3":"audio/mp3","m4a":"audio/mp4","mp4a":"audio/mp4","mpga":"audio/mpeg","mp2":"audio/mpeg","mp2a":"audio/mpeg","mp3":"audio/mpeg","m2a":"audio/mpeg","m3a":"audio/mpeg","oga":"audio/ogg","ogg":"audio/ogg","spx":"audio/ogg","s3m":"audio/s3m","sil":"audio/silk","wav":"audio/wav","wav":"audio/wave","weba":"audio/webm","xm":"audio/xm","ttc":"font/collection","otf":"font/otf","ttf":"font/ttf","woff":"font/woff","woff2":"font/woff2","apng":"image/apng","bmp":"image/bmp","cgm":"image/cgm","g3":"image/g3fax","gif":"image/gif","ief":"image/ief","jp2":"image/jp2","jpg2":"image/jp2","jpeg":"image/jpeg","jpg":"image/jpeg","jpe":"image/jpeg","jpm":"image/jpm","jpx":"image/jpx","jpf":"image/jpx","ktx":"image/ktx","png":"image/png","sgi":"image/sgi","svg":"image/svg+xml","svgz":"image/svg+xml","tiff":"image/tiff","tif":"image/tiff","webp":"image/webp","eml":"message/rfc822","mime":"message/rfc822","gltf":"model/gltf+json","glb":"model/gltf-binary","igs":"model/iges","iges":"model/iges","msh":"model/mesh","mesh":"model/mesh","silo":"model/mesh","wrl":"model/vrml","vrml":"model/vrml","x3db":"model/x3d+binary","x3dbz":"model/x3d+binary","x3dv":"model/x3d+vrml","x3dvz":"model/x3d+vrml","x3d":"model/x3d+xml","x3dz":"model/x3d+xml","appcache":"text/cache-manifest","manifest":"text/cache-manifest","ics":"text/calendar","ifb":"text/calendar","coffee":"text/coffeescript","litcoffee":"text/coffeescript","css":"text/css","csv":"text/csv","html":"text/html","htm":"text/html","shtml":"text/html","jade":"text/jade","jsx":"text/jsx","less":"text/less","markdown":"text/markdown","md":"text/markdown","mml":"text/mathml","n3":"text/n3","txt":"text/plain","text":"text/plain","conf":"text/plain","def":"text/plain","list":"text/plain","log":"text/plain","in":"text/plain","ini":"text/plain","rtx":"text/richtext","rtf":"text/rtf","sgml":"text/sgml","sgm":"text/sgml","shex":"text/shex","slim":"text/slim","slm":"text/slim","stylus":"text/stylus","styl":"text/stylus","tsv":"text/tab-separated-values","t":"text/troff","tr":"text/troff","roff":"text/troff","man":"text/troff","me":"text/troff","ms":"text/troff","ttl":"text/turtle","uri":"text/uri-list","uris":"text/uri-list","urls":"text/uri-list","vcard":"text/vcard","vtt":"text/vtt","xml":"text/xml","yaml":"text/yaml","yml":"text/yaml","3gp":"video/3gpp","3gpp":"video/3gpp","3gpp":"video/3gpp","3g2":"video/3gpp2","h261":"video/h261","h263":"video/h263","h264":"video/h264","jpgv":"video/jpeg","jpm":"video/jpm","jpgm":"video/jpm","mj2":"video/mj2","mjp2":"video/mj2","ts":"video/mp2t","mp4":"video/mp4","mp4v":"video/mp4","mpg4":"video/mp4","mpeg":"video/mpeg","mpg":"video/mpeg","mpe":"video/mpeg","m1v":"video/mpeg","m2v":"video/mpeg","ogv":"video/ogg","qt":"video/quicktime","mov":"video/quicktime","webm":"video/webm","cww":"application/prs.cww","plb":"application/vnd.3gpp.pic-bw-large","psb":"application/vnd.3gpp.pic-bw-small","pvb":"application/vnd.3gpp.pic-bw-var","tcap":"application/vnd.3gpp2.tcap","pwn":"application/vnd.3m.post-it-notes","aso":"application/vnd.accpac.simply.aso","imp":"application/vnd.accpac.simply.imp","acu":"application/vnd.acucobol","atc":"application/vnd.acucorp","acutc":"application/vnd.acucorp","air":"application/vnd.adobe.air-application-installer-package+zip","fcdt":"application/vnd.adobe.formscentral.fcdt","fxp":"application/vnd.adobe.fxp","fxpl":"application/vnd.adobe.fxp","xdp":"application/vnd.adobe.xdp+xml","xfdf":"application/vnd.adobe.xfdf","ahead":"application/vnd.ahead.space","azf":"application/vnd.airzip.filesecure.azf","azs":"application/vnd.airzip.filesecure.azs","azw":"application/vnd.amazon.ebook","acc":"application/vnd.americandynamics.acc","ami":"application/vnd.amiga.ami","apk":"application/vnd.android.package-archive","cii":"application/vnd.anser-web-certificate-issue-initiation","fti":"application/vnd.anser-web-funds-transfer-initiation","atx":"application/vnd.antix.game-component","mpkg":"application/vnd.apple.installer+xml","m3u8":"application/vnd.apple.mpegurl","pkpass":"application/vnd.apple.pkpass","swi":"application/vnd.aristanetworks.swi","iota":"application/vnd.astraea-software.iota","aep":"application/vnd.audiograph","mpm":"application/vnd.blueice.multipass","bmi":"application/vnd.bmi","rep":"application/vnd.businessobjects","cdxml":"application/vnd.chemdraw+xml","mmd":"application/vnd.chipnuts.karaoke-mmd","cdy":"application/vnd.cinderella","cla":"application/vnd.claymore","rp9":"application/vnd.cloanto.rp9","c4g":"application/vnd.clonk.c4group","c4d":"application/vnd.clonk.c4group","c4f":"application/vnd.clonk.c4group","c4p":"application/vnd.clonk.c4group","c4u":"application/vnd.clonk.c4group","c11amc":"application/vnd.cluetrust.cartomobile-config","c11amz":"application/vnd.cluetrust.cartomobile-config-pkg","csp":"application/vnd.commonspace","cdbcmsg":"application/vnd.contact.cmsg","cmc":"application/vnd.cosmocaller","clkx":"application/vnd.crick.clicker","clkk":"application/vnd.crick.clicker.keyboard","clkp":"application/vnd.crick.clicker.palette","clkt":"application/vnd.crick.clicker.template","clkw":"application/vnd.crick.clicker.wordbank","wbs":"application/vnd.criticaltools.wbs+xml","pml":"application/vnd.ctc-posml","ppd":"application/vnd.cups-ppd","car":"application/vnd.curl.car","pcurl":"application/vnd.curl.pcurl","dart":"application/vnd.dart","rdz":"application/vnd.data-vision.rdz","uvf":"application/vnd.dece.data","uvvf":"application/vnd.dece.data","uvd":"application/vnd.dece.data","uvvd":"application/vnd.dece.data","uvt":"application/vnd.dece.ttml+xml","uvvt":"application/vnd.dece.ttml+xml","uvx":"application/vnd.dece.unspecified","uvvx":"application/vnd.dece.unspecified","uvz":"application/vnd.dece.zip","uvvz":"application/vnd.dece.zip","fe_launch":"application/vnd.denovo.fcselayout-link","dna":"application/vnd.dna","mlp":"application/vnd.dolby.mlp","dpg":"application/vnd.dpgraph","dfac":"application/vnd.dreamfactory","kpxx":"application/vnd.ds-keypoint","ait":"application/vnd.dvb.ait","svc":"application/vnd.dvb.service","geo":"application/vnd.dynageo","mag":"application/vnd.ecowin.chart","nml":"application/vnd.enliven","esf":"application/vnd.epson.esf","msf":"application/vnd.epson.msf","qam":"application/vnd.epson.quickanime","slt":"application/vnd.epson.salt","ssf":"application/vnd.epson.ssf","es3":"application/vnd.eszigno3+xml","et3":"application/vnd.eszigno3+xml","ez2":"application/vnd.ezpix-album","ez3":"application/vnd.ezpix-package","fdf":"application/vnd.fdf","mseed":"application/vnd.fdsn.mseed","seed":"application/vnd.fdsn.seed","dataless":"application/vnd.fdsn.seed","gph":"application/vnd.flographit","ftc":"application/vnd.fluxtime.clip","fm":"application/vnd.framemaker","frame":"application/vnd.framemaker","maker":"application/vnd.framemaker","book":"application/vnd.framemaker","fnc":"application/vnd.frogans.fnc","ltf":"application/vnd.frogans.ltf","fsc":"application/vnd.fsc.weblaunch","oas":"application/vnd.fujitsu.oasys","oa2":"application/vnd.fujitsu.oasys2","oa3":"application/vnd.fujitsu.oasys3","fg5":"application/vnd.fujitsu.oasysgp","bh2":"application/vnd.fujitsu.oasysprs","ddd":"application/vnd.fujixerox.ddd","xdw":"application/vnd.fujixerox.docuworks","xbd":"application/vnd.fujixerox.docuworks.binder","fzs":"application/vnd.fuzzysheet","txd":"application/vnd.genomatix.tuxedo","ggb":"application/vnd.geogebra.file","ggt":"application/vnd.geogebra.tool","gex":"application/vnd.geometry-explorer","gre":"application/vnd.geometry-explorer","gxt":"application/vnd.geonext","g2w":"application/vnd.geoplan","g3w":"application/vnd.geospace","gmx":"application/vnd.gmx","gdoc":"application/vnd.google-apps.document","gslides":"application/vnd.google-apps.presentation","gsheet":"application/vnd.google-apps.spreadsheet","kml":"application/vnd.google-earth.kml+xml","kmz":"application/vnd.google-earth.kmz","gqf":"application/vnd.grafeq","gqs":"application/vnd.grafeq","gac":"application/vnd.groove-account","ghf":"application/vnd.groove-help","gim":"application/vnd.groove-identity-message","grv":"application/vnd.groove-injector","gtm":"application/vnd.groove-tool-message","tpl":"application/vnd.groove-tool-template","vcg":"application/vnd.groove-vcard","hal":"application/vnd.hal+xml","zmm":"application/vnd.handheld-entertainment+xml","hbci":"application/vnd.hbci","les":"application/vnd.hhe.lesson-player","hpgl":"application/vnd.hp-hpgl","hpid":"application/vnd.hp-hpid","hps":"application/vnd.hp-hps","jlt":"application/vnd.hp-jlyt","pcl":"application/vnd.hp-pcl","pclxl":"application/vnd.hp-pclxl","sfd-hdstx":"application/vnd.hydrostatix.sof-data","mpy":"application/vnd.ibm.minipay","afp":"application/vnd.ibm.modcap","listafp":"application/vnd.ibm.modcap","list3820":"application/vnd.ibm.modcap","irm":"application/vnd.ibm.rights-management","sc":"application/vnd.ibm.secure-container","icc":"application/vnd.iccprofile","icm":"application/vnd.iccprofile","igl":"application/vnd.igloader","ivp":"application/vnd.immervision-ivp","ivu":"application/vnd.immervision-ivu","igm":"application/vnd.insors.igm","xpw":"application/vnd.intercon.formnet","xpx":"application/vnd.intercon.formnet","i2g":"application/vnd.intergeo","qbo":"application/vnd.intu.qbo","qfx":"application/vnd.intu.qfx","rcprofile":"application/vnd.ipunplugged.rcprofile","irp":"application/vnd.irepository.package+xml","xpr":"application/vnd.is-xpr","fcs":"application/vnd.isac.fcs","jam":"application/vnd.jam","rms":"application/vnd.jcp.javame.midlet-rms","jisp":"application/vnd.jisp","joda":"application/vnd.joost.joda-archive","ktz":"application/vnd.kahootz","ktr":"application/vnd.kahootz","karbon":"application/vnd.kde.karbon","chrt":"application/vnd.kde.kchart","kfo":"application/vnd.kde.kformula","flw":"application/vnd.kde.kivio","kon":"application/vnd.kde.kontour","kpr":"application/vnd.kde.kpresenter","kpt":"application/vnd.kde.kpresenter","ksp":"application/vnd.kde.kspread","kwd":"application/vnd.kde.kword","kwt":"application/vnd.kde.kword","htke":"application/vnd.kenameaapp","kia":"application/vnd.kidspiration","kne":"application/vnd.kinar","knp":"application/vnd.kinar","skp":"application/vnd.koan","skd":"application/vnd.koan","skt":"application/vnd.koan","skm":"application/vnd.koan","sse":"application/vnd.kodak-descriptor","lasxml":"application/vnd.las.las+xml","lbd":"application/vnd.llamagraphics.life-balance.desktop","lbe":"application/vnd.llamagraphics.life-balance.exchange+xml","123":"application/vnd.lotus-1-2-3","apr":"application/vnd.lotus-approach","pre":"application/vnd.lotus-freelance","nsf":"application/vnd.lotus-notes","org":"application/vnd.lotus-organizer","scm":"application/vnd.lotus-screencam","lwp":"application/vnd.lotus-wordpro","portpkg":"application/vnd.macports.portpkg","mcd":"application/vnd.mcd","mc1":"application/vnd.medcalcdata","cdkey":"application/vnd.mediastation.cdkey","mwf":"application/vnd.mfer","mfm":"application/vnd.mfmp","flo":"application/vnd.micrografx.flo","igx":"application/vnd.micrografx.igx","mif":"application/vnd.mif","daf":"application/vnd.mobius.daf","dis":"application/vnd.mobius.dis","mbk":"application/vnd.mobius.mbk","mqy":"application/vnd.mobius.mqy","msl":"application/vnd.mobius.msl","plc":"application/vnd.mobius.plc","txf":"application/vnd.mobius.txf","mpn":"application/vnd.mophun.application","mpc":"application/vnd.mophun.certificate","xul":"application/vnd.mozilla.xul+xml","cil":"application/vnd.ms-artgalry","cab":"application/vnd.ms-cab-compressed","xls":"application/vnd.ms-excel","xlm":"application/vnd.ms-excel","xla":"application/vnd.ms-excel","xlc":"application/vnd.ms-excel","xlt":"application/vnd.ms-excel","xlw":"application/vnd.ms-excel","xlam":"application/vnd.ms-excel.addin.macroenabled.12","xlsb":"application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsm":"application/vnd.ms-excel.sheet.macroenabled.12","xltm":"application/vnd.ms-excel.template.macroenabled.12","eot":"application/vnd.ms-fontobject","chm":"application/vnd.ms-htmlhelp","ims":"application/vnd.ms-ims","lrm":"application/vnd.ms-lrm","thmx":"application/vnd.ms-officetheme","msg":"application/vnd.ms-outlook","cat":"application/vnd.ms-pki.seccat","stl":"application/vnd.ms-pki.stl","ppt":"application/vnd.ms-powerpoint","pps":"application/vnd.ms-powerpoint","pot":"application/vnd.ms-powerpoint","ppam":"application/vnd.ms-powerpoint.addin.macroenabled.12","pptm":"application/vnd.ms-powerpoint.presentation.macroenabled.12","sldm":"application/vnd.ms-powerpoint.slide.macroenabled.12","ppsm":"application/vnd.ms-powerpoint.slideshow.macroenabled.12","potm":"application/vnd.ms-powerpoint.template.macroenabled.12","mpp":"application/vnd.ms-project","mpt":"application/vnd.ms-project","docm":"application/vnd.ms-word.document.macroenabled.12","dotm":"application/vnd.ms-word.template.macroenabled.12","wps":"application/vnd.ms-works","wks":"application/vnd.ms-works","wcm":"application/vnd.ms-works","wdb":"application/vnd.ms-works","wpl":"application/vnd.ms-wpl","xps":"application/vnd.ms-xpsdocument","mseq":"application/vnd.mseq","mus":"application/vnd.musician","msty":"application/vnd.muvee.style","taglet":"application/vnd.mynfc","nlu":"application/vnd.neurolanguage.nlu","ntf":"application/vnd.nitf","nitf":"application/vnd.nitf","nnd":"application/vnd.noblenet-directory","nns":"application/vnd.noblenet-sealer","nnw":"application/vnd.noblenet-web","ngdat":"application/vnd.nokia.n-gage.data","n-gage":"application/vnd.nokia.n-gage.symbian.install","rpst":"application/vnd.nokia.radio-preset","rpss":"application/vnd.nokia.radio-presets","edm":"application/vnd.novadigm.edm","edx":"application/vnd.novadigm.edx","ext":"application/vnd.novadigm.ext","odc":"application/vnd.oasis.opendocument.chart","otc":"application/vnd.oasis.opendocument.chart-template","odb":"application/vnd.oasis.opendocument.database","odf":"application/vnd.oasis.opendocument.formula","odft":"application/vnd.oasis.opendocument.formula-template","odg":"application/vnd.oasis.opendocument.graphics","otg":"application/vnd.oasis.opendocument.graphics-template","odi":"application/vnd.oasis.opendocument.image","oti":"application/vnd.oasis.opendocument.image-template","odp":"application/vnd.oasis.opendocument.presentation","otp":"application/vnd.oasis.opendocument.presentation-template","ods":"application/vnd.oasis.opendocument.spreadsheet","ots":"application/vnd.oasis.opendocument.spreadsheet-template","odt":"application/vnd.oasis.opendocument.text","odm":"application/vnd.oasis.opendocument.text-master","ott":"application/vnd.oasis.opendocument.text-template","oth":"application/vnd.oasis.opendocument.text-web","xo":"application/vnd.olpc-sugar","dd2":"application/vnd.oma.dd2+xml","oxt":"application/vnd.openofficeorg.extension","pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation","sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide","ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow","potx":"application/vnd.openxmlformats-officedocument.presentationml.template","xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template","docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template","mgp":"application/vnd.osgeo.mapguide.package","dp":"application/vnd.osgi.dp","esa":"application/vnd.osgi.subsystem","pdb":"application/vnd.palm","pqa":"application/vnd.palm","oprc":"application/vnd.palm","paw":"application/vnd.pawaafile","str":"application/vnd.pg.format","ei6":"application/vnd.pg.osasli","efif":"application/vnd.picsel","wg":"application/vnd.pmi.widget","plf":"application/vnd.pocketlearn","pbd":"application/vnd.powerbuilder6","box":"application/vnd.previewsystems.box","mgz":"application/vnd.proteus.magazine","qps":"application/vnd.publishare-delta-tree","ptid":"application/vnd.pvi.ptid1","qxd":"application/vnd.quark.quarkxpress","qxt":"application/vnd.quark.quarkxpress","qwd":"application/vnd.quark.quarkxpress","qwt":"application/vnd.quark.quarkxpress","qxl":"application/vnd.quark.quarkxpress","qxb":"application/vnd.quark.quarkxpress","bed":"application/vnd.realvnc.bed","mxl":"application/vnd.recordare.musicxml","musicxml":"application/vnd.recordare.musicxml+xml","cryptonote":"application/vnd.rig.cryptonote","cod":"application/vnd.rim.cod","rm":"application/vnd.rn-realmedia","rmvb":"application/vnd.rn-realmedia-vbr","link66":"application/vnd.route66.link66+xml","st":"application/vnd.sailingtracker.track","see":"application/vnd.seemail","sema":"application/vnd.sema","semd":"application/vnd.semd","semf":"application/vnd.semf","ifm":"application/vnd.shana.informed.formdata","itp":"application/vnd.shana.informed.formtemplate","iif":"application/vnd.shana.informed.interchange","ipk":"application/vnd.shana.informed.package","twd":"application/vnd.simtech-mindmapper","twds":"application/vnd.simtech-mindmapper","mmf":"application/vnd.smaf","teacher":"application/vnd.smart.teacher","sdkm":"application/vnd.solent.sdkm+xml","sdkd":"application/vnd.solent.sdkm+xml","dxp":"application/vnd.spotfire.dxp","sfs":"application/vnd.spotfire.sfs","sdc":"application/vnd.stardivision.calc","sda":"application/vnd.stardivision.draw","sdd":"application/vnd.stardivision.impress","smf":"application/vnd.stardivision.math","sdw":"application/vnd.stardivision.writer","vor":"application/vnd.stardivision.writer","sgl":"application/vnd.stardivision.writer-global","smzip":"application/vnd.stepmania.package","sm":"application/vnd.stepmania.stepchart","wadl":"application/vnd.sun.wadl+xml","sxc":"application/vnd.sun.xml.calc","stc":"application/vnd.sun.xml.calc.template","sxd":"application/vnd.sun.xml.draw","std":"application/vnd.sun.xml.draw.template","sxi":"application/vnd.sun.xml.impress","sti":"application/vnd.sun.xml.impress.template","sxm":"application/vnd.sun.xml.math","sxw":"application/vnd.sun.xml.writer","sxg":"application/vnd.sun.xml.writer.global","stw":"application/vnd.sun.xml.writer.template","sus":"application/vnd.sus-calendar","susp":"application/vnd.sus-calendar","svd":"application/vnd.svd","sis":"application/vnd.symbian.install","sisx":"application/vnd.symbian.install","xsm":"application/vnd.syncml+xml","bdm":"application/vnd.syncml.dm+wbxml","xdm":"application/vnd.syncml.dm+xml","tao":"application/vnd.tao.intent-module-archive","pcap":"application/vnd.tcpdump.pcap","cap":"application/vnd.tcpdump.pcap","dmp":"application/vnd.tcpdump.pcap","tmo":"application/vnd.tmobile-livetv","tpt":"application/vnd.trid.tpt","mxs":"application/vnd.triscape.mxs","tra":"application/vnd.trueapp","ufd":"application/vnd.ufdl","ufdl":"application/vnd.ufdl","utz":"application/vnd.uiq.theme","umj":"application/vnd.umajin","unityweb":"application/vnd.unity","uoml":"application/vnd.uoml+xml","vcx":"application/vnd.vcx","vsd":"application/vnd.visio","vst":"application/vnd.visio","vss":"application/vnd.visio","vsw":"application/vnd.visio","vis":"application/vnd.visionary","vsf":"application/vnd.vsf","wbxml":"application/vnd.wap.wbxml","wmlc":"application/vnd.wap.wmlc","wmlsc":"application/vnd.wap.wmlscriptc","wtb":"application/vnd.webturbo","nbp":"application/vnd.wolfram.player","wpd":"application/vnd.wordperfect","wqd":"application/vnd.wqd","stf":"application/vnd.wt.stf","xar":"application/vnd.xara","xfdl":"application/vnd.xfdl","hvd":"application/vnd.yamaha.hv-dic","hvs":"application/vnd.yamaha.hv-script","hvp":"application/vnd.yamaha.hv-voice","osf":"application/vnd.yamaha.openscoreformat","osfpvg":"application/vnd.yamaha.openscoreformat.osfpvg+xml","saf":"application/vnd.yamaha.smaf-audio","spf":"application/vnd.yamaha.smaf-phrase","cmp":"application/vnd.yellowriver-custom-menu","zir":"application/vnd.zul","zirz":"application/vnd.zul","zaz":"application/vnd.zzazz.deck+xml","7z":"application/x-7z-compressed","abw":"application/x-abiword","ace":"application/x-ace-compressed","dmg":"application/x-apple-diskimage","arj":"application/x-arj","aab":"application/x-authorware-bin","x32":"application/x-authorware-bin","u32":"application/x-authorware-bin","vox":"application/x-authorware-bin","aam":"application/x-authorware-map","aas":"application/x-authorware-seg","bcpio":"application/x-bcpio","bdoc":"application/x-bdoc","torrent":"application/x-bittorrent","blb":"application/x-blorb","blorb":"application/x-blorb","bz":"application/x-bzip","bz2":"application/x-bzip2","boz":"application/x-bzip2","cbr":"application/x-cbr","cba":"application/x-cbr","cbt":"application/x-cbr","cbz":"application/x-cbr","cb7":"application/x-cbr","vcd":"application/x-cdlink","cfs":"application/x-cfs-compressed","chat":"application/x-chat","pgn":"application/x-chess-pgn","crx":"application/x-chrome-extension","cco":"application/x-cocoa","nsc":"application/x-conference","cpio":"application/x-cpio","csh":"application/x-csh","deb":"application/x-debian-package","udeb":"application/x-debian-package","dgc":"application/x-dgc-compressed","dir":"application/x-director","dcr":"application/x-director","dxr":"application/x-director","cst":"application/x-director","cct":"application/x-director","cxt":"application/x-director","w3d":"application/x-director","fgd":"application/x-director","swa":"application/x-director","wad":"application/x-doom","ncx":"application/x-dtbncx+xml","dtb":"application/x-dtbook+xml","res":"application/x-dtbresource+xml","dvi":"application/x-dvi","evy":"application/x-envoy","eva":"application/x-eva","bdf":"application/x-font-bdf","gsf":"application/x-font-ghostscript","psf":"application/x-font-linux-psf","pcf":"application/x-font-pcf","snf":"application/x-font-snf","pfa":"application/x-font-type1","pfb":"application/x-font-type1","pfm":"application/x-font-type1","afm":"application/x-font-type1","arc":"application/x-freearc","spl":"application/x-futuresplash","gca":"application/x-gca-compressed","ulx":"application/x-glulx","gnumeric":"application/x-gnumeric","gramps":"application/x-gramps-xml","gtar":"application/x-gtar","hdf":"application/x-hdf","php":"application/x-httpd-php","install":"application/x-install-instructions","iso":"application/x-iso9660-image","jardiff":"application/x-java-archive-diff","jnlp":"application/x-java-jnlp-file","latex":"application/x-latex","luac":"application/x-lua-bytecode","lzh":"application/x-lzh-compressed","lha":"application/x-lzh-compressed","run":"application/x-makeself","mie":"application/x-mie","prc":"application/x-mobipocket-ebook","mobi":"application/x-mobipocket-ebook","application":"application/x-ms-application","lnk":"application/x-ms-shortcut","wmd":"application/x-ms-wmd","wmz":"application/x-ms-wmz","xbap":"application/x-ms-xbap","mdb":"application/x-msaccess","obd":"application/x-msbinder","crd":"application/x-mscardfile","clp":"application/x-msclip","exe":"application/x-msdos-program","exe":"application/x-msdownload","dll":"application/x-msdownload","com":"application/x-msdownload","bat":"application/x-msdownload","msi":"application/x-msdownload","mvb":"application/x-msmediaview","m13":"application/x-msmediaview","m14":"application/x-msmediaview","wmf":"application/x-msmetafile","wmz":"application/x-msmetafile","emf":"application/x-msmetafile","emz":"application/x-msmetafile","mny":"application/x-msmoney","pub":"application/x-mspublisher","scd":"application/x-msschedule","trm":"application/x-msterminal","wri":"application/x-mswrite","nc":"application/x-netcdf","cdf":"application/x-netcdf","pac":"application/x-ns-proxy-autoconfig","nzb":"application/x-nzb","pl":"application/x-perl","pm":"application/x-perl","prc":"application/x-pilot","pdb":"application/x-pilot","p12":"application/x-pkcs12","pfx":"application/x-pkcs12","p7b":"application/x-pkcs7-certificates","spc":"application/x-pkcs7-certificates","p7r":"application/x-pkcs7-certreqresp","rar":"application/x-rar-compressed","rpm":"application/x-redhat-package-manager","ris":"application/x-research-info-systems","sea":"application/x-sea","sh":"application/x-sh","shar":"application/x-shar","swf":"application/x-shockwave-flash","xap":"application/x-silverlight-app","sql":"application/x-sql","sit":"application/x-stuffit","sitx":"application/x-stuffitx","srt":"application/x-subrip","sv4cpio":"application/x-sv4cpio","sv4crc":"application/x-sv4crc","t3":"application/x-t3vm-image","gam":"application/x-tads","tar":"application/x-tar","tcl":"application/x-tcl","tk":"application/x-tcl","tex":"application/x-tex","tfm":"application/x-tex-tfm","texinfo":"application/x-texinfo","texi":"application/x-texinfo","obj":"application/x-tgif","ustar":"application/x-ustar","hdd":"application/x-virtualbox-hdd","ova":"application/x-virtualbox-ova","ovf":"application/x-virtualbox-ovf","vbox":"application/x-virtualbox-vbox","vbox-extpack":"application/x-virtualbox-vbox-extpack","vdi":"application/x-virtualbox-vdi","vhd":"application/x-virtualbox-vhd","vmdk":"application/x-virtualbox-vmdk","src":"application/x-wais-source","webapp":"application/x-web-app-manifest+json","der":"application/x-x509-ca-cert","crt":"application/x-x509-ca-cert","pem":"application/x-x509-ca-cert","fig":"application/x-xfig","xlf":"application/x-xliff+xml","xpi":"application/x-xpinstall","xz":"application/x-xz","z1":"application/x-zmachine","z2":"application/x-zmachine","z3":"application/x-zmachine","z4":"application/x-zmachine","z5":"application/x-zmachine","z6":"application/x-zmachine","z7":"application/x-zmachine","z8":"application/x-zmachine","uva":"audio/vnd.dece.audio","uvva":"audio/vnd.dece.audio","eol":"audio/vnd.digital-winds","dra":"audio/vnd.dra","dts":"audio/vnd.dts","dtshd":"audio/vnd.dts.hd","lvp":"audio/vnd.lucent.voice","pya":"audio/vnd.ms-playready.media.pya","ecelp4800":"audio/vnd.nuera.ecelp4800","ecelp7470":"audio/vnd.nuera.ecelp7470","ecelp9600":"audio/vnd.nuera.ecelp9600","rip":"audio/vnd.rip","aac":"audio/x-aac","aif":"audio/x-aiff","aiff":"audio/x-aiff","aifc":"audio/x-aiff","caf":"audio/x-caf","flac":"audio/x-flac","m4a":"audio/x-m4a","mka":"audio/x-matroska","m3u":"audio/x-mpegurl","wax":"audio/x-ms-wax","wma":"audio/x-ms-wma","ram":"audio/x-pn-realaudio","ra":"audio/x-pn-realaudio","rmp":"audio/x-pn-realaudio-plugin","ra":"audio/x-realaudio","wav":"audio/x-wav","cdx":"chemical/x-cdx","cif":"chemical/x-cif","cmdf":"chemical/x-cmdf","cml":"chemical/x-cml","csml":"chemical/x-csml","xyz":"chemical/x-xyz","btif":"image/prs.btif","psd":"image/vnd.adobe.photoshop","uvi":"image/vnd.dece.graphic","uvvi":"image/vnd.dece.graphic","uvg":"image/vnd.dece.graphic","uvvg":"image/vnd.dece.graphic","djvu":"image/vnd.djvu","djv":"image/vnd.djvu","sub":"image/vnd.dvb.subtitle","dwg":"image/vnd.dwg","dxf":"image/vnd.dxf","fbs":"image/vnd.fastbidsheet","fpx":"image/vnd.fpx","fst":"image/vnd.fst","mmr":"image/vnd.fujixerox.edmics-mmr","rlc":"image/vnd.fujixerox.edmics-rlc","mdi":"image/vnd.ms-modi","wdp":"image/vnd.ms-photo","npx":"image/vnd.net-fpx","wbmp":"image/vnd.wap.wbmp","xif":"image/vnd.xiff","3ds":"image/x-3ds","ras":"image/x-cmu-raster","cmx":"image/x-cmx","fh":"image/x-freehand","fhc":"image/x-freehand","fh4":"image/x-freehand","fh5":"image/x-freehand","fh7":"image/x-freehand","ico":"image/x-icon","jng":"image/x-jng","sid":"image/x-mrsid-image","bmp":"image/x-ms-bmp","pcx":"image/x-pcx","pic":"image/x-pict","pct":"image/x-pict","pnm":"image/x-portable-anymap","pbm":"image/x-portable-bitmap","pgm":"image/x-portable-graymap","ppm":"image/x-portable-pixmap","rgb":"image/x-rgb","tga":"image/x-tga","xbm":"image/x-xbitmap","xpm":"image/x-xpixmap","xwd":"image/x-xwindowdump","dae":"model/vnd.collada+xml","dwf":"model/vnd.dwf","gdl":"model/vnd.gdl","gtw":"model/vnd.gtw","mts":"model/vnd.mts","vtu":"model/vnd.vtu","dsc":"text/prs.lines.tag","curl":"text/vnd.curl","dcurl":"text/vnd.curl.dcurl","mcurl":"text/vnd.curl.mcurl","scurl":"text/vnd.curl.scurl","sub":"text/vnd.dvb.subtitle","fly":"text/vnd.fly","flx":"text/vnd.fmi.flexstor","gv":"text/vnd.graphviz","3dml":"text/vnd.in3d.3dml","spot":"text/vnd.in3d.spot","jad":"text/vnd.sun.j2me.app-descriptor","wml":"text/vnd.wap.wml","wmls":"text/vnd.wap.wmlscript","s":"text/x-asm","asm":"text/x-asm","c":"text/x-c","cc":"text/x-c","cxx":"text/x-c","cpp":"text/x-c","h":"text/x-c","hh":"text/x-c","dic":"text/x-c","htc":"text/x-component","f":"text/x-fortran","for":"text/x-fortran","f77":"text/x-fortran","f90":"text/x-fortran","hbs":"text/x-handlebars-template","java":"text/x-java-source","lua":"text/x-lua","mkd":"text/x-markdown","nfo":"text/x-nfo","opml":"text/x-opml","org":"text/x-org","p":"text/x-pascal","pas":"text/x-pascal","pde":"text/x-processing","sass":"text/x-sass","scss":"text/x-scss","etx":"text/x-setext","sfv":"text/x-sfv","ymp":"text/x-suse-ymp","uu":"text/x-uuencode","vcs":"text/x-vcalendar","vcf":"text/x-vcard","uvh":"video/vnd.dece.hd","uvvh":"video/vnd.dece.hd","uvm":"video/vnd.dece.mobile","uvvm":"video/vnd.dece.mobile","uvp":"video/vnd.dece.pd","uvvp":"video/vnd.dece.pd","uvs":"video/vnd.dece.sd","uvvs":"video/vnd.dece.sd","uvv":"video/vnd.dece.video","uvvv":"video/vnd.dece.video","dvb":"video/vnd.dvb.file","fvt":"video/vnd.fvt","mxu":"video/vnd.mpegurl","m4u":"video/vnd.mpegurl","pyv":"video/vnd.ms-playready.media.pyv","uvu":"video/vnd.uvvu.mp4","uvvu":"video/vnd.uvvu.mp4","viv":"video/vnd.vivo","f4v":"video/x-f4v","fli":"video/x-fli","flv":"video/x-flv","m4v":"video/x-m4v","mkv":"video/x-matroska","mk3d":"video/x-matroska","mks":"video/x-matroska","mng":"video/x-mng","asf":"video/x-ms-asf","asx":"video/x-ms-asf","vob":"video/x-ms-vob","wm":"video/x-ms-wm","wmv":"video/x-ms-wmv","wmx":"video/x-ms-wmx","wvx":"video/x-ms-wvx","avi":"video/x-msvideo","movie":"video/x-sgi-movie","smv":"video/x-smv","ice":"x-conference/x-cooltalk"};FileUploadEditor.prototype.createElements=function(){Handsontable.editors.TextEditor.prototype.createElements.apply(this,arguments);this.UPLOADINPUT=document.createElement('input');this.UPLOADINPUT.setAttribute('type','file');this.UPLOADINPUT.setAttribute('id',uploadId);this.UPLOADINPUT.className='handsontableInput';this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.textareaStyle.display='none';this.TEXTAREA_PARENT.appendChild(this.UPLOADINPUT);};FileUploadEditor.prototype.prepare=function(){Handsontable.editors.TextEditor.prototype.prepare.apply(this,arguments);$("#"+uploadId).css("width","0");$("#"+uploadId).css("height","0");$("#"+uploadId).css("display","none");$("#"+uploadId).replaceWith($("#"+uploadId).val('').clone(true));};FileUploadEditor.prototype.focus=function(){};FileUploadEditor.prototype.beginEditing=function(){Handsontable.editors.TextEditor.prototype.beginEditing.apply(this,arguments);var meta=this.cellProperties;var o=meta.jsonProp;var acceptedFiles=o.fileType.replace(/;/g,',');var fileTypes=o.fileType.split(";");for(var i in fileTypes){var ext=fileTypes[i];var mime=typemap[ext.substring(1)];if(mime!==undefined){acceptedFiles+=","+mime;}}
if(acceptedFiles!==undefined&&acceptedFiles!==null&&acceptedFiles.length>0){$('#'+uploadId).attr('accept',acceptedFiles);}else{if(this.cellProperties.jFormatType==="image"){$('#'+uploadId).attr('accept',"image/*");}else{$('#'+uploadId).removeAttr('accept');}}
var uploadArea=this;$('#'+uploadId).off("change");$('#'+uploadId).on("change",function(){var file=$(this).prop('files')[0];if(file){var data=new FormData();data.append("fileUpload",file);meta['error']="";if(o.maxSize!==undefined&&o.maxSize!==""){var size=0;try{size=parseInt(o.maxSize);if(size>0&&file.size>(size*1024)){meta['error']=o.maxSizeMsg;uploadArea.instance.getActiveEditor().finishEditing();return;}}catch(err){}}
$('#'+uploadId).parent().prepend('<img style="padding:2px 5px;" src="'+meta.contextPath+'/images/v3/loading.gif" />');var url=meta.serviceUrl+"&_a=upload&_field="+encodeURIComponent(meta.data)+"&_formDefId="+encodeURIComponent(meta.formDefId)+"&_type="+encodeURIComponent(meta.jFormatType);if(meta.jFormatType==="image"){var width=60;try{width=parseInt(o.width);}catch(err){}
var height=60;try{height=parseInt(o.height);}catch(err){}
url+="&_width="+encodeURIComponent(width)+"&_height="+encodeURIComponent(height);}
$.ajax({url:url,type:'POST',data:data,cache:false,dataType:'json',processData:false,contentType:false,success:function(data,textStatus,jqXHR)
{if(typeof data.error==='undefined')
{var value=data.newFilename;var filePaths=[data.path];if(o.multiple==="true"){var exist=uploadArea.instance.getDataAtRowProp(uploadArea.row,meta.data);if(exist!==undefined&&exist!==null&&exist!==""){var values=exist.split(";");if(values.indexOf(value)===-1){value=exist+";"+value;}}
var existPath=uploadArea.instance.getDataAtRowProp(uploadArea.row,"_tempFilePathMap."+meta.data);if(existPath!==undefined&&existPath!==null&&existPath.length>0){var newExistPath=[];for(var i=0;i<existPath.length;i++){if(existPath[i].indexOf(value)===-1){newExistPath.push(existPath[i]);}}
filePaths=newExistPath.concat(filePaths);}}else if(o.removeFile==="true"){var exist=uploadArea.instance.getDataAtRowProp(uploadArea.row,meta.data);var existPath=uploadArea.instance.getDataAtRowProp(uploadArea.row,"_tempFilePathMap."+meta.data);var inExistPath=false;if(existPath!==undefined&&existPath!==null&&existPath.length>0){for(var i=0;i<existPath.length;i++){if(existPath[i].indexOf(exist)!==-1){inExistPath=true;break;}}}
var deletePath=uploadArea.instance.getDataAtRowProp(uploadArea.row,"_deleteFilePathMap."+meta.data);if(deletePath===undefined||deletePath===null){deletePath=[];}
if(!inExistPath){deletePath.push(exist);if(meta.jFormatType==="image"){deletePath.push(exist+".thumb.jpg");}}
uploadArea.instance.setDataAtRowProp(uploadArea.row,"_deleteFilePathMap."+meta.data,deletePath,"upload_field");}
uploadArea.instance.setDataAtRowProp(uploadArea.row,meta.data,value,"edit");uploadArea.instance.setDataAtRowProp(uploadArea.row,"_tempFilePathMap."+meta.data,filePaths,"upload_field");if(meta.jFormatType==="image"){var thumbs=[data.path+".thumb.jpg"];if(o.multiple==="true"){var existThumbPath=uploadArea.instance.getDataAtRowProp(uploadArea.row,"_tempFilePathMap."+meta.data+"_thumbnail");if(existThumbPath!==undefined&&existThumbPath!==null&&existThumbPath.length>0){var newExistThumbPath=[];for(var i=0;i<existThumbPath.length;i++){if(existThumbPath[i].indexOf(value)===-1){newExistThumbPath.push(existThumbPath[i]);}}
thumbs=newExistThumbPath.concat(thumbs);}}
uploadArea.instance.setDataAtRowProp(uploadArea.row,"_tempFilePathMap."+meta.data+"_thumbnail",thumbs,"upload_field");}}else{meta['error']=data.error;}
$('#'+uploadId).parent().find("img").remove();uploadArea.instance.getActiveEditor().finishEditing();},error:function(jqXHR,textStatus,errorThrown)
{$('#'+uploadId).parent().find("img").remove();uploadArea.instance.getActiveEditor().finishEditing();}});}});$('#'+uploadId).click();};Handsontable.editors.FileUploadEditor=FileUploadEditor;Handsontable.editors.registerEditor('file',FileUploadEditor);})(Handsontable);(function($){if(!String.prototype.startsWith){String.prototype.startsWith=function(searchString,position){position=position||0;return this.indexOf(searchString,position)===position;};}
var methods={init:function(args,i18n){return this.each(function(){JSpreadShetFormDataLoader.url=args.serviceURL;var thisObj=$(this);var hot;var colHeaders=[];var columns=[];var colWidths=[];var customColWidth=false;var formulaRefs={};var formulaColumns={};var oriFormulaColumns={};var ajaxOptionsColumns={};var checkboxes=[];var dataSchema={id:""};var convertToBe=function(date){var year=date.getFullYear();if((parseInt(year)-543)<1900){year=parseInt(year)+543;date.setFullYear(year);}
return date;};var optionsRenderer=function(instance,td,row,col,prop,value,cellProperties){var optionsList=cellProperties.keyOptions;var foundValue="";value=value+"";for(var index=0;index<optionsList.length;index++){if(value===optionsList[index].value+""){foundValue=optionsList[index].label.trim();}}
value=foundValue;Handsontable.renderers.AutocompleteRenderer.apply(this,arguments);};var dateRenderer=function(instance,td,row,col,prop,value,cellProperties){if(cellProperties.dateDisplayFormat!==undefined&&value!==undefined&&value!==""){var d=new Date(getDateFromFormat(value,methods.getDateFormat(cellProperties.dateFormat)));if(cellProperties.isBE){d=convertToBe(d);}
value=formatDate(d,methods.getDateFormat(cellProperties.dateDisplayFormat));}else if(cellProperties.isBE&&value!==undefined&&value!==""){var d=new Date(getDateFromFormat(value,methods.getDateFormat(cellProperties.dateFormat)));d=convertToBe(d);value=formatDate(d,methods.getDateFormat(cellProperties.dateFormat));}
Handsontable.renderers.AutocompleteRenderer.apply(this,arguments);};var fileRenderer=function(instance,td,row,col,prop,values,cellProperties){if(values){var type=cellProperties.jFormatType;var formDefId=cellProperties.formDefId;var readonly=cellProperties.readOnly;var tempPath=instance.getDataAtRowProp(row,"_tempFilePathMap."+prop);var id=instance.getDataAtRowProp(row,"id");$(td).html('');$(td).append("<div class=\"file_container\"></div>");var valuesList=values.split(";");$.each(valuesList,function(i,value){var fileContainer=$('<div class="filename_container"></div>');var isTemp=false;if(tempPath!==null&&tempPath!==undefined&&tempPath.length>0){for(var i=0;i<tempPath.length;i++){if(tempPath[i].indexOf(value)!==-1){isTemp=true;}}}
if(type==="image"){var o=cellProperties.jsonProp;var width=60;try{width=parseInt(o.width);}catch(err){}
var height=60;try{height=parseInt(o.height);}catch(err){}
var thumbLink="";if(isTemp){var thumbTempPath=instance.getDataAtRowProp(row,"_tempFilePathMap."+prop+"_thumbnail");if(thumbTempPath!==undefined&&thumbTempPath!==null&&thumbTempPath.length>0){for(var i=0;i<thumbTempPath.length;i++){if(thumbTempPath[i].indexOf(value)!==-1){thumbLink=cellProperties.serviceUrl+"&_a=upload&_path="+encodeURIComponent(thumbTempPath[i]);}}}}else{var encodedFileName=encodeURIComponent(value);if(id!==undefined&&id!==null&&id!==""){thumbLink=args.contextPath+"/web/client/app/"+args.appId+"/"+args.appVersion+"/form/download/"+formDefId+"/"+id+"/"+encodedFileName+".thumb.jpg.?t="+Date.now();}}
$(fileContainer).append('<img src="'+thumbLink+'" style="width:'+width+'px;height:'+height+'px;margin:auto;" /><br/>');}
if(isTemp){$(fileContainer).append('<span class="filename">'+value+'</span>');}else if(id!==undefined&&id!==null){var encodedFileName=encodeURIComponent(value);var link=args.contextPath+"/web/client/app/"+args.appId+"/"+args.appVersion+"/form/download/"+formDefId+"/"+id+"/"+encodedFileName+".?attachment=true";$(fileContainer).append('<a target="_blank" href="'+link+'"><span class="filename">'+value+'</span></a>');}
$(td).find(".file_container").append(fileContainer);});if(!readonly){var delOpt=$('<span class="file_delete" href="#">'+args.msg_delete+'</span>');delOpt.click(function(){var filename=$(this).parent().find(".filename").text();var exist=instance.getDataAtRowProp(row,prop);if(exist!==undefined&&exist!==null&&exist!==""){var newValues=[]
var values=exist.split(";");for(var i=0;i<values.length;i++){if(values[i]!==filename){newValues.push(values[i]);}}
exist=newValues.join(";");}
var existPath=instance.getDataAtRowProp(row,"_tempFilePathMap."+prop);var inExistPath=false;if(existPath!==undefined&&existPath!==null&&existPath.length>0){var newExistPath=[];for(var i=0;i<existPath.length;i++){if(existPath[i].indexOf(filename)===-1){newExistPath.push(existPath[i]);}else{inExistPath=true;}}
existPath=newExistPath;}
instance.setDataAtRowProp(row,prop,exist,"edit");instance.setDataAtRowProp(row,"_tempFilePathMap."+prop,existPath,"upload_field");if(type==="image"){var existThumbPath=instance.getDataAtRowProp(row,"_tempFilePathMap."+prop+"_thumbnail");if(existThumbPath!==undefined&&existThumbPath!==null&&existThumbPath.length>0){var newExistThumbPath=[];for(var i=0;i<existThumbPath.length;i++){if(existThumbPath[i].indexOf(filename)===-1){newExistThumbPath.push(existThumbPath[i]);}}
existThumbPath=newExistThumbPath;}
instance.setDataAtRowProp(row,"_tempFilePathMap."+prop+"_thumbnail",existThumbPath,"upload_field");}
if(cellProperties.jsonProp.removeFile==="true"){var deletePath=instance.getDataAtRowProp(row,"_deleteFilePathMap."+prop);if(deletePath===undefined||deletePath===null){deletePath=[];}
if(!inExistPath){deletePath.push(filename);if(type==="image"){deletePath.push(filename+".thumb.jpg");}}
instance.setDataAtRowProp(row,"_deleteFilePathMap."+prop,deletePath,"upload_field");}});$(td).find(".filename_container").append(delOpt);}
if(cellProperties['error']!==undefined&&cellProperties['error']!==""){$(td).append('<div class="error" style="color:red;">'+cellProperties['error']+'</div>');}}else if(cellProperties['error']!==undefined&&cellProperties['error']!==""){$(td).html('');$(td).append('<div class="error" style="color:red;">'+cellProperties['error']+'</div>');}else{Handsontable.renderers.TextRenderer.apply(this,arguments);}};var urlRenderer=function(instance,td,row,col,prop,value,cellProperties){if(value){var urlSyntax=cellProperties.urlSyntax;var url=urlSyntax;var res=urlSyntax.match(/\{([a-zA-Z0-9_]+)\}/g);for(var r in res){var v=res[r].replace("{","").replace("}","");try{url=url.replace(res[r],instance.getDataAtRowProp(row,v));}catch(err){url=url.replace(res[r],"");}}
$(td).html('');$(td).append("<div class=\"url_container\" style=\"margin:0 5px;\"></div>");$(td).find(".url_container").append("<a target='_blank' href='"+url+"'>"+value+"</a>");}else{Handsontable.renderers.TextRenderer.apply(this,arguments);}};var regexCustomvalidator=function(value,callback){var meta=this.instance.getCellMeta(this.row,this.col);var regex=meta.regexValidator;var rg=new RegExp(regex,'g');setTimeout(function(){if(rg.test(value)){callback(true);}else{callback(false);}},500);};var ccode=97;for(var i in args.headers){var value=args.headers[i]["value"];if(value.match(/\d+/g)!==null){formulaRefs['iternalfield'+String.fromCharCode(ccode++)]=value;}}
for(var i in args.headers){var h=args.headers[i];if(h["formatType"]!=="hidden"){colHeaders.push(h["label"]);}
if(h["formatType"]==="hidden"&&h["format"]!==undefined&&h["format"]!==""){dataSchema[h["value"]]=h["format"];}else if(h["formatType"]==="checkbox"){dataSchema[h["value"]]=null;checkboxes.push(h["value"]);if(args.data!==null&&args.data!==undefined&&args.data.length>0){for(var k in args.data){if(args.data[k][h["value"]]===""||args.data[k][h["value"]]==="null"){args.data[k][h["value"]]="false";}}}}else{dataSchema[h["value"]]="";}
var cwidth=10;if(h["width"]!==null&&h["width"]!==undefined&&h["width"]!==""){try{cwidth=parseInt(h["width"]);}catch(werr){}
customColWidth=true;}
colWidths.push(cwidth);var col={data:h["value"]};var config=null;if(h["formatType"]!==null&&h["formatType"]!==undefined&&h["format"].indexOf("{{")!==-1&&h["format"].indexOf("}}")!==-1){config=h["format"].substring(h["format"].indexOf("{{")+1,h["format"].lastIndexOf("}}")+1);h["format"]=h["format"].substring(0,h["format"].indexOf("{{"));}
if(h["formatType"]!==null&&h["formatType"]!==undefined&&h["formatType"]!==""){col["jFormatType"]=h["formatType"];if(h["formatType"]==="custom"||h["formatType"]==="file"||h["formatType"]==="image"||h["formatType"]==="file"||h["formatType"]==="hidden"||h["formatType"]==="url"){}else{col["type"]=h["formatType"];}
if(h["format"]!==""){if(h["formatType"]==="file"||h["formatType"]==="image"){col["renderer"]=fileRenderer;col["editor"]='file';col["formDefId"]=h["format"];col["serviceUrl"]=args.serviceURL;col["contextPath"]=args.contextPath;if(col["formDefId"].indexOf("::")!==-1){var temp=col["formDefId"].split("::");col["formDefId"]=temp[0];col["jsonProp"]=(eval("["+temp[1]+"]"))[0];}}else if(h["formatType"]==="autocomplete"||h["formatType"]==="dropdown"){if(h["format"].indexOf("http")===0){col["source"]=function(query,process){$.ajax({url:h["format"],dataType:'json',data:{query:query},success:function(response){process(response);}});};col["strict"]=true;}else if(h["format"].indexOf("OPTIONS_USE_AJAX")!==-1){try{var options=eval("["+h["format"]+"]");col["ajaxSourceOptions"]=options[0];var keyOptions=eval(options[0]['OPTIONS']);col["keyOptions"]=keyOptions;ajaxOptionsColumns[h["value"]]=options[0].OPTIONS_AJAX_CONTROL_FIELD;}catch(err){}
col["source"]=function(query,process){var selected=hot.getSelected()[0];var row=selected[0];var col=selected[1];var meta=hot.getCellMeta(row,col);var o=meta.ajaxSourceOptions;var cf=o.OPTIONS_AJAX_CONTROL_FIELD.split(";");var cv="";for(var i in cf){if(cv!==""){cv+=";";}
cv+=hot.getDataAtRowProp(row,cf[i]);}
if(meta.ajaxControlValue===cv){var labels=[];for(var i=0;i<meta.keyOptions.length;i++){labels.push(meta.keyOptions[i].label.trim());}
process(labels);}else{$.getJSON(args.contextPath+"/web/json/app/"+o.OPTIONS_AJAX_APP_ID+"/"+o.OPTIONS_AJAX_APP_VERSION+"/form/options",{_dv:cv,_n:o.OPTIONS_AJAX_NONCE,_bd:o.OPTIONS_AJAX_BINDER_DATA},function(data){var labels=[];var keyOptions=[];for(var i=0,len=data.length;i<len;i++){labels.push(data[i].label.trim());keyOptions.push({value:data[i].value,label:data[i].label.trim()});}
hot.setCellMeta(row,col,"ajaxControlValue",cv);hot.setCellMeta(row,col,"keyOptions",keyOptions);process(labels);});}};col["renderer"]=optionsRenderer;col["editor"]=h["formatType"];col["strict"]=false;col["validator"]=function(value,callback){callback(true);};}else if(h["format"].indexOf("[")===0&&h["format"].substr(h["format"].length-1)==="]"){var options=[];var labels=[];try{options=eval(h["format"]);for(var o in options){labels.push(options[o].label.trim());}}catch(err){}
col["keyOptions"]=options;col["renderer"]=optionsRenderer;col["editor"]=h["formatType"];col["source"]=labels;col["strict"]=false;col["validator"]=function(value,callback){callback(true);};}else if(h["format"].indexOf(";")!==-1){col["source"]=h["format"].split(";");col["strict"]=true;}}else if(h["formatType"]==="numeric"){var lang='en-US';if((h["format"].indexOf("0,0")!==-1&&h["format"].indexOf(".")===-1)||h["format"].indexOf("0.000,0")!==-1||h["format"].indexOf("0.0,0")!==-1){lang="de-DE";h["format"]=h["format"].replace(",","|");h["format"]=h["format"].replace(".",",");h["format"]=h["format"].replace("|",".");}
col["type"]='numeric';col["numericFormat"]={pattern:h["format"],culture:lang};}else if(h["formatType"]==="date"){var format=h["format"];var dateFormat=format.split('|');if(dateFormat.length===2){col["dateDisplayFormat"]=dateFormat[1];format=dateFormat[0];col["renderer"]=dateRenderer;}
col["dateFormat"]=format.toUpperCase();}else if(h["formatType"]==="time"){col["timeFormat"]=h["format"];}else if(h["formatType"]==="url"){col["renderer"]=urlRenderer;col["editor"]="text";col["urlSyntax"]=h["format"];}}}else{col["type"]="text";}
if(h["regexValidator"]!==null&&h["regexValidator"]!==undefined&&h["regexValidator"]!==""){col["regexValidator"]=h["regexValidator"];col["validator"]=regexCustomvalidator;col["allowInvalid"]=true;}
if(h["formula"]!==null&&h["formula"]!==undefined&&h["formula"]!==""){oriFormulaColumns[h["value"]]=h["formula"];var formula=h["formula"];var rkeys=Object.keys(formulaRefs);for(var r in rkeys){formula=formula.replace(new RegExp("(^|[^a-zA-Z0-9])("+methods.escapeRegex(formulaRefs[rkeys[r]])+")($|[^a-zA-Z0-9])",'g'),"$1"+methods.escapeRegex(rkeys[r])+"$3");}
formulaColumns[h["value"]]=formula;}
if(h["readonly"]==="true"||args.readonly==="true"){col["readOnly"]=true;col["editor"]=false;}
if(config!==null&&config!==""){try{config="["+config+"]";var confObj=eval(config);confObj=confObj[0];col=$.extend(col,confObj);}catch(err){}}
if(h["formatType"]==="date"&&(col["dateFormat"]===undefined||col["dateFormat"]==="")){col["dateFormat"]="DD/MM/YYYY";}else if(h["formatType"]==="time"&&(col["timeFormat"]===undefined||col["timeFormat"]==="")){col["timeFormat"]="h:mm:ss a";}
if(h["formatType"]==="date"){col["correctFormat"]=true;col["datePickerConfig"]={i18n:i18n.datepicker};if(args.isBE){col["isBE"]=args.isBE;col["renderer"]=dateRenderer;col["datePickerConfig"]['onDraw']=function(picker){var yearselect=$(picker.el).find(".pika-select-year");$(yearselect).find("option").each(function(){$(this).text(parseInt($(this).text())+543);});$(yearselect).parent().contents().filter(function(){return this.nodeType===3;}).each(function(){this.textContent=parseInt(this.textContent)+543;});var value=$(this.field).val();if(value!==undefined&&value!==null&&value!==""){var d=new Date(getDateFromFormat(value,methods.getDateFormat(this.format)));d=convertToBe(d);value=formatDate(d,methods.getDateFormat(this.format));$(this.field).val(value);}};}}else if(h["formatType"]==="time"){col["correctFormat"]=true;}
if(h["formatType"]!=="hidden"){columns.push(col);}}
var fixRows=0;var fixCols=0;if(args.fixedColumnsLeft!==null&&args.fixedColumnsLeft!==undefined&&args.fixedColumnsLeft!==""){args.fixedColumnsLeft=args.fixedColumnsLeft.replace(/[^0-9]/g,"");try{fixCols=parseInt(args.fixedColumnsLeft);}catch(err){}}
var adjustHeight=function(h){var height=$(thisObj).find(".ht_master .wtHider").height()+50;var maxheight=$(thisObj).data("maxheight");var fixedHeight=false;if(maxheight!==""){var temp=$("<div style=\"height:0px;overflow:hidden;\"><div class=\"spreadsheet-height\" style=\"height:"+maxheight+";\"></div></div>");$(thisObj).append(temp);var maxValue=$(temp).find(".spreadsheet-height").height();temp.remove();if(height>maxValue){height=maxValue;fixedHeight=true;}}
h.updateSettings({height:height});h.render();if(fixedHeight){$(thisObj).css("overflow","hidden !important");}};var settings={data:args.data,dataSchema:dataSchema,stretchH:'all',autoWrapRow:true,rowHeaders:args.showRowNumber==="true",height:50,allowInsertColumn:false,allowRemoveColumn:false,columns:columns,colHeaders:colHeaders,manualColumnResize:true,manualRowResize:true,fixedRowsTop:fixRows,fixedColumnsLeft:fixCols,columnSorting:args.headerSorting==="true",sortIndicator:true,searchBoolean:true,undo:true};thisObj.find(".jsonDataContainer").val(JSON.stringify(args.data));var customEvents={};var events={afterSelection:function(r,c,r2,c2){if($(thisObj).hasClass("mobile")){var ht=this;var activeEditor=ht.getActiveEditor();if(activeEditor!==null&&activeEditor!==undefined){activeEditor.finishEditing();}
if(c===c2){setTimeout(function(){if(!$(thisObj).hasClass("ht__selection--columns")){var editor=ht.getActiveEditor();if(editor!==null&&editor!==undefined){editor.enableFullEditMode();editor.beginEditing();}}},100);}}
if(customEvents['afterSelection']!==undefined){customEvents['afterSelection'](r,c,r2,c2);}},afterBeginEditing:function(row,col){var ht=this;var meta=ht.getCellMeta(row,col);if(meta.keyOptions!==undefined){var value=ht.getDataAtCell(row,col);for(var o in meta.keyOptions){if(value===meta.keyOptions[o].value){ht.setDataAtCell(row,col,meta.keyOptions[o].label.trim(),"key-value-options-label");if(meta.filter===undefined||meta.filter){var activeEditor=ht.getActiveEditor();setTimeout(function(){activeEditor.queryChoices(meta.keyOptions[o].label.trim());},100);}
break;}}}
if(customEvents['afterBeginEditing']!==undefined){customEvents['afterBeginEditing'](row,col);}},afterChange:function(change,source){var ht=this;if(source==="formula"||source==="checkbox"){return;}
if(change!==null&&change!==undefined&&!$.isArray(change[0])){change=[change];}
if(source==="edit"){var col=ht.propToCol(change[0][1]);var meta=ht.getCellMeta(change[0][0],col);if(meta.keyOptions!==undefined){var label=change[0][3];var isFound=false;for(var o in meta.keyOptions){if(label.trim()===meta.keyOptions[o].label.trim()){ht.setDataAtRowProp(change[0][0],change[0][1],meta.keyOptions[o].value,"key-value-options");isFound=true;break;}}
if(!isFound){ht.setDataAtRowProp(change[0][0],change[0][1],"","key-value-options");}}
if(checkboxes.length>0){for(var j in checkboxes){var tempValue=ht.getDataAtRowProp(change[0][0],checkboxes[j]);if(tempValue===null){ht.setDataAtRowProp(change[0][0],checkboxes[j],"false","checkbox");}}}}
var d=this.getSourceData();var calculate=function(row,rowData,changedFields){var parser=new formulaParser.Parser();parser.on('callVariable',function(name,done){if(formulaRefs[name]!==undefined){name=formulaRefs[name];}
var value;if(rowData[name]!==null&&rowData[name]!==undefined){value=rowData[name];}else{value="";}
var tcol=ht.propToCol(name);var tmeta=ht.getCellMeta(change[0][0],tcol);var type=tmeta.type;if(type==="numeric"){if(value===""){value=0;}
var number=numbro().unformat(value);if(number===undefined){done(value);}else{done(number);}}else if(type==="date"){var dateFormat=tmeta.dateFormat;if(dateFormat!==null&&dateFormat!==undefined&&dateFormat!==""&&value!==""){var currentDate=moment(value,dateFormat);currentDate=currentDate.toDate();if(currentDate!==null&&currentDate!==undefined){value=currentDate.getMonth()+1+"/"+currentDate.getDate()+"/"+currentDate.getFullYear();}}
done(value);}else{done(value);}});var newChangedFields=[];for(var k in keys){try{var key=keys[k];var currentFormula=oriFormulaColumns[key];var hasChangedFieldInFormula=false;for(var cf in changedFields){var re=new RegExp("([^'\"a-zA-Z0-9]|^)"+changedFields[cf]+"([^'\"a-zA-Z0-9]|$)");if(currentFormula.match(re)!==null){hasChangedFieldInFormula=true;break;}}
if(hasChangedFieldInFormula){var result=parser.parse(formulaColumns[key]);var value=result.result;rowData[key]=value;ht.setDataAtRowProp(row,key,value,"formula");newChangedFields.push(key);}}catch(err){}}
if(newChangedFields.length>0){calculate(row,rowData,newChangedFields);}};var keys=Object.keys(formulaColumns);if(keys.length>0){if(source!=='loadData'&&source!=="key-value-options-label"){var ccol=ht.propToCol(change[0][1]);var meta=ht.getCellMeta(change[0][0],ccol);if(!(source==='edit'&&meta.keyOptions!==undefined)){for(var i in change){var row=change[i][0];calculate(row,d[row],[change[i][1]]);}}}}
var akeys=Object.keys(ajaxOptionsColumns);if(akeys.length>0){if(source!=='loadData'&&source!=='key-value-options-label'){for(var i in change){var row=change[i][0];var prop=change[i][1];var isLabel=null;for(var ck in akeys){var k=akeys[ck];var controlFields=ajaxOptionsColumns[k].split(";");if($.inArray(prop,controlFields)!==-1){if(isLabel===null){var tcol=ht.propToCol(prop);var meta=ht.getCellMeta(row,tcol);if(meta.keyOptions!==undefined&&source!=="key-value-options"){isLabel=true;}else{isLabel=false;}}
if(!isLabel){var t2col=ht.propToCol(k);var t2meta=ht.getCellMeta(row,t2col);if(t2meta.ajaxControlValue!==change[i][3]){ht.setDataAtRowProp(row,k,"","ajax-options-control-changed");}}}}}}}
d=this.getSourceData();if(args.readonly!=="true"&&args.minSpareRows!=="0"){try{var row=parseInt(args.minSpareRows);if(row>0){var originalTotal=eval(thisObj.find(".jsonDataContainer").val()).length;var totalRows=d.length;if(change!==null&&change[change.length-1][0]>=originalTotal){originalTotal=change[change.length-1][0]+1;}
if(totalRows>originalTotal){d=d.slice(0,((totalRows-originalTotal)*-1));}}}catch(err){}}
if(customEvents['afterChange']!==undefined){customEvents['afterChange'](change,source);}
var newData=[];for(var i=0;i<d.length;i++){var ni=this.toPhysicalRow(i);newData.push(d[ni]);}
d=newData;thisObj.data("gridDataObject",d);thisObj.find(".jsonDataContainer").val(JSON.stringify(d));adjustHeight(this);thisObj.trigger("change");},afterCreateRow:function(index,amount,source){if(customEvents['afterCreateRow']!==undefined){customEvents['afterRowResize'](index,amount,source);}
var originalTotal=eval(thisObj.find(".jsonDataContainer").val()).length;if(index<originalTotal){var d=this.getSourceData();var newData=[];for(var i=0;i<d.length-args.minSpareRows;i++){var ni=this.toPhysicalRow(i);newData.push(d[ni]);}
d=newData;thisObj.data("gridDataObject",d);thisObj.find(".jsonDataContainer").val(JSON.stringify(d));adjustHeight(this);thisObj.trigger("change");}},afterRemoveRow:function(index,amount){var d=this.getSourceData();if(args.readonly!=="true"){try{var row=parseInt(args.minSpareRows);if(row>0){var totalRow=d.length+amount;var nonSpare=totalRow-row;var removedEmptyRow=(index+amount>=nonSpare)?(index+amount-nonSpare):0;var remainingEmptyRow=row-removedEmptyRow;if(remainingEmptyRow>0){d=d.slice(0,(remainingEmptyRow*-1));}}}catch(err){}}
if(customEvents['afterRemoveRow']!==undefined){customEvents['afterRemoveRow'](index,amount);}
var newData=[];for(var i=0;i<d.length;i++){var ni=this.toPhysicalRow(i);newData.push(d[ni]);}
d=newData;thisObj.data("gridDataObject",d);thisObj.find(".jsonDataContainer").val(JSON.stringify(d));adjustHeight(this);thisObj.trigger("change");},afterRowResize:function(currentRow,newSize,isDoubleClick){if(customEvents['afterRowResize']!==undefined){customEvents['afterRowResize'](currentRow,newSize,isDoubleClick);}
adjustHeight(this);},afterColumnSort:function(prevSortConfig,currentSortConfig,isValid){var d=thisObj.data("gridDataObject");var newData=[];for(var i=0;i<d.length;i++){var ni=this.toPhysicalRow(i);newData.push(d[ni]);}
d=newData;if(customEvents['afterColumnSort']!==undefined){customEvents['afterColumnSort'](prevSortConfig,currentSortConfig,isValid);}
thisObj.data("gridDataObject",d);thisObj.find(".jsonDataContainer").val(JSON.stringify(d));adjustHeight(this);thisObj.trigger("change");},beforeKeyDown:function(e){var ht=this;var editor=ht.getActiveEditor();if(editor!==undefined&&editor.$datePicker!==undefined&&editor.$datePicker.isVisible()){switch(e.keyCode){case 37:e.preventDefault();editor.$datePicker.adjustDate('subtract',1);e.stopImmediatePropagation();break;case 38:e.preventDefault();editor.$datePicker.adjustDate('subtract',7);e.stopImmediatePropagation();break;case 39:e.preventDefault();editor.$datePicker.adjustDate('add',1);e.stopImmediatePropagation();break;case 40:e.preventDefault();editor.$datePicker.adjustDate('add',7);e.stopImmediatePropagation();break;}}
if(customEvents['beforeKeyDown']!==undefined){customEvents['beforeKeyDown'](e);}},afterRender:function(isForced){var container=$(thisObj).closest(".subform-cell");if($(container).length===0){container=$(thisObj).closest(".form-cell");}
if($(container).find(".form-error-message").length>0){var ht=this;var rows=[];var data=thisObj.data("gridDataObject");if(data!==undefined){for(var i=0;i<data.length;i++){rows.push(i);}
ht.validateRows(rows);}}
if(customEvents['afterRender']!==undefined){customEvents['afterRender'](isForced);}}};if(customColWidth){settings=$.extend(settings,{colWidths:colWidths});}
if(args.readonly==="true"){settings=$.extend(settings,{allowInsertRowBoolean:false,allowRemoveRowBoolean:false});}else{var contextMenu={};if(args.disabledAdd!=="true"){contextMenu["row_above"]={name:args.msg_row_above};contextMenu["row_below"]={name:args.msg_row_below};settings=$.extend(settings,{allowInsertRowBoolean:true});}else{settings=$.extend(settings,{allowInsertRowBoolean:false});}
if(args.disabledDelete!=="true"){contextMenu["remove_row"]={name:args.msg_remove_row};settings=$.extend(settings,{allowRemoveRowBoolean:true});}else{settings=$.extend(settings,{allowRemoveRowBoolean:false});}
if(Object.keys(contextMenu).length>0){contextMenu["hsep1"]="---------";}
contextMenu["undo"]={name:args.msg_undo};contextMenu["redo"]={name:args.msg_redo};var minRows=0;if(args.validateMinRow!==null&&args.validateMinRow!==undefined&&args.validateMinRow!==""){args.validateMinRow=args.validateMinRow.replace(/[^0-9]/g,"");try{minRows=parseInt(args.validateMinRow);}catch(err){}}
var minSpareRows=1;if(args.disabledAdd!=="true"&&args.minSpareRows!==null&&args.minSpareRows!==undefined&&args.minSpareRows!==""){args.minSpareRows=args.minSpareRows.replace(/[^0-9]/g,"");try{var tempMinSpareRows=parseInt(args.minSpareRows);minSpareRows=tempMinSpareRows;}catch(err){}}else if(args.disabledAdd==="true"){minSpareRows=0;args.minSpareRows=0;}
settings=$.extend(settings,{manualRowMove:true,minRows:minRows,minSpareRows:minSpareRows,copyPaste:true,contextMenu:{items:contextMenu}});if(args.validateMaxRow!==null&&args.validateMaxRow!==undefined&&args.validateMaxRow!==""){args.validateMaxRow=args.validateMaxRow.replace(/[^0-9]/g,"");try{var validateMaxRow=parseInt(args.validateMaxRow);settings=$.extend(settings,{maxRows:validateMaxRow});}catch(err){}}}
if(args.customSettings!==null&&args.customSettings!==undefined&&args.customSettings.startsWith("{")&&args.customSettings.endsWith("}")){try{var customSettings="["+args.customSettings+"]";var customSettingsObj=eval(customSettings);settings=$.extend(settings,customSettingsObj[0]);for(var e in events){if(settings[e]!==undefined){customEvents[e]=settings[e];}}}catch(err){}}
settings=$.extend(settings,events);var container=document.getElementById($(thisObj).attr("id"));hot=new Handsontable(container,settings);var fireMouseEvent=function(element,eventName){var options={bubbles:true,cancelable:(eventName!=='mousemove'),view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,button:0,relatedTarget:undefined};var event;if(MouseEvent){event=new MouseEvent(eventName,options);}else{event=document.createEventObject();}
if(element.dispatchEvent){element.dispatchEvent(event);}else{element.fireEvent('on'+eventName,event);}};var fireTouchEvent=function(element,type,touches){var event;if(TouchEvent){event=new TouchEvent(type,{touches:touches,view:window,cancelable:true,bubbles:true});}else{event=new UIEvent(type,{bubbles:true,cancelable:false,detail:1});event.changedTouches=touches;event.targetTouches=touches;event.touches=touches;}
if(element.dispatchEvent){element.dispatchEvent(event);}else{element.fireEvent('on'+eventName,event);}};if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){$("html").addClass("ismobile");$(document).off("touchstart",".htContextMenu .wtHolder td");$(document).on("touchstart",".htContextMenu .wtHolder td",function(){var table=$(this).closest(".handsontable");setTimeout(function(){fireMouseEvent($(table).find(".wtHolder td.current")[0],"mousedown")},100);});var isMove=false;$(document).off("touchstart.custom",".handsontableInputHolder .handsontable .wtHolder");$(document).on("touchstart.custom",".handsontableInputHolder .handsontable .wtHolder",function(){$(this).closest(".handsontable").removeClass("clickable");isMove=false;});$(document).off("touchmove.custom",".handsontableInputHolder .handsontable .wtHolder");$(document).on("touchmove.custom",".handsontableInputHolder .handsontable .wtHolder",function(){isMove=true;});$(document).off("touchend.custom",".handsontableInputHolder .handsontable .wtHolder");$(document).on("touchend.custom",".handsontableInputHolder .handsontable .wtHolder",function(event){if(!isMove){$(this).closest(".handsontable").addClass("clickable");var x=event.changedTouches[0].clientX;var y=event.changedTouches[0].clientY;if(event.changedTouches[0].originalEvent){x=event.changedTouches[0].originalEvent.clientX;y=event.changedTouches[0].originalEvent.clientY;}
var element=document.elementFromPoint(x,y);fireTouchEvent(element,"touchstart",event.changedTouches);}});}
var updateWidth=function(){$(thisObj).closest(".spreadsheet_container").addClass("resize");hot.updateSettings({width:$(thisObj).closest(".spreadsheet_container").width()-1});hot.render();adjustHeight(hot);};var resizeTimeoutHolder=null;var resize=function(){$(thisObj).closest(".spreadsheet_container").addClass("resize");if(resizeTimeoutHolder){clearTimeout(resizeTimeoutHolder);}
resizeTimeoutHolder=setTimeout(function(){updateWidth();resizeTimeoutHolder=setTimeout(function(){updateWidth();$(thisObj).closest(".spreadsheet_container").removeClass("resize");},500);},1);};$(window).resize(function(){resize();});var timeoutresize=function(){setTimeout(function(){if($(thisObj).closest(".subform-cell, .form-cell").width()===0){timeoutresize();}else{resize();}},100);};timeoutresize();});},escapeRegex:function(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');},getDateFormat:function(f){f=f.toLowerCase();f=f.replace(new RegExp("m",'g'),"M");return f;}};$.fn.jwspreadsheet=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments);}else{$.error('Method '+method+' does not exist on jQuery.jwspreadsheet');}};})(jQuery);
